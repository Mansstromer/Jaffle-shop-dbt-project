[0m00:03:28.924304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6932431F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B695476B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B695476830>]}


============================== 00:03:28.929815 | 18d77acf-6643-43ed-86a9-9a1c6f480f14 ==============================
[0m00:03:28.929815 [info ] [MainThread]: Running with dbt=1.10.9
[0m00:03:28.931816 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt seed', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'None', 'log_cache_events': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\manss\\Desktop\\Case Project\\logs', 'profiles_dir': 'C:\\Users\\manss\\Desktop\\Case Project', 'static_parser': 'True', 'write_json': 'True'}
[0m00:03:28.934813 [error] [MainThread]: Encountered an error:
Runtime Error
  
  dbt encountered an error while trying to read your profiles.yml file.
  
  The profiles.yml file at C:\Users\manss\Desktop\Case Project\profiles.yml is empty
  
[0m00:03:28.936815 [debug] [MainThread]: Command `dbt seed` failed at 00:03:28.936815 after 0.05 seconds
[0m00:03:28.936815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6932431F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B695477E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B695477FD0>]}
[0m00:03:28.937815 [debug] [MainThread]: Flushing usage events
[0m00:03:29.616106 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:03:40.955826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C77DDC3220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C700193CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C700193EB0>]}


============================== 00:03:40.960951 | 5b271c16-a853-4875-a3d7-0c02177e5229 ==============================
[0m00:03:40.960951 [info ] [MainThread]: Running with dbt=1.10.9
[0m00:03:40.961957 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt seed', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'log_path': 'C:\\Users\\manss\\Desktop\\Case Project\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\manss\\Desktop\\Case Project', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True'}
[0m00:03:41.307045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b271c16-a853-4875-a3d7-0c02177e5229', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C70027D180>]}
[0m00:03:41.386717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5b271c16-a853-4875-a3d7-0c02177e5229', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7001213C0>]}
[0m00:03:41.392334 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m00:03:41.746918 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m00:03:41.748918 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m00:03:41.750294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5b271c16-a853-4875-a3d7-0c02177e5229', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7003E2E30>]}
[0m00:03:43.124686 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.case_project
- models.case_project.staging
- models.case_project.marts
[0m00:03:43.131584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b271c16-a853-4875-a3d7-0c02177e5229', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C701821AE0>]}
[0m00:03:43.210919 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\manss\Desktop\Case Project\target\manifest.json
[0m00:03:43.215889 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\manss\Desktop\Case Project\target\semantic_manifest.json
[0m00:03:43.257568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b271c16-a853-4875-a3d7-0c02177e5229', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7018074C0>]}
[0m00:03:43.257568 [info ] [MainThread]: Found 3 seeds, 429 macros
[0m00:03:43.259074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b271c16-a853-4875-a3d7-0c02177e5229', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7018226B0>]}
[0m00:03:43.261086 [info ] [MainThread]: 
[0m00:03:43.262086 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:03:43.263085 [info ] [MainThread]: 
[0m00:03:43.264086 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:03:43.272114 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m00:03:43.534730 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m00:03:43.535729 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m00:03:43.535729 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:03:43.636653 [debug] [ThreadPool]: SQL status: OK in 0.101 seconds
[0m00:03:43.639158 [debug] [ThreadPool]: On list_warehouse: Close
[0m00:03:43.640164 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_raw)
[0m00:03:43.641170 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_raw"
"
[0m00:03:43.648674 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_raw"
[0m00:03:43.649680 [debug] [ThreadPool]: On create_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_raw"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m00:03:43.650680 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:03:43.651686 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:03:43.653686 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_raw"
[0m00:03:43.653686 [debug] [ThreadPool]: On create_warehouse_main_raw: BEGIN
[0m00:03:43.654689 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:03:43.655690 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_raw"
[0m00:03:43.655690 [debug] [ThreadPool]: On create_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_raw"} */

    
    
        create schema if not exists "warehouse"."main_raw"
    
[0m00:03:43.659035 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m00:03:43.660042 [debug] [ThreadPool]: On create_warehouse_main_raw: COMMIT
[0m00:03:43.661048 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_raw"
[0m00:03:43.661048 [debug] [ThreadPool]: On create_warehouse_main_raw: COMMIT
[0m00:03:43.664220 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m00:03:43.665728 [debug] [ThreadPool]: On create_warehouse_main_raw: Close
[0m00:03:43.667735 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_raw'
[0m00:03:43.674251 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m00:03:43.675252 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m00:03:43.676251 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:03:43.676251 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:03:43.677252 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m00:03:43.677252 [debug] [ThreadPool]: On list_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_raw"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'warehouse'
  
[0m00:03:43.699123 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m00:03:43.701129 [debug] [ThreadPool]: On list_warehouse_main_raw: ROLLBACK
[0m00:03:43.703307 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_raw'
[0m00:03:43.703307 [debug] [ThreadPool]: On list_warehouse_main_raw: Close
[0m00:03:43.704344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b271c16-a853-4875-a3d7-0c02177e5229', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C70075DED0>]}
[0m00:03:43.705313 [debug] [MainThread]: Using duckdb connection "master"
[0m00:03:43.706343 [debug] [MainThread]: On master: BEGIN
[0m00:03:43.706343 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:03:43.707313 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:03:43.707313 [debug] [MainThread]: On master: COMMIT
[0m00:03:43.708848 [debug] [MainThread]: Using duckdb connection "master"
[0m00:03:43.708848 [debug] [MainThread]: On master: COMMIT
[0m00:03:43.709854 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:03:43.710854 [debug] [MainThread]: On master: Close
[0m00:03:43.716855 [debug] [Thread-1 (]: Began running node seed.case_project.raw_customers
[0m00:03:43.717855 [info ] [Thread-1 (]: 1 of 3 START seed file main_raw.raw_customers .................................. [RUN]
[0m00:03:43.718855 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.case_project.raw_customers'
[0m00:03:43.719360 [debug] [Thread-1 (]: Began compiling node seed.case_project.raw_customers
[0m00:03:43.719360 [debug] [Thread-1 (]: Began executing node seed.case_project.raw_customers
[0m00:03:43.756568 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_customers"
[0m00:03:43.757636 [debug] [Thread-1 (]: On seed.case_project.raw_customers: BEGIN
[0m00:03:43.757636 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:03:43.758642 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:03:43.759649 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_customers"
[0m00:03:43.760649 [debug] [Thread-1 (]: On seed.case_project.raw_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "seed.case_project.raw_customers"} */

    create table "warehouse"."main_raw"."raw_customers" ("id" text,"name" text)
  
[0m00:03:43.762651 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:03:43.776681 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_customers"
[0m00:03:43.776681 [debug] [Thread-1 (]: On seed.case_project.raw_customers: 
          COPY "warehouse"."main_raw"."raw_customers" FROM 'C:\Users\manss\Desktop\Case Project\seeds\raw_customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m00:03:43.799715 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m00:03:43.806714 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.case_project.raw_customers"
[0m00:03:43.824411 [debug] [Thread-1 (]: On seed.case_project.raw_customers: COMMIT
[0m00:03:43.825386 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_customers"
[0m00:03:43.825386 [debug] [Thread-1 (]: On seed.case_project.raw_customers: COMMIT
[0m00:03:43.829864 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:03:43.832863 [debug] [Thread-1 (]: On seed.case_project.raw_customers: Close
[0m00:03:43.835862 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b271c16-a853-4875-a3d7-0c02177e5229', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C701C4A200>]}
[0m00:03:43.835862 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file main_raw.raw_customers .............................. [[32mINSERT 930[0m in 0.12s]
[0m00:03:43.837862 [debug] [Thread-1 (]: Finished running node seed.case_project.raw_customers
[0m00:03:43.837862 [debug] [Thread-1 (]: Began running node seed.case_project.raw_orders
[0m00:03:43.838863 [info ] [Thread-1 (]: 2 of 3 START seed file main_raw.raw_orders ..................................... [RUN]
[0m00:03:43.839934 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.case_project.raw_customers, now seed.case_project.raw_orders)
[0m00:03:43.840932 [debug] [Thread-1 (]: Began compiling node seed.case_project.raw_orders
[0m00:03:43.840932 [debug] [Thread-1 (]: Began executing node seed.case_project.raw_orders
[0m00:03:47.706314 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_orders"
[0m00:03:47.706314 [debug] [Thread-1 (]: On seed.case_project.raw_orders: BEGIN
[0m00:03:47.707284 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:03:47.707284 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:03:47.708819 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_orders"
[0m00:03:47.709860 [debug] [Thread-1 (]: On seed.case_project.raw_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "seed.case_project.raw_orders"} */

    create table "warehouse"."main_raw"."raw_orders" ("id" text,"customer" text,"ordered_at" timestamp without time zone,"store_id" text,"subtotal" integer,"tax_paid" integer,"order_total" integer)
  
[0m00:03:47.710824 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:03:47.711856 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_orders"
[0m00:03:47.713171 [debug] [Thread-1 (]: On seed.case_project.raw_orders: 
          COPY "warehouse"."main_raw"."raw_orders" FROM 'C:\Users\manss\Desktop\Case Project\seeds\raw_orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m00:03:47.834885 [debug] [Thread-1 (]: SQL status: OK in 0.121 seconds
[0m00:03:47.835886 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.case_project.raw_orders"
[0m00:03:47.839392 [debug] [Thread-1 (]: On seed.case_project.raw_orders: COMMIT
[0m00:03:47.840399 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_orders"
[0m00:03:47.840399 [debug] [Thread-1 (]: On seed.case_project.raw_orders: COMMIT
[0m00:03:47.864789 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m00:03:47.865789 [debug] [Thread-1 (]: On seed.case_project.raw_orders: Close
[0m00:03:47.866789 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b271c16-a853-4875-a3d7-0c02177e5229', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C77DC759C0>]}
[0m00:03:47.867789 [info ] [Thread-1 (]: 2 of 3 OK loaded seed file main_raw.raw_orders ................................. [[32mINSERT 63148[0m in 4.03s]
[0m00:03:47.868801 [debug] [Thread-1 (]: Finished running node seed.case_project.raw_orders
[0m00:03:47.868801 [debug] [Thread-1 (]: Began running node seed.case_project.raw_products
[0m00:03:47.869808 [info ] [Thread-1 (]: 3 of 3 START seed file main_raw.raw_products ................................... [RUN]
[0m00:03:47.870809 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.case_project.raw_orders, now seed.case_project.raw_products)
[0m00:03:47.871807 [debug] [Thread-1 (]: Began compiling node seed.case_project.raw_products
[0m00:03:47.871807 [debug] [Thread-1 (]: Began executing node seed.case_project.raw_products
[0m00:03:47.879313 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_products"
[0m00:03:47.880317 [debug] [Thread-1 (]: On seed.case_project.raw_products: BEGIN
[0m00:03:47.881317 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:03:47.881317 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:03:47.882316 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_products"
[0m00:03:47.883316 [debug] [Thread-1 (]: On seed.case_project.raw_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "seed.case_project.raw_products"} */

    create table "warehouse"."main_raw"."raw_products" ("sku" text,"name" text,"type" text,"price" integer,"description" text)
  
[0m00:03:47.883316 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:03:47.885317 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_products"
[0m00:03:47.886317 [debug] [Thread-1 (]: On seed.case_project.raw_products: 
          COPY "warehouse"."main_raw"."raw_products" FROM 'C:\Users\manss\Desktop\Case Project\seeds\raw_products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m00:03:47.888824 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:03:47.889833 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.case_project.raw_products"
[0m00:03:47.893831 [debug] [Thread-1 (]: On seed.case_project.raw_products: COMMIT
[0m00:03:47.894831 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_products"
[0m00:03:47.894831 [debug] [Thread-1 (]: On seed.case_project.raw_products: COMMIT
[0m00:03:47.896830 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:03:47.897863 [debug] [Thread-1 (]: On seed.case_project.raw_products: Close
[0m00:03:47.898858 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b271c16-a853-4875-a3d7-0c02177e5229', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C701DABF40>]}
[0m00:03:47.900120 [info ] [Thread-1 (]: 3 of 3 OK loaded seed file main_raw.raw_products ............................... [[32mINSERT 10[0m in 0.03s]
[0m00:03:47.901120 [debug] [Thread-1 (]: Finished running node seed.case_project.raw_products
[0m00:03:47.902122 [debug] [MainThread]: Using duckdb connection "master"
[0m00:03:47.903120 [debug] [MainThread]: On master: BEGIN
[0m00:03:47.904121 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:03:47.905121 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:03:47.905121 [debug] [MainThread]: On master: COMMIT
[0m00:03:47.906119 [debug] [MainThread]: Using duckdb connection "master"
[0m00:03:47.907122 [debug] [MainThread]: On master: COMMIT
[0m00:03:47.907122 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:03:47.908631 [debug] [MainThread]: On master: Close
[0m00:03:47.908631 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:03:47.909639 [debug] [MainThread]: Connection 'create_warehouse_main_raw' was properly closed.
[0m00:03:47.910640 [debug] [MainThread]: Connection 'list_warehouse_main_raw' was properly closed.
[0m00:03:47.910640 [debug] [MainThread]: Connection 'seed.case_project.raw_products' was properly closed.
[0m00:03:47.911638 [info ] [MainThread]: 
[0m00:03:47.912640 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 4.65 seconds (4.65s).
[0m00:03:47.913639 [debug] [MainThread]: Command end result
[0m00:03:47.942708 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\manss\Desktop\Case Project\target\manifest.json
[0m00:03:47.946172 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\manss\Desktop\Case Project\target\semantic_manifest.json
[0m00:03:47.955689 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\manss\Desktop\Case Project\target\run_results.json
[0m00:03:47.956690 [info ] [MainThread]: 
[0m00:03:47.957691 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:03:47.957691 [info ] [MainThread]: 
[0m00:03:47.958829 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m00:03:47.959839 [debug] [MainThread]: Command `dbt seed` succeeded at 00:03:47.959839 after 7.11 seconds
[0m00:03:47.960869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C77DDC3220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C77F0C8370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C77D7C80D0>]}
[0m00:03:47.961839 [debug] [MainThread]: Flushing usage events
[0m00:03:48.609046 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:04:14.118885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001518ABA3100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001518CE93B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001518CE93D90>]}


============================== 00:04:14.123430 | 14f4a420-976b-4a8b-a208-07ce9af530b1 ==============================
[0m00:04:14.123430 [info ] [MainThread]: Running with dbt=1.10.9
[0m00:04:14.124447 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt seed', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'use_experimental_parser': 'False', 'printer_width': '80', 'log_path': 'C:\\Users\\manss\\Desktop\\Case Project\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\manss\\Desktop\\Case Project', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m00:04:14.412658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '14f4a420-976b-4a8b-a208-07ce9af530b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001518D0CA8F0>]}
[0m00:04:14.493034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '14f4a420-976b-4a8b-a208-07ce9af530b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001518CE91E70>]}
[0m00:04:14.496333 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m00:04:14.851583 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m00:04:15.051963 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:04:15.051963 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:04:15.062535 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.case_project
- models.case_project.staging
- models.case_project.marts
[0m00:04:15.088617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '14f4a420-976b-4a8b-a208-07ce9af530b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001518D493F40>]}
[0m00:04:15.163314 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\manss\Desktop\Case Project\target\manifest.json
[0m00:04:15.166746 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\manss\Desktop\Case Project\target\semantic_manifest.json
[0m00:04:15.195855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '14f4a420-976b-4a8b-a208-07ce9af530b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001518D472D70>]}
[0m00:04:15.196854 [info ] [MainThread]: Found 3 seeds, 429 macros
[0m00:04:15.197854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14f4a420-976b-4a8b-a208-07ce9af530b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001518D2D4490>]}
[0m00:04:15.199360 [info ] [MainThread]: 
[0m00:04:15.200692 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:04:15.201698 [info ] [MainThread]: 
[0m00:04:15.202699 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:04:15.210787 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m00:04:15.459407 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m00:04:15.460410 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m00:04:15.460410 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:04:15.485537 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m00:04:15.487537 [debug] [ThreadPool]: On list_warehouse: Close
[0m00:04:15.488537 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_raw)
[0m00:04:15.488537 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_raw"
"
[0m00:04:15.497681 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_raw"
[0m00:04:15.498654 [debug] [ThreadPool]: On create_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_raw"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m00:04:15.499193 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:04:15.500197 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:04:15.501225 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_raw"
[0m00:04:15.502228 [debug] [ThreadPool]: On create_warehouse_main_raw: BEGIN
[0m00:04:15.503195 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:04:15.503195 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_raw"
[0m00:04:15.504225 [debug] [ThreadPool]: On create_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_raw"} */

    
    
        create schema if not exists "warehouse"."main_raw"
    
[0m00:04:15.504225 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:04:15.506225 [debug] [ThreadPool]: On create_warehouse_main_raw: COMMIT
[0m00:04:15.506225 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_raw"
[0m00:04:15.507227 [debug] [ThreadPool]: On create_warehouse_main_raw: COMMIT
[0m00:04:15.507227 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:04:15.507227 [debug] [ThreadPool]: On create_warehouse_main_raw: Close
[0m00:04:15.510176 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_raw'
[0m00:04:15.517439 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m00:04:15.517439 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m00:04:15.518944 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:04:15.519951 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:04:15.519951 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m00:04:15.520951 [debug] [ThreadPool]: On list_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_raw"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'warehouse'
  
[0m00:04:15.534007 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m00:04:15.536007 [debug] [ThreadPool]: On list_warehouse_main_raw: ROLLBACK
[0m00:04:15.537290 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_raw'
[0m00:04:15.537290 [debug] [ThreadPool]: On list_warehouse_main_raw: Close
[0m00:04:15.538802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14f4a420-976b-4a8b-a208-07ce9af530b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001518CE1CD90>]}
[0m00:04:15.539809 [debug] [MainThread]: Using duckdb connection "master"
[0m00:04:15.540839 [debug] [MainThread]: On master: BEGIN
[0m00:04:15.540839 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:04:15.541812 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:04:15.542843 [debug] [MainThread]: On master: COMMIT
[0m00:04:15.542843 [debug] [MainThread]: Using duckdb connection "master"
[0m00:04:15.543839 [debug] [MainThread]: On master: COMMIT
[0m00:04:15.543839 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:04:15.544810 [debug] [MainThread]: On master: Close
[0m00:04:15.549973 [debug] [Thread-1 (]: Began running node seed.case_project.raw_customers
[0m00:04:15.550973 [info ] [Thread-1 (]: 1 of 3 START seed file main_raw.raw_customers .................................. [RUN]
[0m00:04:15.550973 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.case_project.raw_customers'
[0m00:04:15.552003 [debug] [Thread-1 (]: Began compiling node seed.case_project.raw_customers
[0m00:04:15.552972 [debug] [Thread-1 (]: Began executing node seed.case_project.raw_customers
[0m00:04:15.591970 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_customers"
[0m00:04:15.592970 [debug] [Thread-1 (]: On seed.case_project.raw_customers: BEGIN
[0m00:04:15.593970 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:04:15.594970 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:04:15.595941 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_customers"
[0m00:04:15.595941 [debug] [Thread-1 (]: On seed.case_project.raw_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "seed.case_project.raw_customers"} */
truncate table "warehouse"."main_raw"."raw_customers"
[0m00:04:15.598626 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:04:15.613466 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_customers"
[0m00:04:15.613466 [debug] [Thread-1 (]: On seed.case_project.raw_customers: 
          COPY "warehouse"."main_raw"."raw_customers" FROM 'C:\Users\manss\Desktop\Case Project\seeds\raw_customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m00:04:15.621066 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m00:04:15.628818 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.case_project.raw_customers"
[0m00:04:15.641933 [debug] [Thread-1 (]: On seed.case_project.raw_customers: COMMIT
[0m00:04:15.642934 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_customers"
[0m00:04:15.642934 [debug] [Thread-1 (]: On seed.case_project.raw_customers: COMMIT
[0m00:04:15.646810 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:04:15.649379 [debug] [Thread-1 (]: On seed.case_project.raw_customers: Close
[0m00:04:15.651412 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14f4a420-976b-4a8b-a208-07ce9af530b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015189106B30>]}
[0m00:04:15.652382 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file main_raw.raw_customers .............................. [[32mINSERT 930[0m in 0.10s]
[0m00:04:15.653406 [debug] [Thread-1 (]: Finished running node seed.case_project.raw_customers
[0m00:04:15.654406 [debug] [Thread-1 (]: Began running node seed.case_project.raw_orders
[0m00:04:15.655380 [info ] [Thread-1 (]: 2 of 3 START seed file main_raw.raw_orders ..................................... [RUN]
[0m00:04:15.656382 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.case_project.raw_customers, now seed.case_project.raw_orders)
[0m00:04:15.657380 [debug] [Thread-1 (]: Began compiling node seed.case_project.raw_orders
[0m00:04:15.657380 [debug] [Thread-1 (]: Began executing node seed.case_project.raw_orders
[0m00:04:19.073556 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_orders"
[0m00:04:19.074556 [debug] [Thread-1 (]: On seed.case_project.raw_orders: BEGIN
[0m00:04:19.074556 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:04:19.075525 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:04:19.076557 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_orders"
[0m00:04:19.077523 [debug] [Thread-1 (]: On seed.case_project.raw_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "seed.case_project.raw_orders"} */
truncate table "warehouse"."main_raw"."raw_orders"
[0m00:04:19.079060 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:04:19.080063 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_orders"
[0m00:04:19.081060 [debug] [Thread-1 (]: On seed.case_project.raw_orders: 
          COPY "warehouse"."main_raw"."raw_orders" FROM 'C:\Users\manss\Desktop\Case Project\seeds\raw_orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m00:04:19.200294 [debug] [Thread-1 (]: SQL status: OK in 0.119 seconds
[0m00:04:19.202324 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.case_project.raw_orders"
[0m00:04:19.204811 [debug] [Thread-1 (]: On seed.case_project.raw_orders: COMMIT
[0m00:04:19.205812 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_orders"
[0m00:04:19.205812 [debug] [Thread-1 (]: On seed.case_project.raw_orders: COMMIT
[0m00:04:19.242890 [debug] [Thread-1 (]: SQL status: OK in 0.037 seconds
[0m00:04:19.244878 [debug] [Thread-1 (]: On seed.case_project.raw_orders: Close
[0m00:04:19.245879 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14f4a420-976b-4a8b-a208-07ce9af530b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001518E945F60>]}
[0m00:04:19.246876 [info ] [Thread-1 (]: 2 of 3 OK loaded seed file main_raw.raw_orders ................................. [[32mINSERT 63148[0m in 3.59s]
[0m00:04:19.247876 [debug] [Thread-1 (]: Finished running node seed.case_project.raw_orders
[0m00:04:19.248876 [debug] [Thread-1 (]: Began running node seed.case_project.raw_products
[0m00:04:19.250048 [info ] [Thread-1 (]: 3 of 3 START seed file main_raw.raw_products ................................... [RUN]
[0m00:04:19.251048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.case_project.raw_orders, now seed.case_project.raw_products)
[0m00:04:19.251048 [debug] [Thread-1 (]: Began compiling node seed.case_project.raw_products
[0m00:04:19.252046 [debug] [Thread-1 (]: Began executing node seed.case_project.raw_products
[0m00:04:19.322798 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_products"
[0m00:04:19.323799 [debug] [Thread-1 (]: On seed.case_project.raw_products: BEGIN
[0m00:04:19.324829 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:04:19.325799 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:04:19.325799 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_products"
[0m00:04:19.326829 [debug] [Thread-1 (]: On seed.case_project.raw_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "seed.case_project.raw_products"} */
truncate table "warehouse"."main_raw"."raw_products"
[0m00:04:19.327822 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:04:19.329364 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_products"
[0m00:04:19.330390 [debug] [Thread-1 (]: On seed.case_project.raw_products: 
          COPY "warehouse"."main_raw"."raw_products" FROM 'C:\Users\manss\Desktop\Case Project\seeds\raw_products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m00:04:19.332402 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:04:19.333370 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.case_project.raw_products"
[0m00:04:19.335400 [debug] [Thread-1 (]: On seed.case_project.raw_products: COMMIT
[0m00:04:19.336401 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_products"
[0m00:04:19.337401 [debug] [Thread-1 (]: On seed.case_project.raw_products: COMMIT
[0m00:04:19.339108 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:04:19.340115 [debug] [Thread-1 (]: On seed.case_project.raw_products: Close
[0m00:04:19.341121 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14f4a420-976b-4a8b-a208-07ce9af530b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015189106B30>]}
[0m00:04:19.342121 [info ] [Thread-1 (]: 3 of 3 OK loaded seed file main_raw.raw_products ............................... [[32mINSERT 10[0m in 0.09s]
[0m00:04:19.343121 [debug] [Thread-1 (]: Finished running node seed.case_project.raw_products
[0m00:04:19.344121 [debug] [MainThread]: Using duckdb connection "master"
[0m00:04:19.345121 [debug] [MainThread]: On master: BEGIN
[0m00:04:19.345121 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:04:19.346121 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:04:19.347120 [debug] [MainThread]: On master: COMMIT
[0m00:04:19.347120 [debug] [MainThread]: Using duckdb connection "master"
[0m00:04:19.347120 [debug] [MainThread]: On master: COMMIT
[0m00:04:19.348624 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:04:19.348624 [debug] [MainThread]: On master: Close
[0m00:04:19.349629 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:04:19.350629 [debug] [MainThread]: Connection 'create_warehouse_main_raw' was properly closed.
[0m00:04:19.350629 [debug] [MainThread]: Connection 'list_warehouse_main_raw' was properly closed.
[0m00:04:19.351628 [debug] [MainThread]: Connection 'seed.case_project.raw_products' was properly closed.
[0m00:04:19.351628 [info ] [MainThread]: 
[0m00:04:19.352631 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 4.15 seconds (4.15s).
[0m00:04:19.354630 [debug] [MainThread]: Command end result
[0m00:04:19.379832 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\manss\Desktop\Case Project\target\manifest.json
[0m00:04:19.383726 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\manss\Desktop\Case Project\target\semantic_manifest.json
[0m00:04:19.392118 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\manss\Desktop\Case Project\target\run_results.json
[0m00:04:19.393117 [info ] [MainThread]: 
[0m00:04:19.394116 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:04:19.394116 [info ] [MainThread]: 
[0m00:04:19.395086 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m00:04:19.396086 [debug] [MainThread]: Command `dbt seed` succeeded at 00:04:19.396086 after 5.37 seconds
[0m00:04:19.397087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001518ABA3100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001518BEAAD70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015188FC4910>]}
[0m00:04:19.397087 [debug] [MainThread]: Flushing usage events
[0m00:04:20.124032 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:10:35.295798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CB9313130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CBB607B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CBB607D60>]}


============================== 00:10:35.300309 | 7ddf5025-fa1e-45fd-a6cc-2554452fe07f ==============================
[0m00:10:35.300309 [info ] [MainThread]: Running with dbt=1.10.9
[0m00:10:35.301309 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --select staging', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\manss\\Desktop\\Case Project\\logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': 'C:\\Users\\manss\\Desktop\\Case Project'}
[0m00:10:35.584734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ddf5025-fa1e-45fd-a6cc-2554452fe07f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CBB6F8C10>]}
[0m00:10:35.663296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ddf5025-fa1e-45fd-a6cc-2554452fe07f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CBADCA830>]}
[0m00:10:35.666740 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m00:10:36.060052 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m00:10:36.301019 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 0 files changed.
[0m00:10:36.302020 [debug] [MainThread]: Partial parsing: added file: case_project://models\staging\stg_customers.sql
[0m00:10:36.303019 [debug] [MainThread]: Partial parsing: added file: case_project://models\staging\staging.yml
[0m00:10:36.303019 [debug] [MainThread]: Partial parsing: added file: case_project://models\staging\stg_orders.sql
[0m00:10:36.304020 [debug] [MainThread]: Partial parsing: added file: case_project://models\sources.yml
[0m00:10:36.305019 [debug] [MainThread]: Partial parsing: added file: case_project://models\staging\stg_products.sql
[0m00:10:36.885245 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m00:10:36.885799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7ddf5025-fa1e-45fd-a6cc-2554452fe07f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CBCE06FB0>]}
[0m00:10:37.163011 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.case_project.marts
[0m00:10:37.178024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ddf5025-fa1e-45fd-a6cc-2554452fe07f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CBCF3A6B0>]}
[0m00:10:37.337882 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\manss\Desktop\Case Project\target\manifest.json
[0m00:10:37.341884 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\manss\Desktop\Case Project\target\semantic_manifest.json
[0m00:10:37.371610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ddf5025-fa1e-45fd-a6cc-2554452fe07f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CBBBF22F0>]}
[0m00:10:37.372610 [info ] [MainThread]: Found 3 seeds, 3 models, 9 data tests, 3 sources, 429 macros
[0m00:10:37.373611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ddf5025-fa1e-45fd-a6cc-2554452fe07f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CBBB96B60>]}
[0m00:10:37.375611 [info ] [MainThread]: 
[0m00:10:37.376610 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:10:37.377612 [info ] [MainThread]: 
[0m00:10:37.378726 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:10:37.386724 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m00:10:37.607532 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m00:10:37.608037 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m00:10:37.609040 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:10:37.632056 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m00:10:37.634058 [debug] [ThreadPool]: On list_warehouse: Close
[0m00:10:37.635057 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_staging)
[0m00:10:37.636057 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_staging"
"
[0m00:10:37.645075 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m00:10:37.645075 [debug] [ThreadPool]: On create_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m00:10:37.646081 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:10:37.647586 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:10:37.648593 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m00:10:37.649591 [debug] [ThreadPool]: On create_warehouse_main_staging: BEGIN
[0m00:10:37.650591 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:10:37.650591 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m00:10:37.651591 [debug] [ThreadPool]: On create_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_staging"} */

    
    
        create schema if not exists "warehouse"."main_staging"
    
[0m00:10:37.652591 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:10:37.653593 [debug] [ThreadPool]: On create_warehouse_main_staging: COMMIT
[0m00:10:37.654593 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m00:10:37.654593 [debug] [ThreadPool]: On create_warehouse_main_staging: COMMIT
[0m00:10:37.659102 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m00:10:37.659102 [debug] [ThreadPool]: On create_warehouse_main_staging: Close
[0m00:10:37.661106 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_raw'
[0m00:10:37.668614 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m00:10:37.669618 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m00:10:37.669618 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:10:37.670619 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:10:37.671619 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m00:10:37.671619 [debug] [ThreadPool]: On list_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_raw"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'warehouse'
  
[0m00:10:37.685219 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m00:10:37.686219 [debug] [ThreadPool]: On list_warehouse_main_raw: ROLLBACK
[0m00:10:37.687724 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_raw'
[0m00:10:37.688729 [debug] [ThreadPool]: On list_warehouse_main_raw: Close
[0m00:10:37.689731 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_raw, now list_warehouse_main_staging)
[0m00:10:37.693730 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_staging"
[0m00:10:37.693730 [debug] [ThreadPool]: On list_warehouse_main_staging: BEGIN
[0m00:10:37.694730 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:10:37.695729 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:10:37.695729 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_staging"
[0m00:10:37.696730 [debug] [ThreadPool]: On list_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_staging"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'warehouse'
  
[0m00:10:37.699910 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m00:10:37.701911 [debug] [ThreadPool]: On list_warehouse_main_staging: ROLLBACK
[0m00:10:37.701911 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_staging'
[0m00:10:37.702910 [debug] [ThreadPool]: On list_warehouse_main_staging: Close
[0m00:10:37.703911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ddf5025-fa1e-45fd-a6cc-2554452fe07f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CBCEF1630>]}
[0m00:10:37.704912 [debug] [MainThread]: Using duckdb connection "master"
[0m00:10:37.704912 [debug] [MainThread]: On master: BEGIN
[0m00:10:37.705911 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:10:37.705911 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:10:37.707416 [debug] [MainThread]: On master: COMMIT
[0m00:10:37.708422 [debug] [MainThread]: Using duckdb connection "master"
[0m00:10:37.708422 [debug] [MainThread]: On master: COMMIT
[0m00:10:37.709422 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:10:37.710423 [debug] [MainThread]: On master: Close
[0m00:10:37.714421 [debug] [Thread-1 (]: Began running node model.case_project.stg_customers
[0m00:10:37.715422 [info ] [Thread-1 (]: 1 of 3 START sql view model main_staging.stg_customers ......................... [RUN]
[0m00:10:37.716426 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.case_project.stg_customers'
[0m00:10:37.717426 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_customers
[0m00:10:37.727451 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_customers"
[0m00:10:37.730460 [debug] [Thread-1 (]: Began executing node model.case_project.stg_customers
[0m00:10:37.769958 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_customers"
[0m00:10:37.771954 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m00:10:37.772955 [debug] [Thread-1 (]: On model.case_project.stg_customers: BEGIN
[0m00:10:37.772955 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:10:37.773954 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:10:37.774955 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m00:10:37.775954 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */

  
  create view "warehouse"."main_staging"."stg_customers__dbt_tmp" as (
    with src as (
  select * from "warehouse"."raw"."raw_customers"
)
select
  -- UUIDs -> keep as text
  cast(id as varchar)        as customer_id,
  lower(trim(first_name))    as first_name,   -- adjust names if different in your CSV
  lower(trim(last_name))     as last_name,
  lower(trim(email))         as email
from src
  );

[0m00:10:37.785367 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */

  
  create view "warehouse"."main_staging"."stg_customers__dbt_tmp" as (
    with src as (
  select * from "warehouse"."raw"."raw_customers"
)
select
  -- UUIDs -> keep as text
  cast(id as varchar)        as customer_id,
  lower(trim(first_name))    as first_name,   -- adjust names if different in your CSV
  lower(trim(last_name))     as last_name,
  lower(trim(email))         as email
from src
  );

[0m00:10:37.786338 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m00:10:37.787368 [debug] [Thread-1 (]: On model.case_project.stg_customers: ROLLBACK
[0m00:10:37.795842 [debug] [Thread-1 (]: Failed to rollback 'model.case_project.stg_customers'
[0m00:10:37.797348 [debug] [Thread-1 (]: On model.case_project.stg_customers: Close
[0m00:10:37.799356 [debug] [Thread-1 (]: Runtime Error in model stg_customers (models\staging\stg_customers.sql)
  Catalog Error: Table with name raw_customers does not exist!
  Did you mean "main_raw.raw_customers"?
  
  LINE 6:   select * from "warehouse"."raw"."raw_customers"
                          ^
[0m00:10:37.802353 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ddf5025-fa1e-45fd-a6cc-2554452fe07f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CBD49BFD0>]}
[0m00:10:37.803355 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main_staging.stg_customers ................ [[31mERROR[0m in 0.08s]
[0m00:10:37.804356 [debug] [Thread-1 (]: Finished running node model.case_project.stg_customers
[0m00:10:37.805354 [debug] [Thread-1 (]: Began running node model.case_project.stg_orders
[0m00:10:37.805354 [debug] [Thread-4 (]: Marking all children of 'model.case_project.stg_customers' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_customers (models\staging\stg_customers.sql)
  Catalog Error: Table with name raw_customers does not exist!
  Did you mean "main_raw.raw_customers"?
  
  LINE 6:   select * from "warehouse"."raw"."raw_customers"
                          ^.
[0m00:10:37.806355 [info ] [Thread-1 (]: 2 of 3 START sql view model main_staging.stg_orders ............................ [RUN]
[0m00:10:37.807866 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_customers, now model.case_project.stg_orders)
[0m00:10:37.808869 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_orders
[0m00:10:37.812866 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_orders"
[0m00:10:37.813980 [debug] [Thread-1 (]: Began executing node model.case_project.stg_orders
[0m00:10:37.819493 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_orders"
[0m00:10:37.821495 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m00:10:37.822493 [debug] [Thread-1 (]: On model.case_project.stg_orders: BEGIN
[0m00:10:37.823494 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:10:37.824492 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:10:37.824492 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m00:10:37.825491 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */

  
  create view "warehouse"."main_staging"."stg_orders__dbt_tmp" as (
    with src as (
  select * from "warehouse"."raw"."raw_orders"
)
select
  cast(id as varchar)                 as order_id,
  cast(customer as varchar)           as customer_id,
  cast(store_id as varchar)           as store_id,
  cast(ordered_at as timestamp)       as ordered_at,
  cast(subtotal as double)            as subtotal,
  cast(tax_paid as double)            as tax_paid,
  cast(order_total as double)         as order_total
from src
  );

[0m00:10:37.826492 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */

  
  create view "warehouse"."main_staging"."stg_orders__dbt_tmp" as (
    with src as (
  select * from "warehouse"."raw"."raw_orders"
)
select
  cast(id as varchar)                 as order_id,
  cast(customer as varchar)           as customer_id,
  cast(store_id as varchar)           as store_id,
  cast(ordered_at as timestamp)       as ordered_at,
  cast(subtotal as double)            as subtotal,
  cast(tax_paid as double)            as tax_paid,
  cast(order_total as double)         as order_total
from src
  );

[0m00:10:37.827492 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m00:10:37.828538 [debug] [Thread-1 (]: On model.case_project.stg_orders: ROLLBACK
[0m00:10:37.830538 [debug] [Thread-1 (]: Failed to rollback 'model.case_project.stg_orders'
[0m00:10:37.830538 [debug] [Thread-1 (]: On model.case_project.stg_orders: Close
[0m00:10:37.832537 [debug] [Thread-1 (]: Runtime Error in model stg_orders (models\staging\stg_orders.sql)
  Catalog Error: Table with name raw_orders does not exist!
  Did you mean "main_raw.raw_orders"?
  
  LINE 6:   select * from "warehouse"."raw"."raw_orders"
                          ^
[0m00:10:37.833540 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ddf5025-fa1e-45fd-a6cc-2554452fe07f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CBCF961A0>]}
[0m00:10:37.835542 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model main_staging.stg_orders ................... [[31mERROR[0m in 0.03s]
[0m00:10:37.836539 [debug] [Thread-1 (]: Finished running node model.case_project.stg_orders
[0m00:10:37.837538 [debug] [Thread-1 (]: Began running node model.case_project.stg_products
[0m00:10:37.837538 [debug] [Thread-4 (]: Marking all children of 'model.case_project.stg_orders' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_orders (models\staging\stg_orders.sql)
  Catalog Error: Table with name raw_orders does not exist!
  Did you mean "main_raw.raw_orders"?
  
  LINE 6:   select * from "warehouse"."raw"."raw_orders"
                          ^.
[0m00:10:37.839015 [info ] [Thread-1 (]: 3 of 3 START sql view model main_staging.stg_products .......................... [RUN]
[0m00:10:37.840011 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_orders, now model.case_project.stg_products)
[0m00:10:37.840011 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_products
[0m00:10:37.844518 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_products"
[0m00:10:37.846524 [debug] [Thread-1 (]: Began executing node model.case_project.stg_products
[0m00:10:37.851034 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_products"
[0m00:10:37.853033 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m00:10:37.854035 [debug] [Thread-1 (]: On model.case_project.stg_products: BEGIN
[0m00:10:37.855031 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:10:37.856032 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:10:37.856032 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m00:10:37.857538 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */

  
  create view "warehouse"."main_staging"."stg_products__dbt_tmp" as (
    with src as (select * from "warehouse"."raw"."raw_products")
select
  cast(id as varchar)      as product_id,
  lower(trim(name))        as product_name,
  cast(price as double)    as price
from src
  );

[0m00:10:37.858544 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */

  
  create view "warehouse"."main_staging"."stg_products__dbt_tmp" as (
    with src as (select * from "warehouse"."raw"."raw_products")
select
  cast(id as varchar)      as product_id,
  lower(trim(name))        as product_name,
  cast(price as double)    as price
from src
  );

[0m00:10:37.859545 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m00:10:37.859545 [debug] [Thread-1 (]: On model.case_project.stg_products: ROLLBACK
[0m00:10:37.861544 [debug] [Thread-1 (]: Failed to rollback 'model.case_project.stg_products'
[0m00:10:37.862545 [debug] [Thread-1 (]: On model.case_project.stg_products: Close
[0m00:10:37.864548 [debug] [Thread-1 (]: Runtime Error in model stg_products (models\staging\stg_products.sql)
  Catalog Error: Table with name raw_products does not exist!
  Did you mean "main_raw.raw_products"?
  
  LINE 5:     with src as (select * from "warehouse"."raw"."raw_products")
                                         ^
[0m00:10:37.865548 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ddf5025-fa1e-45fd-a6cc-2554452fe07f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CBD549C60>]}
[0m00:10:37.866546 [error] [Thread-1 (]: 3 of 3 ERROR creating sql view model main_staging.stg_products ................. [[31mERROR[0m in 0.03s]
[0m00:10:37.867544 [debug] [Thread-1 (]: Finished running node model.case_project.stg_products
[0m00:10:37.868051 [debug] [Thread-4 (]: Marking all children of 'model.case_project.stg_products' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_products (models\staging\stg_products.sql)
  Catalog Error: Table with name raw_products does not exist!
  Did you mean "main_raw.raw_products"?
  
  LINE 5:     with src as (select * from "warehouse"."raw"."raw_products")
                                         ^.
[0m00:10:37.870056 [debug] [MainThread]: Using duckdb connection "master"
[0m00:10:37.871055 [debug] [MainThread]: On master: BEGIN
[0m00:10:37.871055 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:10:37.872054 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:10:37.873053 [debug] [MainThread]: On master: COMMIT
[0m00:10:37.874052 [debug] [MainThread]: Using duckdb connection "master"
[0m00:10:37.874052 [debug] [MainThread]: On master: COMMIT
[0m00:10:37.875054 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:10:37.876052 [debug] [MainThread]: On master: Close
[0m00:10:37.876052 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:10:37.876052 [debug] [MainThread]: Connection 'create_warehouse_main_staging' was properly closed.
[0m00:10:37.877557 [debug] [MainThread]: Connection 'list_warehouse_main_staging' was properly closed.
[0m00:10:37.878566 [debug] [MainThread]: Connection 'model.case_project.stg_products' was properly closed.
[0m00:10:37.879565 [info ] [MainThread]: 
[0m00:10:37.879565 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m00:10:37.881567 [debug] [MainThread]: Command end result
[0m00:10:37.912091 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\manss\Desktop\Case Project\target\manifest.json
[0m00:10:37.916091 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\manss\Desktop\Case Project\target\semantic_manifest.json
[0m00:10:37.925603 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\manss\Desktop\Case Project\target\run_results.json
[0m00:10:37.925603 [info ] [MainThread]: 
[0m00:10:37.926603 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m00:10:37.927605 [info ] [MainThread]: 
[0m00:10:37.928982 [error] [MainThread]: [31mFailure in model stg_customers (models\staging\stg_customers.sql)[0m
[0m00:10:37.928982 [error] [MainThread]:   Runtime Error in model stg_customers (models\staging\stg_customers.sql)
  Catalog Error: Table with name raw_customers does not exist!
  Did you mean "main_raw.raw_customers"?
  
  LINE 6:   select * from "warehouse"."raw"."raw_customers"
                          ^
[0m00:10:37.929981 [info ] [MainThread]: 
[0m00:10:37.930983 [info ] [MainThread]:   compiled code at target\compiled\case_project\models\staging\stg_customers.sql
[0m00:10:37.931980 [info ] [MainThread]: 
[0m00:10:37.932981 [error] [MainThread]: [31mFailure in model stg_orders (models\staging\stg_orders.sql)[0m
[0m00:10:37.932981 [error] [MainThread]:   Runtime Error in model stg_orders (models\staging\stg_orders.sql)
  Catalog Error: Table with name raw_orders does not exist!
  Did you mean "main_raw.raw_orders"?
  
  LINE 6:   select * from "warehouse"."raw"."raw_orders"
                          ^
[0m00:10:37.933981 [info ] [MainThread]: 
[0m00:10:37.934982 [info ] [MainThread]:   compiled code at target\compiled\case_project\models\staging\stg_orders.sql
[0m00:10:37.934982 [info ] [MainThread]: 
[0m00:10:37.935982 [error] [MainThread]: [31mFailure in model stg_products (models\staging\stg_products.sql)[0m
[0m00:10:37.935982 [error] [MainThread]:   Runtime Error in model stg_products (models\staging\stg_products.sql)
  Catalog Error: Table with name raw_products does not exist!
  Did you mean "main_raw.raw_products"?
  
  LINE 5:     with src as (select * from "warehouse"."raw"."raw_products")
                                         ^
[0m00:10:37.937487 [info ] [MainThread]: 
[0m00:10:37.938497 [info ] [MainThread]:   compiled code at target\compiled\case_project\models\staging\stg_products.sql
[0m00:10:37.939497 [info ] [MainThread]: 
[0m00:10:37.940497 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=3
[0m00:10:37.941497 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m00:10:37.942498 [debug] [MainThread]: Command `dbt run` failed at 00:10:37.942498 after 2.74 seconds
[0m00:10:37.943498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CB9313130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CBB6F8C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CBBC1E8F0>]}
[0m00:10:37.944495 [debug] [MainThread]: Flushing usage events
[0m00:10:38.638734 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:10:44.569543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272E10031F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272E3307B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272E3307D60>]}


============================== 00:10:44.573541 | 69012410-a7e8-4ad7-a079-83cc739f6f84 ==============================
[0m00:10:44.573541 [info ] [MainThread]: Running with dbt=1.10.9
[0m00:10:44.574114 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run --select staging', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\manss\\Desktop\\Case Project\\logs', 'profiles_dir': 'C:\\Users\\manss\\Desktop\\Case Project', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m00:10:44.856256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '69012410-a7e8-4ad7-a079-83cc739f6f84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272E2A54880>]}
[0m00:10:44.934724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '69012410-a7e8-4ad7-a079-83cc739f6f84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272E3307070>]}
[0m00:10:44.938900 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m00:10:45.290077 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m00:10:45.588449 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:10:45.589449 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:10:45.598964 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.case_project.marts
[0m00:10:45.684245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '69012410-a7e8-4ad7-a079-83cc739f6f84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272E39800A0>]}
[0m00:10:45.836734 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\manss\Desktop\Case Project\target\manifest.json
[0m00:10:45.839926 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\manss\Desktop\Case Project\target\semantic_manifest.json
[0m00:10:45.905241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '69012410-a7e8-4ad7-a079-83cc739f6f84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272E38640D0>]}
[0m00:10:45.906239 [info ] [MainThread]: Found 3 seeds, 3 models, 9 data tests, 3 sources, 429 macros
[0m00:10:45.906239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69012410-a7e8-4ad7-a079-83cc739f6f84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272E38640D0>]}
[0m00:10:45.908788 [info ] [MainThread]: 
[0m00:10:45.909781 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:10:45.910753 [info ] [MainThread]: 
[0m00:10:45.911782 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:10:45.919329 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m00:10:46.125072 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m00:10:46.126070 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m00:10:46.126070 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:10:46.148917 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m00:10:46.150917 [debug] [ThreadPool]: On list_warehouse: Close
[0m00:10:46.151887 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_staging)
[0m00:10:46.152917 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_staging"
"
[0m00:10:46.161075 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m00:10:46.162108 [debug] [ThreadPool]: On create_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m00:10:46.162108 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:10:46.163106 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:10:46.165106 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m00:10:46.166077 [debug] [ThreadPool]: On create_warehouse_main_staging: BEGIN
[0m00:10:46.166077 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:10:46.166077 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m00:10:46.167582 [debug] [ThreadPool]: On create_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_staging"} */

    
    
        create schema if not exists "warehouse"."main_staging"
    
[0m00:10:46.168591 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:10:46.169598 [debug] [ThreadPool]: On create_warehouse_main_staging: COMMIT
[0m00:10:46.169598 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m00:10:46.170596 [debug] [ThreadPool]: On create_warehouse_main_staging: COMMIT
[0m00:10:46.171595 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:10:46.171595 [debug] [ThreadPool]: On create_warehouse_main_staging: Close
[0m00:10:46.173596 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_raw'
[0m00:10:46.181134 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m00:10:46.181134 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m00:10:46.182105 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:10:46.183105 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:10:46.183105 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m00:10:46.184104 [debug] [ThreadPool]: On list_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_raw"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'warehouse'
  
[0m00:10:46.196673 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m00:10:46.198180 [debug] [ThreadPool]: On list_warehouse_main_raw: ROLLBACK
[0m00:10:46.199213 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_raw'
[0m00:10:46.200212 [debug] [ThreadPool]: On list_warehouse_main_raw: Close
[0m00:10:46.201212 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_raw, now list_warehouse_main_staging)
[0m00:10:46.205513 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_staging"
[0m00:10:46.205513 [debug] [ThreadPool]: On list_warehouse_main_staging: BEGIN
[0m00:10:46.206513 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:10:46.206513 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:10:46.207483 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_staging"
[0m00:10:46.208023 [debug] [ThreadPool]: On list_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_staging"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'warehouse'
  
[0m00:10:46.211055 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m00:10:46.212025 [debug] [ThreadPool]: On list_warehouse_main_staging: ROLLBACK
[0m00:10:46.213056 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_staging'
[0m00:10:46.214025 [debug] [ThreadPool]: On list_warehouse_main_staging: Close
[0m00:10:46.214025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69012410-a7e8-4ad7-a079-83cc739f6f84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272E235F8B0>]}
[0m00:10:46.215055 [debug] [MainThread]: Using duckdb connection "master"
[0m00:10:46.216025 [debug] [MainThread]: On master: BEGIN
[0m00:10:46.216025 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:10:46.217534 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:10:46.217534 [debug] [MainThread]: On master: COMMIT
[0m00:10:46.218542 [debug] [MainThread]: Using duckdb connection "master"
[0m00:10:46.219547 [debug] [MainThread]: On master: COMMIT
[0m00:10:46.219547 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:10:46.220548 [debug] [MainThread]: On master: Close
[0m00:10:46.224987 [debug] [Thread-1 (]: Began running node model.case_project.stg_customers
[0m00:10:46.226024 [info ] [Thread-1 (]: 1 of 3 START sql view model main_staging.stg_customers ......................... [RUN]
[0m00:10:46.226024 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.case_project.stg_customers'
[0m00:10:46.227530 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_customers
[0m00:10:46.237538 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_customers"
[0m00:10:46.238078 [debug] [Thread-1 (]: Began executing node model.case_project.stg_customers
[0m00:10:46.275702 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_customers"
[0m00:10:46.277674 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m00:10:46.277674 [debug] [Thread-1 (]: On model.case_project.stg_customers: BEGIN
[0m00:10:46.279158 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:10:46.280165 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:10:46.281164 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m00:10:46.281164 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */

  
  create view "warehouse"."main_staging"."stg_customers__dbt_tmp" as (
    with src as (
  select * from "warehouse"."raw"."raw_customers"
)
select
  -- UUIDs -> keep as text
  cast(id as varchar)        as customer_id,
  lower(trim(first_name))    as first_name,   -- adjust names if different in your CSV
  lower(trim(last_name))     as last_name,
  lower(trim(email))         as email
from src
  );

[0m00:10:46.282164 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */

  
  create view "warehouse"."main_staging"."stg_customers__dbt_tmp" as (
    with src as (
  select * from "warehouse"."raw"."raw_customers"
)
select
  -- UUIDs -> keep as text
  cast(id as varchar)        as customer_id,
  lower(trim(first_name))    as first_name,   -- adjust names if different in your CSV
  lower(trim(last_name))     as last_name,
  lower(trim(email))         as email
from src
  );

[0m00:10:46.283164 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m00:10:46.284165 [debug] [Thread-1 (]: On model.case_project.stg_customers: ROLLBACK
[0m00:10:46.291671 [debug] [Thread-1 (]: Failed to rollback 'model.case_project.stg_customers'
[0m00:10:46.292671 [debug] [Thread-1 (]: On model.case_project.stg_customers: Close
[0m00:10:46.294901 [debug] [Thread-1 (]: Runtime Error in model stg_customers (models\staging\stg_customers.sql)
  Catalog Error: Table with name raw_customers does not exist!
  Did you mean "main_raw.raw_customers"?
  
  LINE 6:   select * from "warehouse"."raw"."raw_customers"
                          ^
[0m00:10:46.297382 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69012410-a7e8-4ad7-a079-83cc739f6f84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272E353F670>]}
[0m00:10:46.298388 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main_staging.stg_customers ................ [[31mERROR[0m in 0.07s]
[0m00:10:46.299388 [debug] [Thread-1 (]: Finished running node model.case_project.stg_customers
[0m00:10:46.300388 [debug] [Thread-1 (]: Began running node model.case_project.stg_orders
[0m00:10:46.300388 [debug] [Thread-4 (]: Marking all children of 'model.case_project.stg_customers' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_customers (models\staging\stg_customers.sql)
  Catalog Error: Table with name raw_customers does not exist!
  Did you mean "main_raw.raw_customers"?
  
  LINE 6:   select * from "warehouse"."raw"."raw_customers"
                          ^.
[0m00:10:46.301418 [info ] [Thread-1 (]: 2 of 3 START sql view model main_staging.stg_orders ............................ [RUN]
[0m00:10:46.303392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_customers, now model.case_project.stg_orders)
[0m00:10:46.304419 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_orders
[0m00:10:46.307955 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_orders"
[0m00:10:46.309960 [debug] [Thread-1 (]: Began executing node model.case_project.stg_orders
[0m00:10:46.314959 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_orders"
[0m00:10:46.315960 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m00:10:46.317465 [debug] [Thread-1 (]: On model.case_project.stg_orders: BEGIN
[0m00:10:46.317465 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:10:46.318471 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:10:46.319471 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m00:10:46.319471 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */

  
  create view "warehouse"."main_staging"."stg_orders__dbt_tmp" as (
    with src as (
  select * from "warehouse"."raw"."raw_orders"
)
select
  cast(id as varchar)                 as order_id,
  cast(customer as varchar)           as customer_id,
  cast(store_id as varchar)           as store_id,
  cast(ordered_at as timestamp)       as ordered_at,
  cast(subtotal as double)            as subtotal,
  cast(tax_paid as double)            as tax_paid,
  cast(order_total as double)         as order_total
from src
  );

[0m00:10:46.321478 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */

  
  create view "warehouse"."main_staging"."stg_orders__dbt_tmp" as (
    with src as (
  select * from "warehouse"."raw"."raw_orders"
)
select
  cast(id as varchar)                 as order_id,
  cast(customer as varchar)           as customer_id,
  cast(store_id as varchar)           as store_id,
  cast(ordered_at as timestamp)       as ordered_at,
  cast(subtotal as double)            as subtotal,
  cast(tax_paid as double)            as tax_paid,
  cast(order_total as double)         as order_total
from src
  );

[0m00:10:46.321478 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m00:10:46.322477 [debug] [Thread-1 (]: On model.case_project.stg_orders: ROLLBACK
[0m00:10:46.324508 [debug] [Thread-1 (]: Failed to rollback 'model.case_project.stg_orders'
[0m00:10:46.325507 [debug] [Thread-1 (]: On model.case_project.stg_orders: Close
[0m00:10:46.327507 [debug] [Thread-1 (]: Runtime Error in model stg_orders (models\staging\stg_orders.sql)
  Catalog Error: Table with name raw_orders does not exist!
  Did you mean "main_raw.raw_orders"?
  
  LINE 6:   select * from "warehouse"."raw"."raw_orders"
                          ^
[0m00:10:46.327507 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69012410-a7e8-4ad7-a079-83cc739f6f84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272E0EB59C0>]}
[0m00:10:46.328900 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model main_staging.stg_orders ................... [[31mERROR[0m in 0.02s]
[0m00:10:46.329899 [debug] [Thread-1 (]: Finished running node model.case_project.stg_orders
[0m00:10:46.330899 [debug] [Thread-1 (]: Began running node model.case_project.stg_products
[0m00:10:46.331899 [debug] [Thread-4 (]: Marking all children of 'model.case_project.stg_orders' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_orders (models\staging\stg_orders.sql)
  Catalog Error: Table with name raw_orders does not exist!
  Did you mean "main_raw.raw_orders"?
  
  LINE 6:   select * from "warehouse"."raw"."raw_orders"
                          ^.
[0m00:10:46.331899 [info ] [Thread-1 (]: 3 of 3 START sql view model main_staging.stg_products .......................... [RUN]
[0m00:10:46.333899 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_orders, now model.case_project.stg_products)
[0m00:10:46.334899 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_products
[0m00:10:46.340423 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_products"
[0m00:10:46.341418 [debug] [Thread-1 (]: Began executing node model.case_project.stg_products
[0m00:10:46.346420 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_products"
[0m00:10:46.347452 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m00:10:46.348844 [debug] [Thread-1 (]: On model.case_project.stg_products: BEGIN
[0m00:10:46.348844 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:10:46.349846 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:10:46.350843 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m00:10:46.351842 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */

  
  create view "warehouse"."main_staging"."stg_products__dbt_tmp" as (
    with src as (select * from "warehouse"."raw"."raw_products")
select
  cast(id as varchar)      as product_id,
  lower(trim(name))        as product_name,
  cast(price as double)    as price
from src
  );

[0m00:10:46.352842 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */

  
  create view "warehouse"."main_staging"."stg_products__dbt_tmp" as (
    with src as (select * from "warehouse"."raw"."raw_products")
select
  cast(id as varchar)      as product_id,
  lower(trim(name))        as product_name,
  cast(price as double)    as price
from src
  );

[0m00:10:46.353842 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m00:10:46.353842 [debug] [Thread-1 (]: On model.case_project.stg_products: ROLLBACK
[0m00:10:46.355844 [debug] [Thread-1 (]: Failed to rollback 'model.case_project.stg_products'
[0m00:10:46.357352 [debug] [Thread-1 (]: On model.case_project.stg_products: Close
[0m00:10:46.358864 [debug] [Thread-1 (]: Runtime Error in model stg_products (models\staging\stg_products.sql)
  Catalog Error: Table with name raw_products does not exist!
  Did you mean "main_raw.raw_products"?
  
  LINE 5:     with src as (select * from "warehouse"."raw"."raw_products")
                                         ^
[0m00:10:46.359871 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69012410-a7e8-4ad7-a079-83cc739f6f84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272E4D68280>]}
[0m00:10:46.360878 [error] [Thread-1 (]: 3 of 3 ERROR creating sql view model main_staging.stg_products ................. [[31mERROR[0m in 0.03s]
[0m00:10:46.361878 [debug] [Thread-1 (]: Finished running node model.case_project.stg_products
[0m00:10:46.362878 [debug] [Thread-4 (]: Marking all children of 'model.case_project.stg_products' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_products (models\staging\stg_products.sql)
  Catalog Error: Table with name raw_products does not exist!
  Did you mean "main_raw.raw_products"?
  
  LINE 5:     with src as (select * from "warehouse"."raw"."raw_products")
                                         ^.
[0m00:10:46.364879 [debug] [MainThread]: Using duckdb connection "master"
[0m00:10:46.364879 [debug] [MainThread]: On master: BEGIN
[0m00:10:46.365907 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:10:46.365907 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:10:46.367443 [debug] [MainThread]: On master: COMMIT
[0m00:10:46.367443 [debug] [MainThread]: Using duckdb connection "master"
[0m00:10:46.368452 [debug] [MainThread]: On master: COMMIT
[0m00:10:46.369452 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:10:46.369452 [debug] [MainThread]: On master: Close
[0m00:10:46.370479 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:10:46.370479 [debug] [MainThread]: Connection 'create_warehouse_main_staging' was properly closed.
[0m00:10:46.371449 [debug] [MainThread]: Connection 'list_warehouse_main_staging' was properly closed.
[0m00:10:46.372452 [debug] [MainThread]: Connection 'model.case_project.stg_products' was properly closed.
[0m00:10:46.372452 [info ] [MainThread]: 
[0m00:10:46.373479 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m00:10:46.375448 [debug] [MainThread]: Command end result
[0m00:10:46.405658 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\manss\Desktop\Case Project\target\manifest.json
[0m00:10:46.409856 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\manss\Desktop\Case Project\target\semantic_manifest.json
[0m00:10:46.418430 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\manss\Desktop\Case Project\target\run_results.json
[0m00:10:46.419432 [info ] [MainThread]: 
[0m00:10:46.420404 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m00:10:46.421402 [info ] [MainThread]: 
[0m00:10:46.421402 [error] [MainThread]: [31mFailure in model stg_customers (models\staging\stg_customers.sql)[0m
[0m00:10:46.422401 [error] [MainThread]:   Runtime Error in model stg_customers (models\staging\stg_customers.sql)
  Catalog Error: Table with name raw_customers does not exist!
  Did you mean "main_raw.raw_customers"?
  
  LINE 6:   select * from "warehouse"."raw"."raw_customers"
                          ^
[0m00:10:46.423401 [info ] [MainThread]: 
[0m00:10:46.424402 [info ] [MainThread]:   compiled code at target\compiled\case_project\models\staging\stg_customers.sql
[0m00:10:46.425401 [info ] [MainThread]: 
[0m00:10:46.426406 [error] [MainThread]: [31mFailure in model stg_orders (models\staging\stg_orders.sql)[0m
[0m00:10:46.426406 [error] [MainThread]:   Runtime Error in model stg_orders (models\staging\stg_orders.sql)
  Catalog Error: Table with name raw_orders does not exist!
  Did you mean "main_raw.raw_orders"?
  
  LINE 6:   select * from "warehouse"."raw"."raw_orders"
                          ^
[0m00:10:46.427910 [info ] [MainThread]: 
[0m00:10:46.428915 [info ] [MainThread]:   compiled code at target\compiled\case_project\models\staging\stg_orders.sql
[0m00:10:46.428915 [info ] [MainThread]: 
[0m00:10:46.429913 [error] [MainThread]: [31mFailure in model stg_products (models\staging\stg_products.sql)[0m
[0m00:10:46.430915 [error] [MainThread]:   Runtime Error in model stg_products (models\staging\stg_products.sql)
  Catalog Error: Table with name raw_products does not exist!
  Did you mean "main_raw.raw_products"?
  
  LINE 5:     with src as (select * from "warehouse"."raw"."raw_products")
                                         ^
[0m00:10:46.431914 [info ] [MainThread]: 
[0m00:10:46.432919 [info ] [MainThread]:   compiled code at target\compiled\case_project\models\staging\stg_products.sql
[0m00:10:46.433919 [info ] [MainThread]: 
[0m00:10:46.434917 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=3
[0m00:10:46.435915 [debug] [MainThread]: Command `dbt run` failed at 00:10:46.435915 after 1.96 seconds
[0m00:10:46.435915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272E10031F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272E398E3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272E393A8F0>]}
[0m00:10:46.437420 [debug] [MainThread]: Flushing usage events
[0m00:10:47.095481 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:12:18.916989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D45AB13160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D45CE07B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D45CE07D60>]}


============================== 00:12:18.916989 | 11638838-7a8d-4c15-bfa1-4420062394e4 ==============================
[0m00:12:18.916989 [info ] [MainThread]: Running with dbt=1.10.9
[0m00:12:18.916989 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run --select staging', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'printer_width': '80', 'log_path': 'C:\\Users\\manss\\Desktop\\Case Project\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\manss\\Desktop\\Case Project', 'static_parser': 'True', 'write_json': 'True'}
[0m00:12:19.207149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11638838-7a8d-4c15-bfa1-4420062394e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D45CEF4A30>]}
[0m00:12:19.282301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '11638838-7a8d-4c15-bfa1-4420062394e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D45CDBBF70>]}
[0m00:12:19.287340 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m00:12:19.643495 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m00:12:19.928365 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:12:19.928365 [debug] [MainThread]: Partial parsing: updated file: case_project://models\sources.yml
[0m00:12:20.407455 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m00:12:20.407455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '11638838-7a8d-4c15-bfa1-4420062394e4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D45E669FC0>]}
[0m00:12:20.677067 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.case_project.marts
[0m00:12:20.693284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11638838-7a8d-4c15-bfa1-4420062394e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D45E7C17E0>]}
[0m00:12:20.837031 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\manss\Desktop\Case Project\target\manifest.json
[0m00:12:20.840838 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\manss\Desktop\Case Project\target\semantic_manifest.json
[0m00:12:20.867218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11638838-7a8d-4c15-bfa1-4420062394e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D45D239F30>]}
[0m00:12:20.870773 [info ] [MainThread]: Found 3 seeds, 3 models, 9 data tests, 3 sources, 429 macros
[0m00:12:20.870773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11638838-7a8d-4c15-bfa1-4420062394e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D45CF1DF30>]}
[0m00:12:20.873549 [info ] [MainThread]: 
[0m00:12:20.873549 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:12:20.873549 [info ] [MainThread]: 
[0m00:12:20.873549 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:12:20.883442 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m00:12:21.077173 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m00:12:21.087429 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m00:12:21.088400 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:12:21.097343 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m00:12:21.097343 [debug] [ThreadPool]: On list_warehouse: Close
[0m00:12:21.097343 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_staging)
[0m00:12:21.107382 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_staging"
"
[0m00:12:21.108501 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m00:12:21.117051 [debug] [ThreadPool]: On create_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m00:12:21.117051 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:12:21.117051 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:12:21.117051 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m00:12:21.117051 [debug] [ThreadPool]: On create_warehouse_main_staging: BEGIN
[0m00:12:21.117051 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:12:21.117051 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m00:12:21.117051 [debug] [ThreadPool]: On create_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_staging"} */

    
    
        create schema if not exists "warehouse"."main_staging"
    
[0m00:12:21.117051 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:12:21.124206 [debug] [ThreadPool]: On create_warehouse_main_staging: COMMIT
[0m00:12:21.124206 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m00:12:21.124206 [debug] [ThreadPool]: On create_warehouse_main_staging: COMMIT
[0m00:12:21.124206 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:12:21.124206 [debug] [ThreadPool]: On create_warehouse_main_staging: Close
[0m00:12:21.127280 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_raw'
[0m00:12:21.127280 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m00:12:21.127280 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m00:12:21.127280 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:12:21.137440 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:12:21.137440 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m00:12:21.137440 [debug] [ThreadPool]: On list_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_raw"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'warehouse'
  
[0m00:12:21.147197 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m00:12:21.147197 [debug] [ThreadPool]: On list_warehouse_main_raw: ROLLBACK
[0m00:12:21.147197 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_raw'
[0m00:12:21.147197 [debug] [ThreadPool]: On list_warehouse_main_raw: Close
[0m00:12:21.147197 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_raw, now list_warehouse_main_staging)
[0m00:12:21.157240 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_staging"
[0m00:12:21.157240 [debug] [ThreadPool]: On list_warehouse_main_staging: BEGIN
[0m00:12:21.157240 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:12:21.157240 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:12:21.157240 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_staging"
[0m00:12:21.157240 [debug] [ThreadPool]: On list_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_staging"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'warehouse'
  
[0m00:12:21.162361 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m00:12:21.162361 [debug] [ThreadPool]: On list_warehouse_main_staging: ROLLBACK
[0m00:12:21.162361 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_staging'
[0m00:12:21.167400 [debug] [ThreadPool]: On list_warehouse_main_staging: Close
[0m00:12:21.167400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11638838-7a8d-4c15-bfa1-4420062394e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D45E72D9C0>]}
[0m00:12:21.167400 [debug] [MainThread]: Using duckdb connection "master"
[0m00:12:21.167400 [debug] [MainThread]: On master: BEGIN
[0m00:12:21.167400 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:12:21.167400 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:12:21.171366 [debug] [MainThread]: On master: COMMIT
[0m00:12:21.171366 [debug] [MainThread]: Using duckdb connection "master"
[0m00:12:21.172758 [debug] [MainThread]: On master: COMMIT
[0m00:12:21.172758 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:12:21.173795 [debug] [MainThread]: On master: Close
[0m00:12:21.177333 [debug] [Thread-1 (]: Began running node model.case_project.stg_customers
[0m00:12:21.177333 [info ] [Thread-1 (]: 1 of 3 START sql view model main_staging.stg_customers ......................... [RUN]
[0m00:12:21.177333 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.case_project.stg_customers'
[0m00:12:21.177333 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_customers
[0m00:12:21.191680 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_customers"
[0m00:12:21.193649 [debug] [Thread-1 (]: Began executing node model.case_project.stg_customers
[0m00:12:21.230551 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_customers"
[0m00:12:21.230551 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m00:12:21.230551 [debug] [Thread-1 (]: On model.case_project.stg_customers: BEGIN
[0m00:12:21.230551 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:12:21.230551 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:12:21.230551 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m00:12:21.230551 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */

  
  create view "warehouse"."main_staging"."stg_customers__dbt_tmp" as (
    with src as (
  select * from "warehouse"."main_raw"."raw_customers"
)
select
  -- UUIDs -> keep as text
  cast(id as varchar)        as customer_id,
  lower(trim(first_name))    as first_name,   -- adjust names if different in your CSV
  lower(trim(last_name))     as last_name,
  lower(trim(email))         as email
from src
  );

[0m00:12:21.238229 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */

  
  create view "warehouse"."main_staging"."stg_customers__dbt_tmp" as (
    with src as (
  select * from "warehouse"."main_raw"."raw_customers"
)
select
  -- UUIDs -> keep as text
  cast(id as varchar)        as customer_id,
  lower(trim(first_name))    as first_name,   -- adjust names if different in your CSV
  lower(trim(last_name))     as last_name,
  lower(trim(email))         as email
from src
  );

[0m00:12:21.238229 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m00:12:21.238229 [debug] [Thread-1 (]: On model.case_project.stg_customers: ROLLBACK
[0m00:12:21.247357 [debug] [Thread-1 (]: Failed to rollback 'model.case_project.stg_customers'
[0m00:12:21.247357 [debug] [Thread-1 (]: On model.case_project.stg_customers: Close
[0m00:12:21.250919 [debug] [Thread-1 (]: Runtime Error in model stg_customers (models\staging\stg_customers.sql)
  Binder Error: Column "first_name" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
[0m00:12:21.252925 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11638838-7a8d-4c15-bfa1-4420062394e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D45CEED990>]}
[0m00:12:21.252925 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main_staging.stg_customers ................ [[31mERROR[0m in 0.07s]
[0m00:12:21.252925 [debug] [Thread-1 (]: Finished running node model.case_project.stg_customers
[0m00:12:21.257150 [debug] [Thread-1 (]: Began running node model.case_project.stg_orders
[0m00:12:21.257150 [debug] [Thread-4 (]: Marking all children of 'model.case_project.stg_customers' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_customers (models\staging\stg_customers.sql)
  Binder Error: Column "first_name" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined.
[0m00:12:21.257150 [info ] [Thread-1 (]: 2 of 3 START sql view model main_staging.stg_orders ............................ [RUN]
[0m00:12:21.257150 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_customers, now model.case_project.stg_orders)
[0m00:12:21.257150 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_orders
[0m00:12:21.266527 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_orders"
[0m00:12:21.267111 [debug] [Thread-1 (]: Began executing node model.case_project.stg_orders
[0m00:12:21.272646 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_orders"
[0m00:12:21.273618 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m00:12:21.274617 [debug] [Thread-1 (]: On model.case_project.stg_orders: BEGIN
[0m00:12:21.275616 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:12:21.275616 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:12:21.277121 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m00:12:21.277121 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */

  
  create view "warehouse"."main_staging"."stg_orders__dbt_tmp" as (
    with src as (
  select * from "warehouse"."main_raw"."raw_orders"
)
select
  cast(id as varchar)                 as order_id,
  cast(customer as varchar)           as customer_id,
  cast(store_id as varchar)           as store_id,
  cast(ordered_at as timestamp)       as ordered_at,
  cast(subtotal as double)            as subtotal,
  cast(tax_paid as double)            as tax_paid,
  cast(order_total as double)         as order_total
from src
  );

[0m00:12:21.279128 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:12:21.287135 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m00:12:21.288239 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */
alter view "warehouse"."main_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m00:12:21.289239 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:12:21.301754 [debug] [Thread-1 (]: On model.case_project.stg_orders: COMMIT
[0m00:12:21.302755 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m00:12:21.302755 [debug] [Thread-1 (]: On model.case_project.stg_orders: COMMIT
[0m00:12:21.305755 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:12:21.315280 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m00:12:21.315280 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */

      drop view if exists "warehouse"."main_staging"."stg_orders__dbt_backup" cascade
    
[0m00:12:21.316279 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:12:21.319791 [debug] [Thread-1 (]: On model.case_project.stg_orders: Close
[0m00:12:21.319791 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11638838-7a8d-4c15-bfa1-4420062394e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D459072B90>]}
[0m00:12:21.319791 [info ] [Thread-1 (]: 2 of 3 OK created sql view model main_staging.stg_orders ....................... [[32mOK[0m in 0.06s]
[0m00:12:21.319791 [debug] [Thread-1 (]: Finished running node model.case_project.stg_orders
[0m00:12:21.319791 [debug] [Thread-1 (]: Began running node model.case_project.stg_products
[0m00:12:21.324005 [info ] [Thread-1 (]: 3 of 3 START sql view model main_staging.stg_products .......................... [RUN]
[0m00:12:21.324005 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_orders, now model.case_project.stg_products)
[0m00:12:21.324005 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_products
[0m00:12:21.329231 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_products"
[0m00:12:21.329231 [debug] [Thread-1 (]: Began executing node model.case_project.stg_products
[0m00:12:21.333242 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_products"
[0m00:12:21.336075 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m00:12:21.337243 [debug] [Thread-1 (]: On model.case_project.stg_products: BEGIN
[0m00:12:21.337807 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:12:21.339156 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:12:21.339612 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m00:12:21.339987 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */

  
  create view "warehouse"."main_staging"."stg_products__dbt_tmp" as (
    with src as (select * from "warehouse"."main_raw"."raw_products")
select
  cast(id as varchar)      as product_id,
  lower(trim(name))        as product_name,
  cast(price as double)    as price
from src
  );

[0m00:12:21.341546 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */

  
  create view "warehouse"."main_staging"."stg_products__dbt_tmp" as (
    with src as (select * from "warehouse"."main_raw"."raw_products")
select
  cast(id as varchar)      as product_id,
  lower(trim(name))        as product_name,
  cast(price as double)    as price
from src
  );

[0m00:12:21.341546 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m00:12:21.341546 [debug] [Thread-1 (]: On model.case_project.stg_products: ROLLBACK
[0m00:12:21.343554 [debug] [Thread-1 (]: Failed to rollback 'model.case_project.stg_products'
[0m00:12:21.343554 [debug] [Thread-1 (]: On model.case_project.stg_products: Close
[0m00:12:21.347490 [debug] [Thread-1 (]: Runtime Error in model stg_products (models\staging\stg_products.sql)
  Binder Error: Referenced column "id" not found in FROM clause!
  Candidate bindings: "description"
  
  LINE 7:   cast(id as varchar)      as product_id,
                 ^
[0m00:12:21.347490 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11638838-7a8d-4c15-bfa1-4420062394e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D45ED9CCA0>]}
[0m00:12:21.348708 [error] [Thread-1 (]: 3 of 3 ERROR creating sql view model main_staging.stg_products ................. [[31mERROR[0m in 0.02s]
[0m00:12:21.349641 [debug] [Thread-1 (]: Finished running node model.case_project.stg_products
[0m00:12:21.350933 [debug] [Thread-4 (]: Marking all children of 'model.case_project.stg_products' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_products (models\staging\stg_products.sql)
  Binder Error: Referenced column "id" not found in FROM clause!
  Candidate bindings: "description"
  
  LINE 7:   cast(id as varchar)      as product_id,
                 ^.
[0m00:12:21.352328 [debug] [MainThread]: Using duckdb connection "master"
[0m00:12:21.353366 [debug] [MainThread]: On master: BEGIN
[0m00:12:21.353366 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:12:21.354639 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:12:21.355377 [debug] [MainThread]: On master: COMMIT
[0m00:12:21.355377 [debug] [MainThread]: Using duckdb connection "master"
[0m00:12:21.355377 [debug] [MainThread]: On master: COMMIT
[0m00:12:21.357384 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:12:21.357384 [debug] [MainThread]: On master: Close
[0m00:12:21.357384 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:12:21.357384 [debug] [MainThread]: Connection 'create_warehouse_main_staging' was properly closed.
[0m00:12:21.357384 [debug] [MainThread]: Connection 'list_warehouse_main_staging' was properly closed.
[0m00:12:21.357384 [debug] [MainThread]: Connection 'model.case_project.stg_products' was properly closed.
[0m00:12:21.357384 [info ] [MainThread]: 
[0m00:12:21.361531 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m00:12:21.363538 [debug] [MainThread]: Command end result
[0m00:12:21.390198 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\manss\Desktop\Case Project\target\manifest.json
[0m00:12:21.397683 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\manss\Desktop\Case Project\target\semantic_manifest.json
[0m00:12:21.405718 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\manss\Desktop\Case Project\target\run_results.json
[0m00:12:21.405718 [info ] [MainThread]: 
[0m00:12:21.407253 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m00:12:21.408260 [info ] [MainThread]: 
[0m00:12:21.409259 [error] [MainThread]: [31mFailure in model stg_customers (models\staging\stg_customers.sql)[0m
[0m00:12:21.410259 [error] [MainThread]:   Runtime Error in model stg_customers (models\staging\stg_customers.sql)
  Binder Error: Column "first_name" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
[0m00:12:21.410259 [info ] [MainThread]: 
[0m00:12:21.411258 [info ] [MainThread]:   compiled code at target\compiled\case_project\models\staging\stg_customers.sql
[0m00:12:21.412257 [info ] [MainThread]: 
[0m00:12:21.413197 [error] [MainThread]: [31mFailure in model stg_products (models\staging\stg_products.sql)[0m
[0m00:12:21.414204 [error] [MainThread]:   Runtime Error in model stg_products (models\staging\stg_products.sql)
  Binder Error: Referenced column "id" not found in FROM clause!
  Candidate bindings: "description"
  
  LINE 7:   cast(id as varchar)      as product_id,
                 ^
[0m00:12:21.415149 [info ] [MainThread]: 
[0m00:12:21.415149 [info ] [MainThread]:   compiled code at target\compiled\case_project\models\staging\stg_products.sql
[0m00:12:21.416483 [info ] [MainThread]: 
[0m00:12:21.417426 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=3
[0m00:12:21.418810 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m00:12:21.419748 [debug] [MainThread]: Command `dbt run` failed at 00:12:21.419748 after 2.59 seconds
[0m00:12:21.420924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D45AB13160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D45CEF4A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D45D239F30>]}
[0m00:12:21.420924 [debug] [MainThread]: Flushing usage events
[0m00:12:22.095796 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:15:50.847421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFF0BD3220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFF2EC7B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFF2EC7D60>]}


============================== 00:15:50.849457 | 5b062e2a-e212-4bcb-8a74-34ac390339cb ==============================
[0m00:15:50.849457 [info ] [MainThread]: Running with dbt=1.10.9
[0m00:15:50.849457 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --select staging', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'empty': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\manss\\Desktop\\Case Project\\logs', 'profiles_dir': 'C:\\Users\\manss\\Desktop\\Case Project', 'static_parser': 'True', 'write_json': 'True'}
[0m00:15:51.131661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b062e2a-e212-4bcb-8a74-34ac390339cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFF30FAA10>]}
[0m00:15:51.209376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5b062e2a-e212-4bcb-8a74-34ac390339cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFF2EC5E70>]}
[0m00:15:51.209376 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m00:15:51.556696 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m00:15:51.866634 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m00:15:51.866634 [debug] [MainThread]: Partial parsing: updated file: case_project://models\staging\stg_products.sql
[0m00:15:51.866634 [debug] [MainThread]: Partial parsing: updated file: case_project://models\staging\stg_customers.sql
[0m00:15:52.446424 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.case_project.marts
[0m00:15:52.466624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b062e2a-e212-4bcb-8a74-34ac390339cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFF4798130>]}
[0m00:15:52.618657 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\manss\Desktop\Case Project\target\manifest.json
[0m00:15:52.622592 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\manss\Desktop\Case Project\target\semantic_manifest.json
[0m00:15:52.652188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b062e2a-e212-4bcb-8a74-34ac390339cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFF47980D0>]}
[0m00:15:52.653154 [info ] [MainThread]: Found 3 seeds, 3 models, 9 data tests, 3 sources, 429 macros
[0m00:15:52.654168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b062e2a-e212-4bcb-8a74-34ac390339cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFF47C66B0>]}
[0m00:15:52.655154 [info ] [MainThread]: 
[0m00:15:52.656659 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:15:52.657665 [info ] [MainThread]: 
[0m00:15:52.658048 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:15:52.666820 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m00:15:52.867671 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m00:15:52.867671 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m00:15:52.867671 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:15:52.896529 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m00:15:52.899148 [debug] [ThreadPool]: On list_warehouse: Close
[0m00:15:52.899148 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_staging)
[0m00:15:52.901927 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_staging"
"
[0m00:15:52.906530 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m00:15:52.906530 [debug] [ThreadPool]: On create_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m00:15:52.906530 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:15:52.911653 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:15:52.911653 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m00:15:52.911653 [debug] [ThreadPool]: On create_warehouse_main_staging: BEGIN
[0m00:15:52.915216 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:15:52.915216 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m00:15:52.915216 [debug] [ThreadPool]: On create_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_staging"} */

    
    
        create schema if not exists "warehouse"."main_staging"
    
[0m00:15:52.916869 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:15:52.917906 [debug] [ThreadPool]: On create_warehouse_main_staging: COMMIT
[0m00:15:52.918903 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m00:15:52.918903 [debug] [ThreadPool]: On create_warehouse_main_staging: COMMIT
[0m00:15:52.919905 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:15:52.920875 [debug] [ThreadPool]: On create_warehouse_main_staging: Close
[0m00:15:52.921875 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_staging'
[0m00:15:52.927478 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_staging"
[0m00:15:52.927478 [debug] [ThreadPool]: On list_warehouse_main_staging: BEGIN
[0m00:15:52.927478 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:15:52.927478 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:15:52.927478 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_staging"
[0m00:15:52.927478 [debug] [ThreadPool]: On list_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_staging"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'warehouse'
  
[0m00:15:52.943414 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m00:15:52.946431 [debug] [ThreadPool]: On list_warehouse_main_staging: ROLLBACK
[0m00:15:52.946431 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_staging'
[0m00:15:52.946431 [debug] [ThreadPool]: On list_warehouse_main_staging: Close
[0m00:15:52.946431 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_staging, now list_warehouse_main_raw)
[0m00:15:52.946431 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m00:15:52.946431 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m00:15:52.946431 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:15:52.946431 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:15:52.946431 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m00:15:52.946431 [debug] [ThreadPool]: On list_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_raw"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'warehouse'
  
[0m00:15:52.956613 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m00:15:52.959234 [debug] [ThreadPool]: On list_warehouse_main_raw: ROLLBACK
[0m00:15:52.959234 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_raw'
[0m00:15:52.959234 [debug] [ThreadPool]: On list_warehouse_main_raw: Close
[0m00:15:52.959234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b062e2a-e212-4bcb-8a74-34ac390339cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFF30ADFF0>]}
[0m00:15:52.959234 [debug] [MainThread]: Using duckdb connection "master"
[0m00:15:52.959234 [debug] [MainThread]: On master: BEGIN
[0m00:15:52.959234 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:15:52.959234 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:15:52.959234 [debug] [MainThread]: On master: COMMIT
[0m00:15:52.966698 [debug] [MainThread]: Using duckdb connection "master"
[0m00:15:52.966698 [debug] [MainThread]: On master: COMMIT
[0m00:15:52.966698 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:15:52.966698 [debug] [MainThread]: On master: Close
[0m00:15:52.966698 [debug] [Thread-1 (]: Began running node model.case_project.stg_customers
[0m00:15:52.966698 [info ] [Thread-1 (]: 1 of 3 START sql view model main_staging.stg_customers ......................... [RUN]
[0m00:15:52.975273 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.case_project.stg_customers'
[0m00:15:52.975273 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_customers
[0m00:15:52.985197 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_customers"
[0m00:15:52.987740 [debug] [Thread-1 (]: Began executing node model.case_project.stg_customers
[0m00:15:53.023015 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_customers"
[0m00:15:53.025008 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m00:15:53.025008 [debug] [Thread-1 (]: On model.case_project.stg_customers: BEGIN
[0m00:15:53.025008 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:15:53.026514 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:15:53.027552 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m00:15:53.028554 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */

  
  create view "warehouse"."main_staging"."stg_customers__dbt_tmp" as (
    -- models/staging/stg_customers.sql
with src as (
  select * from "warehouse"."main_raw"."raw_customers"
),
clean as (
  select
    cast(id as varchar)           as customer_id,
    lower(trim(first_name))       as first_name,
    lower(trim(last_name))        as last_name,
    lower(trim(email))            as email
  from src
)
select
  customer_id,
  first_name,
  last_name,
  email
  -- if you want a full_name, derive it here using the *already defined* aliases:
  -- , first_name || ' ' || last_name as full_name
from clean
;
  );

[0m00:15:53.034799 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */

  
  create view "warehouse"."main_staging"."stg_customers__dbt_tmp" as (
    -- models/staging/stg_customers.sql
with src as (
  select * from "warehouse"."main_raw"."raw_customers"
),
clean as (
  select
    cast(id as varchar)           as customer_id,
    lower(trim(first_name))       as first_name,
    lower(trim(last_name))        as last_name,
    lower(trim(email))            as email
  from src
)
select
  customer_id,
  first_name,
  last_name,
  email
  -- if you want a full_name, derive it here using the *already defined* aliases:
  -- , first_name || ' ' || last_name as full_name
from clean
;
  );

[0m00:15:53.035718 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m00:15:53.036713 [debug] [Thread-1 (]: On model.case_project.stg_customers: ROLLBACK
[0m00:15:53.036713 [debug] [Thread-1 (]: Failed to rollback 'model.case_project.stg_customers'
[0m00:15:53.036713 [debug] [Thread-1 (]: On model.case_project.stg_customers: Close
[0m00:15:53.046669 [debug] [Thread-1 (]: Runtime Error in model stg_customers (models\staging\stg_customers.sql)
  Parser Error: syntax error at or near ";"
[0m00:15:53.048708 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b062e2a-e212-4bcb-8a74-34ac390339cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFF4C6F3A0>]}
[0m00:15:53.048708 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main_staging.stg_customers ................ [[31mERROR[0m in 0.07s]
[0m00:15:53.048708 [debug] [Thread-1 (]: Finished running node model.case_project.stg_customers
[0m00:15:53.052548 [debug] [Thread-1 (]: Began running node model.case_project.stg_orders
[0m00:15:53.052548 [debug] [Thread-4 (]: Marking all children of 'model.case_project.stg_customers' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_customers (models\staging\stg_customers.sql)
  Parser Error: syntax error at or near ";".
[0m00:15:53.052548 [info ] [Thread-1 (]: 2 of 3 START sql view model main_staging.stg_orders ............................ [RUN]
[0m00:15:53.052548 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_customers, now model.case_project.stg_orders)
[0m00:15:53.056488 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_orders
[0m00:15:53.060546 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_orders"
[0m00:15:53.060546 [debug] [Thread-1 (]: Began executing node model.case_project.stg_orders
[0m00:15:53.064558 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_orders"
[0m00:15:53.066563 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m00:15:53.068310 [debug] [Thread-1 (]: On model.case_project.stg_orders: BEGIN
[0m00:15:53.069016 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:15:53.070024 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:15:53.070445 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m00:15:53.070445 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */

  
  create view "warehouse"."main_staging"."stg_orders__dbt_tmp" as (
    with src as (
  select * from "warehouse"."main_raw"."raw_orders"
)
select
  cast(id as varchar)                 as order_id,
  cast(customer as varchar)           as customer_id,
  cast(store_id as varchar)           as store_id,
  cast(ordered_at as timestamp)       as ordered_at,
  cast(subtotal as double)            as subtotal,
  cast(tax_paid as double)            as tax_paid,
  cast(order_total as double)         as order_total
from src
  );

[0m00:15:53.072636 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:15:53.079832 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m00:15:53.080832 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */
alter view "warehouse"."main_staging"."stg_orders" rename to "stg_orders__dbt_backup"
[0m00:15:53.081534 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:15:53.086913 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m00:15:53.088501 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */
alter view "warehouse"."main_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m00:15:53.089508 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:15:53.103618 [debug] [Thread-1 (]: On model.case_project.stg_orders: COMMIT
[0m00:15:53.103618 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m00:15:53.104618 [debug] [Thread-1 (]: On model.case_project.stg_orders: COMMIT
[0m00:15:53.106624 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:15:53.109629 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m00:15:53.109629 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */

      drop view if exists "warehouse"."main_staging"."stg_orders__dbt_backup" cascade
    
[0m00:15:53.116628 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:15:53.116628 [debug] [Thread-1 (]: On model.case_project.stg_orders: Close
[0m00:15:53.116628 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b062e2a-e212-4bcb-8a74-34ac390339cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFEF1342B0>]}
[0m00:15:53.116628 [info ] [Thread-1 (]: 2 of 3 OK created sql view model main_staging.stg_orders ....................... [[32mOK[0m in 0.06s]
[0m00:15:53.116628 [debug] [Thread-1 (]: Finished running node model.case_project.stg_orders
[0m00:15:53.116628 [debug] [Thread-1 (]: Began running node model.case_project.stg_products
[0m00:15:53.125504 [info ] [Thread-1 (]: 3 of 3 START sql view model main_staging.stg_products .......................... [RUN]
[0m00:15:53.126512 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_orders, now model.case_project.stg_products)
[0m00:15:53.126512 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_products
[0m00:15:53.126512 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_products"
[0m00:15:53.126512 [debug] [Thread-1 (]: Began executing node model.case_project.stg_products
[0m00:15:53.136343 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_products"
[0m00:15:53.136343 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m00:15:53.136343 [debug] [Thread-1 (]: On model.case_project.stg_products: BEGIN
[0m00:15:53.136343 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:15:53.136343 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:15:53.136343 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m00:15:53.141167 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */

  
  create view "warehouse"."main_staging"."stg_products__dbt_tmp" as (
    with src as (select * from "warehouse"."main_raw"."raw_products")
select
  cast(sku as varchar)      as product_id,
  lower(trim(name))        as product_name,
  cast(price as double)    as price
from src
  );

[0m00:15:53.142270 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:15:53.145270 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m00:15:53.146775 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */
alter view "warehouse"."main_staging"."stg_products__dbt_tmp" rename to "stg_products"
[0m00:15:53.147781 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:15:53.149779 [debug] [Thread-1 (]: On model.case_project.stg_products: COMMIT
[0m00:15:53.150780 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m00:15:53.150780 [debug] [Thread-1 (]: On model.case_project.stg_products: COMMIT
[0m00:15:53.152754 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:15:53.155758 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m00:15:53.156757 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */

      drop view if exists "warehouse"."main_staging"."stg_products__dbt_backup" cascade
    
[0m00:15:53.158112 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:15:53.159112 [debug] [Thread-1 (]: On model.case_project.stg_products: Close
[0m00:15:53.160111 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b062e2a-e212-4bcb-8a74-34ac390339cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFF0A859C0>]}
[0m00:15:53.161114 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main_staging.stg_products ..................... [[32mOK[0m in 0.03s]
[0m00:15:53.162111 [debug] [Thread-1 (]: Finished running node model.case_project.stg_products
[0m00:15:53.164113 [debug] [MainThread]: Using duckdb connection "master"
[0m00:15:53.165112 [debug] [MainThread]: On master: BEGIN
[0m00:15:53.165112 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:15:53.166618 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:15:53.166618 [debug] [MainThread]: On master: COMMIT
[0m00:15:53.167624 [debug] [MainThread]: Using duckdb connection "master"
[0m00:15:53.167624 [debug] [MainThread]: On master: COMMIT
[0m00:15:53.169043 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:15:53.169043 [debug] [MainThread]: On master: Close
[0m00:15:53.170049 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:15:53.170049 [debug] [MainThread]: Connection 'create_warehouse_main_staging' was properly closed.
[0m00:15:53.171048 [debug] [MainThread]: Connection 'list_warehouse_main_raw' was properly closed.
[0m00:15:53.171048 [debug] [MainThread]: Connection 'model.case_project.stg_products' was properly closed.
[0m00:15:53.173054 [info ] [MainThread]: 
[0m00:15:53.173054 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m00:15:53.175052 [debug] [MainThread]: Command end result
[0m00:15:53.207385 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\manss\Desktop\Case Project\target\manifest.json
[0m00:15:53.207385 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\manss\Desktop\Case Project\target\semantic_manifest.json
[0m00:15:53.220098 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\manss\Desktop\Case Project\target\run_results.json
[0m00:15:53.220646 [info ] [MainThread]: 
[0m00:15:53.221691 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:15:53.221691 [info ] [MainThread]: 
[0m00:15:53.222835 [error] [MainThread]: [31mFailure in model stg_customers (models\staging\stg_customers.sql)[0m
[0m00:15:53.223935 [error] [MainThread]:   Runtime Error in model stg_customers (models\staging\stg_customers.sql)
  Parser Error: syntax error at or near ";"
[0m00:15:53.223935 [info ] [MainThread]: 
[0m00:15:53.224965 [info ] [MainThread]:   compiled code at target\compiled\case_project\models\staging\stg_customers.sql
[0m00:15:53.224965 [info ] [MainThread]: 
[0m00:15:53.226503 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m00:15:53.227387 [debug] [MainThread]: Command `dbt run` failed at 00:15:53.227387 after 2.48 seconds
[0m00:15:53.228868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFF0BD3220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFF30FBD30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFF1F01E70>]}
[0m00:15:53.229811 [debug] [MainThread]: Flushing usage events
[0m00:15:53.964080 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:58:16.028389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290CD673160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290CF967D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290CF967EE0>]}


============================== 11:58:16.036055 | 581a3539-9798-4463-aa75-5ae6f1df739d ==============================
[0m11:58:16.036055 [info ] [MainThread]: Running with dbt=1.10.9
[0m11:58:16.037054 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --select staging', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\manss\\Desktop\\Case Project\\logs', 'profiles_dir': 'C:\\Users\\manss\\Desktop\\Case Project', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m11:58:16.391864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '581a3539-9798-4463-aa75-5ae6f1df739d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290CF0C48E0>]}
[0m11:58:16.467522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '581a3539-9798-4463-aa75-5ae6f1df739d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290CF965FC0>]}
[0m11:58:16.473994 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m11:58:16.929546 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m11:58:17.312778 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:58:17.313557 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:58:17.322764 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.case_project.marts
[0m11:58:17.403816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '581a3539-9798-4463-aa75-5ae6f1df739d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290D10080D0>]}
[0m11:58:17.601797 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\manss\Desktop\Case Project\target\manifest.json
[0m11:58:17.607777 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\manss\Desktop\Case Project\target\semantic_manifest.json
[0m11:58:17.652012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '581a3539-9798-4463-aa75-5ae6f1df739d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290CFF8DEA0>]}
[0m11:58:17.652527 [info ] [MainThread]: Found 3 seeds, 3 models, 9 data tests, 3 sources, 429 macros
[0m11:58:17.653534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '581a3539-9798-4463-aa75-5ae6f1df739d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290CFF8FF10>]}
[0m11:58:17.654533 [info ] [MainThread]: 
[0m11:58:17.654533 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:58:17.654533 [info ] [MainThread]: 
[0m11:58:17.654533 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:58:17.667220 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m11:58:17.962802 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m11:58:17.962802 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m11:58:17.964189 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:58:18.080437 [debug] [ThreadPool]: SQL status: OK in 0.116 seconds
[0m11:58:18.082950 [debug] [ThreadPool]: On list_warehouse: Close
[0m11:58:18.083455 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_staging)
[0m11:58:18.084462 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_staging"
"
[0m11:58:18.092971 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m11:58:18.094013 [debug] [ThreadPool]: On create_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m11:58:18.094013 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:58:18.094013 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m11:58:18.098456 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m11:58:18.098456 [debug] [ThreadPool]: On create_warehouse_main_staging: BEGIN
[0m11:58:18.098456 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:58:18.098456 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m11:58:18.098456 [debug] [ThreadPool]: On create_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_staging"} */

    
    
        create schema if not exists "warehouse"."main_staging"
    
[0m11:58:18.102663 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m11:58:18.102663 [debug] [ThreadPool]: On create_warehouse_main_staging: COMMIT
[0m11:58:18.105369 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m11:58:18.105369 [debug] [ThreadPool]: On create_warehouse_main_staging: COMMIT
[0m11:58:18.105369 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:58:18.105369 [debug] [ThreadPool]: On create_warehouse_main_staging: Close
[0m11:58:18.105369 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_staging'
[0m11:58:18.113740 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_staging"
[0m11:58:18.113740 [debug] [ThreadPool]: On list_warehouse_main_staging: BEGIN
[0m11:58:18.113740 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:58:18.113740 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:58:18.118737 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_staging"
[0m11:58:18.119087 [debug] [ThreadPool]: On list_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_staging"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'warehouse'
  
[0m11:58:18.139988 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m11:58:18.142125 [debug] [ThreadPool]: On list_warehouse_main_staging: ROLLBACK
[0m11:58:18.142670 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_staging'
[0m11:58:18.142670 [debug] [ThreadPool]: On list_warehouse_main_staging: Close
[0m11:58:18.142670 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_staging, now list_warehouse_main_raw)
[0m11:58:18.146928 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m11:58:18.146928 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m11:58:18.146928 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:58:18.146928 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:58:18.146928 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m11:58:18.151975 [debug] [ThreadPool]: On list_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_raw"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'warehouse'
  
[0m11:58:18.153950 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m11:58:18.157094 [debug] [ThreadPool]: On list_warehouse_main_raw: ROLLBACK
[0m11:58:18.157094 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_raw'
[0m11:58:18.157094 [debug] [ThreadPool]: On list_warehouse_main_raw: Close
[0m11:58:18.159100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '581a3539-9798-4463-aa75-5ae6f1df739d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290CFF98A60>]}
[0m11:58:18.160463 [debug] [MainThread]: Using duckdb connection "master"
[0m11:58:18.160964 [debug] [MainThread]: On master: BEGIN
[0m11:58:18.161973 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:58:18.162491 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:58:18.162491 [debug] [MainThread]: On master: COMMIT
[0m11:58:18.162491 [debug] [MainThread]: Using duckdb connection "master"
[0m11:58:18.162491 [debug] [MainThread]: On master: COMMIT
[0m11:58:18.162491 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:58:18.162491 [debug] [MainThread]: On master: Close
[0m11:58:18.167753 [debug] [Thread-1 (]: Began running node model.case_project.stg_customers
[0m11:58:18.172654 [info ] [Thread-1 (]: 1 of 3 START sql view model main_staging.stg_customers ......................... [RUN]
[0m11:58:18.173568 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.case_project.stg_customers'
[0m11:58:18.174331 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_customers
[0m11:58:18.184193 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_customers"
[0m11:58:18.185165 [debug] [Thread-1 (]: Began executing node model.case_project.stg_customers
[0m11:58:18.223973 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_customers"
[0m11:58:18.223973 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m11:58:18.223973 [debug] [Thread-1 (]: On model.case_project.stg_customers: BEGIN
[0m11:58:18.223973 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:58:18.223973 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:58:18.223973 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m11:58:18.229869 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */

  
  create view "warehouse"."main_staging"."stg_customers__dbt_tmp" as (
    -- models/staging/stg_customers.sql
with src as (
  select * from "warehouse"."main_raw"."raw_customers"
),
clean as (
  select
    cast(id as varchar)           as customer_id,
    lower(trim(first_name))       as first_name,
    lower(trim(last_name))        as last_name,
    lower(trim(email))            as email
  from src
)
select
  customer_id,
  first_name,
  last_name,
  email
  -- if you want a full_name, derive it here using the *already defined* aliases:
  -- , first_name || ' ' || last_name as full_name
from clean
;
  );

[0m11:58:18.241049 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */

  
  create view "warehouse"."main_staging"."stg_customers__dbt_tmp" as (
    -- models/staging/stg_customers.sql
with src as (
  select * from "warehouse"."main_raw"."raw_customers"
),
clean as (
  select
    cast(id as varchar)           as customer_id,
    lower(trim(first_name))       as first_name,
    lower(trim(last_name))        as last_name,
    lower(trim(email))            as email
  from src
)
select
  customer_id,
  first_name,
  last_name,
  email
  -- if you want a full_name, derive it here using the *already defined* aliases:
  -- , first_name || ' ' || last_name as full_name
from clean
;
  );

[0m11:58:18.242050 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m11:58:18.242555 [debug] [Thread-1 (]: On model.case_project.stg_customers: ROLLBACK
[0m11:58:18.252496 [debug] [Thread-1 (]: Failed to rollback 'model.case_project.stg_customers'
[0m11:58:18.252496 [debug] [Thread-1 (]: On model.case_project.stg_customers: Close
[0m11:58:18.256197 [debug] [Thread-1 (]: Runtime Error in model stg_customers (models\staging\stg_customers.sql)
  Parser Error: syntax error at or near ";"
[0m11:58:18.258023 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '581a3539-9798-4463-aa75-5ae6f1df739d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290CD4F22C0>]}
[0m11:58:18.258023 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main_staging.stg_customers ................ [[31mERROR[0m in 0.08s]
[0m11:58:18.258023 [debug] [Thread-1 (]: Finished running node model.case_project.stg_customers
[0m11:58:18.261658 [debug] [Thread-1 (]: Began running node model.case_project.stg_orders
[0m11:58:18.262672 [debug] [Thread-4 (]: Marking all children of 'model.case_project.stg_customers' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_customers (models\staging\stg_customers.sql)
  Parser Error: syntax error at or near ";".
[0m11:58:18.262672 [info ] [Thread-1 (]: 2 of 3 START sql view model main_staging.stg_orders ............................ [RUN]
[0m11:58:18.264988 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_customers, now model.case_project.stg_orders)
[0m11:58:18.264988 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_orders
[0m11:58:18.266994 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_orders"
[0m11:58:18.266994 [debug] [Thread-1 (]: Began executing node model.case_project.stg_orders
[0m11:58:18.275553 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_orders"
[0m11:58:18.276626 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m11:58:18.278315 [debug] [Thread-1 (]: On model.case_project.stg_orders: BEGIN
[0m11:58:18.279150 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:58:18.279831 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:58:18.280840 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m11:58:18.281840 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */

  
  create view "warehouse"."main_staging"."stg_orders__dbt_tmp" as (
    with src as (
  select * from "warehouse"."main_raw"."raw_orders"
)
select
  cast(id as varchar)                 as order_id,
  cast(customer as varchar)           as customer_id,
  cast(store_id as varchar)           as store_id,
  cast(ordered_at as timestamp)       as ordered_at,
  cast(subtotal as double)            as subtotal,
  cast(tax_paid as double)            as tax_paid,
  cast(order_total as double)         as order_total
from src
  );

[0m11:58:18.282851 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:18.288291 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m11:58:18.292188 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */
alter view "warehouse"."main_staging"."stg_orders" rename to "stg_orders__dbt_backup"
[0m11:58:18.292698 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:18.292698 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m11:58:18.292698 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */
alter view "warehouse"."main_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m11:58:18.299140 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:18.314239 [debug] [Thread-1 (]: On model.case_project.stg_orders: COMMIT
[0m11:58:18.314239 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m11:58:18.314239 [debug] [Thread-1 (]: On model.case_project.stg_orders: COMMIT
[0m11:58:18.314239 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:58:18.323700 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m11:58:18.323700 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */

      drop view if exists "warehouse"."main_staging"."stg_orders__dbt_backup" cascade
    
[0m11:58:18.327960 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:58:18.330967 [debug] [Thread-1 (]: On model.case_project.stg_orders: Close
[0m11:58:18.332473 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '581a3539-9798-4463-aa75-5ae6f1df739d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290CBBD6B90>]}
[0m11:58:18.332473 [info ] [Thread-1 (]: 2 of 3 OK created sql view model main_staging.stg_orders ....................... [[32mOK[0m in 0.07s]
[0m11:58:18.334486 [debug] [Thread-1 (]: Finished running node model.case_project.stg_orders
[0m11:58:18.334486 [debug] [Thread-1 (]: Began running node model.case_project.stg_products
[0m11:58:18.335485 [info ] [Thread-1 (]: 3 of 3 START sql view model main_staging.stg_products .......................... [RUN]
[0m11:58:18.336338 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_orders, now model.case_project.stg_products)
[0m11:58:18.337377 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_products
[0m11:58:18.340377 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_products"
[0m11:58:18.341915 [debug] [Thread-1 (]: Began executing node model.case_project.stg_products
[0m11:58:18.349087 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_products"
[0m11:58:18.351089 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m11:58:18.351089 [debug] [Thread-1 (]: On model.case_project.stg_products: BEGIN
[0m11:58:18.352087 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:58:18.352591 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:58:18.353596 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m11:58:18.354595 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */

  
  create view "warehouse"."main_staging"."stg_products__dbt_tmp" as (
    with src as (select * from "warehouse"."main_raw"."raw_products")
select
  cast(sku as varchar)      as product_id,
  lower(trim(name))        as product_name,
  cast(price as double)    as price
from src
  );

[0m11:58:18.355598 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:18.359599 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m11:58:18.360595 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */
alter view "warehouse"."main_staging"."stg_products" rename to "stg_products__dbt_backup"
[0m11:58:18.362102 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:18.365617 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m11:58:18.367149 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */
alter view "warehouse"."main_staging"."stg_products__dbt_tmp" rename to "stg_products"
[0m11:58:18.367149 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:18.369171 [debug] [Thread-1 (]: On model.case_project.stg_products: COMMIT
[0m11:58:18.369171 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m11:58:18.371849 [debug] [Thread-1 (]: On model.case_project.stg_products: COMMIT
[0m11:58:18.372865 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:58:18.376633 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m11:58:18.376633 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */

      drop view if exists "warehouse"."main_staging"."stg_products__dbt_backup" cascade
    
[0m11:58:18.378649 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:58:18.380686 [debug] [Thread-1 (]: On model.case_project.stg_products: Close
[0m11:58:18.380686 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '581a3539-9798-4463-aa75-5ae6f1df739d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290D15C8EB0>]}
[0m11:58:18.382222 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main_staging.stg_products ..................... [[32mOK[0m in 0.04s]
[0m11:58:18.382729 [debug] [Thread-1 (]: Finished running node model.case_project.stg_products
[0m11:58:18.384735 [debug] [MainThread]: Using duckdb connection "master"
[0m11:58:18.384735 [debug] [MainThread]: On master: BEGIN
[0m11:58:18.385735 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:58:18.386735 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:58:18.386735 [debug] [MainThread]: On master: COMMIT
[0m11:58:18.387765 [debug] [MainThread]: Using duckdb connection "master"
[0m11:58:18.387765 [debug] [MainThread]: On master: COMMIT
[0m11:58:18.388765 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:58:18.389765 [debug] [MainThread]: On master: Close
[0m11:58:18.389765 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:58:18.389765 [debug] [MainThread]: Connection 'create_warehouse_main_staging' was properly closed.
[0m11:58:18.389765 [debug] [MainThread]: Connection 'list_warehouse_main_raw' was properly closed.
[0m11:58:18.392083 [debug] [MainThread]: Connection 'model.case_project.stg_products' was properly closed.
[0m11:58:18.392626 [info ] [MainThread]: 
[0m11:58:18.393555 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.74 seconds (0.74s).
[0m11:58:18.395007 [debug] [MainThread]: Command end result
[0m11:58:18.425243 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\manss\Desktop\Case Project\target\manifest.json
[0m11:58:18.425243 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\manss\Desktop\Case Project\target\semantic_manifest.json
[0m11:58:18.438567 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\manss\Desktop\Case Project\target\run_results.json
[0m11:58:18.438567 [info ] [MainThread]: 
[0m11:58:18.438567 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:58:18.438567 [info ] [MainThread]: 
[0m11:58:18.441886 [error] [MainThread]: [31mFailure in model stg_customers (models\staging\stg_customers.sql)[0m
[0m11:58:18.442898 [error] [MainThread]:   Runtime Error in model stg_customers (models\staging\stg_customers.sql)
  Parser Error: syntax error at or near ";"
[0m11:58:18.442898 [info ] [MainThread]: 
[0m11:58:18.442898 [info ] [MainThread]:   compiled code at target\compiled\case_project\models\staging\stg_customers.sql
[0m11:58:18.445016 [info ] [MainThread]: 
[0m11:58:18.445588 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m11:58:18.447685 [debug] [MainThread]: Command `dbt run` failed at 11:58:18.446678 after 2.53 seconds
[0m11:58:18.447685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290CD673160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290D1008280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290CD9A8BB0>]}
[0m11:58:18.448684 [debug] [MainThread]: Flushing usage events
[0m11:58:19.251130 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:58:46.077279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194F94631F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194FB757B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194FB757D60>]}


============================== 11:58:46.084151 | f266ac1c-5ab6-4d4a-ab94-4725787f4d02 ==============================
[0m11:58:46.084151 [info ] [MainThread]: Running with dbt=1.10.9
[0m11:58:46.084151 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\manss\\Desktop\\Case Project', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run --select staging', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\manss\\Desktop\\Case Project\\logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m11:58:46.368735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f266ac1c-5ab6-4d4a-ab94-4725787f4d02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194FAEB4880>]}
[0m11:58:46.447011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f266ac1c-5ab6-4d4a-ab94-4725787f4d02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194FB757070>]}
[0m11:58:46.450463 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m11:58:46.891835 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m11:58:47.187898 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:58:47.187898 [debug] [MainThread]: Partial parsing: updated file: case_project://models\staging\stg_customers.sql
[0m11:58:47.782213 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.case_project.marts
[0m11:58:47.803712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f266ac1c-5ab6-4d4a-ab94-4725787f4d02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194FD0323B0>]}
[0m11:58:47.952635 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\manss\Desktop\Case Project\target\manifest.json
[0m11:58:47.953586 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\manss\Desktop\Case Project\target\semantic_manifest.json
[0m11:58:47.986926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f266ac1c-5ab6-4d4a-ab94-4725787f4d02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194FCFD85E0>]}
[0m11:58:47.986926 [info ] [MainThread]: Found 3 seeds, 3 models, 9 data tests, 3 sources, 429 macros
[0m11:58:47.986926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f266ac1c-5ab6-4d4a-ab94-4725787f4d02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194FCFDACB0>]}
[0m11:58:47.992602 [info ] [MainThread]: 
[0m11:58:47.992602 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:58:47.993921 [info ] [MainThread]: 
[0m11:58:47.993921 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:58:48.002808 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m11:58:48.253721 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m11:58:48.253721 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m11:58:48.253721 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:58:48.277810 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m11:58:48.278809 [debug] [ThreadPool]: On list_warehouse: Close
[0m11:58:48.279838 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_staging)
[0m11:58:48.280839 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_staging"
"
[0m11:58:48.288959 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m11:58:48.289961 [debug] [ThreadPool]: On create_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m11:58:48.289961 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:58:48.291930 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:58:48.292973 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m11:58:48.293978 [debug] [ThreadPool]: On create_warehouse_main_staging: BEGIN
[0m11:58:48.294977 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:58:48.294977 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m11:58:48.295978 [debug] [ThreadPool]: On create_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_staging"} */

    
    
        create schema if not exists "warehouse"."main_staging"
    
[0m11:58:48.295978 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:58:48.297066 [debug] [ThreadPool]: On create_warehouse_main_staging: COMMIT
[0m11:58:48.298066 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m11:58:48.299066 [debug] [ThreadPool]: On create_warehouse_main_staging: COMMIT
[0m11:58:48.299066 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:58:48.300065 [debug] [ThreadPool]: On create_warehouse_main_staging: Close
[0m11:58:48.302066 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_staging'
[0m11:58:48.309098 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_staging"
[0m11:58:48.309098 [debug] [ThreadPool]: On list_warehouse_main_staging: BEGIN
[0m11:58:48.310099 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:58:48.311133 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:58:48.311768 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_staging"
[0m11:58:48.311768 [debug] [ThreadPool]: On list_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_staging"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'warehouse'
  
[0m11:58:48.323880 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m11:58:48.326779 [debug] [ThreadPool]: On list_warehouse_main_staging: ROLLBACK
[0m11:58:48.327151 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_staging'
[0m11:58:48.327151 [debug] [ThreadPool]: On list_warehouse_main_staging: Close
[0m11:58:48.327151 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_staging, now list_warehouse_main_raw)
[0m11:58:48.332940 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m11:58:48.332940 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m11:58:48.334164 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:58:48.334164 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:58:48.334164 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m11:58:48.334164 [debug] [ThreadPool]: On list_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_raw"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'warehouse'
  
[0m11:58:48.334164 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m11:58:48.340694 [debug] [ThreadPool]: On list_warehouse_main_raw: ROLLBACK
[0m11:58:48.341079 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_raw'
[0m11:58:48.341079 [debug] [ThreadPool]: On list_warehouse_main_raw: Close
[0m11:58:48.342626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f266ac1c-5ab6-4d4a-ab94-4725787f4d02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194FB7561D0>]}
[0m11:58:48.343651 [debug] [MainThread]: Using duckdb connection "master"
[0m11:58:48.343651 [debug] [MainThread]: On master: BEGIN
[0m11:58:48.343651 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:58:48.343651 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:58:48.343651 [debug] [MainThread]: On master: COMMIT
[0m11:58:48.343651 [debug] [MainThread]: Using duckdb connection "master"
[0m11:58:48.347940 [debug] [MainThread]: On master: COMMIT
[0m11:58:48.347940 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:58:48.347940 [debug] [MainThread]: On master: Close
[0m11:58:48.352787 [debug] [Thread-1 (]: Began running node model.case_project.stg_customers
[0m11:58:48.354462 [info ] [Thread-1 (]: 1 of 3 START sql view model main_staging.stg_customers ......................... [RUN]
[0m11:58:48.354835 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.case_project.stg_customers'
[0m11:58:48.354835 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_customers
[0m11:58:48.363814 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_customers"
[0m11:58:48.368493 [debug] [Thread-1 (]: Began executing node model.case_project.stg_customers
[0m11:58:48.406416 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_customers"
[0m11:58:48.407386 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m11:58:48.408415 [debug] [Thread-1 (]: On model.case_project.stg_customers: BEGIN
[0m11:58:48.409386 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:58:48.409386 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:58:48.410386 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m11:58:48.410386 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */

  
  create view "warehouse"."main_staging"."stg_customers__dbt_tmp" as (
    -- models/staging/stg_customers.sql
with src as (
  select * from "warehouse"."main_raw"."raw_customers"
),
clean as (
  select
    cast(id as varchar)           as customer_id,
    lower(trim(first_name))       as first_name,
    lower(trim(last_name))        as last_name,
    lower(trim(email))            as email
  from src
)
select
  customer_id,
  first_name,
  last_name,
  email
  -- if you want a full_name, derive it here using the *already defined* aliases:
  -- , first_name || ' ' || last_name as full_name
from clean
  );

[0m11:58:48.419346 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */

  
  create view "warehouse"."main_staging"."stg_customers__dbt_tmp" as (
    -- models/staging/stg_customers.sql
with src as (
  select * from "warehouse"."main_raw"."raw_customers"
),
clean as (
  select
    cast(id as varchar)           as customer_id,
    lower(trim(first_name))       as first_name,
    lower(trim(last_name))        as last_name,
    lower(trim(email))            as email
  from src
)
select
  customer_id,
  first_name,
  last_name,
  email
  -- if you want a full_name, derive it here using the *already defined* aliases:
  -- , first_name || ' ' || last_name as full_name
from clean
  );

[0m11:58:48.419346 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m11:58:48.420345 [debug] [Thread-1 (]: On model.case_project.stg_customers: ROLLBACK
[0m11:58:48.427055 [debug] [Thread-1 (]: Failed to rollback 'model.case_project.stg_customers'
[0m11:58:48.428056 [debug] [Thread-1 (]: On model.case_project.stg_customers: Close
[0m11:58:48.430056 [debug] [Thread-1 (]: Runtime Error in model stg_customers (models\staging\stg_customers.sql)
  Binder Error: Column "first_name" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
[0m11:58:48.432560 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f266ac1c-5ab6-4d4a-ab94-4725787f4d02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194F93159C0>]}
[0m11:58:48.432560 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main_staging.stg_customers ................ [[31mERROR[0m in 0.08s]
[0m11:58:48.434385 [debug] [Thread-1 (]: Finished running node model.case_project.stg_customers
[0m11:58:48.435421 [debug] [Thread-1 (]: Began running node model.case_project.stg_orders
[0m11:58:48.436420 [debug] [Thread-4 (]: Marking all children of 'model.case_project.stg_customers' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_customers (models\staging\stg_customers.sql)
  Binder Error: Column "first_name" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined.
[0m11:58:48.436420 [info ] [Thread-1 (]: 2 of 3 START sql view model main_staging.stg_orders ............................ [RUN]
[0m11:58:48.438291 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_customers, now model.case_project.stg_orders)
[0m11:58:48.438291 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_orders
[0m11:58:48.442679 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_orders"
[0m11:58:48.444787 [debug] [Thread-1 (]: Began executing node model.case_project.stg_orders
[0m11:58:48.449667 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_orders"
[0m11:58:48.451637 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m11:58:48.452667 [debug] [Thread-1 (]: On model.case_project.stg_orders: BEGIN
[0m11:58:48.452667 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:58:48.453679 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:58:48.454680 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m11:58:48.455982 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */

  
  create view "warehouse"."main_staging"."stg_orders__dbt_tmp" as (
    with src as (
  select * from "warehouse"."main_raw"."raw_orders"
)
select
  cast(id as varchar)                 as order_id,
  cast(customer as varchar)           as customer_id,
  cast(store_id as varchar)           as store_id,
  cast(ordered_at as timestamp)       as ordered_at,
  cast(subtotal as double)            as subtotal,
  cast(tax_paid as double)            as tax_paid,
  cast(order_total as double)         as order_total
from src
  );

[0m11:58:48.456346 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:48.465539 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m11:58:48.465539 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */
alter view "warehouse"."main_staging"."stg_orders" rename to "stg_orders__dbt_backup"
[0m11:58:48.466576 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:48.470576 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m11:58:48.472083 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */
alter view "warehouse"."main_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m11:58:48.472601 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:48.486810 [debug] [Thread-1 (]: On model.case_project.stg_orders: COMMIT
[0m11:58:48.486810 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m11:58:48.486810 [debug] [Thread-1 (]: On model.case_project.stg_orders: COMMIT
[0m11:58:48.491885 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:58:48.494386 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m11:58:48.494386 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */

      drop view if exists "warehouse"."main_staging"."stg_orders__dbt_backup" cascade
    
[0m11:58:48.500726 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:58:48.502805 [debug] [Thread-1 (]: On model.case_project.stg_orders: Close
[0m11:58:48.502805 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f266ac1c-5ab6-4d4a-ab94-4725787f4d02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194F79C0160>]}
[0m11:58:48.502805 [info ] [Thread-1 (]: 2 of 3 OK created sql view model main_staging.stg_orders ....................... [[32mOK[0m in 0.06s]
[0m11:58:48.507347 [debug] [Thread-1 (]: Finished running node model.case_project.stg_orders
[0m11:58:48.507782 [debug] [Thread-1 (]: Began running node model.case_project.stg_products
[0m11:58:48.507782 [info ] [Thread-1 (]: 3 of 3 START sql view model main_staging.stg_products .......................... [RUN]
[0m11:58:48.507782 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_orders, now model.case_project.stg_products)
[0m11:58:48.507782 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_products
[0m11:58:48.514067 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_products"
[0m11:58:48.514703 [debug] [Thread-1 (]: Began executing node model.case_project.stg_products
[0m11:58:48.519852 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_products"
[0m11:58:48.521854 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m11:58:48.523012 [debug] [Thread-1 (]: On model.case_project.stg_products: BEGIN
[0m11:58:48.523012 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:58:48.524018 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:58:48.525018 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m11:58:48.526017 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */

  
  create view "warehouse"."main_staging"."stg_products__dbt_tmp" as (
    with src as (select * from "warehouse"."main_raw"."raw_products")
select
  cast(sku as varchar)      as product_id,
  lower(trim(name))        as product_name,
  cast(price as double)    as price
from src
  );

[0m11:58:48.527017 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:48.531018 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m11:58:48.532016 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */
alter view "warehouse"."main_staging"."stg_products" rename to "stg_products__dbt_backup"
[0m11:58:48.532521 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:48.536887 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m11:58:48.537887 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */
alter view "warehouse"."main_staging"."stg_products__dbt_tmp" rename to "stg_products"
[0m11:58:48.538888 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:48.540887 [debug] [Thread-1 (]: On model.case_project.stg_products: COMMIT
[0m11:58:48.541888 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m11:58:48.541888 [debug] [Thread-1 (]: On model.case_project.stg_products: COMMIT
[0m11:58:48.544009 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:58:48.547773 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m11:58:48.548773 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */

      drop view if exists "warehouse"."main_staging"."stg_products__dbt_backup" cascade
    
[0m11:58:48.550359 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:58:48.551777 [debug] [Thread-1 (]: On model.case_project.stg_products: Close
[0m11:58:48.552783 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f266ac1c-5ab6-4d4a-ab94-4725787f4d02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194FD665A80>]}
[0m11:58:48.553743 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main_staging.stg_products ..................... [[32mOK[0m in 0.05s]
[0m11:58:48.553743 [debug] [Thread-1 (]: Finished running node model.case_project.stg_products
[0m11:58:48.556387 [debug] [MainThread]: Using duckdb connection "master"
[0m11:58:48.556387 [debug] [MainThread]: On master: BEGIN
[0m11:58:48.556387 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:58:48.556387 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:58:48.556387 [debug] [MainThread]: On master: COMMIT
[0m11:58:48.556387 [debug] [MainThread]: Using duckdb connection "master"
[0m11:58:48.556387 [debug] [MainThread]: On master: COMMIT
[0m11:58:48.561681 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:58:48.561681 [debug] [MainThread]: On master: Close
[0m11:58:48.562885 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:58:48.562885 [debug] [MainThread]: Connection 'create_warehouse_main_staging' was properly closed.
[0m11:58:48.563892 [debug] [MainThread]: Connection 'list_warehouse_main_raw' was properly closed.
[0m11:58:48.563892 [debug] [MainThread]: Connection 'model.case_project.stg_products' was properly closed.
[0m11:58:48.564891 [info ] [MainThread]: 
[0m11:58:48.565891 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m11:58:48.567244 [debug] [MainThread]: Command end result
[0m11:58:48.597509 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\manss\Desktop\Case Project\target\manifest.json
[0m11:58:48.601942 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\manss\Desktop\Case Project\target\semantic_manifest.json
[0m11:58:48.605460 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\manss\Desktop\Case Project\target\run_results.json
[0m11:58:48.611755 [info ] [MainThread]: 
[0m11:58:48.611755 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:58:48.612785 [info ] [MainThread]: 
[0m11:58:48.612785 [error] [MainThread]: [31mFailure in model stg_customers (models\staging\stg_customers.sql)[0m
[0m11:58:48.612785 [error] [MainThread]:   Runtime Error in model stg_customers (models\staging\stg_customers.sql)
  Binder Error: Column "first_name" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
[0m11:58:48.612785 [info ] [MainThread]: 
[0m11:58:48.612785 [info ] [MainThread]:   compiled code at target\compiled\case_project\models\staging\stg_customers.sql
[0m11:58:48.612785 [info ] [MainThread]: 
[0m11:58:48.618020 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m11:58:48.619027 [debug] [MainThread]: Command `dbt run` failed at 11:58:48.619027 after 2.64 seconds
[0m11:58:48.620026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194F94631F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194FB757070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194FCF45330>]}
[0m11:58:48.621026 [debug] [MainThread]: Flushing usage events
[0m11:58:49.253875 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:08:41.230194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157C6883160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157C8B77D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157C8B77EE0>]}


============================== 12:08:41.233738 | 7abd7185-a144-4d87-99aa-96ed52350181 ==============================
[0m12:08:41.233738 [info ] [MainThread]: Running with dbt=1.10.9
[0m12:08:41.235743 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --select staging', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'printer_width': '80', 'log_path': 'C:\\Users\\manss\\Desktop\\Case Project\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': 'C:\\Users\\manss\\Desktop\\Case Project'}
[0m12:08:41.524374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7abd7185-a144-4d87-99aa-96ed52350181', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157C89774F0>]}
[0m12:08:41.602834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7abd7185-a144-4d87-99aa-96ed52350181', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157C8339990>]}
[0m12:08:41.605100 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m12:08:42.046049 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m12:08:42.356467 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:08:42.357467 [debug] [MainThread]: Partial parsing: updated file: case_project://models\staging\stg_customers.sql
[0m12:08:42.946341 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.case_project.marts
[0m12:08:42.968505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7abd7185-a144-4d87-99aa-96ed52350181', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157CA452320>]}
[0m12:08:43.118945 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\manss\Desktop\Case Project\target\manifest.json
[0m12:08:43.122537 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\manss\Desktop\Case Project\target\semantic_manifest.json
[0m12:08:43.154447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7abd7185-a144-4d87-99aa-96ed52350181', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157CA3FAC50>]}
[0m12:08:43.154447 [info ] [MainThread]: Found 3 seeds, 3 models, 9 data tests, 3 sources, 429 macros
[0m12:08:43.154447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7abd7185-a144-4d87-99aa-96ed52350181', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157CA3FBE80>]}
[0m12:08:43.159393 [info ] [MainThread]: 
[0m12:08:43.160327 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:08:43.160755 [info ] [MainThread]: 
[0m12:08:43.161759 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:08:43.167744 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m12:08:43.420034 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m12:08:43.421031 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m12:08:43.421031 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:08:43.444609 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m12:08:43.445581 [debug] [ThreadPool]: On list_warehouse: Close
[0m12:08:43.447289 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_staging)
[0m12:08:43.448295 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_staging"
"
[0m12:08:43.455943 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m12:08:43.456943 [debug] [ThreadPool]: On create_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m12:08:43.456943 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:08:43.457942 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:08:43.459944 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m12:08:43.460912 [debug] [ThreadPool]: On create_warehouse_main_staging: BEGIN
[0m12:08:43.460912 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:08:43.461944 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m12:08:43.461944 [debug] [ThreadPool]: On create_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_staging"} */

    
    
        create schema if not exists "warehouse"."main_staging"
    
[0m12:08:43.463192 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:08:43.464230 [debug] [ThreadPool]: On create_warehouse_main_staging: COMMIT
[0m12:08:43.464230 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m12:08:43.465200 [debug] [ThreadPool]: On create_warehouse_main_staging: COMMIT
[0m12:08:43.466198 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:08:43.466198 [debug] [ThreadPool]: On create_warehouse_main_staging: Close
[0m12:08:43.468198 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_staging'
[0m12:08:43.475399 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_staging"
[0m12:08:43.476399 [debug] [ThreadPool]: On list_warehouse_main_staging: BEGIN
[0m12:08:43.477399 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:08:43.477399 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:08:43.478370 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_staging"
[0m12:08:43.479382 [debug] [ThreadPool]: On list_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_staging"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'warehouse'
  
[0m12:08:43.492693 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m12:08:43.494099 [debug] [ThreadPool]: On list_warehouse_main_staging: ROLLBACK
[0m12:08:43.494099 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_staging'
[0m12:08:43.494099 [debug] [ThreadPool]: On list_warehouse_main_staging: Close
[0m12:08:43.494099 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_staging, now list_warehouse_main_raw)
[0m12:08:43.494099 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m12:08:43.500985 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m12:08:43.500985 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:08:43.502534 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:08:43.502534 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m12:08:43.503547 [debug] [ThreadPool]: On list_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_raw"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'warehouse'
  
[0m12:08:43.503547 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m12:08:43.507924 [debug] [ThreadPool]: On list_warehouse_main_raw: ROLLBACK
[0m12:08:43.508753 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_raw'
[0m12:08:43.508753 [debug] [ThreadPool]: On list_warehouse_main_raw: Close
[0m12:08:43.508753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7abd7185-a144-4d87-99aa-96ed52350181', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157CA4B7040>]}
[0m12:08:43.508753 [debug] [MainThread]: Using duckdb connection "master"
[0m12:08:43.511980 [debug] [MainThread]: On master: BEGIN
[0m12:08:43.512494 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:08:43.512494 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:08:43.512494 [debug] [MainThread]: On master: COMMIT
[0m12:08:43.514486 [debug] [MainThread]: Using duckdb connection "master"
[0m12:08:43.515491 [debug] [MainThread]: On master: COMMIT
[0m12:08:43.515491 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:08:43.516492 [debug] [MainThread]: On master: Close
[0m12:08:43.521374 [debug] [Thread-1 (]: Began running node model.case_project.stg_customers
[0m12:08:43.522102 [info ] [Thread-1 (]: 1 of 3 START sql view model main_staging.stg_customers ......................... [RUN]
[0m12:08:43.522610 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.case_project.stg_customers'
[0m12:08:43.523941 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_customers
[0m12:08:43.534279 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_customers"
[0m12:08:43.535247 [debug] [Thread-1 (]: Began executing node model.case_project.stg_customers
[0m12:08:43.573519 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_customers"
[0m12:08:43.574518 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m12:08:43.575526 [debug] [Thread-1 (]: On model.case_project.stg_customers: BEGIN
[0m12:08:43.576519 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:08:43.577491 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:08:43.577491 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m12:08:43.577491 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */

  
  create view "warehouse"."main_staging"."stg_customers__dbt_tmp" as (
    with src as (
  select * from "warehouse"."main_raw"."raw_customers"
),
clean as (
  select
    cast(id as varchar) as customer_id,
    regexp_replace(name, '^(Mr\.|Mrs\.|Ms\.|Dr\.|MD)\s+', '') as clean_name
  from src
)
select
  customer_id,
  split_part(clean_name, ' ', 1) as first_name,
  split_part(clean_name, ' ', 2) as last_name
from clean
  );

[0m12:08:43.582000 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:08:43.587548 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m12:08:43.591254 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */
alter view "warehouse"."main_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m12:08:43.591762 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:08:43.603872 [debug] [Thread-1 (]: On model.case_project.stg_customers: COMMIT
[0m12:08:43.605076 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m12:08:43.605076 [debug] [Thread-1 (]: On model.case_project.stg_customers: COMMIT
[0m12:08:43.605076 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:08:43.612698 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m12:08:43.612698 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */

      drop view if exists "warehouse"."main_staging"."stg_customers__dbt_backup" cascade
    
[0m12:08:43.612698 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:08:43.619010 [debug] [Thread-1 (]: On model.case_project.stg_customers: Close
[0m12:08:43.622948 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7abd7185-a144-4d87-99aa-96ed52350181', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157CA8DB640>]}
[0m12:08:43.624028 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main_staging.stg_customers .................... [[32mOK[0m in 0.10s]
[0m12:08:43.625600 [debug] [Thread-1 (]: Finished running node model.case_project.stg_customers
[0m12:08:43.626026 [debug] [Thread-1 (]: Began running node model.case_project.stg_orders
[0m12:08:43.626026 [info ] [Thread-1 (]: 2 of 3 START sql view model main_staging.stg_orders ............................ [RUN]
[0m12:08:43.626026 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_customers, now model.case_project.stg_orders)
[0m12:08:43.626026 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_orders
[0m12:08:43.632542 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_orders"
[0m12:08:43.632933 [debug] [Thread-1 (]: Began executing node model.case_project.stg_orders
[0m12:08:43.639489 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_orders"
[0m12:08:43.640786 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m12:08:43.641539 [debug] [Thread-1 (]: On model.case_project.stg_orders: BEGIN
[0m12:08:43.642628 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:43.643683 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:08:43.644547 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m12:08:43.645251 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */

  
  create view "warehouse"."main_staging"."stg_orders__dbt_tmp" as (
    with src as (
  select * from "warehouse"."main_raw"."raw_orders"
)
select
  cast(id as varchar)                 as order_id,
  cast(customer as varchar)           as customer_id,
  cast(store_id as varchar)           as store_id,
  cast(ordered_at as timestamp)       as ordered_at,
  cast(subtotal as double)            as subtotal,
  cast(tax_paid as double)            as tax_paid,
  cast(order_total as double)         as order_total
from src
  );

[0m12:08:43.646095 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:08:43.650826 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m12:08:43.651863 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */
alter view "warehouse"."main_staging"."stg_orders" rename to "stg_orders__dbt_backup"
[0m12:08:43.653225 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:08:43.654152 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m12:08:43.654152 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */
alter view "warehouse"."main_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m12:08:43.654152 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:08:43.664194 [debug] [Thread-1 (]: On model.case_project.stg_orders: COMMIT
[0m12:08:43.664194 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m12:08:43.665196 [debug] [Thread-1 (]: On model.case_project.stg_orders: COMMIT
[0m12:08:43.667195 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:08:43.670194 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m12:08:43.670194 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */

      drop view if exists "warehouse"."main_staging"."stg_orders__dbt_backup" cascade
    
[0m12:08:43.672704 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:08:43.674636 [debug] [Thread-1 (]: On model.case_project.stg_orders: Close
[0m12:08:43.674636 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7abd7185-a144-4d87-99aa-96ed52350181', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157CA9EFEE0>]}
[0m12:08:43.674636 [info ] [Thread-1 (]: 2 of 3 OK created sql view model main_staging.stg_orders ....................... [[32mOK[0m in 0.05s]
[0m12:08:43.674636 [debug] [Thread-1 (]: Finished running node model.case_project.stg_orders
[0m12:08:43.674636 [debug] [Thread-1 (]: Began running node model.case_project.stg_products
[0m12:08:43.674636 [info ] [Thread-1 (]: 3 of 3 START sql view model main_staging.stg_products .......................... [RUN]
[0m12:08:43.674636 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_orders, now model.case_project.stg_products)
[0m12:08:43.674636 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_products
[0m12:08:43.682508 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_products"
[0m12:08:43.682508 [debug] [Thread-1 (]: Began executing node model.case_project.stg_products
[0m12:08:43.688483 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_products"
[0m12:08:43.691658 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m12:08:43.691658 [debug] [Thread-1 (]: On model.case_project.stg_products: BEGIN
[0m12:08:43.692671 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:43.693656 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:08:43.693656 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m12:08:43.694953 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */

  
  create view "warehouse"."main_staging"."stg_products__dbt_tmp" as (
    with src as (select * from "warehouse"."main_raw"."raw_products")
select
  cast(sku as varchar)      as product_id,
  lower(trim(name))        as product_name,
  cast(price as double)    as price
from src
  );

[0m12:08:43.696132 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:08:43.701189 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m12:08:43.701655 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */
alter view "warehouse"."main_staging"."stg_products" rename to "stg_products__dbt_backup"
[0m12:08:43.702667 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:08:43.709083 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m12:08:43.710082 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */
alter view "warehouse"."main_staging"."stg_products__dbt_tmp" rename to "stg_products"
[0m12:08:43.711086 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:08:43.713636 [debug] [Thread-1 (]: On model.case_project.stg_products: COMMIT
[0m12:08:43.713636 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m12:08:43.714898 [debug] [Thread-1 (]: On model.case_project.stg_products: COMMIT
[0m12:08:43.715897 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:08:43.719895 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m12:08:43.720895 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */

      drop view if exists "warehouse"."main_staging"."stg_products__dbt_backup" cascade
    
[0m12:08:43.721896 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:08:43.723963 [debug] [Thread-1 (]: On model.case_project.stg_products: Close
[0m12:08:43.724962 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7abd7185-a144-4d87-99aa-96ed52350181', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157CAA39090>]}
[0m12:08:43.725961 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main_staging.stg_products ..................... [[32mOK[0m in 0.05s]
[0m12:08:43.726579 [debug] [Thread-1 (]: Finished running node model.case_project.stg_products
[0m12:08:43.728614 [debug] [MainThread]: Using duckdb connection "master"
[0m12:08:43.728614 [debug] [MainThread]: On master: BEGIN
[0m12:08:43.729585 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:08:43.730065 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:08:43.730065 [debug] [MainThread]: On master: COMMIT
[0m12:08:43.730065 [debug] [MainThread]: Using duckdb connection "master"
[0m12:08:43.732146 [debug] [MainThread]: On master: COMMIT
[0m12:08:43.733058 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:08:43.733507 [debug] [MainThread]: On master: Close
[0m12:08:43.734196 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:08:43.734196 [debug] [MainThread]: Connection 'create_warehouse_main_staging' was properly closed.
[0m12:08:43.735203 [debug] [MainThread]: Connection 'list_warehouse_main_raw' was properly closed.
[0m12:08:43.735203 [debug] [MainThread]: Connection 'model.case_project.stg_products' was properly closed.
[0m12:08:43.736201 [info ] [MainThread]: 
[0m12:08:43.737203 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m12:08:43.739202 [debug] [MainThread]: Command end result
[0m12:08:43.770662 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\manss\Desktop\Case Project\target\manifest.json
[0m12:08:43.775242 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\manss\Desktop\Case Project\target\semantic_manifest.json
[0m12:08:43.784262 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\manss\Desktop\Case Project\target\run_results.json
[0m12:08:43.784262 [info ] [MainThread]: 
[0m12:08:43.785264 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:08:43.786292 [info ] [MainThread]: 
[0m12:08:43.787261 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m12:08:43.788260 [debug] [MainThread]: Command `dbt run` succeeded at 12:08:43.788260 after 2.66 seconds
[0m12:08:43.788765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157C6883160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157C89774F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157C8339990>]}
[0m12:08:43.789768 [debug] [MainThread]: Flushing usage events
[0m12:08:44.473694 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:21:04.286903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215CC6031F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215CE8F7BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215CE8F7D90>]}


============================== 13:21:04.302098 | 6f5e3556-447d-4acd-831f-2acfc2058ecb ==============================
[0m13:21:04.302098 [info ] [MainThread]: Running with dbt=1.10.9
[0m13:21:04.302098 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run --select staging', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\manss\\Desktop\\Case Project\\logs', 'profiles_dir': 'C:\\Users\\manss\\Desktop\\Case Project', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m13:21:04.665953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f5e3556-447d-4acd-831f-2acfc2058ecb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215CD920A90>]}
[0m13:21:04.750984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6f5e3556-447d-4acd-831f-2acfc2058ecb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215CE0B9390>]}
[0m13:21:04.756269 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m13:21:05.103723 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m13:21:05.494893 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 3 files changed.
[0m13:21:05.494893 [debug] [MainThread]: Partial parsing: added file: case_project://models\marts\dim_customers.sql
[0m13:21:05.494893 [debug] [MainThread]: Partial parsing: added file: case_project://seeds\raw_items.csv
[0m13:21:05.510612 [debug] [MainThread]: Partial parsing: added file: case_project://models\marts\dim_products.sql
[0m13:21:05.510612 [debug] [MainThread]: Partial parsing: added file: case_project://models\staging\stg_items.sql
[0m13:21:05.510612 [debug] [MainThread]: Partial parsing: added file: case_project://models\marts\fct_orders.sql
[0m13:21:05.510612 [debug] [MainThread]: Partial parsing: updated file: case_project://models\sources.yml
[0m13:21:05.510612 [debug] [MainThread]: Partial parsing: updated file: case_project://models\staging\staging.yml
[0m13:21:05.510612 [debug] [MainThread]: Partial parsing: updated file: case_project://models\staging\stg_products.sql
[0m13:21:06.446584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f5e3556-447d-4acd-831f-2acfc2058ecb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215D03B00A0>]}
[0m13:21:06.603307 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\manss\Desktop\Case Project\target\manifest.json
[0m13:21:06.610366 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\manss\Desktop\Case Project\target\semantic_manifest.json
[0m13:21:06.649586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f5e3556-447d-4acd-831f-2acfc2058ecb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215CFEEAD10>]}
[0m13:21:06.649586 [info ] [MainThread]: Found 4 seeds, 7 models, 6 data tests, 4 sources, 429 macros
[0m13:21:06.649586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f5e3556-447d-4acd-831f-2acfc2058ecb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215CFEEADA0>]}
[0m13:21:06.649586 [info ] [MainThread]: 
[0m13:21:06.649586 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:21:06.649586 [info ] [MainThread]: 
[0m13:21:06.649586 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:21:06.671707 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m13:21:06.930173 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m13:21:06.931204 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m13:21:06.931204 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:07.034865 [debug] [ThreadPool]: SQL status: OK in 0.113 seconds
[0m13:21:07.034865 [debug] [ThreadPool]: On list_warehouse: Close
[0m13:21:07.034865 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_staging)
[0m13:21:07.034865 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_staging"
"
[0m13:21:07.057713 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m13:21:07.058713 [debug] [ThreadPool]: On create_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m13:21:07.058713 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:21:07.060943 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:21:07.061949 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m13:21:07.062979 [debug] [ThreadPool]: On create_warehouse_main_staging: BEGIN
[0m13:21:07.063950 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:21:07.063950 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m13:21:07.064983 [debug] [ThreadPool]: On create_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_staging"} */

    
    
        create schema if not exists "warehouse"."main_staging"
    
[0m13:21:07.066950 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:21:07.067949 [debug] [ThreadPool]: On create_warehouse_main_staging: COMMIT
[0m13:21:07.067949 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m13:21:07.068979 [debug] [ThreadPool]: On create_warehouse_main_staging: COMMIT
[0m13:21:07.069948 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:21:07.069948 [debug] [ThreadPool]: On create_warehouse_main_staging: Close
[0m13:21:07.071947 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_staging'
[0m13:21:07.071947 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_staging"
[0m13:21:07.071947 [debug] [ThreadPool]: On list_warehouse_main_staging: BEGIN
[0m13:21:07.071947 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:07.071947 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:21:07.071947 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_staging"
[0m13:21:07.071947 [debug] [ThreadPool]: On list_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_staging"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'warehouse'
  
[0m13:21:07.105705 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m13:21:07.107710 [debug] [ThreadPool]: On list_warehouse_main_staging: ROLLBACK
[0m13:21:07.109714 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_staging'
[0m13:21:07.109714 [debug] [ThreadPool]: On list_warehouse_main_staging: Close
[0m13:21:07.109714 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_staging, now list_warehouse_main_raw)
[0m13:21:07.109714 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m13:21:07.109714 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m13:21:07.109714 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:21:07.109714 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:21:07.109714 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m13:21:07.109714 [debug] [ThreadPool]: On list_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_raw"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'warehouse'
  
[0m13:21:07.119777 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m13:21:07.119777 [debug] [ThreadPool]: On list_warehouse_main_raw: ROLLBACK
[0m13:21:07.119777 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_raw'
[0m13:21:07.119777 [debug] [ThreadPool]: On list_warehouse_main_raw: Close
[0m13:21:07.119777 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_raw, now list_warehouse_main_marts)
[0m13:21:07.119777 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m13:21:07.119777 [debug] [ThreadPool]: On list_warehouse_main_marts: BEGIN
[0m13:21:07.119777 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:21:07.119777 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:21:07.119777 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m13:21:07.119777 [debug] [ThreadPool]: On list_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_marts"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'warehouse'
  
[0m13:21:07.119777 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m13:21:07.135905 [debug] [ThreadPool]: On list_warehouse_main_marts: ROLLBACK
[0m13:21:07.135905 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_marts'
[0m13:21:07.135905 [debug] [ThreadPool]: On list_warehouse_main_marts: Close
[0m13:21:07.135905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f5e3556-447d-4acd-831f-2acfc2058ecb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215CB90B3D0>]}
[0m13:21:07.135905 [debug] [MainThread]: Using duckdb connection "master"
[0m13:21:07.135905 [debug] [MainThread]: On master: BEGIN
[0m13:21:07.135905 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:21:07.135905 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:21:07.135905 [debug] [MainThread]: On master: COMMIT
[0m13:21:07.135905 [debug] [MainThread]: Using duckdb connection "master"
[0m13:21:07.135905 [debug] [MainThread]: On master: COMMIT
[0m13:21:07.135905 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:21:07.135905 [debug] [MainThread]: On master: Close
[0m13:21:07.151585 [debug] [Thread-1 (]: Began running node model.case_project.stg_customers
[0m13:21:07.151585 [info ] [Thread-1 (]: 1 of 4 START sql view model main_staging.stg_customers ......................... [RUN]
[0m13:21:07.151585 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.case_project.stg_customers'
[0m13:21:07.151585 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_customers
[0m13:21:07.151585 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_customers"
[0m13:21:07.151585 [debug] [Thread-1 (]: Began executing node model.case_project.stg_customers
[0m13:21:07.203398 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_customers"
[0m13:21:07.203838 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m13:21:07.203838 [debug] [Thread-1 (]: On model.case_project.stg_customers: BEGIN
[0m13:21:07.203838 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:21:07.203838 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:21:07.203838 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m13:21:07.203838 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */

  
  create view "warehouse"."main_staging"."stg_customers__dbt_tmp" as (
    with src as (
  select * from "warehouse"."main_raw"."raw_customers"
),
clean as (
  select
    cast(id as varchar) as customer_id,
    regexp_replace(name, '^(Mr\.|Mrs\.|Ms\.|Dr\.|MD)\s+', '') as clean_name
  from src
)
select
  customer_id,
  split_part(clean_name, ' ', 1) as first_name,
  split_part(clean_name, ' ', 2) as last_name
from clean
  );

[0m13:21:07.210883 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:21:07.217667 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m13:21:07.217667 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */
alter view "warehouse"."main_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m13:21:07.217667 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:21:07.224660 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m13:21:07.224660 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */
alter view "warehouse"."main_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m13:21:07.224660 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:21:07.238456 [debug] [Thread-1 (]: On model.case_project.stg_customers: COMMIT
[0m13:21:07.238456 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m13:21:07.238456 [debug] [Thread-1 (]: On model.case_project.stg_customers: COMMIT
[0m13:21:07.245421 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:21:07.252668 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m13:21:07.252668 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */

      drop view if exists "warehouse"."main_staging"."stg_customers__dbt_backup" cascade
    
[0m13:21:07.252668 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:21:07.259581 [debug] [Thread-1 (]: On model.case_project.stg_customers: Close
[0m13:21:07.259581 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f5e3556-447d-4acd-831f-2acfc2058ecb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215CB90B3D0>]}
[0m13:21:07.259581 [info ] [Thread-1 (]: 1 of 4 OK created sql view model main_staging.stg_customers .................... [[32mOK[0m in 0.11s]
[0m13:21:07.265892 [debug] [Thread-1 (]: Finished running node model.case_project.stg_customers
[0m13:21:07.266558 [debug] [Thread-1 (]: Began running node model.case_project.stg_items
[0m13:21:07.266558 [info ] [Thread-1 (]: 2 of 4 START sql view model main_staging.stg_items ............................. [RUN]
[0m13:21:07.266558 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_customers, now model.case_project.stg_items)
[0m13:21:07.266558 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_items
[0m13:21:07.273477 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_items"
[0m13:21:07.275619 [debug] [Thread-1 (]: Began executing node model.case_project.stg_items
[0m13:21:07.280787 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_items"
[0m13:21:07.282788 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m13:21:07.283787 [debug] [Thread-1 (]: On model.case_project.stg_items: BEGIN
[0m13:21:07.283787 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:21:07.284776 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:21:07.285880 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m13:21:07.286878 [debug] [Thread-1 (]: On model.case_project.stg_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_items"} */

  
  create view "warehouse"."main_staging"."stg_items__dbt_tmp" as (
    with src as (
  select * from "warehouse"."main_raw"."raw_items"
)
select
  cast(order_id   as varchar)        as order_id,
  cast(sku        as varchar)        as product_id,
  coalesce(cast(quantity   as int), 1)      as quantity,
  cast(unit_price as double)               as unit_price
from src
  );

[0m13:21:07.298414 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_items"} */

  
  create view "warehouse"."main_staging"."stg_items__dbt_tmp" as (
    with src as (
  select * from "warehouse"."main_raw"."raw_items"
)
select
  cast(order_id   as varchar)        as order_id,
  cast(sku        as varchar)        as product_id,
  coalesce(cast(quantity   as int), 1)      as quantity,
  cast(unit_price as double)               as unit_price
from src
  );

[0m13:21:07.299418 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:21:07.300416 [debug] [Thread-1 (]: On model.case_project.stg_items: ROLLBACK
[0m13:21:07.308571 [debug] [Thread-1 (]: Failed to rollback 'model.case_project.stg_items'
[0m13:21:07.308571 [debug] [Thread-1 (]: On model.case_project.stg_items: Close
[0m13:21:07.314439 [debug] [Thread-1 (]: Runtime Error in model stg_items (models\staging\stg_items.sql)
  Catalog Error: Table with name raw_items does not exist!
  Did you mean "raw_customers"?
  
  LINE 6:   select * from "warehouse"."main_raw"."raw_items"
                          ^
[0m13:21:07.315446 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f5e3556-447d-4acd-831f-2acfc2058ecb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215CC4B59C0>]}
[0m13:21:07.316444 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model main_staging.stg_items .................... [[31mERROR[0m in 0.05s]
[0m13:21:07.317447 [debug] [Thread-1 (]: Finished running node model.case_project.stg_items
[0m13:21:07.318448 [debug] [Thread-1 (]: Began running node model.case_project.stg_orders
[0m13:21:07.319446 [debug] [Thread-4 (]: Marking all children of 'model.case_project.stg_items' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_items (models\staging\stg_items.sql)
  Catalog Error: Table with name raw_items does not exist!
  Did you mean "raw_customers"?
  
  LINE 6:   select * from "warehouse"."main_raw"."raw_items"
                          ^.
[0m13:21:07.319446 [info ] [Thread-1 (]: 3 of 4 START sql view model main_staging.stg_orders ............................ [RUN]
[0m13:21:07.321447 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_items, now model.case_project.stg_orders)
[0m13:21:07.321447 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_orders
[0m13:21:07.325669 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_orders"
[0m13:21:07.327670 [debug] [Thread-1 (]: Began executing node model.case_project.stg_orders
[0m13:21:07.328697 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_orders"
[0m13:21:07.328697 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m13:21:07.328697 [debug] [Thread-1 (]: On model.case_project.stg_orders: BEGIN
[0m13:21:07.328697 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:21:07.328697 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:21:07.328697 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m13:21:07.328697 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */

  
  create view "warehouse"."main_staging"."stg_orders__dbt_tmp" as (
    with src as (
  select * from "warehouse"."main_raw"."raw_orders"
)
select
  cast(id as varchar)                 as order_id,
  cast(customer as varchar)           as customer_id,
  cast(store_id as varchar)           as store_id,
  cast(ordered_at as timestamp)       as ordered_at,
  cast(subtotal as double)            as subtotal,
  cast(tax_paid as double)            as tax_paid,
  cast(order_total as double)         as order_total
from src
  );

[0m13:21:07.328697 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:21:07.328697 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m13:21:07.328697 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */
alter view "warehouse"."main_staging"."stg_orders" rename to "stg_orders__dbt_backup"
[0m13:21:07.328697 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:21:07.348887 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m13:21:07.349887 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */
alter view "warehouse"."main_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m13:21:07.350888 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:21:07.352888 [debug] [Thread-1 (]: On model.case_project.stg_orders: COMMIT
[0m13:21:07.353889 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m13:21:07.354887 [debug] [Thread-1 (]: On model.case_project.stg_orders: COMMIT
[0m13:21:07.356887 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:21:07.360887 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m13:21:07.360887 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */

      drop view if exists "warehouse"."main_staging"."stg_orders__dbt_backup" cascade
    
[0m13:21:07.362884 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:21:07.364888 [debug] [Thread-1 (]: On model.case_project.stg_orders: Close
[0m13:21:07.365888 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f5e3556-447d-4acd-831f-2acfc2058ecb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215CB90B3D0>]}
[0m13:21:07.366888 [info ] [Thread-1 (]: 3 of 4 OK created sql view model main_staging.stg_orders ....................... [[32mOK[0m in 0.04s]
[0m13:21:07.367885 [debug] [Thread-1 (]: Finished running node model.case_project.stg_orders
[0m13:21:07.368885 [debug] [Thread-1 (]: Began running node model.case_project.stg_products
[0m13:21:07.369988 [info ] [Thread-1 (]: 4 of 4 START sql view model main_staging.stg_products .......................... [RUN]
[0m13:21:07.370990 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_orders, now model.case_project.stg_products)
[0m13:21:07.371989 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_products
[0m13:21:07.374988 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_products"
[0m13:21:07.376989 [debug] [Thread-1 (]: Began executing node model.case_project.stg_products
[0m13:21:07.381988 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_products"
[0m13:21:07.383988 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m13:21:07.383988 [debug] [Thread-1 (]: On model.case_project.stg_products: BEGIN
[0m13:21:07.384990 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:21:07.385985 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:21:07.386989 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m13:21:07.386989 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */

  
  create view "warehouse"."main_staging"."stg_products__dbt_tmp" as (
    -- models/staging/stg_products.sql
with src as (select * from "warehouse"."main_raw"."raw_products")
select
  cast(sku as varchar)      as product_id,
  lower(trim(name))        as product_name,
  cast(price as double)    as price
from src
  );

[0m13:21:07.388989 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:21:07.392989 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m13:21:07.393988 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */
alter view "warehouse"."main_staging"."stg_products" rename to "stg_products__dbt_backup"
[0m13:21:07.395023 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:21:07.398986 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m13:21:07.399986 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */
alter view "warehouse"."main_staging"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:21:07.399986 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:21:07.399986 [debug] [Thread-1 (]: On model.case_project.stg_products: COMMIT
[0m13:21:07.399986 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m13:21:07.404747 [debug] [Thread-1 (]: On model.case_project.stg_products: COMMIT
[0m13:21:07.405791 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:21:07.409797 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m13:21:07.410797 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */

      drop view if exists "warehouse"."main_staging"."stg_products__dbt_backup" cascade
    
[0m13:21:07.411797 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:21:07.413797 [debug] [Thread-1 (]: On model.case_project.stg_products: Close
[0m13:21:07.414797 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f5e3556-447d-4acd-831f-2acfc2058ecb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215D079F0D0>]}
[0m13:21:07.415796 [info ] [Thread-1 (]: 4 of 4 OK created sql view model main_staging.stg_products ..................... [[32mOK[0m in 0.04s]
[0m13:21:07.416797 [debug] [Thread-1 (]: Finished running node model.case_project.stg_products
[0m13:21:07.418828 [debug] [MainThread]: Using duckdb connection "master"
[0m13:21:07.418828 [debug] [MainThread]: On master: BEGIN
[0m13:21:07.419828 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:21:07.420799 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:21:07.420799 [debug] [MainThread]: On master: COMMIT
[0m13:21:07.421832 [debug] [MainThread]: Using duckdb connection "master"
[0m13:21:07.421832 [debug] [MainThread]: On master: COMMIT
[0m13:21:07.422798 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:21:07.422798 [debug] [MainThread]: On master: Close
[0m13:21:07.423798 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:21:07.424799 [debug] [MainThread]: Connection 'create_warehouse_main_staging' was properly closed.
[0m13:21:07.424799 [debug] [MainThread]: Connection 'list_warehouse_main_marts' was properly closed.
[0m13:21:07.425798 [debug] [MainThread]: Connection 'model.case_project.stg_products' was properly closed.
[0m13:21:07.426798 [info ] [MainThread]: 
[0m13:21:07.426798 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.78 seconds (0.78s).
[0m13:21:07.428798 [debug] [MainThread]: Command end result
[0m13:21:07.508379 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\manss\Desktop\Case Project\target\manifest.json
[0m13:21:07.508379 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\manss\Desktop\Case Project\target\semantic_manifest.json
[0m13:21:07.530067 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\manss\Desktop\Case Project\target\run_results.json
[0m13:21:07.531071 [info ] [MainThread]: 
[0m13:21:07.532071 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:21:07.533071 [info ] [MainThread]: 
[0m13:21:07.534070 [error] [MainThread]: [31mFailure in model stg_items (models\staging\stg_items.sql)[0m
[0m13:21:07.534070 [error] [MainThread]:   Runtime Error in model stg_items (models\staging\stg_items.sql)
  Catalog Error: Table with name raw_items does not exist!
  Did you mean "raw_customers"?
  
  LINE 6:   select * from "warehouse"."main_raw"."raw_items"
                          ^
[0m13:21:07.535068 [info ] [MainThread]: 
[0m13:21:07.536068 [info ] [MainThread]:   compiled code at target\compiled\case_project\models\staging\stg_items.sql
[0m13:21:07.536755 [info ] [MainThread]: 
[0m13:21:07.537810 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m13:21:07.538857 [debug] [MainThread]: Command `dbt run` failed at 13:21:07.538857 after 3.36 seconds
[0m13:21:07.539988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215CC6031F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215CD933250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215D03B2DD0>]}
[0m13:21:07.540987 [debug] [MainThread]: Flushing usage events
[0m13:21:08.225409 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:49:32.467869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F34643130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F36933B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F36933D60>]}


============================== 13:49:32.472867 | d600037c-0418-4f35-9181-f27d887d8635 ==============================
[0m13:49:32.472867 [info ] [MainThread]: Running with dbt=1.10.9
[0m13:49:32.473341 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'printer_width': '80', 'empty': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\manss\\Desktop\\Case Project\\logs', 'profiles_dir': 'C:\\Users\\manss\\Desktop\\Case Project', 'static_parser': 'True', 'write_json': 'True'}
[0m13:49:32.765329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd600037c-0418-4f35-9181-f27d887d8635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F369C0EB0>]}
[0m13:49:32.837481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd600037c-0418-4f35-9181-f27d887d8635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F36736800>]}
[0m13:49:32.837481 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m13:49:33.181588 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m13:49:33.539834 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 4 files added, 4 files changed.
[0m13:49:33.539834 [debug] [MainThread]: Partial parsing: added file: case_project://models\marts\schema.yml
[0m13:49:33.539834 [debug] [MainThread]: Partial parsing: added file: case_project://models\staging\schema.yml
[0m13:49:33.539834 [debug] [MainThread]: Partial parsing: added file: case_project://tests\order_total_matches.sql
[0m13:49:33.539834 [debug] [MainThread]: Partial parsing: added file: case_project://models\marts\fct_order_items.sql
[0m13:49:33.539834 [debug] [MainThread]: Partial parsing: updated file: case_project://models\staging\stg_items.sql
[0m13:49:33.539834 [debug] [MainThread]: Partial parsing: updated file: case_project://models\marts\dim_customers.sql
[0m13:49:33.555805 [debug] [MainThread]: Partial parsing: updated file: case_project://models\marts\dim_products.sql
[0m13:49:33.555805 [debug] [MainThread]: Partial parsing: updated file: case_project://models\marts\fct_orders.sql
[0m13:49:34.149452 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m13:49:34.149452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd600037c-0418-4f35-9181-f27d887d8635', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F38203DC0>]}
[0m13:49:34.364130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd600037c-0418-4f35-9181-f27d887d8635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F3833E2C0>]}
[0m13:49:34.554550 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\manss\Desktop\Case Project\target\manifest.json
[0m13:49:34.555550 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\manss\Desktop\Case Project\target\semantic_manifest.json
[0m13:49:34.586882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd600037c-0418-4f35-9181-f27d887d8635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F3833D270>]}
[0m13:49:34.586882 [info ] [MainThread]: Found 4 seeds, 8 models, 24 data tests, 4 sources, 429 macros
[0m13:49:34.586882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd600037c-0418-4f35-9181-f27d887d8635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F3833D4E0>]}
[0m13:49:34.586882 [info ] [MainThread]: 
[0m13:49:34.586882 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:49:34.586882 [info ] [MainThread]: 
[0m13:49:34.586882 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:49:34.604945 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m13:49:34.820566 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m13:49:34.820566 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m13:49:34.820566 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:49:34.847559 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m13:49:34.849557 [debug] [ThreadPool]: On list_warehouse: Close
[0m13:49:34.852531 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m13:49:34.852531 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m13:49:34.852531 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:49:34.852531 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:49:34.852531 [debug] [ThreadPool]: On list_warehouse: Close
[0m13:49:34.852531 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_marts)
[0m13:49:34.852531 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_marts"
"
[0m13:49:34.852531 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m13:49:34.852531 [debug] [ThreadPool]: On create_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_marts"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m13:49:34.868280 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:49:34.869440 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:49:34.870439 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m13:49:34.871440 [debug] [ThreadPool]: On create_warehouse_main_marts: BEGIN
[0m13:49:34.872439 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:49:34.872439 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m13:49:34.873439 [debug] [ThreadPool]: On create_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_marts"} */

    
    
        create schema if not exists "warehouse"."main_marts"
    
[0m13:49:34.874410 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:49:34.875440 [debug] [ThreadPool]: On create_warehouse_main_marts: COMMIT
[0m13:49:34.875440 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m13:49:34.876440 [debug] [ThreadPool]: On create_warehouse_main_marts: COMMIT
[0m13:49:34.880702 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m13:49:34.880702 [debug] [ThreadPool]: On create_warehouse_main_marts: Close
[0m13:49:34.881738 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_warehouse_main_marts, now create_warehouse_main_staging)
[0m13:49:34.882738 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_staging"
"
[0m13:49:34.883742 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m13:49:34.883742 [debug] [ThreadPool]: On create_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m13:49:34.883742 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:49:34.883742 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:49:34.883742 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m13:49:34.883742 [debug] [ThreadPool]: On create_warehouse_main_staging: BEGIN
[0m13:49:34.883742 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:49:34.883742 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m13:49:34.883742 [debug] [ThreadPool]: On create_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_staging"} */

    
    
        create schema if not exists "warehouse"."main_staging"
    
[0m13:49:34.883742 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:49:34.883742 [debug] [ThreadPool]: On create_warehouse_main_staging: COMMIT
[0m13:49:34.883742 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m13:49:34.883742 [debug] [ThreadPool]: On create_warehouse_main_staging: COMMIT
[0m13:49:34.883742 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:49:34.883742 [debug] [ThreadPool]: On create_warehouse_main_staging: Close
[0m13:49:34.883742 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_raw'
[0m13:49:34.899600 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m13:49:34.899600 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m13:49:34.899600 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:49:34.899600 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:49:34.899600 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m13:49:34.899600 [debug] [ThreadPool]: On list_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_raw"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'warehouse'
  
[0m13:49:34.922327 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m13:49:34.924327 [debug] [ThreadPool]: On list_warehouse_main_raw: ROLLBACK
[0m13:49:34.925684 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_raw'
[0m13:49:34.925684 [debug] [ThreadPool]: On list_warehouse_main_raw: Close
[0m13:49:34.926688 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_raw, now list_warehouse_main_marts)
[0m13:49:34.930651 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m13:49:34.930651 [debug] [ThreadPool]: On list_warehouse_main_marts: BEGIN
[0m13:49:34.931719 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:49:34.932720 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:49:34.932720 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m13:49:34.933750 [debug] [ThreadPool]: On list_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_marts"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'warehouse'
  
[0m13:49:34.936749 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m13:49:34.937719 [debug] [ThreadPool]: On list_warehouse_main_marts: ROLLBACK
[0m13:49:34.938749 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_marts'
[0m13:49:34.939750 [debug] [ThreadPool]: On list_warehouse_main_marts: Close
[0m13:49:34.939750 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_marts, now list_warehouse_main_staging)
[0m13:49:34.942749 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_staging"
[0m13:49:34.943750 [debug] [ThreadPool]: On list_warehouse_main_staging: BEGIN
[0m13:49:34.943750 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:49:34.944749 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:49:34.945750 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_staging"
[0m13:49:34.945750 [debug] [ThreadPool]: On list_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_staging"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'warehouse'
  
[0m13:49:34.948751 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m13:49:34.950749 [debug] [ThreadPool]: On list_warehouse_main_staging: ROLLBACK
[0m13:49:34.950749 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_staging'
[0m13:49:34.951750 [debug] [ThreadPool]: On list_warehouse_main_staging: Close
[0m13:49:34.953749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd600037c-0418-4f35-9181-f27d887d8635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F369321D0>]}
[0m13:49:34.953749 [debug] [MainThread]: Using duckdb connection "master"
[0m13:49:34.954753 [debug] [MainThread]: On master: BEGIN
[0m13:49:34.954753 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:49:34.955720 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:49:34.956749 [debug] [MainThread]: On master: COMMIT
[0m13:49:34.956749 [debug] [MainThread]: Using duckdb connection "master"
[0m13:49:34.957720 [debug] [MainThread]: On master: COMMIT
[0m13:49:34.958750 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:49:34.958750 [debug] [MainThread]: On master: Close
[0m13:49:34.961719 [debug] [Thread-1 (]: Began running node model.case_project.stg_customers
[0m13:49:34.961719 [info ] [Thread-1 (]: 1 of 8 START sql view model main_staging.stg_customers ......................... [RUN]
[0m13:49:34.961719 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.case_project.stg_customers'
[0m13:49:34.961719 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_customers
[0m13:49:34.961719 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_customers"
[0m13:49:34.978835 [debug] [Thread-1 (]: Began executing node model.case_project.stg_customers
[0m13:49:35.014119 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_customers"
[0m13:49:35.014119 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m13:49:35.014119 [debug] [Thread-1 (]: On model.case_project.stg_customers: BEGIN
[0m13:49:35.014119 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:49:35.014119 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:49:35.014119 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m13:49:35.014119 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */

  
  create view "warehouse"."main_staging"."stg_customers__dbt_tmp" as (
    with src as (
  select * from "warehouse"."main_raw"."raw_customers"
),
clean as (
  select
    cast(id as varchar) as customer_id,
    regexp_replace(name, '^(Mr\.|Mrs\.|Ms\.|Dr\.|MD)\s+', '') as clean_name
  from src
)
select
  customer_id,
  split_part(clean_name, ' ', 1) as first_name,
  split_part(clean_name, ' ', 2) as last_name
from clean
  );

[0m13:49:35.014119 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:49:35.030024 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m13:49:35.030024 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */
alter view "warehouse"."main_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m13:49:35.030024 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:49:35.030024 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m13:49:35.030024 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */
alter view "warehouse"."main_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m13:49:35.030024 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:49:35.045759 [debug] [Thread-1 (]: On model.case_project.stg_customers: COMMIT
[0m13:49:35.045759 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m13:49:35.045759 [debug] [Thread-1 (]: On model.case_project.stg_customers: COMMIT
[0m13:49:35.045759 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:49:35.061692 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m13:49:35.061692 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */

      drop view if exists "warehouse"."main_staging"."stg_customers__dbt_backup" cascade
    
[0m13:49:35.061692 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:49:35.061692 [debug] [Thread-1 (]: On model.case_project.stg_customers: Close
[0m13:49:35.061692 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd600037c-0418-4f35-9181-f27d887d8635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F32BA6B60>]}
[0m13:49:35.061692 [info ] [Thread-1 (]: 1 of 8 OK created sql view model main_staging.stg_customers .................... [[32mOK[0m in 0.10s]
[0m13:49:35.061692 [debug] [Thread-1 (]: Finished running node model.case_project.stg_customers
[0m13:49:35.061692 [debug] [Thread-1 (]: Began running node model.case_project.stg_items
[0m13:49:35.061692 [info ] [Thread-1 (]: 2 of 8 START sql view model main_staging.stg_items ............................. [RUN]
[0m13:49:35.061692 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_customers, now model.case_project.stg_items)
[0m13:49:35.061692 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_items
[0m13:49:35.080519 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_items"
[0m13:49:35.081511 [debug] [Thread-1 (]: Began executing node model.case_project.stg_items
[0m13:49:35.087648 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_items"
[0m13:49:35.088676 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m13:49:35.088676 [debug] [Thread-1 (]: On model.case_project.stg_items: BEGIN
[0m13:49:35.089645 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:49:35.090674 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:49:35.091676 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m13:49:35.091676 [debug] [Thread-1 (]: On model.case_project.stg_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_items"} */

  
  create view "warehouse"."main_staging"."stg_items__dbt_tmp" as (
    -- models/staging/stg_items.sql
with src as (
  select * from "warehouse"."main_raw"."raw_items"
)
select
  cast(id as varchar)        as item_id,
  cast(order_id as varchar)  as order_id,
  cast(sku as varchar)       as product_id,
  1                          as quantity
from src
  );

[0m13:49:35.092674 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_items"} */

  
  create view "warehouse"."main_staging"."stg_items__dbt_tmp" as (
    -- models/staging/stg_items.sql
with src as (
  select * from "warehouse"."main_raw"."raw_items"
)
select
  cast(id as varchar)        as item_id,
  cast(order_id as varchar)  as order_id,
  cast(sku as varchar)       as product_id,
  1                          as quantity
from src
  );

[0m13:49:35.093677 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:49:35.094645 [debug] [Thread-1 (]: On model.case_project.stg_items: ROLLBACK
[0m13:49:35.103093 [debug] [Thread-1 (]: Failed to rollback 'model.case_project.stg_items'
[0m13:49:35.104206 [debug] [Thread-1 (]: On model.case_project.stg_items: Close
[0m13:49:35.106220 [debug] [Thread-1 (]: Runtime Error in model stg_items (models\staging\stg_items.sql)
  Catalog Error: Table with name raw_items does not exist!
  Did you mean "raw_customers"?
  
  LINE 7:   select * from "warehouse"."main_raw"."raw_items"
                          ^
[0m13:49:35.106220 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd600037c-0418-4f35-9181-f27d887d8635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F381D9C60>]}
[0m13:49:35.107221 [error] [Thread-1 (]: 2 of 8 ERROR creating sql view model main_staging.stg_items .................... [[31mERROR[0m in 0.04s]
[0m13:49:35.108220 [debug] [Thread-1 (]: Finished running node model.case_project.stg_items
[0m13:49:35.109191 [debug] [Thread-1 (]: Began running node model.case_project.stg_orders
[0m13:49:35.110190 [debug] [Thread-4 (]: Marking all children of 'model.case_project.stg_items' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_items (models\staging\stg_items.sql)
  Catalog Error: Table with name raw_items does not exist!
  Did you mean "raw_customers"?
  
  LINE 7:   select * from "warehouse"."main_raw"."raw_items"
                          ^.
[0m13:49:35.111164 [info ] [Thread-1 (]: 3 of 8 START sql view model main_staging.stg_orders ............................ [RUN]
[0m13:49:35.113170 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_items, now model.case_project.stg_orders)
[0m13:49:35.113170 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_orders
[0m13:49:35.118101 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_orders"
[0m13:49:35.119100 [debug] [Thread-1 (]: Began executing node model.case_project.stg_orders
[0m13:49:35.122063 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_orders"
[0m13:49:35.125850 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m13:49:35.125850 [debug] [Thread-1 (]: On model.case_project.stg_orders: BEGIN
[0m13:49:35.125850 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:49:35.125850 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:49:35.125850 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m13:49:35.125850 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */

  
  create view "warehouse"."main_staging"."stg_orders__dbt_tmp" as (
    with src as (
  select * from "warehouse"."main_raw"."raw_orders"
)
select
  cast(id as varchar)                 as order_id,
  cast(customer as varchar)           as customer_id,
  cast(store_id as varchar)           as store_id,
  cast(ordered_at as timestamp)       as ordered_at,
  cast(subtotal as double)            as subtotal,
  cast(tax_paid as double)            as tax_paid,
  cast(order_total as double)         as order_total
from src
  );

[0m13:49:35.125850 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:49:35.133972 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m13:49:35.134972 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */
alter view "warehouse"."main_staging"."stg_orders" rename to "stg_orders__dbt_backup"
[0m13:49:35.135998 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:49:35.139970 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m13:49:35.140971 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */
alter view "warehouse"."main_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m13:49:35.141972 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:49:35.144242 [debug] [Thread-1 (]: On model.case_project.stg_orders: COMMIT
[0m13:49:35.144242 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m13:49:35.145779 [debug] [Thread-1 (]: On model.case_project.stg_orders: COMMIT
[0m13:49:35.146634 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:49:35.146634 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m13:49:35.146634 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */

      drop view if exists "warehouse"."main_staging"."stg_orders__dbt_backup" cascade
    
[0m13:49:35.154000 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:49:35.155007 [debug] [Thread-1 (]: On model.case_project.stg_orders: Close
[0m13:49:35.156007 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd600037c-0418-4f35-9181-f27d887d8635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F3819D2D0>]}
[0m13:49:35.157006 [info ] [Thread-1 (]: 3 of 8 OK created sql view model main_staging.stg_orders ....................... [[32mOK[0m in 0.04s]
[0m13:49:35.158008 [debug] [Thread-1 (]: Finished running node model.case_project.stg_orders
[0m13:49:35.159007 [debug] [Thread-1 (]: Began running node model.case_project.stg_products
[0m13:49:35.159875 [info ] [Thread-1 (]: 4 of 8 START sql view model main_staging.stg_products .......................... [RUN]
[0m13:49:35.160935 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_orders, now model.case_project.stg_products)
[0m13:49:35.161936 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_products
[0m13:49:35.164934 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_products"
[0m13:49:35.165935 [debug] [Thread-1 (]: Began executing node model.case_project.stg_products
[0m13:49:35.224522 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_products"
[0m13:49:35.225522 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m13:49:35.226496 [debug] [Thread-1 (]: On model.case_project.stg_products: BEGIN
[0m13:49:35.226496 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:49:35.227522 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:49:35.228522 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m13:49:35.229492 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */

  
  create view "warehouse"."main_staging"."stg_products__dbt_tmp" as (
    -- models/staging/stg_products.sql
with src as (select * from "warehouse"."main_raw"."raw_products")
select
  cast(sku as varchar)      as product_id,
  lower(trim(name))        as product_name,
  cast(price as double)    as price
from src
  );

[0m13:49:35.229492 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:49:35.229492 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m13:49:35.229492 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */
alter view "warehouse"."main_staging"."stg_products" rename to "stg_products__dbt_backup"
[0m13:49:35.229492 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:49:35.239897 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m13:49:35.240993 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */
alter view "warehouse"."main_staging"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:49:35.240993 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:49:35.242992 [debug] [Thread-1 (]: On model.case_project.stg_products: COMMIT
[0m13:49:35.244111 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m13:49:35.245111 [debug] [Thread-1 (]: On model.case_project.stg_products: COMMIT
[0m13:49:35.246548 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:49:35.250583 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m13:49:35.250583 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */

      drop view if exists "warehouse"."main_staging"."stg_products__dbt_backup" cascade
    
[0m13:49:35.252553 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:49:35.254585 [debug] [Thread-1 (]: On model.case_project.stg_products: Close
[0m13:49:35.255554 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd600037c-0418-4f35-9181-f27d887d8635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F381D9C60>]}
[0m13:49:35.256584 [info ] [Thread-1 (]: 4 of 8 OK created sql view model main_staging.stg_products ..................... [[32mOK[0m in 0.09s]
[0m13:49:35.257553 [debug] [Thread-1 (]: Finished running node model.case_project.stg_products
[0m13:49:35.257553 [debug] [Thread-1 (]: Began running node model.case_project.dim_customers
[0m13:49:35.258553 [info ] [Thread-1 (]: 5 of 8 START sql table model main_marts.dim_customers .......................... [RUN]
[0m13:49:35.259552 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_products, now model.case_project.dim_customers)
[0m13:49:35.260552 [debug] [Thread-1 (]: Began compiling node model.case_project.dim_customers
[0m13:49:35.264551 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.dim_customers"
[0m13:49:35.266554 [debug] [Thread-1 (]: Began executing node model.case_project.dim_customers
[0m13:49:35.292554 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.dim_customers"
[0m13:49:35.293553 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m13:49:35.294556 [debug] [Thread-1 (]: On model.case_project.dim_customers: BEGIN
[0m13:49:35.295556 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:49:35.296553 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:49:35.297552 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m13:49:35.297552 [debug] [Thread-1 (]: On model.case_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_customers"} */

  
    
    

    create  table
      "warehouse"."main_marts"."dim_customers__dbt_tmp"
  
    as (
      -- models/marts/dim_customers.sql


with base as (
    select
        customer_id,
        first_name,
        last_name,
        (first_name || ' ' || coalesce(last_name, '')) as customer_name
    from "warehouse"."main_staging"."stg_customers"
),

orders as (
    select
        customer_id,
        min(ordered_at) as first_order_at,
        max(ordered_at) as most_recent_order_at,
        count(*)        as order_count,
        sum(order_total) as lifetime_value
    from "warehouse"."main_staging"."stg_orders"
    group by 1
)

select
    b.customer_id,
    b.first_name,
    b.last_name,
    b.customer_name,
    o.first_order_at,
    o.most_recent_order_at,
    coalesce(o.order_count, 0)      as order_count,
    coalesce(o.lifetime_value, 0.0) as lifetime_value
from base b
left join orders o using (customer_id)
    );
  
  
[0m13:49:35.317656 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m13:49:35.319694 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m13:49:35.319694 [debug] [Thread-1 (]: On model.case_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_customers"} */
alter table "warehouse"."main_marts"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m13:49:35.319694 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:49:35.330549 [debug] [Thread-1 (]: On model.case_project.dim_customers: COMMIT
[0m13:49:35.331526 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m13:49:35.331526 [debug] [Thread-1 (]: On model.case_project.dim_customers: COMMIT
[0m13:49:35.333413 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:49:35.339021 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m13:49:35.339021 [debug] [Thread-1 (]: On model.case_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_customers"} */

      drop table if exists "warehouse"."main_marts"."dim_customers__dbt_backup" cascade
    
[0m13:49:35.339021 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:49:35.341026 [debug] [Thread-1 (]: On model.case_project.dim_customers: Close
[0m13:49:35.343031 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd600037c-0418-4f35-9181-f27d887d8635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F3811F700>]}
[0m13:49:35.343031 [info ] [Thread-1 (]: 5 of 8 OK created sql table model main_marts.dim_customers ..................... [[32mOK[0m in 0.08s]
[0m13:49:35.343031 [debug] [Thread-1 (]: Finished running node model.case_project.dim_customers
[0m13:49:35.343031 [debug] [Thread-1 (]: Began running node model.case_project.fct_orders
[0m13:49:35.346652 [info ] [Thread-1 (]: 6 of 8 START sql table model main_marts.fct_orders ............................. [RUN]
[0m13:49:35.346652 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.dim_customers, now model.case_project.fct_orders)
[0m13:49:35.348393 [debug] [Thread-1 (]: Began compiling node model.case_project.fct_orders
[0m13:49:35.352403 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.fct_orders"
[0m13:49:35.352403 [debug] [Thread-1 (]: Began executing node model.case_project.fct_orders
[0m13:49:35.358417 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.fct_orders"
[0m13:49:35.358417 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m13:49:35.358417 [debug] [Thread-1 (]: On model.case_project.fct_orders: BEGIN
[0m13:49:35.358417 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:49:35.361569 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:49:35.361569 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m13:49:35.361569 [debug] [Thread-1 (]: On model.case_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_orders"} */

  
    
    

    create  table
      "warehouse"."main_marts"."fct_orders__dbt_tmp"
  
    as (
      -- models/marts/fct_orders.sql


select
    o.order_id,
    o.customer_id,
    o.store_id,
    o.ordered_at,
    cast(date_trunc('day', o.ordered_at) as date) as order_date,
    o.subtotal,
    o.tax_paid,
    o.order_total
from "warehouse"."main_staging"."stg_orders" o
    );
  
  
[0m13:49:35.396581 [debug] [Thread-1 (]: SQL status: OK in 0.035 seconds
[0m13:49:35.402781 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m13:49:35.403791 [debug] [Thread-1 (]: On model.case_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_orders"} */
alter table "warehouse"."main_marts"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m13:49:35.404790 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:49:35.406790 [debug] [Thread-1 (]: On model.case_project.fct_orders: COMMIT
[0m13:49:35.406790 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m13:49:35.407788 [debug] [Thread-1 (]: On model.case_project.fct_orders: COMMIT
[0m13:49:35.416963 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m13:49:35.416963 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m13:49:35.416963 [debug] [Thread-1 (]: On model.case_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_orders"} */

      drop table if exists "warehouse"."main_marts"."fct_orders__dbt_backup" cascade
    
[0m13:49:35.432919 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:49:35.432919 [debug] [Thread-1 (]: On model.case_project.fct_orders: Close
[0m13:49:35.432919 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd600037c-0418-4f35-9181-f27d887d8635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F3811F700>]}
[0m13:49:35.432919 [info ] [Thread-1 (]: 6 of 8 OK created sql table model main_marts.fct_orders ........................ [[32mOK[0m in 0.09s]
[0m13:49:35.432919 [debug] [Thread-1 (]: Finished running node model.case_project.fct_orders
[0m13:49:35.432919 [debug] [Thread-1 (]: Began running node model.case_project.dim_products
[0m13:49:35.432919 [info ] [Thread-1 (]: 7 of 8 START sql table model main_marts.dim_products ........................... [RUN]
[0m13:49:35.432919 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.fct_orders, now model.case_project.dim_products)
[0m13:49:35.432919 [debug] [Thread-1 (]: Began compiling node model.case_project.dim_products
[0m13:49:35.444564 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.dim_products"
[0m13:49:35.444564 [debug] [Thread-1 (]: Began executing node model.case_project.dim_products
[0m13:49:35.452982 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.dim_products"
[0m13:49:35.455925 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_products"
[0m13:49:35.456934 [debug] [Thread-1 (]: On model.case_project.dim_products: BEGIN
[0m13:49:35.456934 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:49:35.457935 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:49:35.458935 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_products"
[0m13:49:35.459935 [debug] [Thread-1 (]: On model.case_project.dim_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_products"} */

  
    
    

    create  table
      "warehouse"."main_marts"."dim_products__dbt_tmp"
  
    as (
      -- models/marts/dim_products.sql


select
    p.product_id,
    p.product_name,
    p.price as current_list_price
from "warehouse"."main_staging"."stg_products" p
    );
  
  
[0m13:49:35.461907 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:49:35.466017 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_products"
[0m13:49:35.466017 [debug] [Thread-1 (]: On model.case_project.dim_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_products"} */
alter table "warehouse"."main_marts"."dim_products__dbt_tmp" rename to "dim_products"
[0m13:49:35.466017 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:49:35.466017 [debug] [Thread-1 (]: On model.case_project.dim_products: COMMIT
[0m13:49:35.472316 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_products"
[0m13:49:35.472316 [debug] [Thread-1 (]: On model.case_project.dim_products: COMMIT
[0m13:49:35.474327 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:49:35.478326 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_products"
[0m13:49:35.479326 [debug] [Thread-1 (]: On model.case_project.dim_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_products"} */

      drop table if exists "warehouse"."main_marts"."dim_products__dbt_backup" cascade
    
[0m13:49:35.480462 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:49:35.482488 [debug] [Thread-1 (]: On model.case_project.dim_products: Close
[0m13:49:35.483460 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd600037c-0418-4f35-9181-f27d887d8635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F3706B7F0>]}
[0m13:49:35.484462 [info ] [Thread-1 (]: 7 of 8 OK created sql table model main_marts.dim_products ...................... [[32mOK[0m in 0.05s]
[0m13:49:35.485463 [debug] [Thread-1 (]: Finished running node model.case_project.dim_products
[0m13:49:35.486462 [debug] [Thread-1 (]: Began running node model.case_project.fct_order_items
[0m13:49:35.487461 [info ] [Thread-1 (]: 8 of 8 SKIP relation main_marts.fct_order_items ................................ [[33mSKIP[0m]
[0m13:49:35.487461 [debug] [Thread-1 (]: Finished running node model.case_project.fct_order_items
[0m13:49:35.489458 [debug] [MainThread]: Using duckdb connection "master"
[0m13:49:35.490458 [debug] [MainThread]: On master: BEGIN
[0m13:49:35.490458 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:49:35.491462 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:49:35.492461 [debug] [MainThread]: On master: COMMIT
[0m13:49:35.492461 [debug] [MainThread]: Using duckdb connection "master"
[0m13:49:35.493461 [debug] [MainThread]: On master: COMMIT
[0m13:49:35.493461 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:49:35.494462 [debug] [MainThread]: On master: Close
[0m13:49:35.494462 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:49:35.494462 [debug] [MainThread]: Connection 'create_warehouse_main_staging' was properly closed.
[0m13:49:35.494462 [debug] [MainThread]: Connection 'list_warehouse_main_staging' was properly closed.
[0m13:49:35.494462 [debug] [MainThread]: Connection 'model.case_project.dim_products' was properly closed.
[0m13:49:35.494462 [info ] [MainThread]: 
[0m13:49:35.494462 [info ] [MainThread]: Finished running 4 table models, 4 view models in 0 hours 0 minutes and 0.91 seconds (0.91s).
[0m13:49:35.501326 [debug] [MainThread]: Command end result
[0m13:49:35.539953 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\manss\Desktop\Case Project\target\manifest.json
[0m13:49:35.544035 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\manss\Desktop\Case Project\target\semantic_manifest.json
[0m13:49:35.549035 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\manss\Desktop\Case Project\target\run_results.json
[0m13:49:35.549035 [info ] [MainThread]: 
[0m13:49:35.549035 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:49:35.549035 [info ] [MainThread]: 
[0m13:49:35.549035 [error] [MainThread]: [31mFailure in model stg_items (models\staging\stg_items.sql)[0m
[0m13:49:35.549035 [error] [MainThread]:   Runtime Error in model stg_items (models\staging\stg_items.sql)
  Catalog Error: Table with name raw_items does not exist!
  Did you mean "raw_customers"?
  
  LINE 7:   select * from "warehouse"."main_raw"."raw_items"
                          ^
[0m13:49:35.549035 [info ] [MainThread]: 
[0m13:49:35.549035 [info ] [MainThread]:   compiled code at target\compiled\case_project\models\staging\stg_items.sql
[0m13:49:35.549035 [info ] [MainThread]: 
[0m13:49:35.560691 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=8
[0m13:49:35.562530 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 7 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:49:35.563851 [debug] [MainThread]: Command `dbt run` failed at 13:49:35.563851 after 3.20 seconds
[0m13:49:35.564781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F34643130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F349A3C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F382CF340>]}
[0m13:49:35.565430 [debug] [MainThread]: Flushing usage events
[0m13:49:36.352792 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:50:12.743515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F36FE31C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F392D3D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F392D3F40>]}


============================== 13:50:12.743515 | 1003b15f-476b-47a2-88b7-859a3adab76c ==============================
[0m13:50:12.743515 [info ] [MainThread]: Running with dbt=1.10.9
[0m13:50:12.743515 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\manss\\Desktop\\Case Project\\logs', 'profiles_dir': 'C:\\Users\\manss\\Desktop\\Case Project', 'static_parser': 'True', 'write_json': 'True'}
[0m13:50:13.035560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1003b15f-476b-47a2-88b7-859a3adab76c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F392169B0>]}
[0m13:50:13.114086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1003b15f-476b-47a2-88b7-859a3adab76c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F392D1FF0>]}
[0m13:50:13.118224 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m13:50:13.446644 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m13:50:13.774292 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:50:13.774292 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:50:13.883797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1003b15f-476b-47a2-88b7-859a3adab76c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F3A9CD990>]}
[0m13:50:14.103032 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\manss\Desktop\Case Project\target\manifest.json
[0m13:50:14.103032 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\manss\Desktop\Case Project\target\semantic_manifest.json
[0m13:50:14.142141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1003b15f-476b-47a2-88b7-859a3adab76c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F393EDF90>]}
[0m13:50:14.144147 [info ] [MainThread]: Found 4 seeds, 8 models, 24 data tests, 4 sources, 429 macros
[0m13:50:14.144147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1003b15f-476b-47a2-88b7-859a3adab76c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F39357220>]}
[0m13:50:14.146383 [info ] [MainThread]: 
[0m13:50:14.146383 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:50:14.146383 [info ] [MainThread]: 
[0m13:50:14.149927 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:50:14.160101 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m13:50:14.352894 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m13:50:14.352894 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m13:50:14.352894 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:50:14.384393 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m13:50:14.384393 [debug] [ThreadPool]: On list_warehouse: Close
[0m13:50:14.384393 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m13:50:14.384393 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m13:50:14.384393 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:50:14.384393 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:50:14.384393 [debug] [ThreadPool]: On list_warehouse: Close
[0m13:50:14.400375 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_staging)
[0m13:50:14.400375 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_staging"
"
[0m13:50:14.400375 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m13:50:14.400375 [debug] [ThreadPool]: On create_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m13:50:14.400375 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:50:14.400375 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:50:14.400375 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m13:50:14.400375 [debug] [ThreadPool]: On create_warehouse_main_staging: BEGIN
[0m13:50:14.400375 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:50:14.400375 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m13:50:14.416011 [debug] [ThreadPool]: On create_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_staging"} */

    
    
        create schema if not exists "warehouse"."main_staging"
    
[0m13:50:14.416011 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:50:14.418134 [debug] [ThreadPool]: On create_warehouse_main_staging: COMMIT
[0m13:50:14.418134 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m13:50:14.419137 [debug] [ThreadPool]: On create_warehouse_main_staging: COMMIT
[0m13:50:14.420105 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:50:14.420105 [debug] [ThreadPool]: On create_warehouse_main_staging: Close
[0m13:50:14.421135 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_warehouse_main_staging, now create_warehouse_main_marts)
[0m13:50:14.422104 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_marts"
"
[0m13:50:14.425136 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m13:50:14.426134 [debug] [ThreadPool]: On create_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_marts"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m13:50:14.426134 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:50:14.427135 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:50:14.429135 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m13:50:14.430105 [debug] [ThreadPool]: On create_warehouse_main_marts: BEGIN
[0m13:50:14.430105 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:50:14.431135 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m13:50:14.431135 [debug] [ThreadPool]: On create_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_marts"} */

    
    
        create schema if not exists "warehouse"."main_marts"
    
[0m13:50:14.431135 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:50:14.431135 [debug] [ThreadPool]: On create_warehouse_main_marts: COMMIT
[0m13:50:14.431135 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m13:50:14.431135 [debug] [ThreadPool]: On create_warehouse_main_marts: COMMIT
[0m13:50:14.431135 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:50:14.431135 [debug] [ThreadPool]: On create_warehouse_main_marts: Close
[0m13:50:14.431135 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_staging'
[0m13:50:14.431135 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_staging"
[0m13:50:14.431135 [debug] [ThreadPool]: On list_warehouse_main_staging: BEGIN
[0m13:50:14.431135 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:50:14.447242 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:50:14.448407 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_staging"
[0m13:50:14.448407 [debug] [ThreadPool]: On list_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_staging"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'warehouse'
  
[0m13:50:14.461407 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m13:50:14.462407 [debug] [ThreadPool]: On list_warehouse_main_staging: ROLLBACK
[0m13:50:14.462407 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_staging'
[0m13:50:14.462407 [debug] [ThreadPool]: On list_warehouse_main_staging: Close
[0m13:50:14.462407 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_staging, now list_warehouse_main_raw)
[0m13:50:14.462407 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m13:50:14.462407 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m13:50:14.462407 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:50:14.462407 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:50:14.462407 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m13:50:14.462407 [debug] [ThreadPool]: On list_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_raw"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'warehouse'
  
[0m13:50:14.462407 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m13:50:14.462407 [debug] [ThreadPool]: On list_warehouse_main_raw: ROLLBACK
[0m13:50:14.478388 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_raw'
[0m13:50:14.478823 [debug] [ThreadPool]: On list_warehouse_main_raw: Close
[0m13:50:14.480047 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_raw, now list_warehouse_main_marts)
[0m13:50:14.483357 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m13:50:14.484358 [debug] [ThreadPool]: On list_warehouse_main_marts: BEGIN
[0m13:50:14.484358 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:50:14.485358 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:50:14.485358 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m13:50:14.486577 [debug] [ThreadPool]: On list_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_marts"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'warehouse'
  
[0m13:50:14.489607 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m13:50:14.491607 [debug] [ThreadPool]: On list_warehouse_main_marts: ROLLBACK
[0m13:50:14.492459 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_marts'
[0m13:50:14.492459 [debug] [ThreadPool]: On list_warehouse_main_marts: Close
[0m13:50:14.492459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1003b15f-476b-47a2-88b7-859a3adab76c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F35EAD600>]}
[0m13:50:14.492459 [debug] [MainThread]: Using duckdb connection "master"
[0m13:50:14.492459 [debug] [MainThread]: On master: BEGIN
[0m13:50:14.492459 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:50:14.492459 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:50:14.492459 [debug] [MainThread]: On master: COMMIT
[0m13:50:14.492459 [debug] [MainThread]: Using duckdb connection "master"
[0m13:50:14.492459 [debug] [MainThread]: On master: COMMIT
[0m13:50:14.492459 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:50:14.492459 [debug] [MainThread]: On master: Close
[0m13:50:14.492459 [debug] [Thread-1 (]: Began running node model.case_project.stg_customers
[0m13:50:14.492459 [info ] [Thread-1 (]: 1 of 8 START sql view model main_staging.stg_customers ......................... [RUN]
[0m13:50:14.492459 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.case_project.stg_customers'
[0m13:50:14.507302 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_customers
[0m13:50:14.507302 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_customers"
[0m13:50:14.507302 [debug] [Thread-1 (]: Began executing node model.case_project.stg_customers
[0m13:50:14.555229 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_customers"
[0m13:50:14.555229 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m13:50:14.555229 [debug] [Thread-1 (]: On model.case_project.stg_customers: BEGIN
[0m13:50:14.555229 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:50:14.555229 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:50:14.555229 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m13:50:14.555229 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */

  
  create view "warehouse"."main_staging"."stg_customers__dbt_tmp" as (
    with src as (
  select * from "warehouse"."main_raw"."raw_customers"
),
clean as (
  select
    cast(id as varchar) as customer_id,
    regexp_replace(name, '^(Mr\.|Mrs\.|Ms\.|Dr\.|MD)\s+', '') as clean_name
  from src
)
select
  customer_id,
  split_part(clean_name, ' ', 1) as first_name,
  split_part(clean_name, ' ', 2) as last_name
from clean
  );

[0m13:50:14.555229 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:50:14.555229 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m13:50:14.571311 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */
alter view "warehouse"."main_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m13:50:14.572426 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:50:14.576453 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m13:50:14.576453 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */
alter view "warehouse"."main_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m13:50:14.577425 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:50:14.592453 [debug] [Thread-1 (]: On model.case_project.stg_customers: COMMIT
[0m13:50:14.592453 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m13:50:14.593453 [debug] [Thread-1 (]: On model.case_project.stg_customers: COMMIT
[0m13:50:14.598174 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:50:14.605372 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m13:50:14.606373 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */

      drop view if exists "warehouse"."main_staging"."stg_customers__dbt_backup" cascade
    
[0m13:50:14.607342 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:50:14.611372 [debug] [Thread-1 (]: On model.case_project.stg_customers: Close
[0m13:50:14.614160 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1003b15f-476b-47a2-88b7-859a3adab76c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F3AE1DE10>]}
[0m13:50:14.615166 [info ] [Thread-1 (]: 1 of 8 OK created sql view model main_staging.stg_customers .................... [[32mOK[0m in 0.12s]
[0m13:50:14.616197 [debug] [Thread-1 (]: Finished running node model.case_project.stg_customers
[0m13:50:14.616197 [debug] [Thread-1 (]: Began running node model.case_project.stg_items
[0m13:50:14.617234 [info ] [Thread-1 (]: 2 of 8 START sql view model main_staging.stg_items ............................. [RUN]
[0m13:50:14.618234 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_customers, now model.case_project.stg_items)
[0m13:50:14.618234 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_items
[0m13:50:14.618234 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_items"
[0m13:50:14.618234 [debug] [Thread-1 (]: Began executing node model.case_project.stg_items
[0m13:50:14.618234 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_items"
[0m13:50:14.618234 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m13:50:14.618234 [debug] [Thread-1 (]: On model.case_project.stg_items: BEGIN
[0m13:50:14.618234 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:50:14.618234 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:50:14.618234 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m13:50:14.618234 [debug] [Thread-1 (]: On model.case_project.stg_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_items"} */

  
  create view "warehouse"."main_staging"."stg_items__dbt_tmp" as (
    -- models/staging/stg_items.sql
with src as (
  select * from "warehouse"."main_raw"."raw_items"
)
select
  cast(id as varchar)        as item_id,
  cast(order_id as varchar)  as order_id,
  cast(sku as varchar)       as product_id,
  1                          as quantity
from src
  );

[0m13:50:14.634342 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_items"} */

  
  create view "warehouse"."main_staging"."stg_items__dbt_tmp" as (
    -- models/staging/stg_items.sql
with src as (
  select * from "warehouse"."main_raw"."raw_items"
)
select
  cast(id as varchar)        as item_id,
  cast(order_id as varchar)  as order_id,
  cast(sku as varchar)       as product_id,
  1                          as quantity
from src
  );

[0m13:50:14.635505 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:50:14.636505 [debug] [Thread-1 (]: On model.case_project.stg_items: ROLLBACK
[0m13:50:14.644333 [debug] [Thread-1 (]: Failed to rollback 'model.case_project.stg_items'
[0m13:50:14.645333 [debug] [Thread-1 (]: On model.case_project.stg_items: Close
[0m13:50:14.647331 [debug] [Thread-1 (]: Runtime Error in model stg_items (models\staging\stg_items.sql)
  Catalog Error: Table with name raw_items does not exist!
  Did you mean "raw_customers"?
  
  LINE 7:   select * from "warehouse"."main_raw"."raw_items"
                          ^
[0m13:50:14.648331 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1003b15f-476b-47a2-88b7-859a3adab76c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F3A954DC0>]}
[0m13:50:14.649333 [error] [Thread-1 (]: 2 of 8 ERROR creating sql view model main_staging.stg_items .................... [[31mERROR[0m in 0.03s]
[0m13:50:14.650335 [debug] [Thread-1 (]: Finished running node model.case_project.stg_items
[0m13:50:14.651333 [debug] [Thread-1 (]: Began running node model.case_project.stg_orders
[0m13:50:14.651333 [debug] [Thread-4 (]: Marking all children of 'model.case_project.stg_items' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_items (models\staging\stg_items.sql)
  Catalog Error: Table with name raw_items does not exist!
  Did you mean "raw_customers"?
  
  LINE 7:   select * from "warehouse"."main_raw"."raw_items"
                          ^.
[0m13:50:14.652334 [info ] [Thread-1 (]: 3 of 8 START sql view model main_staging.stg_orders ............................ [RUN]
[0m13:50:14.654333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_items, now model.case_project.stg_orders)
[0m13:50:14.654333 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_orders
[0m13:50:14.660688 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_orders"
[0m13:50:14.661658 [debug] [Thread-1 (]: Began executing node model.case_project.stg_orders
[0m13:50:14.666758 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_orders"
[0m13:50:14.668830 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m13:50:14.669831 [debug] [Thread-1 (]: On model.case_project.stg_orders: BEGIN
[0m13:50:14.669831 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:50:14.670831 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:50:14.671831 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m13:50:14.672831 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */

  
  create view "warehouse"."main_staging"."stg_orders__dbt_tmp" as (
    with src as (
  select * from "warehouse"."main_raw"."raw_orders"
)
select
  cast(id as varchar)                 as order_id,
  cast(customer as varchar)           as customer_id,
  cast(store_id as varchar)           as store_id,
  cast(ordered_at as timestamp)       as ordered_at,
  cast(subtotal as double)            as subtotal,
  cast(tax_paid as double)            as tax_paid,
  cast(order_total as double)         as order_total
from src
  );

[0m13:50:14.673396 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:50:14.677400 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m13:50:14.678401 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */
alter view "warehouse"."main_staging"."stg_orders" rename to "stg_orders__dbt_backup"
[0m13:50:14.679401 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:50:14.683401 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m13:50:14.684401 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */
alter view "warehouse"."main_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m13:50:14.685401 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:50:14.687402 [debug] [Thread-1 (]: On model.case_project.stg_orders: COMMIT
[0m13:50:14.688578 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m13:50:14.689657 [debug] [Thread-1 (]: On model.case_project.stg_orders: COMMIT
[0m13:50:14.690158 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:50:14.694625 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m13:50:14.694625 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */

      drop view if exists "warehouse"."main_staging"."stg_orders__dbt_backup" cascade
    
[0m13:50:14.694625 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:50:14.694625 [debug] [Thread-1 (]: On model.case_project.stg_orders: Close
[0m13:50:14.694625 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1003b15f-476b-47a2-88b7-859a3adab76c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F38A0DB70>]}
[0m13:50:14.700701 [info ] [Thread-1 (]: 3 of 8 OK created sql view model main_staging.stg_orders ....................... [[32mOK[0m in 0.04s]
[0m13:50:14.701737 [debug] [Thread-1 (]: Finished running node model.case_project.stg_orders
[0m13:50:14.702737 [debug] [Thread-1 (]: Began running node model.case_project.stg_products
[0m13:50:14.703737 [info ] [Thread-1 (]: 4 of 8 START sql view model main_staging.stg_products .......................... [RUN]
[0m13:50:14.704707 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_orders, now model.case_project.stg_products)
[0m13:50:14.705738 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_products
[0m13:50:14.708935 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_products"
[0m13:50:14.709932 [debug] [Thread-1 (]: Began executing node model.case_project.stg_products
[0m13:50:14.714934 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_products"
[0m13:50:14.716934 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m13:50:14.716934 [debug] [Thread-1 (]: On model.case_project.stg_products: BEGIN
[0m13:50:14.717934 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:50:14.718934 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:50:14.719934 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m13:50:14.720933 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */

  
  create view "warehouse"."main_staging"."stg_products__dbt_tmp" as (
    -- models/staging/stg_products.sql
with src as (select * from "warehouse"."main_raw"."raw_products")
select
  cast(sku as varchar)      as product_id,
  lower(trim(name))        as product_name,
  cast(price as double)    as price
from src
  );

[0m13:50:14.721934 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:50:14.726932 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m13:50:14.727931 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */
alter view "warehouse"."main_staging"."stg_products" rename to "stg_products__dbt_backup"
[0m13:50:14.728964 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:50:14.732932 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m13:50:14.733932 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */
alter view "warehouse"."main_staging"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:50:14.733932 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:50:14.736964 [debug] [Thread-1 (]: On model.case_project.stg_products: COMMIT
[0m13:50:14.736964 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m13:50:14.737964 [debug] [Thread-1 (]: On model.case_project.stg_products: COMMIT
[0m13:50:14.739935 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:50:14.743933 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m13:50:14.743933 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */

      drop view if exists "warehouse"."main_staging"."stg_products__dbt_backup" cascade
    
[0m13:50:14.745935 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:50:14.747932 [debug] [Thread-1 (]: On model.case_project.stg_products: Close
[0m13:50:14.748931 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1003b15f-476b-47a2-88b7-859a3adab76c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F3AE1EDD0>]}
[0m13:50:14.749934 [info ] [Thread-1 (]: 4 of 8 OK created sql view model main_staging.stg_products ..................... [[32mOK[0m in 0.04s]
[0m13:50:14.750866 [debug] [Thread-1 (]: Finished running node model.case_project.stg_products
[0m13:50:14.751902 [debug] [Thread-1 (]: Began running node model.case_project.dim_customers
[0m13:50:14.752872 [info ] [Thread-1 (]: 5 of 8 START sql table model main_marts.dim_customers .......................... [RUN]
[0m13:50:14.753872 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_products, now model.case_project.dim_customers)
[0m13:50:14.754907 [debug] [Thread-1 (]: Began compiling node model.case_project.dim_customers
[0m13:50:14.758869 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.dim_customers"
[0m13:50:14.759905 [debug] [Thread-1 (]: Began executing node model.case_project.dim_customers
[0m13:50:14.785683 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.dim_customers"
[0m13:50:14.787661 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m13:50:14.787661 [debug] [Thread-1 (]: On model.case_project.dim_customers: BEGIN
[0m13:50:14.788688 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:50:14.789684 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:50:14.789684 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m13:50:14.790992 [debug] [Thread-1 (]: On model.case_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_customers"} */

  
    
    

    create  table
      "warehouse"."main_marts"."dim_customers__dbt_tmp"
  
    as (
      -- models/marts/dim_customers.sql


with base as (
    select
        customer_id,
        first_name,
        last_name,
        (first_name || ' ' || coalesce(last_name, '')) as customer_name
    from "warehouse"."main_staging"."stg_customers"
),

orders as (
    select
        customer_id,
        min(ordered_at) as first_order_at,
        max(ordered_at) as most_recent_order_at,
        count(*)        as order_count,
        sum(order_total) as lifetime_value
    from "warehouse"."main_staging"."stg_orders"
    group by 1
)

select
    b.customer_id,
    b.first_name,
    b.last_name,
    b.customer_name,
    o.first_order_at,
    o.most_recent_order_at,
    coalesce(o.order_count, 0)      as order_count,
    coalesce(o.lifetime_value, 0.0) as lifetime_value
from base b
left join orders o using (customer_id)
    );
  
  
[0m13:50:14.800120 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m13:50:14.805120 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m13:50:14.805120 [debug] [Thread-1 (]: On model.case_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_customers"} */
alter table "warehouse"."main_marts"."dim_customers" rename to "dim_customers__dbt_backup"
[0m13:50:14.805120 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:50:14.805120 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m13:50:14.805120 [debug] [Thread-1 (]: On model.case_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_customers"} */
alter table "warehouse"."main_marts"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m13:50:14.805120 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:50:14.805120 [debug] [Thread-1 (]: On model.case_project.dim_customers: COMMIT
[0m13:50:14.805120 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m13:50:14.805120 [debug] [Thread-1 (]: On model.case_project.dim_customers: COMMIT
[0m13:50:14.821150 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:50:14.821150 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m13:50:14.821150 [debug] [Thread-1 (]: On model.case_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_customers"} */

      drop table if exists "warehouse"."main_marts"."dim_customers__dbt_backup" cascade
    
[0m13:50:14.821150 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:50:14.821150 [debug] [Thread-1 (]: On model.case_project.dim_customers: Close
[0m13:50:14.821150 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1003b15f-476b-47a2-88b7-859a3adab76c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F393EDDB0>]}
[0m13:50:14.821150 [info ] [Thread-1 (]: 5 of 8 OK created sql table model main_marts.dim_customers ..................... [[32mOK[0m in 0.07s]
[0m13:50:14.821150 [debug] [Thread-1 (]: Finished running node model.case_project.dim_customers
[0m13:50:14.821150 [debug] [Thread-1 (]: Began running node model.case_project.fct_orders
[0m13:50:14.821150 [info ] [Thread-1 (]: 6 of 8 START sql table model main_marts.fct_orders ............................. [RUN]
[0m13:50:14.821150 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.dim_customers, now model.case_project.fct_orders)
[0m13:50:14.836914 [debug] [Thread-1 (]: Began compiling node model.case_project.fct_orders
[0m13:50:14.841025 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.fct_orders"
[0m13:50:14.841992 [debug] [Thread-1 (]: Began executing node model.case_project.fct_orders
[0m13:50:14.847022 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.fct_orders"
[0m13:50:14.848024 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m13:50:14.849022 [debug] [Thread-1 (]: On model.case_project.fct_orders: BEGIN
[0m13:50:14.849022 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:50:14.850022 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:50:14.851022 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m13:50:14.851992 [debug] [Thread-1 (]: On model.case_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_orders"} */

  
    
    

    create  table
      "warehouse"."main_marts"."fct_orders__dbt_tmp"
  
    as (
      -- models/marts/fct_orders.sql


select
    o.order_id,
    o.customer_id,
    o.store_id,
    o.ordered_at,
    cast(date_trunc('day', o.ordered_at) as date) as order_date,
    o.subtotal,
    o.tax_paid,
    o.order_total
from "warehouse"."main_staging"."stg_orders" o
    );
  
  
[0m13:50:14.882257 [debug] [Thread-1 (]: SQL status: OK in 0.032 seconds
[0m13:50:14.889251 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m13:50:14.889251 [debug] [Thread-1 (]: On model.case_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_orders"} */
alter table "warehouse"."main_marts"."fct_orders" rename to "fct_orders__dbt_backup"
[0m13:50:14.890252 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:50:14.894251 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m13:50:14.895256 [debug] [Thread-1 (]: On model.case_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_orders"} */
alter table "warehouse"."main_marts"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m13:50:14.896454 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:50:14.898454 [debug] [Thread-1 (]: On model.case_project.fct_orders: COMMIT
[0m13:50:14.899455 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m13:50:14.899455 [debug] [Thread-1 (]: On model.case_project.fct_orders: COMMIT
[0m13:50:14.918353 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m13:50:14.918353 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m13:50:14.918353 [debug] [Thread-1 (]: On model.case_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_orders"} */

      drop table if exists "warehouse"."main_marts"."fct_orders__dbt_backup" cascade
    
[0m13:50:14.918353 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:50:14.918353 [debug] [Thread-1 (]: On model.case_project.fct_orders: Close
[0m13:50:14.918353 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1003b15f-476b-47a2-88b7-859a3adab76c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F3AFDBF10>]}
[0m13:50:14.918353 [info ] [Thread-1 (]: 6 of 8 OK created sql table model main_marts.fct_orders ........................ [[32mOK[0m in 0.10s]
[0m13:50:14.918353 [debug] [Thread-1 (]: Finished running node model.case_project.fct_orders
[0m13:50:14.918353 [debug] [Thread-1 (]: Began running node model.case_project.dim_products
[0m13:50:14.918353 [info ] [Thread-1 (]: 7 of 8 START sql table model main_marts.dim_products ........................... [RUN]
[0m13:50:14.918353 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.fct_orders, now model.case_project.dim_products)
[0m13:50:14.918353 [debug] [Thread-1 (]: Began compiling node model.case_project.dim_products
[0m13:50:14.933987 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.dim_products"
[0m13:50:14.933987 [debug] [Thread-1 (]: Began executing node model.case_project.dim_products
[0m13:50:14.933987 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.dim_products"
[0m13:50:14.933987 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_products"
[0m13:50:14.933987 [debug] [Thread-1 (]: On model.case_project.dim_products: BEGIN
[0m13:50:14.933987 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:50:14.933987 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:50:14.933987 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_products"
[0m13:50:14.933987 [debug] [Thread-1 (]: On model.case_project.dim_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_products"} */

  
    
    

    create  table
      "warehouse"."main_marts"."dim_products__dbt_tmp"
  
    as (
      -- models/marts/dim_products.sql


select
    p.product_id,
    p.product_name,
    p.price as current_list_price
from "warehouse"."main_staging"."stg_products" p
    );
  
  
[0m13:50:14.951115 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:50:14.954588 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_products"
[0m13:50:14.955588 [debug] [Thread-1 (]: On model.case_project.dim_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_products"} */
alter table "warehouse"."main_marts"."dim_products" rename to "dim_products__dbt_backup"
[0m13:50:14.956588 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:50:14.956588 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_products"
[0m13:50:14.956588 [debug] [Thread-1 (]: On model.case_project.dim_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_products"} */
alter table "warehouse"."main_marts"."dim_products__dbt_tmp" rename to "dim_products"
[0m13:50:14.956588 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:50:14.956588 [debug] [Thread-1 (]: On model.case_project.dim_products: COMMIT
[0m13:50:14.956588 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_products"
[0m13:50:14.956588 [debug] [Thread-1 (]: On model.case_project.dim_products: COMMIT
[0m13:50:14.956588 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:50:14.971588 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_products"
[0m13:50:14.972397 [debug] [Thread-1 (]: On model.case_project.dim_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_products"} */

      drop table if exists "warehouse"."main_marts"."dim_products__dbt_backup" cascade
    
[0m13:50:14.974530 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:50:14.975535 [debug] [Thread-1 (]: On model.case_project.dim_products: Close
[0m13:50:14.976536 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1003b15f-476b-47a2-88b7-859a3adab76c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F3AFDBF10>]}
[0m13:50:14.977536 [info ] [Thread-1 (]: 7 of 8 OK created sql table model main_marts.dim_products ...................... [[32mOK[0m in 0.06s]
[0m13:50:14.979505 [debug] [Thread-1 (]: Finished running node model.case_project.dim_products
[0m13:50:14.979505 [debug] [Thread-1 (]: Began running node model.case_project.fct_order_items
[0m13:50:14.980504 [info ] [Thread-1 (]: 8 of 8 SKIP relation main_marts.fct_order_items ................................ [[33mSKIP[0m]
[0m13:50:14.981504 [debug] [Thread-1 (]: Finished running node model.case_project.fct_order_items
[0m13:50:14.982824 [debug] [MainThread]: Using duckdb connection "master"
[0m13:50:14.983822 [debug] [MainThread]: On master: BEGIN
[0m13:50:14.983822 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:50:14.984823 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:50:14.985824 [debug] [MainThread]: On master: COMMIT
[0m13:50:14.985824 [debug] [MainThread]: Using duckdb connection "master"
[0m13:50:14.986824 [debug] [MainThread]: On master: COMMIT
[0m13:50:14.987822 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:50:14.987822 [debug] [MainThread]: On master: Close
[0m13:50:14.988824 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:50:14.988824 [debug] [MainThread]: Connection 'create_warehouse_main_marts' was properly closed.
[0m13:50:14.989823 [debug] [MainThread]: Connection 'list_warehouse_main_marts' was properly closed.
[0m13:50:14.989823 [debug] [MainThread]: Connection 'model.case_project.dim_products' was properly closed.
[0m13:50:14.990822 [info ] [MainThread]: 
[0m13:50:14.991822 [info ] [MainThread]: Finished running 4 table models, 4 view models in 0 hours 0 minutes and 0.84 seconds (0.84s).
[0m13:50:14.993824 [debug] [MainThread]: Command end result
[0m13:50:15.027441 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\manss\Desktop\Case Project\target\manifest.json
[0m13:50:15.027441 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\manss\Desktop\Case Project\target\semantic_manifest.json
[0m13:50:15.043558 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\manss\Desktop\Case Project\target\run_results.json
[0m13:50:15.043558 [info ] [MainThread]: 
[0m13:50:15.043558 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:50:15.043558 [info ] [MainThread]: 
[0m13:50:15.043558 [error] [MainThread]: [31mFailure in model stg_items (models\staging\stg_items.sql)[0m
[0m13:50:15.043558 [error] [MainThread]:   Runtime Error in model stg_items (models\staging\stg_items.sql)
  Catalog Error: Table with name raw_items does not exist!
  Did you mean "raw_customers"?
  
  LINE 7:   select * from "warehouse"."main_raw"."raw_items"
                          ^
[0m13:50:15.043558 [info ] [MainThread]: 
[0m13:50:15.043558 [info ] [MainThread]:   compiled code at target\compiled\case_project\models\staging\stg_items.sql
[0m13:50:15.043558 [info ] [MainThread]: 
[0m13:50:15.051467 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=8
[0m13:50:15.052308 [debug] [MainThread]: Command `dbt run` failed at 13:50:15.052308 after 2.41 seconds
[0m13:50:15.053095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F36FE31C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F362F3BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F3A9CEFE0>]}
[0m13:50:15.054140 [debug] [MainThread]: Flushing usage events
[0m13:50:15.775598 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:55:02.461413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015208D531F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001520B043BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001520B043D90>]}


============================== 13:55:02.466539 | 24622a0b-9202-4d36-98ef-a7712d885912 ==============================
[0m13:55:02.466539 [info ] [MainThread]: Running with dbt=1.10.9
[0m13:55:02.467539 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt seed', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'log_path': 'C:\\Users\\manss\\Desktop\\Case Project\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\manss\\Desktop\\Case Project', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True'}
[0m13:55:02.760286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24622a0b-9202-4d36-98ef-a7712d885912', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001520B15FCA0>]}
[0m13:55:02.836856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '24622a0b-9202-4d36-98ef-a7712d885912', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001520B041EA0>]}
[0m13:55:02.836856 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m13:55:03.196840 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m13:55:03.516324 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:55:03.517325 [debug] [MainThread]: Partial parsing: updated file: case_project://models\staging\stg_customers.sql
[0m13:55:04.134623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '24622a0b-9202-4d36-98ef-a7712d885912', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001520C96A4D0>]}
[0m13:55:04.315526 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\manss\Desktop\Case Project\target\manifest.json
[0m13:55:04.318875 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\manss\Desktop\Case Project\target\semantic_manifest.json
[0m13:55:04.353493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '24622a0b-9202-4d36-98ef-a7712d885912', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001520C97AAD0>]}
[0m13:55:04.353493 [info ] [MainThread]: Found 4 seeds, 8 models, 24 data tests, 4 sources, 429 macros
[0m13:55:04.355498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24622a0b-9202-4d36-98ef-a7712d885912', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001520B6ACDF0>]}
[0m13:55:04.357855 [info ] [MainThread]: 
[0m13:55:04.357855 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:55:04.357855 [info ] [MainThread]: 
[0m13:55:04.357855 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:55:04.368766 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m13:55:04.575174 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m13:55:04.575174 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m13:55:04.575174 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:55:04.606853 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m13:55:04.608853 [debug] [ThreadPool]: On list_warehouse: Close
[0m13:55:04.609843 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_raw)
[0m13:55:04.610853 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_raw"
"
[0m13:55:04.617853 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_raw"
[0m13:55:04.617853 [debug] [ThreadPool]: On create_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_raw"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m13:55:04.617853 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:55:04.617853 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:55:04.617853 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_raw"
[0m13:55:04.617853 [debug] [ThreadPool]: On create_warehouse_main_raw: BEGIN
[0m13:55:04.617853 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:55:04.617853 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_raw"
[0m13:55:04.617853 [debug] [ThreadPool]: On create_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_raw"} */

    
    
        create schema if not exists "warehouse"."main_raw"
    
[0m13:55:04.617853 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:55:04.617853 [debug] [ThreadPool]: On create_warehouse_main_raw: COMMIT
[0m13:55:04.617853 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_raw"
[0m13:55:04.617853 [debug] [ThreadPool]: On create_warehouse_main_raw: COMMIT
[0m13:55:04.617853 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:55:04.617853 [debug] [ThreadPool]: On create_warehouse_main_raw: Close
[0m13:55:04.617853 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_marts'
[0m13:55:04.633664 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m13:55:04.633664 [debug] [ThreadPool]: On list_warehouse_main_marts: BEGIN
[0m13:55:04.633664 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:55:04.633664 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:55:04.633664 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m13:55:04.633664 [debug] [ThreadPool]: On list_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_marts"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'warehouse'
  
[0m13:55:04.649545 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m13:55:04.649545 [debug] [ThreadPool]: On list_warehouse_main_marts: ROLLBACK
[0m13:55:04.649545 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_marts'
[0m13:55:04.649545 [debug] [ThreadPool]: On list_warehouse_main_marts: Close
[0m13:55:04.649545 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_marts, now list_warehouse_main_raw)
[0m13:55:04.649545 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m13:55:04.649545 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m13:55:04.649545 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:55:04.665451 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:55:04.665451 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m13:55:04.665451 [debug] [ThreadPool]: On list_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_raw"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'warehouse'
  
[0m13:55:04.665451 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m13:55:04.665451 [debug] [ThreadPool]: On list_warehouse_main_raw: ROLLBACK
[0m13:55:04.665451 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_raw'
[0m13:55:04.665451 [debug] [ThreadPool]: On list_warehouse_main_raw: Close
[0m13:55:04.665451 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_raw, now list_warehouse_main_staging)
[0m13:55:04.665451 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_staging"
[0m13:55:04.665451 [debug] [ThreadPool]: On list_warehouse_main_staging: BEGIN
[0m13:55:04.665451 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:55:04.665451 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:55:04.665451 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_staging"
[0m13:55:04.665451 [debug] [ThreadPool]: On list_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_staging"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'warehouse'
  
[0m13:55:04.682330 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m13:55:04.682330 [debug] [ThreadPool]: On list_warehouse_main_staging: ROLLBACK
[0m13:55:04.682330 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_staging'
[0m13:55:04.682330 [debug] [ThreadPool]: On list_warehouse_main_staging: Close
[0m13:55:04.682330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24622a0b-9202-4d36-98ef-a7712d885912', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001520B0DAEF0>]}
[0m13:55:04.682330 [debug] [MainThread]: Using duckdb connection "master"
[0m13:55:04.688818 [debug] [MainThread]: On master: BEGIN
[0m13:55:04.688818 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:55:04.689857 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:55:04.690824 [debug] [MainThread]: On master: COMMIT
[0m13:55:04.691823 [debug] [MainThread]: Using duckdb connection "master"
[0m13:55:04.691823 [debug] [MainThread]: On master: COMMIT
[0m13:55:04.692823 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:55:04.693823 [debug] [MainThread]: On master: Close
[0m13:55:04.695715 [debug] [Thread-1 (]: Began running node seed.case_project.raw_customers
[0m13:55:04.695715 [info ] [Thread-1 (]: 1 of 4 START seed file main_raw.raw_customers .................................. [RUN]
[0m13:55:04.695715 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.case_project.raw_customers'
[0m13:55:04.695715 [debug] [Thread-1 (]: Began compiling node seed.case_project.raw_customers
[0m13:55:04.695715 [debug] [Thread-1 (]: Began executing node seed.case_project.raw_customers
[0m13:55:04.737629 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_customers"
[0m13:55:04.737629 [debug] [Thread-1 (]: On seed.case_project.raw_customers: BEGIN
[0m13:55:04.737629 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:55:04.737629 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:55:04.737629 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_customers"
[0m13:55:04.737629 [debug] [Thread-1 (]: On seed.case_project.raw_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "seed.case_project.raw_customers"} */
truncate table "warehouse"."main_raw"."raw_customers"
[0m13:55:04.737629 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:55:04.753382 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_customers"
[0m13:55:04.753382 [debug] [Thread-1 (]: On seed.case_project.raw_customers: 
          COPY "warehouse"."main_raw"."raw_customers" FROM 'C:\Users\manss\Desktop\Case Project\seeds\raw_customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m13:55:04.769461 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m13:55:04.769461 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.case_project.raw_customers"
[0m13:55:04.796881 [debug] [Thread-1 (]: On seed.case_project.raw_customers: COMMIT
[0m13:55:04.797886 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_customers"
[0m13:55:04.798881 [debug] [Thread-1 (]: On seed.case_project.raw_customers: COMMIT
[0m13:55:04.801608 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:55:04.804638 [debug] [Thread-1 (]: On seed.case_project.raw_customers: Close
[0m13:55:04.806645 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24622a0b-9202-4d36-98ef-a7712d885912', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015207AB0160>]}
[0m13:55:04.807768 [info ] [Thread-1 (]: 1 of 4 OK loaded seed file main_raw.raw_customers .............................. [[32mINSERT 930[0m in 0.11s]
[0m13:55:04.808796 [debug] [Thread-1 (]: Finished running node seed.case_project.raw_customers
[0m13:55:04.809794 [debug] [Thread-1 (]: Began running node seed.case_project.raw_items
[0m13:55:04.810769 [info ] [Thread-1 (]: 2 of 4 START seed file main_raw.raw_items ...................................... [RUN]
[0m13:55:04.811769 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.case_project.raw_customers, now seed.case_project.raw_items)
[0m13:55:04.811769 [debug] [Thread-1 (]: Began compiling node seed.case_project.raw_items
[0m13:55:04.812794 [debug] [Thread-1 (]: Began executing node seed.case_project.raw_items
[0m13:55:05.399412 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_items"
[0m13:55:05.399412 [debug] [Thread-1 (]: On seed.case_project.raw_items: BEGIN
[0m13:55:05.399412 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:05.399412 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:55:05.399412 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_items"
[0m13:55:05.399412 [debug] [Thread-1 (]: On seed.case_project.raw_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "seed.case_project.raw_items"} */

    create table "warehouse"."main_raw"."raw_items" ("id" text,"order_id" text,"sku" text)
  
[0m13:55:05.399412 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:55:05.399412 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_items"
[0m13:55:05.399412 [debug] [Thread-1 (]: On seed.case_project.raw_items: 
          COPY "warehouse"."main_raw"."raw_items" FROM 'C:\Users\manss\Desktop\Case Project\seeds\raw_items.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m13:55:05.484339 [debug] [Thread-1 (]: SQL status: OK in 0.071 seconds
[0m13:55:05.485337 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.case_project.raw_items"
[0m13:55:05.498535 [debug] [Thread-1 (]: On seed.case_project.raw_items: COMMIT
[0m13:55:05.498535 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_items"
[0m13:55:05.499535 [debug] [Thread-1 (]: On seed.case_project.raw_items: COMMIT
[0m13:55:05.518635 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m13:55:05.519632 [debug] [Thread-1 (]: On seed.case_project.raw_items: Close
[0m13:55:05.520634 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24622a0b-9202-4d36-98ef-a7712d885912', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015208C059C0>]}
[0m13:55:05.522178 [info ] [Thread-1 (]: 2 of 4 OK loaded seed file main_raw.raw_items .................................. [[32mINSERT 90183[0m in 0.71s]
[0m13:55:05.523211 [debug] [Thread-1 (]: Finished running node seed.case_project.raw_items
[0m13:55:05.523211 [debug] [Thread-1 (]: Began running node seed.case_project.raw_orders
[0m13:55:05.524211 [info ] [Thread-1 (]: 3 of 4 START seed file main_raw.raw_orders ..................................... [RUN]
[0m13:55:05.525210 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.case_project.raw_items, now seed.case_project.raw_orders)
[0m13:55:05.526210 [debug] [Thread-1 (]: Began compiling node seed.case_project.raw_orders
[0m13:55:05.527211 [debug] [Thread-1 (]: Began executing node seed.case_project.raw_orders
[0m13:55:08.939875 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_orders"
[0m13:55:08.955958 [debug] [Thread-1 (]: On seed.case_project.raw_orders: BEGIN
[0m13:55:08.955958 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:08.955958 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:55:08.955958 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_orders"
[0m13:55:08.955958 [debug] [Thread-1 (]: On seed.case_project.raw_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "seed.case_project.raw_orders"} */
truncate table "warehouse"."main_raw"."raw_orders"
[0m13:55:08.955958 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:55:08.955958 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_orders"
[0m13:55:08.955958 [debug] [Thread-1 (]: On seed.case_project.raw_orders: 
          COPY "warehouse"."main_raw"."raw_orders" FROM 'C:\Users\manss\Desktop\Case Project\seeds\raw_orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m13:55:09.085629 [debug] [Thread-1 (]: SQL status: OK in 0.122 seconds
[0m13:55:09.086629 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.case_project.raw_orders"
[0m13:55:09.088762 [debug] [Thread-1 (]: On seed.case_project.raw_orders: COMMIT
[0m13:55:09.089759 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_orders"
[0m13:55:09.090762 [debug] [Thread-1 (]: On seed.case_project.raw_orders: COMMIT
[0m13:55:09.118479 [debug] [Thread-1 (]: SQL status: OK in 0.033 seconds
[0m13:55:09.118479 [debug] [Thread-1 (]: On seed.case_project.raw_orders: Close
[0m13:55:09.126122 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24622a0b-9202-4d36-98ef-a7712d885912', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015208C059C0>]}
[0m13:55:09.126122 [info ] [Thread-1 (]: 3 of 4 OK loaded seed file main_raw.raw_orders ................................. [[32mINSERT 63148[0m in 3.60s]
[0m13:55:09.126122 [debug] [Thread-1 (]: Finished running node seed.case_project.raw_orders
[0m13:55:09.126122 [debug] [Thread-1 (]: Began running node seed.case_project.raw_products
[0m13:55:09.129804 [info ] [Thread-1 (]: 4 of 4 START seed file main_raw.raw_products ................................... [RUN]
[0m13:55:09.129804 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.case_project.raw_orders, now seed.case_project.raw_products)
[0m13:55:09.129804 [debug] [Thread-1 (]: Began compiling node seed.case_project.raw_products
[0m13:55:09.132319 [debug] [Thread-1 (]: Began executing node seed.case_project.raw_products
[0m13:55:09.139480 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_products"
[0m13:55:09.140814 [debug] [Thread-1 (]: On seed.case_project.raw_products: BEGIN
[0m13:55:09.140814 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:09.140814 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:55:09.140814 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_products"
[0m13:55:09.140814 [debug] [Thread-1 (]: On seed.case_project.raw_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "seed.case_project.raw_products"} */
truncate table "warehouse"."main_raw"."raw_products"
[0m13:55:09.140814 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:55:09.147003 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_products"
[0m13:55:09.147003 [debug] [Thread-1 (]: On seed.case_project.raw_products: 
          COPY "warehouse"."main_raw"."raw_products" FROM 'C:\Users\manss\Desktop\Case Project\seeds\raw_products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m13:55:09.149721 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:55:09.150862 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.case_project.raw_products"
[0m13:55:09.153932 [debug] [Thread-1 (]: On seed.case_project.raw_products: COMMIT
[0m13:55:09.154377 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_products"
[0m13:55:09.154377 [debug] [Thread-1 (]: On seed.case_project.raw_products: COMMIT
[0m13:55:09.154377 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:55:09.154377 [debug] [Thread-1 (]: On seed.case_project.raw_products: Close
[0m13:55:09.154377 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24622a0b-9202-4d36-98ef-a7712d885912', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001520C979DB0>]}
[0m13:55:09.154377 [info ] [Thread-1 (]: 4 of 4 OK loaded seed file main_raw.raw_products ............................... [[32mINSERT 10[0m in 0.02s]
[0m13:55:09.160917 [debug] [Thread-1 (]: Finished running node seed.case_project.raw_products
[0m13:55:09.163163 [debug] [MainThread]: Using duckdb connection "master"
[0m13:55:09.163163 [debug] [MainThread]: On master: BEGIN
[0m13:55:09.164163 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:55:09.165164 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:55:09.165164 [debug] [MainThread]: On master: COMMIT
[0m13:55:09.166163 [debug] [MainThread]: Using duckdb connection "master"
[0m13:55:09.167161 [debug] [MainThread]: On master: COMMIT
[0m13:55:09.167895 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:55:09.167895 [debug] [MainThread]: On master: Close
[0m13:55:09.168594 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:55:09.169619 [debug] [MainThread]: Connection 'create_warehouse_main_raw' was properly closed.
[0m13:55:09.169619 [debug] [MainThread]: Connection 'list_warehouse_main_staging' was properly closed.
[0m13:55:09.170618 [debug] [MainThread]: Connection 'seed.case_project.raw_products' was properly closed.
[0m13:55:09.170618 [info ] [MainThread]: 
[0m13:55:09.171715 [info ] [MainThread]: Finished running 4 seeds in 0 hours 0 minutes and 4.81 seconds (4.81s).
[0m13:55:09.173721 [debug] [MainThread]: Command end result
[0m13:55:09.213765 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\manss\Desktop\Case Project\target\manifest.json
[0m13:55:09.217995 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\manss\Desktop\Case Project\target\semantic_manifest.json
[0m13:55:09.226996 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\manss\Desktop\Case Project\target\run_results.json
[0m13:55:09.226996 [info ] [MainThread]: 
[0m13:55:09.228022 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:55:09.228022 [info ] [MainThread]: 
[0m13:55:09.228022 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m13:55:09.228022 [debug] [MainThread]: Command `dbt seed` succeeded at 13:55:09.228022 after 6.87 seconds
[0m13:55:09.228022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015208D531F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001520A083250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152087580D0>]}
[0m13:55:09.232623 [debug] [MainThread]: Flushing usage events
[0m13:55:09.932784 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:55:15.219339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D6ADF3160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D6D0E3B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D6D0E3D60>]}


============================== 13:55:15.224369 | 12f2604b-fc4d-436f-bfbf-829c7edc3832 ==============================
[0m13:55:15.224369 [info ] [MainThread]: Running with dbt=1.10.9
[0m13:55:15.225339 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\manss\\Desktop\\Case Project\\logs', 'profiles_dir': 'C:\\Users\\manss\\Desktop\\Case Project', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True'}
[0m13:55:15.508454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12f2604b-fc4d-436f-bfbf-829c7edc3832', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D6D1D0A30>]}
[0m13:55:15.590728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '12f2604b-fc4d-436f-bfbf-829c7edc3832', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D6D09BF70>]}
[0m13:55:15.593880 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m13:55:15.942255 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m13:55:16.286663 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:55:16.286663 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:55:16.407860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12f2604b-fc4d-436f-bfbf-829c7edc3832', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D6E7DD9C0>]}
[0m13:55:16.664718 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\manss\Desktop\Case Project\target\manifest.json
[0m13:55:16.668649 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\manss\Desktop\Case Project\target\semantic_manifest.json
[0m13:55:16.699212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12f2604b-fc4d-436f-bfbf-829c7edc3832', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D6D177640>]}
[0m13:55:16.700210 [info ] [MainThread]: Found 4 seeds, 8 models, 24 data tests, 4 sources, 429 macros
[0m13:55:16.701212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12f2604b-fc4d-436f-bfbf-829c7edc3832', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D6AC2CA00>]}
[0m13:55:16.704209 [info ] [MainThread]: 
[0m13:55:16.705210 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:55:16.706213 [info ] [MainThread]: 
[0m13:55:16.707210 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:55:16.717129 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m13:55:16.950739 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m13:55:16.952403 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m13:55:16.952403 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:55:16.973229 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m13:55:16.973229 [debug] [ThreadPool]: On list_warehouse: Close
[0m13:55:16.973229 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m13:55:16.973229 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m13:55:16.973229 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:55:16.973229 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:55:16.988057 [debug] [ThreadPool]: On list_warehouse: Close
[0m13:55:16.988057 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_marts)
[0m13:55:16.988057 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_marts"
"
[0m13:55:17.001746 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m13:55:17.002748 [debug] [ThreadPool]: On create_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_marts"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m13:55:17.002748 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:55:17.004748 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:55:17.005749 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m13:55:17.006747 [debug] [ThreadPool]: On create_warehouse_main_marts: BEGIN
[0m13:55:17.007748 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:55:17.007748 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m13:55:17.009013 [debug] [ThreadPool]: On create_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_marts"} */

    
    
        create schema if not exists "warehouse"."main_marts"
    
[0m13:55:17.010012 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:55:17.011015 [debug] [ThreadPool]: On create_warehouse_main_marts: COMMIT
[0m13:55:17.012016 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m13:55:17.012016 [debug] [ThreadPool]: On create_warehouse_main_marts: COMMIT
[0m13:55:17.013015 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:55:17.014013 [debug] [ThreadPool]: On create_warehouse_main_marts: Close
[0m13:55:17.014875 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_warehouse_main_marts, now create_warehouse_main_staging)
[0m13:55:17.015981 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_staging"
"
[0m13:55:17.019007 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m13:55:17.020008 [debug] [ThreadPool]: On create_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m13:55:17.021007 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:55:17.022007 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:55:17.023981 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m13:55:17.023981 [debug] [ThreadPool]: On create_warehouse_main_staging: BEGIN
[0m13:55:17.025064 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:55:17.026062 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m13:55:17.026062 [debug] [ThreadPool]: On create_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_staging"} */

    
    
        create schema if not exists "warehouse"."main_staging"
    
[0m13:55:17.027062 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:55:17.028063 [debug] [ThreadPool]: On create_warehouse_main_staging: COMMIT
[0m13:55:17.029063 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m13:55:17.030059 [debug] [ThreadPool]: On create_warehouse_main_staging: COMMIT
[0m13:55:17.031090 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:55:17.032086 [debug] [ThreadPool]: On create_warehouse_main_staging: Close
[0m13:55:17.034058 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_marts'
[0m13:55:17.042062 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m13:55:17.042646 [debug] [ThreadPool]: On list_warehouse_main_marts: BEGIN
[0m13:55:17.043756 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:55:17.043756 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:55:17.044786 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m13:55:17.045751 [debug] [ThreadPool]: On list_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_marts"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'warehouse'
  
[0m13:55:17.049611 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m13:55:17.049611 [debug] [ThreadPool]: On list_warehouse_main_marts: ROLLBACK
[0m13:55:17.049611 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_marts'
[0m13:55:17.049611 [debug] [ThreadPool]: On list_warehouse_main_marts: Close
[0m13:55:17.049611 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_marts, now list_warehouse_main_staging)
[0m13:55:17.067857 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_staging"
[0m13:55:17.067857 [debug] [ThreadPool]: On list_warehouse_main_staging: BEGIN
[0m13:55:17.068857 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:55:17.069857 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:55:17.069857 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_staging"
[0m13:55:17.070858 [debug] [ThreadPool]: On list_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_staging"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'warehouse'
  
[0m13:55:17.070858 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m13:55:17.070858 [debug] [ThreadPool]: On list_warehouse_main_staging: ROLLBACK
[0m13:55:17.070858 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_staging'
[0m13:55:17.070858 [debug] [ThreadPool]: On list_warehouse_main_staging: Close
[0m13:55:17.078997 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_staging, now list_warehouse_main_raw)
[0m13:55:17.078997 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m13:55:17.078997 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m13:55:17.078997 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:55:17.078997 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:55:17.078997 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m13:55:17.078997 [debug] [ThreadPool]: On list_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_raw"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'warehouse'
  
[0m13:55:17.086564 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m13:55:17.086564 [debug] [ThreadPool]: On list_warehouse_main_raw: ROLLBACK
[0m13:55:17.086564 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_raw'
[0m13:55:17.086564 [debug] [ThreadPool]: On list_warehouse_main_raw: Close
[0m13:55:17.086564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12f2604b-fc4d-436f-bfbf-829c7edc3832', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D6E7F0940>]}
[0m13:55:17.086564 [debug] [MainThread]: Using duckdb connection "master"
[0m13:55:17.086564 [debug] [MainThread]: On master: BEGIN
[0m13:55:17.086564 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:55:17.086564 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:55:17.086564 [debug] [MainThread]: On master: COMMIT
[0m13:55:17.086564 [debug] [MainThread]: Using duckdb connection "master"
[0m13:55:17.086564 [debug] [MainThread]: On master: COMMIT
[0m13:55:17.086564 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:55:17.086564 [debug] [MainThread]: On master: Close
[0m13:55:17.102381 [debug] [Thread-1 (]: Began running node model.case_project.stg_customers
[0m13:55:17.102381 [info ] [Thread-1 (]: 1 of 8 START sql view model main_staging.stg_customers ......................... [RUN]
[0m13:55:17.102381 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.case_project.stg_customers'
[0m13:55:17.102381 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_customers
[0m13:55:17.102381 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_customers"
[0m13:55:17.118063 [debug] [Thread-1 (]: Began executing node model.case_project.stg_customers
[0m13:55:17.157301 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_customers"
[0m13:55:17.159301 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m13:55:17.160328 [debug] [Thread-1 (]: On model.case_project.stg_customers: BEGIN
[0m13:55:17.160750 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:55:17.160750 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:55:17.160750 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m13:55:17.160750 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */

  
  create view "warehouse"."main_staging"."stg_customers__dbt_tmp" as (
    -- models/staging/stg_customers.sql
with src as (
  select * from "warehouse"."main_raw"."raw_customers"
),
clean as (
  select
    cast(id as varchar) as customer_id,
    regexp_replace(name, '^(Mr\.|Mrs\.|Ms\.|Dr\.|MD)\s+', '') as clean_name
  from src
)
select
  customer_id,
  split_part(clean_name, ' ', 1) as first_name,
  split_part(clean_name, ' ', 2) as last_name
from clean
  );

[0m13:55:17.160750 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:55:17.160750 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m13:55:17.160750 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */
alter view "warehouse"."main_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m13:55:17.160750 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:55:17.178114 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m13:55:17.178114 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */
alter view "warehouse"."main_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m13:55:17.178114 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:55:17.195367 [debug] [Thread-1 (]: On model.case_project.stg_customers: COMMIT
[0m13:55:17.195698 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m13:55:17.196729 [debug] [Thread-1 (]: On model.case_project.stg_customers: COMMIT
[0m13:55:17.200143 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:55:17.208600 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m13:55:17.209396 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */

      drop view if exists "warehouse"."main_staging"."stg_customers__dbt_backup" cascade
    
[0m13:55:17.209396 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:55:17.209396 [debug] [Thread-1 (]: On model.case_project.stg_customers: Close
[0m13:55:17.209396 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12f2604b-fc4d-436f-bfbf-829c7edc3832', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D6EC2E1D0>]}
[0m13:55:17.209396 [info ] [Thread-1 (]: 1 of 8 OK created sql view model main_staging.stg_customers .................... [[32mOK[0m in 0.11s]
[0m13:55:17.209396 [debug] [Thread-1 (]: Finished running node model.case_project.stg_customers
[0m13:55:17.209396 [debug] [Thread-1 (]: Began running node model.case_project.stg_items
[0m13:55:17.209396 [info ] [Thread-1 (]: 2 of 8 START sql view model main_staging.stg_items ............................. [RUN]
[0m13:55:17.209396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_customers, now model.case_project.stg_items)
[0m13:55:17.209396 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_items
[0m13:55:17.227413 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_items"
[0m13:55:17.228380 [debug] [Thread-1 (]: Began executing node model.case_project.stg_items
[0m13:55:17.234379 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_items"
[0m13:55:17.235381 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m13:55:17.236380 [debug] [Thread-1 (]: On model.case_project.stg_items: BEGIN
[0m13:55:17.237383 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:17.238384 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:55:17.239381 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m13:55:17.239381 [debug] [Thread-1 (]: On model.case_project.stg_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_items"} */

  
  create view "warehouse"."main_staging"."stg_items__dbt_tmp" as (
    -- models/staging/stg_items.sql
with src as (
  select * from "warehouse"."main_raw"."raw_items"
)
select
  cast(id as varchar)        as item_id,
  cast(order_id as varchar)  as order_id,
  cast(sku as varchar)       as product_id,
  1                          as quantity
from src
  );

[0m13:55:17.240379 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:55:17.246379 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m13:55:17.247379 [debug] [Thread-1 (]: On model.case_project.stg_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_items"} */
alter view "warehouse"."main_staging"."stg_items__dbt_tmp" rename to "stg_items"
[0m13:55:17.248381 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:55:17.250379 [debug] [Thread-1 (]: On model.case_project.stg_items: COMMIT
[0m13:55:17.250379 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m13:55:17.251384 [debug] [Thread-1 (]: On model.case_project.stg_items: COMMIT
[0m13:55:17.253382 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:55:17.256379 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m13:55:17.257380 [debug] [Thread-1 (]: On model.case_project.stg_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_items"} */

      drop view if exists "warehouse"."main_staging"."stg_items__dbt_backup" cascade
    
[0m13:55:17.258384 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:55:17.260121 [debug] [Thread-1 (]: On model.case_project.stg_items: Close
[0m13:55:17.261147 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12f2604b-fc4d-436f-bfbf-829c7edc3832', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D6D1CCEE0>]}
[0m13:55:17.262147 [info ] [Thread-1 (]: 2 of 8 OK created sql view model main_staging.stg_items ........................ [[32mOK[0m in 0.05s]
[0m13:55:17.264147 [debug] [Thread-1 (]: Finished running node model.case_project.stg_items
[0m13:55:17.264147 [debug] [Thread-1 (]: Began running node model.case_project.stg_orders
[0m13:55:17.265147 [info ] [Thread-1 (]: 3 of 8 START sql view model main_staging.stg_orders ............................ [RUN]
[0m13:55:17.266493 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_items, now model.case_project.stg_orders)
[0m13:55:17.267500 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_orders
[0m13:55:17.271498 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_orders"
[0m13:55:17.272530 [debug] [Thread-1 (]: Began executing node model.case_project.stg_orders
[0m13:55:17.277499 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_orders"
[0m13:55:17.279500 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m13:55:17.279500 [debug] [Thread-1 (]: On model.case_project.stg_orders: BEGIN
[0m13:55:17.280499 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:17.281499 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:55:17.282498 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m13:55:17.282498 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */

  
  create view "warehouse"."main_staging"."stg_orders__dbt_tmp" as (
    with src as (
  select * from "warehouse"."main_raw"."raw_orders"
)
select
  cast(id as varchar)                 as order_id,
  cast(customer as varchar)           as customer_id,
  cast(store_id as varchar)           as store_id,
  cast(ordered_at as timestamp)       as ordered_at,
  cast(subtotal as double)            as subtotal,
  cast(tax_paid as double)            as tax_paid,
  cast(order_total as double)         as order_total
from src
  );

[0m13:55:17.283498 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:55:17.288497 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m13:55:17.288497 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */
alter view "warehouse"."main_staging"."stg_orders" rename to "stg_orders__dbt_backup"
[0m13:55:17.289498 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:55:17.293659 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m13:55:17.294655 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */
alter view "warehouse"."main_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m13:55:17.295656 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:55:17.298120 [debug] [Thread-1 (]: On model.case_project.stg_orders: COMMIT
[0m13:55:17.299118 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m13:55:17.299548 [debug] [Thread-1 (]: On model.case_project.stg_orders: COMMIT
[0m13:55:17.300347 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:55:17.300347 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m13:55:17.300347 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */

      drop view if exists "warehouse"."main_staging"."stg_orders__dbt_backup" cascade
    
[0m13:55:17.307216 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:55:17.309251 [debug] [Thread-1 (]: On model.case_project.stg_orders: Close
[0m13:55:17.309251 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12f2604b-fc4d-436f-bfbf-829c7edc3832', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D6AC722C0>]}
[0m13:55:17.310251 [info ] [Thread-1 (]: 3 of 8 OK created sql view model main_staging.stg_orders ....................... [[32mOK[0m in 0.04s]
[0m13:55:17.311251 [debug] [Thread-1 (]: Finished running node model.case_project.stg_orders
[0m13:55:17.312252 [debug] [Thread-1 (]: Began running node model.case_project.stg_products
[0m13:55:17.313691 [info ] [Thread-1 (]: 4 of 8 START sql view model main_staging.stg_products .......................... [RUN]
[0m13:55:17.314728 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_orders, now model.case_project.stg_products)
[0m13:55:17.314728 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_products
[0m13:55:17.319727 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_products"
[0m13:55:17.320727 [debug] [Thread-1 (]: Began executing node model.case_project.stg_products
[0m13:55:17.320727 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_products"
[0m13:55:17.320727 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m13:55:17.320727 [debug] [Thread-1 (]: On model.case_project.stg_products: BEGIN
[0m13:55:17.320727 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:17.320727 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:55:17.320727 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m13:55:17.320727 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */

  
  create view "warehouse"."main_staging"."stg_products__dbt_tmp" as (
    -- models/staging/stg_products.sql
with src as (select * from "warehouse"."main_raw"."raw_products")
select
  cast(sku as varchar)      as product_id,
  lower(trim(name))        as product_name,
  cast(price as double)    as price
from src
  );

[0m13:55:17.320727 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:55:17.320727 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m13:55:17.336466 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */
alter view "warehouse"."main_staging"."stg_products" rename to "stg_products__dbt_backup"
[0m13:55:17.337386 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:55:17.341972 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m13:55:17.341972 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */
alter view "warehouse"."main_staging"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:55:17.341972 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:55:17.341972 [debug] [Thread-1 (]: On model.case_project.stg_products: COMMIT
[0m13:55:17.341972 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m13:55:17.341972 [debug] [Thread-1 (]: On model.case_project.stg_products: COMMIT
[0m13:55:17.349370 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:55:17.351291 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m13:55:17.351291 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */

      drop view if exists "warehouse"."main_staging"."stg_products__dbt_backup" cascade
    
[0m13:55:17.355235 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:55:17.357441 [debug] [Thread-1 (]: On model.case_project.stg_products: Close
[0m13:55:17.358440 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12f2604b-fc4d-436f-bfbf-829c7edc3832', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D6AC722C0>]}
[0m13:55:17.359441 [info ] [Thread-1 (]: 4 of 8 OK created sql view model main_staging.stg_products ..................... [[32mOK[0m in 0.04s]
[0m13:55:17.360442 [debug] [Thread-1 (]: Finished running node model.case_project.stg_products
[0m13:55:17.361441 [debug] [Thread-1 (]: Began running node model.case_project.dim_customers
[0m13:55:17.362443 [info ] [Thread-1 (]: 5 of 8 START sql table model main_marts.dim_customers .......................... [RUN]
[0m13:55:17.363444 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_products, now model.case_project.dim_customers)
[0m13:55:17.363444 [debug] [Thread-1 (]: Began compiling node model.case_project.dim_customers
[0m13:55:17.368445 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.dim_customers"
[0m13:55:17.369222 [debug] [Thread-1 (]: Began executing node model.case_project.dim_customers
[0m13:55:17.397893 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.dim_customers"
[0m13:55:17.398894 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m13:55:17.399893 [debug] [Thread-1 (]: On model.case_project.dim_customers: BEGIN
[0m13:55:17.400895 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:17.401893 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:55:17.401893 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m13:55:17.402892 [debug] [Thread-1 (]: On model.case_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_customers"} */

  
    
    

    create  table
      "warehouse"."main_marts"."dim_customers__dbt_tmp"
  
    as (
      -- models/marts/dim_customers.sql


with base as (
    select
        customer_id,
        first_name,
        last_name,
        (first_name || ' ' || coalesce(last_name, '')) as customer_name
    from "warehouse"."main_staging"."stg_customers"
),

orders as (
    select
        customer_id,
        min(ordered_at) as first_order_at,
        max(ordered_at) as most_recent_order_at,
        count(*)        as order_count,
        sum(order_total) as lifetime_value
    from "warehouse"."main_staging"."stg_orders"
    group by 1
)

select
    b.customer_id,
    b.first_name,
    b.last_name,
    b.customer_name,
    o.first_order_at,
    o.most_recent_order_at,
    coalesce(o.order_count, 0)      as order_count,
    coalesce(o.lifetime_value, 0.0) as lifetime_value
from base b
left join orders o using (customer_id)
    );
  
  
[0m13:55:17.412246 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m13:55:17.418612 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m13:55:17.419612 [debug] [Thread-1 (]: On model.case_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_customers"} */
alter table "warehouse"."main_marts"."dim_customers" rename to "dim_customers__dbt_backup"
[0m13:55:17.420612 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:55:17.424610 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m13:55:17.425611 [debug] [Thread-1 (]: On model.case_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_customers"} */
alter table "warehouse"."main_marts"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m13:55:17.426612 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:55:17.431605 [debug] [Thread-1 (]: On model.case_project.dim_customers: COMMIT
[0m13:55:17.431605 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m13:55:17.431605 [debug] [Thread-1 (]: On model.case_project.dim_customers: COMMIT
[0m13:55:17.431605 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:55:17.431605 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m13:55:17.431605 [debug] [Thread-1 (]: On model.case_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_customers"} */

      drop table if exists "warehouse"."main_marts"."dim_customers__dbt_backup" cascade
    
[0m13:55:17.431605 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:55:17.431605 [debug] [Thread-1 (]: On model.case_project.dim_customers: Close
[0m13:55:17.431605 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12f2604b-fc4d-436f-bfbf-829c7edc3832', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D6ED96470>]}
[0m13:55:17.431605 [info ] [Thread-1 (]: 5 of 8 OK created sql table model main_marts.dim_customers ..................... [[32mOK[0m in 0.07s]
[0m13:55:17.446444 [debug] [Thread-1 (]: Finished running node model.case_project.dim_customers
[0m13:55:17.447582 [debug] [Thread-1 (]: Began running node model.case_project.fct_orders
[0m13:55:17.448583 [info ] [Thread-1 (]: 6 of 8 START sql table model main_marts.fct_orders ............................. [RUN]
[0m13:55:17.449446 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.dim_customers, now model.case_project.fct_orders)
[0m13:55:17.449446 [debug] [Thread-1 (]: Began compiling node model.case_project.fct_orders
[0m13:55:17.453482 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.fct_orders"
[0m13:55:17.454482 [debug] [Thread-1 (]: Began executing node model.case_project.fct_orders
[0m13:55:17.459483 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.fct_orders"
[0m13:55:17.460451 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m13:55:17.461482 [debug] [Thread-1 (]: On model.case_project.fct_orders: BEGIN
[0m13:55:17.461482 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:17.463456 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:55:17.463456 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m13:55:17.464457 [debug] [Thread-1 (]: On model.case_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_orders"} */

  
    
    

    create  table
      "warehouse"."main_marts"."fct_orders__dbt_tmp"
  
    as (
      -- models/marts/fct_orders.sql


select
    o.order_id,
    o.customer_id,
    o.store_id,
    o.ordered_at,
    cast(date_trunc('day', o.ordered_at) as date) as order_date,
    o.subtotal,
    o.tax_paid,
    o.order_total
from "warehouse"."main_staging"."stg_orders" o
    );
  
  
[0m13:55:17.496320 [debug] [Thread-1 (]: SQL status: OK in 0.032 seconds
[0m13:55:17.501319 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m13:55:17.502322 [debug] [Thread-1 (]: On model.case_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_orders"} */
alter table "warehouse"."main_marts"."fct_orders" rename to "fct_orders__dbt_backup"
[0m13:55:17.503321 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:55:17.507322 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m13:55:17.508323 [debug] [Thread-1 (]: On model.case_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_orders"} */
alter table "warehouse"."main_marts"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m13:55:17.509163 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:55:17.514098 [debug] [Thread-1 (]: On model.case_project.fct_orders: COMMIT
[0m13:55:17.514885 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m13:55:17.514885 [debug] [Thread-1 (]: On model.case_project.fct_orders: COMMIT
[0m13:55:17.533923 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m13:55:17.535682 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m13:55:17.535682 [debug] [Thread-1 (]: On model.case_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_orders"} */

      drop table if exists "warehouse"."main_marts"."fct_orders__dbt_backup" cascade
    
[0m13:55:17.535682 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:55:17.535682 [debug] [Thread-1 (]: On model.case_project.fct_orders: Close
[0m13:55:17.535682 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12f2604b-fc4d-436f-bfbf-829c7edc3832', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D6EDBD030>]}
[0m13:55:17.535682 [info ] [Thread-1 (]: 6 of 8 OK created sql table model main_marts.fct_orders ........................ [[32mOK[0m in 0.09s]
[0m13:55:17.535682 [debug] [Thread-1 (]: Finished running node model.case_project.fct_orders
[0m13:55:17.535682 [debug] [Thread-1 (]: Began running node model.case_project.dim_products
[0m13:55:17.535682 [info ] [Thread-1 (]: 7 of 8 START sql table model main_marts.dim_products ........................... [RUN]
[0m13:55:17.535682 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.fct_orders, now model.case_project.dim_products)
[0m13:55:17.535682 [debug] [Thread-1 (]: Began compiling node model.case_project.dim_products
[0m13:55:17.550963 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.dim_products"
[0m13:55:17.552757 [debug] [Thread-1 (]: Began executing node model.case_project.dim_products
[0m13:55:17.557201 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.dim_products"
[0m13:55:17.557201 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_products"
[0m13:55:17.557201 [debug] [Thread-1 (]: On model.case_project.dim_products: BEGIN
[0m13:55:17.557201 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:17.557201 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:55:17.557201 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_products"
[0m13:55:17.557201 [debug] [Thread-1 (]: On model.case_project.dim_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_products"} */

  
    
    

    create  table
      "warehouse"."main_marts"."dim_products__dbt_tmp"
  
    as (
      -- models/marts/dim_products.sql


select
    p.product_id,
    p.product_name,
    p.price as current_list_price
from "warehouse"."main_staging"."stg_products" p
    );
  
  
[0m13:55:17.564469 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:55:17.568464 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_products"
[0m13:55:17.568464 [debug] [Thread-1 (]: On model.case_project.dim_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_products"} */
alter table "warehouse"."main_marts"."dim_products" rename to "dim_products__dbt_backup"
[0m13:55:17.569434 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:55:17.573680 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_products"
[0m13:55:17.574679 [debug] [Thread-1 (]: On model.case_project.dim_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_products"} */
alter table "warehouse"."main_marts"."dim_products__dbt_tmp" rename to "dim_products"
[0m13:55:17.575650 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:55:17.577650 [debug] [Thread-1 (]: On model.case_project.dim_products: COMMIT
[0m13:55:17.578649 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_products"
[0m13:55:17.578649 [debug] [Thread-1 (]: On model.case_project.dim_products: COMMIT
[0m13:55:17.580550 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:55:17.584585 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_products"
[0m13:55:17.585557 [debug] [Thread-1 (]: On model.case_project.dim_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_products"} */

      drop table if exists "warehouse"."main_marts"."dim_products__dbt_backup" cascade
    
[0m13:55:17.586555 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:55:17.588646 [debug] [Thread-1 (]: On model.case_project.dim_products: Close
[0m13:55:17.589834 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12f2604b-fc4d-436f-bfbf-829c7edc3832', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D6EDC6FB0>]}
[0m13:55:17.590839 [info ] [Thread-1 (]: 7 of 8 OK created sql table model main_marts.dim_products ...................... [[32mOK[0m in 0.05s]
[0m13:55:17.591840 [debug] [Thread-1 (]: Finished running node model.case_project.dim_products
[0m13:55:17.592839 [debug] [Thread-1 (]: Began running node model.case_project.fct_order_items
[0m13:55:17.592839 [info ] [Thread-1 (]: 8 of 8 START sql table model main_marts.fct_order_items ........................ [RUN]
[0m13:55:17.593870 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.dim_products, now model.case_project.fct_order_items)
[0m13:55:17.594873 [debug] [Thread-1 (]: Began compiling node model.case_project.fct_order_items
[0m13:55:17.598841 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.fct_order_items"
[0m13:55:17.600840 [debug] [Thread-1 (]: Began executing node model.case_project.fct_order_items
[0m13:55:17.607840 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.fct_order_items"
[0m13:55:17.609839 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_order_items"
[0m13:55:17.609839 [debug] [Thread-1 (]: On model.case_project.fct_order_items: BEGIN
[0m13:55:17.610840 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:17.611839 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:55:17.612840 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_order_items"
[0m13:55:17.612840 [debug] [Thread-1 (]: On model.case_project.fct_order_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_order_items"} */

  
    
    

    create  table
      "warehouse"."main_marts"."fct_order_items__dbt_tmp"
  
    as (
      -- models/marts/fct_order_items.sql


with items as (
    select
        order_id,
        product_id,
        quantity,
        unit_price
    from "warehouse"."main_staging"."stg_items"
),
prod as (
    select
        product_id,
        product_name,
        price as current_list_price
    from "warehouse"."main_staging"."stg_products"
)

select
    i.order_id,
    i.product_id,
    p.product_name,
    i.quantity,
    i.unit_price,
    (i.quantity * i.unit_price) as line_revenue,
    p.current_list_price
from items i
left join prod p using (product_id)
    );
  
  
[0m13:55:17.615490 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_order_items"} */

  
    
    

    create  table
      "warehouse"."main_marts"."fct_order_items__dbt_tmp"
  
    as (
      -- models/marts/fct_order_items.sql


with items as (
    select
        order_id,
        product_id,
        quantity,
        unit_price
    from "warehouse"."main_staging"."stg_items"
),
prod as (
    select
        product_id,
        product_name,
        price as current_list_price
    from "warehouse"."main_staging"."stg_products"
)

select
    i.order_id,
    i.product_id,
    p.product_name,
    i.quantity,
    i.unit_price,
    (i.quantity * i.unit_price) as line_revenue,
    p.current_list_price
from items i
left join prod p using (product_id)
    );
  
  
[0m13:55:17.616496 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:55:17.616496 [debug] [Thread-1 (]: On model.case_project.fct_order_items: ROLLBACK
[0m13:55:17.624495 [debug] [Thread-1 (]: Failed to rollback 'model.case_project.fct_order_items'
[0m13:55:17.624495 [debug] [Thread-1 (]: On model.case_project.fct_order_items: Close
[0m13:55:17.627496 [debug] [Thread-1 (]: Runtime Error in model fct_order_items (models\marts\fct_order_items.sql)
  Binder Error: Referenced column "unit_price" not found in FROM clause!
  Candidate bindings: "item_id", "quantity", "product_id"
  
  LINE 19:         unit_price
                   ^
[0m13:55:17.628495 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12f2604b-fc4d-436f-bfbf-829c7edc3832', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D6ED166E0>]}
[0m13:55:17.629496 [error] [Thread-1 (]: 8 of 8 ERROR creating sql table model main_marts.fct_order_items ............... [[31mERROR[0m in 0.03s]
[0m13:55:17.630495 [debug] [Thread-1 (]: Finished running node model.case_project.fct_order_items
[0m13:55:17.631494 [debug] [Thread-4 (]: Marking all children of 'model.case_project.fct_order_items' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_order_items (models\marts\fct_order_items.sql)
  Binder Error: Referenced column "unit_price" not found in FROM clause!
  Candidate bindings: "item_id", "quantity", "product_id"
  
  LINE 19:         unit_price
                   ^.
[0m13:55:17.632495 [debug] [MainThread]: Using duckdb connection "master"
[0m13:55:17.633496 [debug] [MainThread]: On master: BEGIN
[0m13:55:17.634495 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:55:17.634495 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:55:17.635495 [debug] [MainThread]: On master: COMMIT
[0m13:55:17.636495 [debug] [MainThread]: Using duckdb connection "master"
[0m13:55:17.636495 [debug] [MainThread]: On master: COMMIT
[0m13:55:17.637494 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:55:17.637494 [debug] [MainThread]: On master: Close
[0m13:55:17.638495 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:55:17.639493 [debug] [MainThread]: Connection 'create_warehouse_main_staging' was properly closed.
[0m13:55:17.639983 [debug] [MainThread]: Connection 'list_warehouse_main_raw' was properly closed.
[0m13:55:17.640606 [debug] [MainThread]: Connection 'model.case_project.fct_order_items' was properly closed.
[0m13:55:17.640606 [info ] [MainThread]: 
[0m13:55:17.641658 [info ] [MainThread]: Finished running 4 table models, 4 view models in 0 hours 0 minutes and 0.93 seconds (0.93s).
[0m13:55:17.644656 [debug] [MainThread]: Command end result
[0m13:55:17.681527 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\manss\Desktop\Case Project\target\manifest.json
[0m13:55:17.686179 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\manss\Desktop\Case Project\target\semantic_manifest.json
[0m13:55:17.695417 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\manss\Desktop\Case Project\target\run_results.json
[0m13:55:17.696424 [info ] [MainThread]: 
[0m13:55:17.696424 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:55:17.697453 [info ] [MainThread]: 
[0m13:55:17.698423 [error] [MainThread]: [31mFailure in model fct_order_items (models\marts\fct_order_items.sql)[0m
[0m13:55:17.699423 [error] [MainThread]:   Runtime Error in model fct_order_items (models\marts\fct_order_items.sql)
  Binder Error: Referenced column "unit_price" not found in FROM clause!
  Candidate bindings: "item_id", "quantity", "product_id"
  
  LINE 19:         unit_price
                   ^
[0m13:55:17.700423 [info ] [MainThread]: 
[0m13:55:17.700423 [info ] [MainThread]:   compiled code at target\compiled\case_project\models\marts\fct_order_items.sql
[0m13:55:17.701423 [info ] [MainThread]: 
[0m13:55:17.702306 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=8
[0m13:55:17.703386 [debug] [MainThread]: Command `dbt run` failed at 13:55:17.703386 after 2.58 seconds
[0m13:55:17.704387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D6ADF3160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D6D7292D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D6E7DD720>]}
[0m13:55:17.705386 [debug] [MainThread]: Flushing usage events
[0m13:55:18.459858 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:56:54.134251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF809131C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF82D13D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF82D13F40>]}


============================== 13:56:54.134251 | 8f645183-c104-449d-8399-af6f0234e888 ==============================
[0m13:56:54.134251 [info ] [MainThread]: Running with dbt=1.10.9
[0m13:56:54.134251 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\manss\\Desktop\\Case Project', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt seed', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\manss\\Desktop\\Case Project\\logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m13:56:54.433770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f645183-c104-449d-8399-af6f0234e888', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF82C56A70>]}
[0m13:56:54.499289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8f645183-c104-449d-8399-af6f0234e888', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF82D11FF0>]}
[0m13:56:54.514122 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m13:56:54.855084 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m13:56:55.180949 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:56:55.182074 [debug] [MainThread]: Partial parsing: updated file: case_project://models\marts\fct_order_items.sql
[0m13:56:55.547657 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m13:56:55.548628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8f645183-c104-449d-8399-af6f0234e888', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF8451CF70>]}
[0m13:56:55.815989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f645183-c104-449d-8399-af6f0234e888', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF84684070>]}
[0m13:56:56.009266 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\manss\Desktop\Case Project\target\manifest.json
[0m13:56:56.009266 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\manss\Desktop\Case Project\target\semantic_manifest.json
[0m13:56:56.045077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f645183-c104-449d-8399-af6f0234e888', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF84623430>]}
[0m13:56:56.045077 [info ] [MainThread]: Found 4 seeds, 8 models, 24 data tests, 4 sources, 429 macros
[0m13:56:56.046097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f645183-c104-449d-8399-af6f0234e888', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF833628C0>]}
[0m13:56:56.049104 [info ] [MainThread]: 
[0m13:56:56.050074 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:56:56.051075 [info ] [MainThread]: 
[0m13:56:56.052074 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:56:56.060603 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m13:56:56.259515 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m13:56:56.259515 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m13:56:56.259515 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:56:56.292445 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m13:56:56.294411 [debug] [ThreadPool]: On list_warehouse: Close
[0m13:56:56.295198 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_raw)
[0m13:56:56.295198 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_raw"
"
[0m13:56:56.304234 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_raw"
[0m13:56:56.304234 [debug] [ThreadPool]: On create_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_raw"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m13:56:56.305234 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:56:56.306234 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:56:56.306234 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_raw"
[0m13:56:56.306234 [debug] [ThreadPool]: On create_warehouse_main_raw: BEGIN
[0m13:56:56.306234 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:56:56.306234 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_raw"
[0m13:56:56.306234 [debug] [ThreadPool]: On create_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_raw"} */

    
    
        create schema if not exists "warehouse"."main_raw"
    
[0m13:56:56.306234 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:56:56.306234 [debug] [ThreadPool]: On create_warehouse_main_raw: COMMIT
[0m13:56:56.306234 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_raw"
[0m13:56:56.306234 [debug] [ThreadPool]: On create_warehouse_main_raw: COMMIT
[0m13:56:56.306234 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:56:56.306234 [debug] [ThreadPool]: On create_warehouse_main_raw: Close
[0m13:56:56.306234 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_raw'
[0m13:56:56.322178 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m13:56:56.322178 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m13:56:56.322178 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:56:56.322178 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:56:56.322178 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m13:56:56.322178 [debug] [ThreadPool]: On list_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_raw"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'warehouse'
  
[0m13:56:56.338065 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m13:56:56.338065 [debug] [ThreadPool]: On list_warehouse_main_raw: ROLLBACK
[0m13:56:56.338065 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_raw'
[0m13:56:56.338065 [debug] [ThreadPool]: On list_warehouse_main_raw: Close
[0m13:56:56.338065 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_raw, now list_warehouse_main_staging)
[0m13:56:56.338065 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_staging"
[0m13:56:56.338065 [debug] [ThreadPool]: On list_warehouse_main_staging: BEGIN
[0m13:56:56.338065 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:56:56.338065 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:56:56.338065 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_staging"
[0m13:56:56.338065 [debug] [ThreadPool]: On list_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_staging"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'warehouse'
  
[0m13:56:56.353742 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m13:56:56.353742 [debug] [ThreadPool]: On list_warehouse_main_staging: ROLLBACK
[0m13:56:56.353742 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_staging'
[0m13:56:56.353742 [debug] [ThreadPool]: On list_warehouse_main_staging: Close
[0m13:56:56.353742 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_staging, now list_warehouse_main_marts)
[0m13:56:56.353742 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m13:56:56.353742 [debug] [ThreadPool]: On list_warehouse_main_marts: BEGIN
[0m13:56:56.353742 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:56:56.353742 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:56:56.353742 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m13:56:56.353742 [debug] [ThreadPool]: On list_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_marts"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'warehouse'
  
[0m13:56:56.369661 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m13:56:56.371366 [debug] [ThreadPool]: On list_warehouse_main_marts: ROLLBACK
[0m13:56:56.371366 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_marts'
[0m13:56:56.372366 [debug] [ThreadPool]: On list_warehouse_main_marts: Close
[0m13:56:56.374311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f645183-c104-449d-8399-af6f0234e888', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF82DB2EF0>]}
[0m13:56:56.374311 [debug] [MainThread]: Using duckdb connection "master"
[0m13:56:56.375414 [debug] [MainThread]: On master: BEGIN
[0m13:56:56.375414 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:56:56.376415 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:56:56.377414 [debug] [MainThread]: On master: COMMIT
[0m13:56:56.378384 [debug] [MainThread]: Using duckdb connection "master"
[0m13:56:56.378384 [debug] [MainThread]: On master: COMMIT
[0m13:56:56.379384 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:56:56.380384 [debug] [MainThread]: On master: Close
[0m13:56:56.381256 [debug] [Thread-1 (]: Began running node seed.case_project.raw_customers
[0m13:56:56.381256 [info ] [Thread-1 (]: 1 of 4 START seed file main_raw.raw_customers .................................. [RUN]
[0m13:56:56.381256 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.case_project.raw_customers'
[0m13:56:56.381256 [debug] [Thread-1 (]: Began compiling node seed.case_project.raw_customers
[0m13:56:56.381256 [debug] [Thread-1 (]: Began executing node seed.case_project.raw_customers
[0m13:56:56.427869 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_customers"
[0m13:56:56.427869 [debug] [Thread-1 (]: On seed.case_project.raw_customers: BEGIN
[0m13:56:56.428871 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:56:56.429870 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:56:56.430870 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_customers"
[0m13:56:56.430870 [debug] [Thread-1 (]: On seed.case_project.raw_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "seed.case_project.raw_customers"} */
truncate table "warehouse"."main_raw"."raw_customers"
[0m13:56:56.432997 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:56:56.446027 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_customers"
[0m13:56:56.447158 [debug] [Thread-1 (]: On seed.case_project.raw_customers: 
          COPY "warehouse"."main_raw"."raw_customers" FROM 'C:\Users\manss\Desktop\Case Project\seeds\raw_customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m13:56:56.455158 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m13:56:56.462157 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.case_project.raw_customers"
[0m13:56:56.462157 [debug] [Thread-1 (]: On seed.case_project.raw_customers: COMMIT
[0m13:56:56.462157 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_customers"
[0m13:56:56.462157 [debug] [Thread-1 (]: On seed.case_project.raw_customers: COMMIT
[0m13:56:56.481683 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:56:56.483682 [debug] [Thread-1 (]: On seed.case_project.raw_customers: Close
[0m13:56:56.486682 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f645183-c104-449d-8399-af6f0234e888', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF84AC6F80>]}
[0m13:56:56.487681 [info ] [Thread-1 (]: 1 of 4 OK loaded seed file main_raw.raw_customers .............................. [[32mINSERT 930[0m in 0.10s]
[0m13:56:56.488652 [debug] [Thread-1 (]: Finished running node seed.case_project.raw_customers
[0m13:56:56.489687 [debug] [Thread-1 (]: Began running node seed.case_project.raw_items
[0m13:56:56.489687 [info ] [Thread-1 (]: 2 of 4 START seed file main_raw.raw_items ...................................... [RUN]
[0m13:56:56.490682 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.case_project.raw_customers, now seed.case_project.raw_items)
[0m13:56:56.491681 [debug] [Thread-1 (]: Began compiling node seed.case_project.raw_items
[0m13:56:56.492690 [debug] [Thread-1 (]: Began executing node seed.case_project.raw_items
[0m13:56:57.080129 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_items"
[0m13:56:57.080129 [debug] [Thread-1 (]: On seed.case_project.raw_items: BEGIN
[0m13:56:57.081112 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:56:57.082101 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:56:57.083129 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_items"
[0m13:56:57.084098 [debug] [Thread-1 (]: On seed.case_project.raw_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "seed.case_project.raw_items"} */
truncate table "warehouse"."main_raw"."raw_items"
[0m13:56:57.085132 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:56:57.087131 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_items"
[0m13:56:57.087131 [debug] [Thread-1 (]: On seed.case_project.raw_items: 
          COPY "warehouse"."main_raw"."raw_items" FROM 'C:\Users\manss\Desktop\Case Project\seeds\raw_items.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m13:56:57.161848 [debug] [Thread-1 (]: SQL status: OK in 0.074 seconds
[0m13:56:57.163849 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.case_project.raw_items"
[0m13:56:57.166705 [debug] [Thread-1 (]: On seed.case_project.raw_items: COMMIT
[0m13:56:57.167548 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_items"
[0m13:56:57.168630 [debug] [Thread-1 (]: On seed.case_project.raw_items: COMMIT
[0m13:56:57.200897 [debug] [Thread-1 (]: SQL status: OK in 0.036 seconds
[0m13:56:57.200897 [debug] [Thread-1 (]: On seed.case_project.raw_items: Close
[0m13:56:57.207534 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f645183-c104-449d-8399-af6f0234e888', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF84620370>]}
[0m13:56:57.207838 [info ] [Thread-1 (]: 2 of 4 OK loaded seed file main_raw.raw_items .................................. [[32mINSERT 90183[0m in 0.71s]
[0m13:56:57.207838 [debug] [Thread-1 (]: Finished running node seed.case_project.raw_items
[0m13:56:57.207838 [debug] [Thread-1 (]: Began running node seed.case_project.raw_orders
[0m13:56:57.207838 [info ] [Thread-1 (]: 3 of 4 START seed file main_raw.raw_orders ..................................... [RUN]
[0m13:56:57.207838 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.case_project.raw_items, now seed.case_project.raw_orders)
[0m13:56:57.207838 [debug] [Thread-1 (]: Began compiling node seed.case_project.raw_orders
[0m13:56:57.207838 [debug] [Thread-1 (]: Began executing node seed.case_project.raw_orders
[0m13:57:00.656836 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_orders"
[0m13:57:00.657837 [debug] [Thread-1 (]: On seed.case_project.raw_orders: BEGIN
[0m13:57:00.657837 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:57:00.658865 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:57:00.659867 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_orders"
[0m13:57:00.659867 [debug] [Thread-1 (]: On seed.case_project.raw_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "seed.case_project.raw_orders"} */
truncate table "warehouse"."main_raw"."raw_orders"
[0m13:57:00.661864 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:57:00.662834 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_orders"
[0m13:57:00.663864 [debug] [Thread-1 (]: On seed.case_project.raw_orders: 
          COPY "warehouse"."main_raw"."raw_orders" FROM 'C:\Users\manss\Desktop\Case Project\seeds\raw_orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m13:57:00.776507 [debug] [Thread-1 (]: SQL status: OK in 0.119 seconds
[0m13:57:00.776507 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.case_project.raw_orders"
[0m13:57:00.776507 [debug] [Thread-1 (]: On seed.case_project.raw_orders: COMMIT
[0m13:57:00.788043 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_orders"
[0m13:57:00.788043 [debug] [Thread-1 (]: On seed.case_project.raw_orders: COMMIT
[0m13:57:00.821899 [debug] [Thread-1 (]: SQL status: OK in 0.033 seconds
[0m13:57:00.821899 [debug] [Thread-1 (]: On seed.case_project.raw_orders: Close
[0m13:57:00.821899 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f645183-c104-449d-8399-af6f0234e888', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF84625CC0>]}
[0m13:57:00.821899 [info ] [Thread-1 (]: 3 of 4 OK loaded seed file main_raw.raw_orders ................................. [[32mINSERT 63148[0m in 3.61s]
[0m13:57:00.821899 [debug] [Thread-1 (]: Finished running node seed.case_project.raw_orders
[0m13:57:00.821899 [debug] [Thread-1 (]: Began running node seed.case_project.raw_products
[0m13:57:00.821899 [info ] [Thread-1 (]: 4 of 4 START seed file main_raw.raw_products ................................... [RUN]
[0m13:57:00.821899 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.case_project.raw_orders, now seed.case_project.raw_products)
[0m13:57:00.821899 [debug] [Thread-1 (]: Began compiling node seed.case_project.raw_products
[0m13:57:00.821899 [debug] [Thread-1 (]: Began executing node seed.case_project.raw_products
[0m13:57:00.840200 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_products"
[0m13:57:00.840837 [debug] [Thread-1 (]: On seed.case_project.raw_products: BEGIN
[0m13:57:00.841865 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:57:00.842494 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:57:00.843674 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_products"
[0m13:57:00.843674 [debug] [Thread-1 (]: On seed.case_project.raw_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "seed.case_project.raw_products"} */
truncate table "warehouse"."main_raw"."raw_products"
[0m13:57:00.844757 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:57:00.847372 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_products"
[0m13:57:00.848372 [debug] [Thread-1 (]: On seed.case_project.raw_products: 
          COPY "warehouse"."main_raw"."raw_products" FROM 'C:\Users\manss\Desktop\Case Project\seeds\raw_products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m13:57:00.850347 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:57:00.850347 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.case_project.raw_products"
[0m13:57:00.854292 [debug] [Thread-1 (]: On seed.case_project.raw_products: COMMIT
[0m13:57:00.854292 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_products"
[0m13:57:00.854292 [debug] [Thread-1 (]: On seed.case_project.raw_products: COMMIT
[0m13:57:01.042300 [debug] [Thread-1 (]: SQL status: OK in 0.188 seconds
[0m13:57:01.047042 [debug] [Thread-1 (]: On seed.case_project.raw_products: Close
[0m13:57:01.047042 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f645183-c104-449d-8399-af6f0234e888', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF82C9D180>]}
[0m13:57:01.047042 [info ] [Thread-1 (]: 4 of 4 OK loaded seed file main_raw.raw_products ............................... [[32mINSERT 10[0m in 0.23s]
[0m13:57:01.047042 [debug] [Thread-1 (]: Finished running node seed.case_project.raw_products
[0m13:57:01.047042 [debug] [MainThread]: Using duckdb connection "master"
[0m13:57:01.047042 [debug] [MainThread]: On master: BEGIN
[0m13:57:01.047042 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:57:01.053027 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:57:01.053027 [debug] [MainThread]: On master: COMMIT
[0m13:57:01.053027 [debug] [MainThread]: Using duckdb connection "master"
[0m13:57:01.055032 [debug] [MainThread]: On master: COMMIT
[0m13:57:01.055032 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:57:01.055032 [debug] [MainThread]: On master: Close
[0m13:57:01.057037 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:57:01.057037 [debug] [MainThread]: Connection 'create_warehouse_main_raw' was properly closed.
[0m13:57:01.058041 [debug] [MainThread]: Connection 'list_warehouse_main_marts' was properly closed.
[0m13:57:01.058744 [debug] [MainThread]: Connection 'seed.case_project.raw_products' was properly closed.
[0m13:57:01.058744 [info ] [MainThread]: 
[0m13:57:01.060104 [info ] [MainThread]: Finished running 4 seeds in 0 hours 0 minutes and 5.01 seconds (5.01s).
[0m13:57:01.062540 [debug] [MainThread]: Command end result
[0m13:57:01.099262 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\manss\Desktop\Case Project\target\manifest.json
[0m13:57:01.103096 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\manss\Desktop\Case Project\target\semantic_manifest.json
[0m13:57:01.111604 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\manss\Desktop\Case Project\target\run_results.json
[0m13:57:01.112608 [info ] [MainThread]: 
[0m13:57:01.113214 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:57:01.114220 [info ] [MainThread]: 
[0m13:57:01.114220 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m13:57:01.116219 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 4 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:57:01.117219 [debug] [MainThread]: Command `dbt seed` succeeded at 13:57:01.117219 after 7.07 seconds
[0m13:57:01.117219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF809131C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF82C9D180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF82D11FF0>]}
[0m13:57:01.118220 [debug] [MainThread]: Flushing usage events
[0m13:57:01.806269 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:57:10.135116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019309603190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001930B8F3BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001930B8F3D90>]}


============================== 13:57:10.145325 | d7497cea-2a51-4d8e-a622-f1d24ed1ed99 ==============================
[0m13:57:10.145325 [info ] [MainThread]: Running with dbt=1.10.9
[0m13:57:10.145325 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'log_path': 'C:\\Users\\manss\\Desktop\\Case Project\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\manss\\Desktop\\Case Project', 'static_parser': 'True', 'write_json': 'True'}
[0m13:57:10.431135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd7497cea-2a51-4d8e-a622-f1d24ed1ed99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001930B056B90>]}
[0m13:57:10.509476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd7497cea-2a51-4d8e-a622-f1d24ed1ed99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001930B0B9330>]}
[0m13:57:10.509476 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m13:57:10.861726 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m13:57:11.189351 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:57:11.190348 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:57:11.296204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd7497cea-2a51-4d8e-a622-f1d24ed1ed99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001930CFED9F0>]}
[0m13:57:11.515380 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\manss\Desktop\Case Project\target\manifest.json
[0m13:57:11.519020 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\manss\Desktop\Case Project\target\semantic_manifest.json
[0m13:57:11.552188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd7497cea-2a51-4d8e-a622-f1d24ed1ed99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001930B9DEAA0>]}
[0m13:57:11.553178 [info ] [MainThread]: Found 4 seeds, 8 models, 24 data tests, 4 sources, 429 macros
[0m13:57:11.554148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7497cea-2a51-4d8e-a622-f1d24ed1ed99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001930CFFC250>]}
[0m13:57:11.556179 [info ] [MainThread]: 
[0m13:57:11.556179 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:57:11.556179 [info ] [MainThread]: 
[0m13:57:11.559811 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:57:11.569456 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m13:57:11.773823 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m13:57:11.774824 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m13:57:11.774824 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:57:11.798091 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m13:57:11.800095 [debug] [ThreadPool]: On list_warehouse: Close
[0m13:57:11.803093 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m13:57:11.804091 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m13:57:11.805091 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:57:11.806089 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:57:11.807060 [debug] [ThreadPool]: On list_warehouse: Close
[0m13:57:11.808091 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_marts)
[0m13:57:11.809091 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_marts"
"
[0m13:57:11.817091 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m13:57:11.818088 [debug] [ThreadPool]: On create_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_marts"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m13:57:11.818088 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:57:11.819091 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:57:11.821091 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m13:57:11.821091 [debug] [ThreadPool]: On create_warehouse_main_marts: BEGIN
[0m13:57:11.821091 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:57:11.821091 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m13:57:11.821091 [debug] [ThreadPool]: On create_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_marts"} */

    
    
        create schema if not exists "warehouse"."main_marts"
    
[0m13:57:11.821091 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:57:11.821091 [debug] [ThreadPool]: On create_warehouse_main_marts: COMMIT
[0m13:57:11.821091 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m13:57:11.821091 [debug] [ThreadPool]: On create_warehouse_main_marts: COMMIT
[0m13:57:11.821091 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:57:11.821091 [debug] [ThreadPool]: On create_warehouse_main_marts: Close
[0m13:57:11.821091 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_warehouse_main_marts, now create_warehouse_main_staging)
[0m13:57:11.821091 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_staging"
"
[0m13:57:11.821091 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m13:57:11.821091 [debug] [ThreadPool]: On create_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m13:57:11.821091 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:57:11.821091 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:57:11.821091 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m13:57:11.836934 [debug] [ThreadPool]: On create_warehouse_main_staging: BEGIN
[0m13:57:11.836934 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:57:11.836934 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m13:57:11.836934 [debug] [ThreadPool]: On create_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_staging"} */

    
    
        create schema if not exists "warehouse"."main_staging"
    
[0m13:57:11.836934 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:57:11.836934 [debug] [ThreadPool]: On create_warehouse_main_staging: COMMIT
[0m13:57:11.836934 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m13:57:11.836934 [debug] [ThreadPool]: On create_warehouse_main_staging: COMMIT
[0m13:57:11.836934 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:57:11.836934 [debug] [ThreadPool]: On create_warehouse_main_staging: Close
[0m13:57:11.836934 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_marts'
[0m13:57:11.852621 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m13:57:11.852621 [debug] [ThreadPool]: On list_warehouse_main_marts: BEGIN
[0m13:57:11.852621 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:57:11.852621 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:57:11.852621 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m13:57:11.852621 [debug] [ThreadPool]: On list_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_marts"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'warehouse'
  
[0m13:57:11.869091 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m13:57:11.870376 [debug] [ThreadPool]: On list_warehouse_main_marts: ROLLBACK
[0m13:57:11.872382 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_marts'
[0m13:57:11.872382 [debug] [ThreadPool]: On list_warehouse_main_marts: Close
[0m13:57:11.873382 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_marts, now list_warehouse_main_raw)
[0m13:57:11.877104 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m13:57:11.878073 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m13:57:11.878073 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:57:11.879105 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:57:11.879105 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m13:57:11.880104 [debug] [ThreadPool]: On list_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_raw"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'warehouse'
  
[0m13:57:11.880982 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m13:57:11.880982 [debug] [ThreadPool]: On list_warehouse_main_raw: ROLLBACK
[0m13:57:11.880982 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_raw'
[0m13:57:11.880982 [debug] [ThreadPool]: On list_warehouse_main_raw: Close
[0m13:57:11.880982 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_raw, now list_warehouse_main_staging)
[0m13:57:11.880982 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_staging"
[0m13:57:11.880982 [debug] [ThreadPool]: On list_warehouse_main_staging: BEGIN
[0m13:57:11.880982 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:57:11.880982 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:57:11.880982 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_staging"
[0m13:57:11.880982 [debug] [ThreadPool]: On list_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_staging"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'warehouse'
  
[0m13:57:11.896055 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m13:57:11.896055 [debug] [ThreadPool]: On list_warehouse_main_staging: ROLLBACK
[0m13:57:11.896055 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_staging'
[0m13:57:11.896055 [debug] [ThreadPool]: On list_warehouse_main_staging: Close
[0m13:57:11.896055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7497cea-2a51-4d8e-a622-f1d24ed1ed99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019308469240>]}
[0m13:57:11.896055 [debug] [MainThread]: Using duckdb connection "master"
[0m13:57:11.896055 [debug] [MainThread]: On master: BEGIN
[0m13:57:11.896055 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:57:11.896055 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:57:11.896055 [debug] [MainThread]: On master: COMMIT
[0m13:57:11.896055 [debug] [MainThread]: Using duckdb connection "master"
[0m13:57:11.896055 [debug] [MainThread]: On master: COMMIT
[0m13:57:11.896055 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:57:11.896055 [debug] [MainThread]: On master: Close
[0m13:57:11.911779 [debug] [Thread-1 (]: Began running node model.case_project.stg_customers
[0m13:57:11.911779 [info ] [Thread-1 (]: 1 of 8 START sql view model main_staging.stg_customers ......................... [RUN]
[0m13:57:11.911779 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.case_project.stg_customers'
[0m13:57:11.911779 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_customers
[0m13:57:11.911779 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_customers"
[0m13:57:11.911779 [debug] [Thread-1 (]: Began executing node model.case_project.stg_customers
[0m13:57:11.964517 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_customers"
[0m13:57:11.964517 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m13:57:11.964517 [debug] [Thread-1 (]: On model.case_project.stg_customers: BEGIN
[0m13:57:11.964517 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:57:11.964517 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:57:11.964517 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m13:57:11.964517 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */

  
  create view "warehouse"."main_staging"."stg_customers__dbt_tmp" as (
    -- models/staging/stg_customers.sql
with src as (
  select * from "warehouse"."main_raw"."raw_customers"
),
clean as (
  select
    cast(id as varchar) as customer_id,
    regexp_replace(name, '^(Mr\.|Mrs\.|Ms\.|Dr\.|MD)\s+', '') as clean_name
  from src
)
select
  customer_id,
  split_part(clean_name, ' ', 1) as first_name,
  split_part(clean_name, ' ', 2) as last_name
from clean
  );

[0m13:57:11.971303 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:57:11.979333 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m13:57:11.979333 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */
alter view "warehouse"."main_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m13:57:11.980303 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:57:11.984333 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m13:57:11.985332 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */
alter view "warehouse"."main_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m13:57:11.986304 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:57:12.000480 [debug] [Thread-1 (]: On model.case_project.stg_customers: COMMIT
[0m13:57:12.001480 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m13:57:12.002480 [debug] [Thread-1 (]: On model.case_project.stg_customers: COMMIT
[0m13:57:12.006441 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:57:12.008440 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m13:57:12.008440 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */

      drop view if exists "warehouse"."main_staging"."stg_customers__dbt_backup" cascade
    
[0m13:57:12.008440 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:57:12.018348 [debug] [Thread-1 (]: On model.case_project.stg_customers: Close
[0m13:57:12.022358 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7497cea-2a51-4d8e-a622-f1d24ed1ed99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019308360520>]}
[0m13:57:12.022358 [info ] [Thread-1 (]: 1 of 8 OK created sql view model main_staging.stg_customers .................... [[32mOK[0m in 0.11s]
[0m13:57:12.024104 [debug] [Thread-1 (]: Finished running node model.case_project.stg_customers
[0m13:57:12.024104 [debug] [Thread-1 (]: Began running node model.case_project.stg_items
[0m13:57:12.024104 [info ] [Thread-1 (]: 2 of 8 START sql view model main_staging.stg_items ............................. [RUN]
[0m13:57:12.024104 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_customers, now model.case_project.stg_items)
[0m13:57:12.024104 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_items
[0m13:57:12.024104 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_items"
[0m13:57:12.024104 [debug] [Thread-1 (]: Began executing node model.case_project.stg_items
[0m13:57:12.024104 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_items"
[0m13:57:12.024104 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m13:57:12.024104 [debug] [Thread-1 (]: On model.case_project.stg_items: BEGIN
[0m13:57:12.040187 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:57:12.040977 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:57:12.041757 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m13:57:12.042439 [debug] [Thread-1 (]: On model.case_project.stg_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_items"} */

  
  create view "warehouse"."main_staging"."stg_items__dbt_tmp" as (
    -- models/staging/stg_items.sql
with src as (
  select * from "warehouse"."main_raw"."raw_items"
)
select
  cast(id as varchar)        as item_id,
  cast(order_id as varchar)  as order_id,
  cast(sku as varchar)       as product_id,
  1                          as quantity
from src
  );

[0m13:57:12.043524 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:57:12.048653 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m13:57:12.049654 [debug] [Thread-1 (]: On model.case_project.stg_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_items"} */
alter view "warehouse"."main_staging"."stg_items" rename to "stg_items__dbt_backup"
[0m13:57:12.050652 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:57:12.055565 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m13:57:12.055565 [debug] [Thread-1 (]: On model.case_project.stg_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_items"} */
alter view "warehouse"."main_staging"."stg_items__dbt_tmp" rename to "stg_items"
[0m13:57:12.055565 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:57:12.055565 [debug] [Thread-1 (]: On model.case_project.stg_items: COMMIT
[0m13:57:12.055565 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m13:57:12.055565 [debug] [Thread-1 (]: On model.case_project.stg_items: COMMIT
[0m13:57:12.062259 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:57:12.065263 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m13:57:12.066265 [debug] [Thread-1 (]: On model.case_project.stg_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_items"} */

      drop view if exists "warehouse"."main_staging"."stg_items__dbt_backup" cascade
    
[0m13:57:12.068267 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:57:12.069724 [debug] [Thread-1 (]: On model.case_project.stg_items: Close
[0m13:57:12.070725 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7497cea-2a51-4d8e-a622-f1d24ed1ed99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001930BE72B30>]}
[0m13:57:12.071695 [info ] [Thread-1 (]: 2 of 8 OK created sql view model main_staging.stg_items ........................ [[32mOK[0m in 0.05s]
[0m13:57:12.072695 [debug] [Thread-1 (]: Finished running node model.case_project.stg_items
[0m13:57:12.073694 [debug] [Thread-1 (]: Began running node model.case_project.stg_orders
[0m13:57:12.073694 [info ] [Thread-1 (]: 3 of 8 START sql view model main_staging.stg_orders ............................ [RUN]
[0m13:57:12.074695 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_items, now model.case_project.stg_orders)
[0m13:57:12.075724 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_orders
[0m13:57:12.079725 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_orders"
[0m13:57:12.080695 [debug] [Thread-1 (]: Began executing node model.case_project.stg_orders
[0m13:57:12.085693 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_orders"
[0m13:57:12.086694 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m13:57:12.087695 [debug] [Thread-1 (]: On model.case_project.stg_orders: BEGIN
[0m13:57:12.088697 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:57:12.089695 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:57:12.090323 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m13:57:12.090323 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */

  
  create view "warehouse"."main_staging"."stg_orders__dbt_tmp" as (
    with src as (
  select * from "warehouse"."main_raw"."raw_orders"
)
select
  cast(id as varchar)                 as order_id,
  cast(customer as varchar)           as customer_id,
  cast(store_id as varchar)           as store_id,
  cast(ordered_at as timestamp)       as ordered_at,
  cast(subtotal as double)            as subtotal,
  cast(tax_paid as double)            as tax_paid,
  cast(order_total as double)         as order_total
from src
  );

[0m13:57:12.091394 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:57:12.096378 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m13:57:12.097348 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */
alter view "warehouse"."main_staging"."stg_orders" rename to "stg_orders__dbt_backup"
[0m13:57:12.098347 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:57:12.100055 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m13:57:12.103077 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */
alter view "warehouse"."main_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m13:57:12.103992 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:57:12.106098 [debug] [Thread-1 (]: On model.case_project.stg_orders: COMMIT
[0m13:57:12.107096 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m13:57:12.107096 [debug] [Thread-1 (]: On model.case_project.stg_orders: COMMIT
[0m13:57:12.109097 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:57:12.113095 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m13:57:12.114127 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */

      drop view if exists "warehouse"."main_staging"."stg_orders__dbt_backup" cascade
    
[0m13:57:12.116097 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:57:12.118095 [debug] [Thread-1 (]: On model.case_project.stg_orders: Close
[0m13:57:12.118095 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7497cea-2a51-4d8e-a622-f1d24ed1ed99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019308360520>]}
[0m13:57:12.119097 [info ] [Thread-1 (]: 3 of 8 OK created sql view model main_staging.stg_orders ....................... [[32mOK[0m in 0.04s]
[0m13:57:12.120095 [debug] [Thread-1 (]: Finished running node model.case_project.stg_orders
[0m13:57:12.121098 [debug] [Thread-1 (]: Began running node model.case_project.stg_products
[0m13:57:12.122096 [info ] [Thread-1 (]: 4 of 8 START sql view model main_staging.stg_products .......................... [RUN]
[0m13:57:12.123097 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_orders, now model.case_project.stg_products)
[0m13:57:12.123097 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_products
[0m13:57:12.125096 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_products"
[0m13:57:12.125096 [debug] [Thread-1 (]: Began executing node model.case_project.stg_products
[0m13:57:12.125096 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_products"
[0m13:57:12.125096 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m13:57:12.125096 [debug] [Thread-1 (]: On model.case_project.stg_products: BEGIN
[0m13:57:12.125096 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:57:12.125096 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:57:12.125096 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m13:57:12.125096 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */

  
  create view "warehouse"."main_staging"."stg_products__dbt_tmp" as (
    -- models/staging/stg_products.sql
with src as (select * from "warehouse"."main_raw"."raw_products")
select
  cast(sku as varchar)      as product_id,
  lower(trim(name))        as product_name,
  cast(price as double)    as price
from src
  );

[0m13:57:12.125096 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:57:12.143645 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m13:57:12.143645 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */
alter view "warehouse"."main_staging"."stg_products" rename to "stg_products__dbt_backup"
[0m13:57:12.145388 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:57:12.147612 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m13:57:12.147612 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */
alter view "warehouse"."main_staging"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:57:12.147612 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:57:12.152930 [debug] [Thread-1 (]: On model.case_project.stg_products: COMMIT
[0m13:57:12.153966 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m13:57:12.154937 [debug] [Thread-1 (]: On model.case_project.stg_products: COMMIT
[0m13:57:12.156935 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:57:12.160813 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m13:57:12.161786 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */

      drop view if exists "warehouse"."main_staging"."stg_products__dbt_backup" cascade
    
[0m13:57:12.162329 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:57:12.165650 [debug] [Thread-1 (]: On model.case_project.stg_products: Close
[0m13:57:12.166592 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7497cea-2a51-4d8e-a622-f1d24ed1ed99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019309480490>]}
[0m13:57:12.166592 [info ] [Thread-1 (]: 4 of 8 OK created sql view model main_staging.stg_products ..................... [[32mOK[0m in 0.04s]
[0m13:57:12.166592 [debug] [Thread-1 (]: Finished running node model.case_project.stg_products
[0m13:57:12.166592 [debug] [Thread-1 (]: Began running node model.case_project.dim_customers
[0m13:57:12.169919 [info ] [Thread-1 (]: 5 of 8 START sql table model main_marts.dim_customers .......................... [RUN]
[0m13:57:12.169919 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_products, now model.case_project.dim_customers)
[0m13:57:12.169919 [debug] [Thread-1 (]: Began compiling node model.case_project.dim_customers
[0m13:57:12.176597 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.dim_customers"
[0m13:57:12.177597 [debug] [Thread-1 (]: Began executing node model.case_project.dim_customers
[0m13:57:12.201360 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.dim_customers"
[0m13:57:12.201360 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m13:57:12.201360 [debug] [Thread-1 (]: On model.case_project.dim_customers: BEGIN
[0m13:57:12.207323 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:57:12.208333 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:57:12.209333 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m13:57:12.209333 [debug] [Thread-1 (]: On model.case_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_customers"} */

  
    
    

    create  table
      "warehouse"."main_marts"."dim_customers__dbt_tmp"
  
    as (
      -- models/marts/dim_customers.sql


with base as (
    select
        customer_id,
        first_name,
        last_name,
        (first_name || ' ' || coalesce(last_name, '')) as customer_name
    from "warehouse"."main_staging"."stg_customers"
),

orders as (
    select
        customer_id,
        min(ordered_at) as first_order_at,
        max(ordered_at) as most_recent_order_at,
        count(*)        as order_count,
        sum(order_total) as lifetime_value
    from "warehouse"."main_staging"."stg_orders"
    group by 1
)

select
    b.customer_id,
    b.first_name,
    b.last_name,
    b.customer_name,
    o.first_order_at,
    o.most_recent_order_at,
    coalesce(o.order_count, 0)      as order_count,
    coalesce(o.lifetime_value, 0.0) as lifetime_value
from base b
left join orders o using (customer_id)
    );
  
  
[0m13:57:12.219419 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m13:57:12.223417 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m13:57:12.224418 [debug] [Thread-1 (]: On model.case_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_customers"} */
alter table "warehouse"."main_marts"."dim_customers" rename to "dim_customers__dbt_backup"
[0m13:57:12.225419 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:57:12.228417 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m13:57:12.228417 [debug] [Thread-1 (]: On model.case_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_customers"} */
alter table "warehouse"."main_marts"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m13:57:12.228417 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:57:12.228417 [debug] [Thread-1 (]: On model.case_project.dim_customers: COMMIT
[0m13:57:12.228417 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m13:57:12.228417 [debug] [Thread-1 (]: On model.case_project.dim_customers: COMMIT
[0m13:57:12.228417 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:57:12.244006 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m13:57:12.245039 [debug] [Thread-1 (]: On model.case_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_customers"} */

      drop table if exists "warehouse"."main_marts"."dim_customers__dbt_backup" cascade
    
[0m13:57:12.247039 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:57:12.248988 [debug] [Thread-1 (]: On model.case_project.dim_customers: Close
[0m13:57:12.248988 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7497cea-2a51-4d8e-a622-f1d24ed1ed99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001930BB79210>]}
[0m13:57:12.250284 [info ] [Thread-1 (]: 5 of 8 OK created sql table model main_marts.dim_customers ..................... [[32mOK[0m in 0.08s]
[0m13:57:12.252284 [debug] [Thread-1 (]: Finished running node model.case_project.dim_customers
[0m13:57:12.252284 [debug] [Thread-1 (]: Began running node model.case_project.fct_orders
[0m13:57:12.253283 [info ] [Thread-1 (]: 6 of 8 START sql table model main_marts.fct_orders ............................. [RUN]
[0m13:57:12.254284 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.dim_customers, now model.case_project.fct_orders)
[0m13:57:12.255283 [debug] [Thread-1 (]: Began compiling node model.case_project.fct_orders
[0m13:57:12.259110 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.fct_orders"
[0m13:57:12.260079 [debug] [Thread-1 (]: Began executing node model.case_project.fct_orders
[0m13:57:12.265102 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.fct_orders"
[0m13:57:12.267071 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m13:57:12.267071 [debug] [Thread-1 (]: On model.case_project.fct_orders: BEGIN
[0m13:57:12.268103 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:57:12.269072 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:57:12.269072 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m13:57:12.270074 [debug] [Thread-1 (]: On model.case_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_orders"} */

  
    
    

    create  table
      "warehouse"."main_marts"."fct_orders__dbt_tmp"
  
    as (
      -- models/marts/fct_orders.sql


select
    o.order_id,
    o.customer_id,
    o.store_id,
    o.ordered_at,
    cast(date_trunc('day', o.ordered_at) as date) as order_date,
    o.subtotal,
    o.tax_paid,
    o.order_total
from "warehouse"."main_staging"."stg_orders" o
    );
  
  
[0m13:57:12.301639 [debug] [Thread-1 (]: SQL status: OK in 0.031 seconds
[0m13:57:12.306780 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m13:57:12.306780 [debug] [Thread-1 (]: On model.case_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_orders"} */
alter table "warehouse"."main_marts"."fct_orders" rename to "fct_orders__dbt_backup"
[0m13:57:12.307779 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:57:12.311779 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m13:57:12.311779 [debug] [Thread-1 (]: On model.case_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_orders"} */
alter table "warehouse"."main_marts"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m13:57:12.311779 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:57:12.311779 [debug] [Thread-1 (]: On model.case_project.fct_orders: COMMIT
[0m13:57:12.311779 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m13:57:12.311779 [debug] [Thread-1 (]: On model.case_project.fct_orders: COMMIT
[0m13:57:12.337013 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m13:57:12.337013 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m13:57:12.337013 [debug] [Thread-1 (]: On model.case_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_orders"} */

      drop table if exists "warehouse"."main_marts"."fct_orders__dbt_backup" cascade
    
[0m13:57:12.337013 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:57:12.337013 [debug] [Thread-1 (]: On model.case_project.fct_orders: Close
[0m13:57:12.337013 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7497cea-2a51-4d8e-a622-f1d24ed1ed99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001930B9DF160>]}
[0m13:57:12.337013 [info ] [Thread-1 (]: 6 of 8 OK created sql table model main_marts.fct_orders ........................ [[32mOK[0m in 0.08s]
[0m13:57:12.337013 [debug] [Thread-1 (]: Finished running node model.case_project.fct_orders
[0m13:57:12.337013 [debug] [Thread-1 (]: Began running node model.case_project.dim_products
[0m13:57:12.337013 [info ] [Thread-1 (]: 7 of 8 START sql table model main_marts.dim_products ........................... [RUN]
[0m13:57:12.337013 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.fct_orders, now model.case_project.dim_products)
[0m13:57:12.337013 [debug] [Thread-1 (]: Began compiling node model.case_project.dim_products
[0m13:57:12.356116 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.dim_products"
[0m13:57:12.357399 [debug] [Thread-1 (]: Began executing node model.case_project.dim_products
[0m13:57:12.360831 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.dim_products"
[0m13:57:12.360831 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_products"
[0m13:57:12.360831 [debug] [Thread-1 (]: On model.case_project.dim_products: BEGIN
[0m13:57:12.360831 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:57:12.360831 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:57:12.367005 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_products"
[0m13:57:12.368012 [debug] [Thread-1 (]: On model.case_project.dim_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_products"} */

  
    
    

    create  table
      "warehouse"."main_marts"."dim_products__dbt_tmp"
  
    as (
      -- models/marts/dim_products.sql


select
    p.product_id,
    p.product_name,
    p.price as current_list_price
from "warehouse"."main_staging"."stg_products" p
    );
  
  
[0m13:57:12.369012 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:57:12.373010 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_products"
[0m13:57:12.374010 [debug] [Thread-1 (]: On model.case_project.dim_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_products"} */
alter table "warehouse"."main_marts"."dim_products" rename to "dim_products__dbt_backup"
[0m13:57:12.375230 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:57:12.378993 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_products"
[0m13:57:12.379992 [debug] [Thread-1 (]: On model.case_project.dim_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_products"} */
alter table "warehouse"."main_marts"."dim_products__dbt_tmp" rename to "dim_products"
[0m13:57:12.380996 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:57:12.382268 [debug] [Thread-1 (]: On model.case_project.dim_products: COMMIT
[0m13:57:12.382268 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_products"
[0m13:57:12.382268 [debug] [Thread-1 (]: On model.case_project.dim_products: COMMIT
[0m13:57:12.387845 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:57:12.391845 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_products"
[0m13:57:12.391845 [debug] [Thread-1 (]: On model.case_project.dim_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_products"} */

      drop table if exists "warehouse"."main_marts"."dim_products__dbt_backup" cascade
    
[0m13:57:12.394129 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:57:12.396134 [debug] [Thread-1 (]: On model.case_project.dim_products: Close
[0m13:57:12.397134 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7497cea-2a51-4d8e-a622-f1d24ed1ed99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019308469240>]}
[0m13:57:12.397134 [info ] [Thread-1 (]: 7 of 8 OK created sql table model main_marts.dim_products ...................... [[32mOK[0m in 0.06s]
[0m13:57:12.398409 [debug] [Thread-1 (]: Finished running node model.case_project.dim_products
[0m13:57:12.399449 [debug] [Thread-1 (]: Began running node model.case_project.fct_order_items
[0m13:57:12.400449 [info ] [Thread-1 (]: 8 of 8 START sql table model main_marts.fct_order_items ........................ [RUN]
[0m13:57:12.401445 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.dim_products, now model.case_project.fct_order_items)
[0m13:57:12.401445 [debug] [Thread-1 (]: Began compiling node model.case_project.fct_order_items
[0m13:57:12.407445 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.fct_order_items"
[0m13:57:12.408445 [debug] [Thread-1 (]: Began executing node model.case_project.fct_order_items
[0m13:57:12.413413 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.fct_order_items"
[0m13:57:12.415417 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_order_items"
[0m13:57:12.415417 [debug] [Thread-1 (]: On model.case_project.fct_order_items: BEGIN
[0m13:57:12.416418 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:57:12.417446 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:57:12.418415 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_order_items"
[0m13:57:12.418415 [debug] [Thread-1 (]: On model.case_project.fct_order_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_order_items"} */

  
    
    

    create  table
      "warehouse"."main_marts"."fct_order_items__dbt_tmp"
  
    as (
      -- models/marts/fct_order_items.sql


with items as (
    select
        order_id,
        product_id,
        quantity,
        unit_price
    from "warehouse"."main_staging"."stg_items"
),
prod as (
    select
        product_id,
        product_name,
        price as current_list_price
    from "warehouse"."main_staging"."stg_products"
)

select
    i.order_id,
    i.product_id,
    p.product_name,
    i.quantity,
    i.price,
    (i.quantity * i.unit_price) as line_revenue,
    p.current_list_price
from items i
left join prod p using (product_id)
    );
  
  
[0m13:57:12.420415 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_order_items"} */

  
    
    

    create  table
      "warehouse"."main_marts"."fct_order_items__dbt_tmp"
  
    as (
      -- models/marts/fct_order_items.sql


with items as (
    select
        order_id,
        product_id,
        quantity,
        unit_price
    from "warehouse"."main_staging"."stg_items"
),
prod as (
    select
        product_id,
        product_name,
        price as current_list_price
    from "warehouse"."main_staging"."stg_products"
)

select
    i.order_id,
    i.product_id,
    p.product_name,
    i.quantity,
    i.price,
    (i.quantity * i.unit_price) as line_revenue,
    p.current_list_price
from items i
left join prod p using (product_id)
    );
  
  
[0m13:57:12.420415 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:57:12.421414 [debug] [Thread-1 (]: On model.case_project.fct_order_items: ROLLBACK
[0m13:57:12.428296 [debug] [Thread-1 (]: Failed to rollback 'model.case_project.fct_order_items'
[0m13:57:12.429296 [debug] [Thread-1 (]: On model.case_project.fct_order_items: Close
[0m13:57:12.431295 [debug] [Thread-1 (]: Runtime Error in model fct_order_items (models\marts\fct_order_items.sql)
  Binder Error: Referenced column "unit_price" not found in FROM clause!
  Candidate bindings: "item_id", "quantity", "product_id"
  
  LINE 19:         unit_price
                   ^
[0m13:57:12.432296 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7497cea-2a51-4d8e-a622-f1d24ed1ed99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019308469240>]}
[0m13:57:12.433296 [error] [Thread-1 (]: 8 of 8 ERROR creating sql table model main_marts.fct_order_items ............... [[31mERROR[0m in 0.03s]
[0m13:57:12.434296 [debug] [Thread-1 (]: Finished running node model.case_project.fct_order_items
[0m13:57:12.435296 [debug] [Thread-4 (]: Marking all children of 'model.case_project.fct_order_items' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_order_items (models\marts\fct_order_items.sql)
  Binder Error: Referenced column "unit_price" not found in FROM clause!
  Candidate bindings: "item_id", "quantity", "product_id"
  
  LINE 19:         unit_price
                   ^.
[0m13:57:12.437316 [debug] [MainThread]: Using duckdb connection "master"
[0m13:57:12.438297 [debug] [MainThread]: On master: BEGIN
[0m13:57:12.438297 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:57:12.439297 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:57:12.440298 [debug] [MainThread]: On master: COMMIT
[0m13:57:12.440298 [debug] [MainThread]: Using duckdb connection "master"
[0m13:57:12.441296 [debug] [MainThread]: On master: COMMIT
[0m13:57:12.442297 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:57:12.442297 [debug] [MainThread]: On master: Close
[0m13:57:12.443297 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:57:12.443297 [debug] [MainThread]: Connection 'create_warehouse_main_staging' was properly closed.
[0m13:57:12.444298 [debug] [MainThread]: Connection 'list_warehouse_main_staging' was properly closed.
[0m13:57:12.445298 [debug] [MainThread]: Connection 'model.case_project.fct_order_items' was properly closed.
[0m13:57:12.445298 [info ] [MainThread]: 
[0m13:57:12.446331 [info ] [MainThread]: Finished running 4 table models, 4 view models in 0 hours 0 minutes and 0.89 seconds (0.89s).
[0m13:57:12.449153 [debug] [MainThread]: Command end result
[0m13:57:12.485279 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\manss\Desktop\Case Project\target\manifest.json
[0m13:57:12.489670 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\manss\Desktop\Case Project\target\semantic_manifest.json
[0m13:57:12.498636 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\manss\Desktop\Case Project\target\run_results.json
[0m13:57:12.499636 [info ] [MainThread]: 
[0m13:57:12.500636 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:57:12.501636 [info ] [MainThread]: 
[0m13:57:12.502637 [error] [MainThread]: [31mFailure in model fct_order_items (models\marts\fct_order_items.sql)[0m
[0m13:57:12.502637 [error] [MainThread]:   Runtime Error in model fct_order_items (models\marts\fct_order_items.sql)
  Binder Error: Referenced column "unit_price" not found in FROM clause!
  Candidate bindings: "item_id", "quantity", "product_id"
  
  LINE 19:         unit_price
                   ^
[0m13:57:12.503637 [info ] [MainThread]: 
[0m13:57:12.504636 [info ] [MainThread]:   compiled code at target\compiled\case_project\models\marts\fct_order_items.sql
[0m13:57:12.505637 [info ] [MainThread]: 
[0m13:57:12.506638 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=8
[0m13:57:12.507638 [debug] [MainThread]: Command `dbt run` failed at 13:57:12.507638 after 2.47 seconds
[0m13:57:12.508637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019309603190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001930A909DB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001930CFEF2E0>]}
[0m13:57:12.509636 [debug] [MainThread]: Flushing usage events
[0m13:57:13.327575 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:58:14.845082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E6DEAD3160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E6E0D4EAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E6E0D4FD30>]}


============================== 13:58:14.845528 | f461bde6-3020-4e62-a5d2-1290043bff40 ==============================
[0m13:58:14.845528 [info ] [MainThread]: Running with dbt=1.10.9
[0m13:58:14.845528 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\manss\\Desktop\\Case Project\\logs', 'profiles_dir': 'C:\\Users\\manss\\Desktop\\Case Project', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m13:58:15.150676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f461bde6-3020-4e62-a5d2-1290043bff40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E6E0E7E5C0>]}
[0m13:58:15.234518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f461bde6-3020-4e62-a5d2-1290043bff40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E6E0DC6470>]}
[0m13:58:15.234518 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m13:58:15.595594 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m13:58:15.921914 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:58:15.921914 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:58:16.033097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f461bde6-3020-4e62-a5d2-1290043bff40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E6E14E9AE0>]}
[0m13:58:16.268683 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\manss\Desktop\Case Project\target\manifest.json
[0m13:58:16.269210 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\manss\Desktop\Case Project\target\semantic_manifest.json
[0m13:58:16.322412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f461bde6-3020-4e62-a5d2-1290043bff40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E6E142F760>]}
[0m13:58:16.323412 [info ] [MainThread]: Found 4 seeds, 8 models, 24 data tests, 4 sources, 429 macros
[0m13:58:16.324413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f461bde6-3020-4e62-a5d2-1290043bff40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E6E14FCBE0>]}
[0m13:58:16.328444 [info ] [MainThread]: 
[0m13:58:16.329413 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:58:16.329413 [info ] [MainThread]: 
[0m13:58:16.330413 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:58:16.340146 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_staging'
[0m13:58:16.588757 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_staging"
[0m13:58:16.589767 [debug] [ThreadPool]: On list_warehouse_main_staging: BEGIN
[0m13:58:16.589767 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:58:16.613993 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m13:58:16.614963 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_staging"
[0m13:58:16.615963 [debug] [ThreadPool]: On list_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_staging"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'warehouse'
  
[0m13:58:16.630064 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m13:58:16.632094 [debug] [ThreadPool]: On list_warehouse_main_staging: ROLLBACK
[0m13:58:16.633065 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_staging'
[0m13:58:16.634064 [debug] [ThreadPool]: On list_warehouse_main_staging: Close
[0m13:58:16.635066 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_staging, now list_warehouse_main_marts)
[0m13:58:16.640102 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m13:58:16.641100 [debug] [ThreadPool]: On list_warehouse_main_marts: BEGIN
[0m13:58:16.641100 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:58:16.642102 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:58:16.643102 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m13:58:16.643653 [debug] [ThreadPool]: On list_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_marts"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'warehouse'
  
[0m13:58:16.646878 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m13:58:16.647879 [debug] [ThreadPool]: On list_warehouse_main_marts: ROLLBACK
[0m13:58:16.648910 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_marts'
[0m13:58:16.649910 [debug] [ThreadPool]: On list_warehouse_main_marts: Close
[0m13:58:16.650883 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_marts, now list_warehouse_main_raw)
[0m13:58:16.653884 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m13:58:16.654884 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m13:58:16.655882 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:58:16.656883 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:58:16.656883 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m13:58:16.657881 [debug] [ThreadPool]: On list_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_raw"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'warehouse'
  
[0m13:58:16.660882 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m13:58:16.662883 [debug] [ThreadPool]: On list_warehouse_main_raw: ROLLBACK
[0m13:58:16.663884 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_raw'
[0m13:58:16.663884 [debug] [ThreadPool]: On list_warehouse_main_raw: Close
[0m13:58:16.665911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f461bde6-3020-4e62-a5d2-1290043bff40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E6E142F760>]}
[0m13:58:16.666910 [debug] [MainThread]: Using duckdb connection "master"
[0m13:58:16.666910 [debug] [MainThread]: On master: BEGIN
[0m13:58:16.667881 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:58:16.668882 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:58:16.668882 [debug] [MainThread]: On master: COMMIT
[0m13:58:16.669910 [debug] [MainThread]: Using duckdb connection "master"
[0m13:58:16.669910 [debug] [MainThread]: On master: COMMIT
[0m13:58:16.670910 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:58:16.671606 [debug] [MainThread]: On master: Close
[0m13:58:16.676716 [debug] [Thread-1 (]: Began running node test.case_project.accepted_range_fct_order_items_quantity__1.598bf9b560
[0m13:58:16.677716 [info ] [Thread-1 (]: 1 of 24 START test accepted_range_fct_order_items_quantity__1 .................. [RUN]
[0m13:58:16.678511 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.case_project.accepted_range_fct_order_items_quantity__1.598bf9b560'
[0m13:58:16.679517 [debug] [Thread-1 (]: Began compiling node test.case_project.accepted_range_fct_order_items_quantity__1.598bf9b560
[0m13:58:16.702805 [debug] [Thread-1 (]: Compilation Error in test accepted_range_fct_order_items_quantity__1 (models\marts\schema.yml)
  'test_accepted_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:58:16.702805 [error] [Thread-1 (]: 1 of 24 ERROR accepted_range_fct_order_items_quantity__1 ....................... [[31mERROR[0m in 0.02s]
[0m13:58:16.706115 [debug] [Thread-1 (]: Finished running node test.case_project.accepted_range_fct_order_items_quantity__1.598bf9b560
[0m13:58:16.706115 [debug] [Thread-1 (]: Began running node test.case_project.accepted_range_fct_order_items_unit_price__0.b5a85ed8ca
[0m13:58:16.706115 [debug] [Thread-4 (]: Marking all children of 'test.case_project.accepted_range_fct_order_items_quantity__1.598bf9b560' to be skipped because of status 'error'.  Reason: Compilation Error in test accepted_range_fct_order_items_quantity__1 (models\marts\schema.yml)
  'test_accepted_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:58:16.706115 [info ] [Thread-1 (]: 2 of 24 START test accepted_range_fct_order_items_unit_price__0 ................ [RUN]
[0m13:58:16.706115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.case_project.accepted_range_fct_order_items_quantity__1.598bf9b560, now test.case_project.accepted_range_fct_order_items_unit_price__0.b5a85ed8ca)
[0m13:58:16.706115 [debug] [Thread-1 (]: Began compiling node test.case_project.accepted_range_fct_order_items_unit_price__0.b5a85ed8ca
[0m13:58:16.717092 [debug] [Thread-1 (]: Compilation Error in test accepted_range_fct_order_items_unit_price__0 (models\marts\schema.yml)
  'test_accepted_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:58:16.718093 [error] [Thread-1 (]: 2 of 24 ERROR accepted_range_fct_order_items_unit_price__0 ..................... [[31mERROR[0m in 0.01s]
[0m13:58:16.718520 [debug] [Thread-1 (]: Finished running node test.case_project.accepted_range_fct_order_items_unit_price__0.b5a85ed8ca
[0m13:58:16.719570 [debug] [Thread-1 (]: Began running node test.case_project.accepted_range_stg_items_quantity__1.44445fbd28
[0m13:58:16.720529 [debug] [Thread-4 (]: Marking all children of 'test.case_project.accepted_range_fct_order_items_unit_price__0.b5a85ed8ca' to be skipped because of status 'error'.  Reason: Compilation Error in test accepted_range_fct_order_items_unit_price__0 (models\marts\schema.yml)
  'test_accepted_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:58:16.720529 [info ] [Thread-1 (]: 3 of 24 START test accepted_range_stg_items_quantity__1 ........................ [RUN]
[0m13:58:16.722527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.case_project.accepted_range_fct_order_items_unit_price__0.b5a85ed8ca, now test.case_project.accepted_range_stg_items_quantity__1.44445fbd28)
[0m13:58:16.722527 [debug] [Thread-1 (]: Began compiling node test.case_project.accepted_range_stg_items_quantity__1.44445fbd28
[0m13:58:16.730495 [debug] [Thread-1 (]: Compilation Error in test accepted_range_stg_items_quantity__1 (models\staging\schema.yml)
  'test_accepted_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:58:16.731496 [error] [Thread-1 (]: 3 of 24 ERROR accepted_range_stg_items_quantity__1 ............................. [[31mERROR[0m in 0.01s]
[0m13:58:16.732497 [debug] [Thread-1 (]: Finished running node test.case_project.accepted_range_stg_items_quantity__1.44445fbd28
[0m13:58:16.733497 [debug] [Thread-1 (]: Began running node test.case_project.accepted_range_stg_items_unit_price__0.9b0064827f
[0m13:58:16.733497 [debug] [Thread-4 (]: Marking all children of 'test.case_project.accepted_range_stg_items_quantity__1.44445fbd28' to be skipped because of status 'error'.  Reason: Compilation Error in test accepted_range_stg_items_quantity__1 (models\staging\schema.yml)
  'test_accepted_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:58:16.734497 [info ] [Thread-1 (]: 4 of 24 START test accepted_range_stg_items_unit_price__0 ...................... [RUN]
[0m13:58:16.735500 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.case_project.accepted_range_stg_items_quantity__1.44445fbd28, now test.case_project.accepted_range_stg_items_unit_price__0.9b0064827f)
[0m13:58:16.736498 [debug] [Thread-1 (]: Began compiling node test.case_project.accepted_range_stg_items_unit_price__0.9b0064827f
[0m13:58:16.744497 [debug] [Thread-1 (]: Compilation Error in test accepted_range_stg_items_unit_price__0 (models\staging\schema.yml)
  'test_accepted_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:58:16.745495 [error] [Thread-1 (]: 4 of 24 ERROR accepted_range_stg_items_unit_price__0 ........................... [[31mERROR[0m in 0.01s]
[0m13:58:16.746496 [debug] [Thread-1 (]: Finished running node test.case_project.accepted_range_stg_items_unit_price__0.9b0064827f
[0m13:58:16.747527 [debug] [Thread-1 (]: Began running node test.case_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:58:16.748496 [debug] [Thread-4 (]: Marking all children of 'test.case_project.accepted_range_stg_items_unit_price__0.9b0064827f' to be skipped because of status 'error'.  Reason: Compilation Error in test accepted_range_stg_items_unit_price__0 (models\staging\schema.yml)
  'test_accepted_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:58:16.749496 [info ] [Thread-1 (]: 5 of 24 START test not_null_dim_customers_customer_id .......................... [RUN]
[0m13:58:16.750499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.case_project.accepted_range_stg_items_unit_price__0.9b0064827f, now test.case_project.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m13:58:16.751497 [debug] [Thread-1 (]: Began compiling node test.case_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:58:16.763491 [debug] [Thread-1 (]: Writing injected SQL for node "test.case_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:58:16.765465 [debug] [Thread-1 (]: Began executing node test.case_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:58:16.787796 [debug] [Thread-1 (]: Writing runtime sql for node "test.case_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:58:16.789768 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:58:16.790769 [debug] [Thread-1 (]: On test.case_project.not_null_dim_customers_customer_id.dd91cd1c8d: BEGIN
[0m13:58:16.790769 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:58:16.791769 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:58:16.792797 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:58:16.793769 [debug] [Thread-1 (]: On test.case_project.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "test.case_project.not_null_dim_customers_customer_id.dd91cd1c8d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "warehouse"."main_marts"."dim_customers"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m13:58:16.795767 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:58:16.801179 [debug] [Thread-1 (]: On test.case_project.not_null_dim_customers_customer_id.dd91cd1c8d: ROLLBACK
[0m13:58:16.802211 [debug] [Thread-1 (]: Failed to rollback 'test.case_project.not_null_dim_customers_customer_id.dd91cd1c8d'
[0m13:58:16.803590 [debug] [Thread-1 (]: On test.case_project.not_null_dim_customers_customer_id.dd91cd1c8d: Close
[0m13:58:16.804621 [info ] [Thread-1 (]: 5 of 24 PASS not_null_dim_customers_customer_id ................................ [[32mPASS[0m in 0.05s]
[0m13:58:16.805595 [debug] [Thread-1 (]: Finished running node test.case_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:58:16.806283 [debug] [Thread-1 (]: Began running node test.case_project.not_null_dim_products_product_id.c8aba288d1
[0m13:58:16.806283 [info ] [Thread-1 (]: 6 of 24 START test not_null_dim_products_product_id ............................ [RUN]
[0m13:58:16.806283 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.case_project.not_null_dim_customers_customer_id.dd91cd1c8d, now test.case_project.not_null_dim_products_product_id.c8aba288d1)
[0m13:58:16.806283 [debug] [Thread-1 (]: Began compiling node test.case_project.not_null_dim_products_product_id.c8aba288d1
[0m13:58:16.814763 [debug] [Thread-1 (]: Writing injected SQL for node "test.case_project.not_null_dim_products_product_id.c8aba288d1"
[0m13:58:16.815674 [debug] [Thread-1 (]: Began executing node test.case_project.not_null_dim_products_product_id.c8aba288d1
[0m13:58:16.820276 [debug] [Thread-1 (]: Writing runtime sql for node "test.case_project.not_null_dim_products_product_id.c8aba288d1"
[0m13:58:16.821278 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.not_null_dim_products_product_id.c8aba288d1"
[0m13:58:16.822281 [debug] [Thread-1 (]: On test.case_project.not_null_dim_products_product_id.c8aba288d1: BEGIN
[0m13:58:16.822281 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:58:16.824277 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:58:16.824277 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.not_null_dim_products_product_id.c8aba288d1"
[0m13:58:16.825279 [debug] [Thread-1 (]: On test.case_project.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "test.case_project.not_null_dim_products_product_id.c8aba288d1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "warehouse"."main_marts"."dim_products"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m13:58:16.826601 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:58:16.828606 [debug] [Thread-1 (]: On test.case_project.not_null_dim_products_product_id.c8aba288d1: ROLLBACK
[0m13:58:16.828606 [debug] [Thread-1 (]: Failed to rollback 'test.case_project.not_null_dim_products_product_id.c8aba288d1'
[0m13:58:16.829606 [debug] [Thread-1 (]: On test.case_project.not_null_dim_products_product_id.c8aba288d1: Close
[0m13:58:16.831607 [info ] [Thread-1 (]: 6 of 24 PASS not_null_dim_products_product_id .................................. [[32mPASS[0m in 0.03s]
[0m13:58:16.832606 [debug] [Thread-1 (]: Finished running node test.case_project.not_null_dim_products_product_id.c8aba288d1
[0m13:58:16.833593 [debug] [Thread-1 (]: Began running node test.case_project.not_null_fct_orders_order_id.4e687af8d0
[0m13:58:16.834837 [info ] [Thread-1 (]: 7 of 24 START test not_null_fct_orders_order_id ................................ [RUN]
[0m13:58:16.835838 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.case_project.not_null_dim_products_product_id.c8aba288d1, now test.case_project.not_null_fct_orders_order_id.4e687af8d0)
[0m13:58:16.836428 [debug] [Thread-1 (]: Began compiling node test.case_project.not_null_fct_orders_order_id.4e687af8d0
[0m13:58:16.842163 [debug] [Thread-1 (]: Writing injected SQL for node "test.case_project.not_null_fct_orders_order_id.4e687af8d0"
[0m13:58:16.843136 [debug] [Thread-1 (]: Began executing node test.case_project.not_null_fct_orders_order_id.4e687af8d0
[0m13:58:16.847132 [debug] [Thread-1 (]: Writing runtime sql for node "test.case_project.not_null_fct_orders_order_id.4e687af8d0"
[0m13:58:16.848787 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.not_null_fct_orders_order_id.4e687af8d0"
[0m13:58:16.849792 [debug] [Thread-1 (]: On test.case_project.not_null_fct_orders_order_id.4e687af8d0: BEGIN
[0m13:58:16.849792 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:58:16.850793 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:58:16.851793 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.not_null_fct_orders_order_id.4e687af8d0"
[0m13:58:16.852792 [debug] [Thread-1 (]: On test.case_project.not_null_fct_orders_order_id.4e687af8d0: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "test.case_project.not_null_fct_orders_order_id.4e687af8d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "warehouse"."main_marts"."fct_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m13:58:16.853901 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:58:16.857869 [debug] [Thread-1 (]: On test.case_project.not_null_fct_orders_order_id.4e687af8d0: ROLLBACK
[0m13:58:16.858869 [debug] [Thread-1 (]: Failed to rollback 'test.case_project.not_null_fct_orders_order_id.4e687af8d0'
[0m13:58:16.859870 [debug] [Thread-1 (]: On test.case_project.not_null_fct_orders_order_id.4e687af8d0: Close
[0m13:58:16.860869 [info ] [Thread-1 (]: 7 of 24 PASS not_null_fct_orders_order_id ...................................... [[32mPASS[0m in 0.03s]
[0m13:58:16.861874 [debug] [Thread-1 (]: Finished running node test.case_project.not_null_fct_orders_order_id.4e687af8d0
[0m13:58:16.862873 [debug] [Thread-1 (]: Began running node test.case_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:58:16.863869 [info ] [Thread-1 (]: 8 of 24 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m13:58:16.864871 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.case_project.not_null_fct_orders_order_id.4e687af8d0, now test.case_project.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m13:58:16.864871 [debug] [Thread-1 (]: Began compiling node test.case_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:58:16.871472 [debug] [Thread-1 (]: Writing injected SQL for node "test.case_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:58:16.873472 [debug] [Thread-1 (]: Began executing node test.case_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:58:16.877474 [debug] [Thread-1 (]: Writing runtime sql for node "test.case_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:58:16.879475 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:58:16.879475 [debug] [Thread-1 (]: On test.case_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m13:58:16.880473 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:58:16.881472 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:58:16.882473 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:58:16.882473 [debug] [Thread-1 (]: On test.case_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "test.case_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "warehouse"."main_staging"."stg_customers"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m13:58:16.884472 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:58:16.886470 [debug] [Thread-1 (]: On test.case_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m13:58:16.887473 [debug] [Thread-1 (]: Failed to rollback 'test.case_project.not_null_stg_customers_customer_id.e2cfb1f9aa'
[0m13:58:16.887473 [debug] [Thread-1 (]: On test.case_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m13:58:16.888474 [info ] [Thread-1 (]: 8 of 24 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.02s]
[0m13:58:16.890473 [debug] [Thread-1 (]: Finished running node test.case_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:58:16.890473 [debug] [Thread-1 (]: Began running node test.case_project.not_null_stg_items_order_id.f5d55da547
[0m13:58:16.891472 [info ] [Thread-1 (]: 9 of 24 START test not_null_stg_items_order_id ................................. [RUN]
[0m13:58:16.892472 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.case_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.case_project.not_null_stg_items_order_id.f5d55da547)
[0m13:58:16.893473 [debug] [Thread-1 (]: Began compiling node test.case_project.not_null_stg_items_order_id.f5d55da547
[0m13:58:16.894474 [debug] [Thread-1 (]: Writing injected SQL for node "test.case_project.not_null_stg_items_order_id.f5d55da547"
[0m13:58:16.894474 [debug] [Thread-1 (]: Began executing node test.case_project.not_null_stg_items_order_id.f5d55da547
[0m13:58:16.904758 [debug] [Thread-1 (]: Writing runtime sql for node "test.case_project.not_null_stg_items_order_id.f5d55da547"
[0m13:58:16.905761 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.not_null_stg_items_order_id.f5d55da547"
[0m13:58:16.906760 [debug] [Thread-1 (]: On test.case_project.not_null_stg_items_order_id.f5d55da547: BEGIN
[0m13:58:16.907759 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:58:16.908760 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:58:16.909758 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.not_null_stg_items_order_id.f5d55da547"
[0m13:58:16.909758 [debug] [Thread-1 (]: On test.case_project.not_null_stg_items_order_id.f5d55da547: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "test.case_project.not_null_stg_items_order_id.f5d55da547"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "warehouse"."main_staging"."stg_items"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m13:58:16.911758 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:58:16.913758 [debug] [Thread-1 (]: On test.case_project.not_null_stg_items_order_id.f5d55da547: ROLLBACK
[0m13:58:16.914760 [debug] [Thread-1 (]: Failed to rollback 'test.case_project.not_null_stg_items_order_id.f5d55da547'
[0m13:58:16.914760 [debug] [Thread-1 (]: On test.case_project.not_null_stg_items_order_id.f5d55da547: Close
[0m13:58:16.915757 [info ] [Thread-1 (]: 9 of 24 PASS not_null_stg_items_order_id ....................................... [[32mPASS[0m in 0.02s]
[0m13:58:16.917759 [debug] [Thread-1 (]: Finished running node test.case_project.not_null_stg_items_order_id.f5d55da547
[0m13:58:16.918634 [debug] [Thread-1 (]: Began running node test.case_project.not_null_stg_items_product_id.aa0688cb17
[0m13:58:16.919702 [info ] [Thread-1 (]: 10 of 24 START test not_null_stg_items_product_id .............................. [RUN]
[0m13:58:16.920701 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.case_project.not_null_stg_items_order_id.f5d55da547, now test.case_project.not_null_stg_items_product_id.aa0688cb17)
[0m13:58:16.920701 [debug] [Thread-1 (]: Began compiling node test.case_project.not_null_stg_items_product_id.aa0688cb17
[0m13:58:16.927114 [debug] [Thread-1 (]: Writing injected SQL for node "test.case_project.not_null_stg_items_product_id.aa0688cb17"
[0m13:58:16.928116 [debug] [Thread-1 (]: Began executing node test.case_project.not_null_stg_items_product_id.aa0688cb17
[0m13:58:16.932765 [debug] [Thread-1 (]: Writing runtime sql for node "test.case_project.not_null_stg_items_product_id.aa0688cb17"
[0m13:58:16.934766 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.not_null_stg_items_product_id.aa0688cb17"
[0m13:58:16.935769 [debug] [Thread-1 (]: On test.case_project.not_null_stg_items_product_id.aa0688cb17: BEGIN
[0m13:58:16.936769 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:58:16.937770 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:58:16.938869 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.not_null_stg_items_product_id.aa0688cb17"
[0m13:58:16.938869 [debug] [Thread-1 (]: On test.case_project.not_null_stg_items_product_id.aa0688cb17: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "test.case_project.not_null_stg_items_product_id.aa0688cb17"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "warehouse"."main_staging"."stg_items"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m13:58:16.940869 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:58:16.942898 [debug] [Thread-1 (]: On test.case_project.not_null_stg_items_product_id.aa0688cb17: ROLLBACK
[0m13:58:16.943871 [debug] [Thread-1 (]: Failed to rollback 'test.case_project.not_null_stg_items_product_id.aa0688cb17'
[0m13:58:16.944867 [debug] [Thread-1 (]: On test.case_project.not_null_stg_items_product_id.aa0688cb17: Close
[0m13:58:16.945903 [info ] [Thread-1 (]: 10 of 24 PASS not_null_stg_items_product_id .................................... [[32mPASS[0m in 0.03s]
[0m13:58:16.946866 [debug] [Thread-1 (]: Finished running node test.case_project.not_null_stg_items_product_id.aa0688cb17
[0m13:58:16.947865 [debug] [Thread-1 (]: Began running node test.case_project.not_null_stg_orders_order_id.81cfe2fe64
[0m13:58:16.947865 [info ] [Thread-1 (]: 11 of 24 START test not_null_stg_orders_order_id ............................... [RUN]
[0m13:58:16.948866 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.case_project.not_null_stg_items_product_id.aa0688cb17, now test.case_project.not_null_stg_orders_order_id.81cfe2fe64)
[0m13:58:16.949866 [debug] [Thread-1 (]: Began compiling node test.case_project.not_null_stg_orders_order_id.81cfe2fe64
[0m13:58:16.957865 [debug] [Thread-1 (]: Writing injected SQL for node "test.case_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:58:16.958867 [debug] [Thread-1 (]: Began executing node test.case_project.not_null_stg_orders_order_id.81cfe2fe64
[0m13:58:16.962864 [debug] [Thread-1 (]: Writing runtime sql for node "test.case_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:58:16.963917 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:58:16.963917 [debug] [Thread-1 (]: On test.case_project.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m13:58:16.963917 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:58:16.963917 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:58:16.963917 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:58:16.963917 [debug] [Thread-1 (]: On test.case_project.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "test.case_project.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "warehouse"."main_staging"."stg_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m13:58:16.963917 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:58:16.971096 [debug] [Thread-1 (]: On test.case_project.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m13:58:16.972477 [debug] [Thread-1 (]: Failed to rollback 'test.case_project.not_null_stg_orders_order_id.81cfe2fe64'
[0m13:58:16.973510 [debug] [Thread-1 (]: On test.case_project.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m13:58:16.974509 [info ] [Thread-1 (]: 11 of 24 PASS not_null_stg_orders_order_id ..................................... [[32mPASS[0m in 0.03s]
[0m13:58:16.975508 [debug] [Thread-1 (]: Finished running node test.case_project.not_null_stg_orders_order_id.81cfe2fe64
[0m13:58:16.976509 [debug] [Thread-1 (]: Began running node test.case_project.not_null_stg_orders_ordered_at.ed431172ca
[0m13:58:16.976961 [info ] [Thread-1 (]: 12 of 24 START test not_null_stg_orders_ordered_at ............................. [RUN]
[0m13:58:16.977779 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.case_project.not_null_stg_orders_order_id.81cfe2fe64, now test.case_project.not_null_stg_orders_ordered_at.ed431172ca)
[0m13:58:16.977779 [debug] [Thread-1 (]: Began compiling node test.case_project.not_null_stg_orders_ordered_at.ed431172ca
[0m13:58:16.984974 [debug] [Thread-1 (]: Writing injected SQL for node "test.case_project.not_null_stg_orders_ordered_at.ed431172ca"
[0m13:58:16.985975 [debug] [Thread-1 (]: Began executing node test.case_project.not_null_stg_orders_ordered_at.ed431172ca
[0m13:58:16.991977 [debug] [Thread-1 (]: Writing runtime sql for node "test.case_project.not_null_stg_orders_ordered_at.ed431172ca"
[0m13:58:16.992978 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.not_null_stg_orders_ordered_at.ed431172ca"
[0m13:58:16.993977 [debug] [Thread-1 (]: On test.case_project.not_null_stg_orders_ordered_at.ed431172ca: BEGIN
[0m13:58:16.994975 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:58:16.995975 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:58:16.996979 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.not_null_stg_orders_ordered_at.ed431172ca"
[0m13:58:16.997977 [debug] [Thread-1 (]: On test.case_project.not_null_stg_orders_ordered_at.ed431172ca: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "test.case_project.not_null_stg_orders_ordered_at.ed431172ca"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ordered_at
from "warehouse"."main_staging"."stg_orders"
where ordered_at is null



  
  
      
    ) dbt_internal_test
[0m13:58:17.000975 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:58:17.003004 [debug] [Thread-1 (]: On test.case_project.not_null_stg_orders_ordered_at.ed431172ca: ROLLBACK
[0m13:58:17.003004 [debug] [Thread-1 (]: Failed to rollback 'test.case_project.not_null_stg_orders_ordered_at.ed431172ca'
[0m13:58:17.003976 [debug] [Thread-1 (]: On test.case_project.not_null_stg_orders_ordered_at.ed431172ca: Close
[0m13:58:17.005975 [info ] [Thread-1 (]: 12 of 24 PASS not_null_stg_orders_ordered_at ................................... [[32mPASS[0m in 0.03s]
[0m13:58:17.006975 [debug] [Thread-1 (]: Finished running node test.case_project.not_null_stg_orders_ordered_at.ed431172ca
[0m13:58:17.007977 [debug] [Thread-1 (]: Began running node test.case_project.not_null_stg_products_product_id.6373b0acf3
[0m13:58:17.008975 [info ] [Thread-1 (]: 13 of 24 START test not_null_stg_products_product_id ........................... [RUN]
[0m13:58:17.009974 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.case_project.not_null_stg_orders_ordered_at.ed431172ca, now test.case_project.not_null_stg_products_product_id.6373b0acf3)
[0m13:58:17.009974 [debug] [Thread-1 (]: Began compiling node test.case_project.not_null_stg_products_product_id.6373b0acf3
[0m13:58:17.015974 [debug] [Thread-1 (]: Writing injected SQL for node "test.case_project.not_null_stg_products_product_id.6373b0acf3"
[0m13:58:17.016974 [debug] [Thread-1 (]: Began executing node test.case_project.not_null_stg_products_product_id.6373b0acf3
[0m13:58:17.020715 [debug] [Thread-1 (]: Writing runtime sql for node "test.case_project.not_null_stg_products_product_id.6373b0acf3"
[0m13:58:17.022250 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.not_null_stg_products_product_id.6373b0acf3"
[0m13:58:17.023304 [debug] [Thread-1 (]: On test.case_project.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m13:58:17.023304 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:58:17.024331 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:58:17.025334 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.not_null_stg_products_product_id.6373b0acf3"
[0m13:58:17.025334 [debug] [Thread-1 (]: On test.case_project.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "test.case_project.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "warehouse"."main_staging"."stg_products"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m13:58:17.027366 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:58:17.029403 [debug] [Thread-1 (]: On test.case_project.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m13:58:17.029403 [debug] [Thread-1 (]: Failed to rollback 'test.case_project.not_null_stg_products_product_id.6373b0acf3'
[0m13:58:17.030403 [debug] [Thread-1 (]: On test.case_project.not_null_stg_products_product_id.6373b0acf3: Close
[0m13:58:17.031404 [info ] [Thread-1 (]: 13 of 24 PASS not_null_stg_products_product_id ................................. [[32mPASS[0m in 0.02s]
[0m13:58:17.032372 [debug] [Thread-1 (]: Finished running node test.case_project.not_null_stg_products_product_id.6373b0acf3
[0m13:58:17.033598 [debug] [Thread-1 (]: Began running node test.case_project.order_total_matches
[0m13:58:17.034195 [info ] [Thread-1 (]: 14 of 24 START test order_total_matches ........................................ [RUN]
[0m13:58:17.034195 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.case_project.not_null_stg_products_product_id.6373b0acf3, now test.case_project.order_total_matches)
[0m13:58:17.034195 [debug] [Thread-1 (]: Began compiling node test.case_project.order_total_matches
[0m13:58:17.039511 [debug] [Thread-1 (]: Writing injected SQL for node "test.case_project.order_total_matches"
[0m13:58:17.042055 [debug] [Thread-1 (]: Began executing node test.case_project.order_total_matches
[0m13:58:17.046055 [debug] [Thread-1 (]: Writing runtime sql for node "test.case_project.order_total_matches"
[0m13:58:17.048056 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.order_total_matches"
[0m13:58:17.049056 [debug] [Thread-1 (]: On test.case_project.order_total_matches: BEGIN
[0m13:58:17.049056 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:58:17.050086 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:58:17.051055 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.order_total_matches"
[0m13:58:17.051055 [debug] [Thread-1 (]: On test.case_project.order_total_matches: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "test.case_project.order_total_matches"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Allow small rounding differences (e.g., 0.01)
with src as (
  select
    order_id,
    subtotal,
    tax_paid,
    order_total,
    abs(order_total - (coalesce(subtotal,0) + coalesce(tax_paid,0))) as delta
  from "warehouse"."main_marts"."fct_orders"
)
select *
from src
where delta > 0.01
  
  
      
    ) dbt_internal_test
[0m13:58:17.057054 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:58:17.060054 [debug] [Thread-1 (]: On test.case_project.order_total_matches: ROLLBACK
[0m13:58:17.061055 [debug] [Thread-1 (]: Failed to rollback 'test.case_project.order_total_matches'
[0m13:58:17.062053 [debug] [Thread-1 (]: On test.case_project.order_total_matches: Close
[0m13:58:17.063054 [info ] [Thread-1 (]: 14 of 24 PASS order_total_matches .............................................. [[32mPASS[0m in 0.03s]
[0m13:58:17.064056 [debug] [Thread-1 (]: Finished running node test.case_project.order_total_matches
[0m13:58:17.065060 [debug] [Thread-1 (]: Began running node test.case_project.positive_value_stg_products_price.e6c8fbc631
[0m13:58:17.066059 [info ] [Thread-1 (]: 15 of 24 START test positive_value_stg_products_price .......................... [RUN]
[0m13:58:17.067058 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.case_project.order_total_matches, now test.case_project.positive_value_stg_products_price.e6c8fbc631)
[0m13:58:17.068056 [debug] [Thread-1 (]: Began compiling node test.case_project.positive_value_stg_products_price.e6c8fbc631
[0m13:58:17.074089 [debug] [Thread-1 (]: Compilation Error in test positive_value_stg_products_price (models\staging\schema.yml)
  'test_positive_value' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:58:17.075086 [error] [Thread-1 (]: 15 of 24 ERROR positive_value_stg_products_price ............................... [[31mERROR[0m in 0.01s]
[0m13:58:17.076058 [debug] [Thread-1 (]: Finished running node test.case_project.positive_value_stg_products_price.e6c8fbc631
[0m13:58:17.077086 [debug] [Thread-1 (]: Began running node test.case_project.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec
[0m13:58:17.078086 [debug] [Thread-4 (]: Marking all children of 'test.case_project.positive_value_stg_products_price.e6c8fbc631' to be skipped because of status 'error'.  Reason: Compilation Error in test positive_value_stg_products_price (models\staging\schema.yml)
  'test_positive_value' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:58:17.078086 [info ] [Thread-1 (]: 16 of 24 START test relationships_fct_order_items_order_id__order_id__ref_fct_orders_  [RUN]
[0m13:58:17.080055 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.case_project.positive_value_stg_products_price.e6c8fbc631, now test.case_project.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec)
[0m13:58:17.080055 [debug] [Thread-1 (]: Began compiling node test.case_project.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec
[0m13:58:17.091168 [debug] [Thread-1 (]: Writing injected SQL for node "test.case_project.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec"
[0m13:58:17.092168 [debug] [Thread-1 (]: Began executing node test.case_project.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec
[0m13:58:17.096168 [debug] [Thread-1 (]: Writing runtime sql for node "test.case_project.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec"
[0m13:58:17.098169 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec"
[0m13:58:17.098169 [debug] [Thread-1 (]: On test.case_project.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec: BEGIN
[0m13:58:17.099169 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:58:17.100169 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:58:17.101169 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec"
[0m13:58:17.101169 [debug] [Thread-1 (]: On test.case_project.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "test.case_project.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select order_id as from_field
    from "warehouse"."main_marts"."fct_order_items"
    where order_id is not null
),

parent as (
    select order_id as to_field
    from "warehouse"."main_marts"."fct_orders"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:58:17.103169 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "test.case_project.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select order_id as from_field
    from "warehouse"."main_marts"."fct_order_items"
    where order_id is not null
),

parent as (
    select order_id as to_field
    from "warehouse"."main_marts"."fct_orders"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:58:17.104170 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:58:17.105169 [debug] [Thread-1 (]: On test.case_project.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec: ROLLBACK
[0m13:58:17.111168 [debug] [Thread-1 (]: Failed to rollback 'test.case_project.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec'
[0m13:58:17.112168 [debug] [Thread-1 (]: On test.case_project.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec: Close
[0m13:58:17.112835 [debug] [Thread-1 (]: Runtime Error in test relationships_fct_order_items_order_id__order_id__ref_fct_orders_ (models\marts\schema.yml)
  Catalog Error: Table with name fct_order_items does not exist!
  Did you mean "fct_orders"?
  
  LINE 16:     from "warehouse"."main_marts"."fct_order_items"
                    ^
[0m13:58:17.112835 [error] [Thread-1 (]: 16 of 24 ERROR relationships_fct_order_items_order_id__order_id__ref_fct_orders_  [[31mERROR[0m in 0.03s]
[0m13:58:17.115851 [debug] [Thread-1 (]: Finished running node test.case_project.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec
[0m13:58:17.116864 [debug] [Thread-1 (]: Began running node test.case_project.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1
[0m13:58:17.117859 [debug] [Thread-4 (]: Marking all children of 'test.case_project.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec' to be skipped because of status 'error'.  Reason: Runtime Error in test relationships_fct_order_items_order_id__order_id__ref_fct_orders_ (models\marts\schema.yml)
  Catalog Error: Table with name fct_order_items does not exist!
  Did you mean "fct_orders"?
  
  LINE 16:     from "warehouse"."main_marts"."fct_order_items"
                    ^.
[0m13:58:17.117859 [info ] [Thread-1 (]: 17 of 24 START test relationships_fct_order_items_product_id__product_id__ref_dim_products_  [RUN]
[0m13:58:17.118890 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.case_project.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec, now test.case_project.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1)
[0m13:58:17.119858 [debug] [Thread-1 (]: Began compiling node test.case_project.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1
[0m13:58:17.126857 [debug] [Thread-1 (]: Writing injected SQL for node "test.case_project.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1"
[0m13:58:17.128862 [debug] [Thread-1 (]: Began executing node test.case_project.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1
[0m13:58:17.130746 [debug] [Thread-1 (]: Writing runtime sql for node "test.case_project.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1"
[0m13:58:17.130746 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1"
[0m13:58:17.130746 [debug] [Thread-1 (]: On test.case_project.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1: BEGIN
[0m13:58:17.130746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:58:17.130746 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:58:17.136684 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1"
[0m13:58:17.137707 [debug] [Thread-1 (]: On test.case_project.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "test.case_project.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_id as from_field
    from "warehouse"."main_marts"."fct_order_items"
    where product_id is not null
),

parent as (
    select product_id as to_field
    from "warehouse"."main_marts"."dim_products"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:58:17.138720 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "test.case_project.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_id as from_field
    from "warehouse"."main_marts"."fct_order_items"
    where product_id is not null
),

parent as (
    select product_id as to_field
    from "warehouse"."main_marts"."dim_products"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:58:17.139693 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:58:17.139693 [debug] [Thread-1 (]: On test.case_project.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1: ROLLBACK
[0m13:58:17.141720 [debug] [Thread-1 (]: Failed to rollback 'test.case_project.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1'
[0m13:58:17.142720 [debug] [Thread-1 (]: On test.case_project.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1: Close
[0m13:58:17.144297 [debug] [Thread-1 (]: Runtime Error in test relationships_fct_order_items_product_id__product_id__ref_dim_products_ (models\marts\schema.yml)
  Catalog Error: Table with name fct_order_items does not exist!
  Did you mean "fct_orders"?
  
  LINE 16:     from "warehouse"."main_marts"."fct_order_items"
                    ^
[0m13:58:17.145373 [error] [Thread-1 (]: 17 of 24 ERROR relationships_fct_order_items_product_id__product_id__ref_dim_products_  [[31mERROR[0m in 0.03s]
[0m13:58:17.146342 [debug] [Thread-1 (]: Finished running node test.case_project.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1
[0m13:58:17.147342 [debug] [Thread-1 (]: Began running node test.case_project.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m13:58:17.147342 [debug] [Thread-4 (]: Marking all children of 'test.case_project.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1' to be skipped because of status 'error'.  Reason: Runtime Error in test relationships_fct_order_items_product_id__product_id__ref_dim_products_ (models\marts\schema.yml)
  Catalog Error: Table with name fct_order_items does not exist!
  Did you mean "fct_orders"?
  
  LINE 16:     from "warehouse"."main_marts"."fct_order_items"
                    ^.
[0m13:58:17.148373 [info ] [Thread-1 (]: 18 of 24 START test relationships_fct_orders_customer_id__customer_id__ref_dim_customers_  [RUN]
[0m13:58:17.149344 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.case_project.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1, now test.case_project.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4)
[0m13:58:17.150342 [debug] [Thread-1 (]: Began compiling node test.case_project.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m13:58:17.157752 [debug] [Thread-1 (]: Writing injected SQL for node "test.case_project.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:58:17.159753 [debug] [Thread-1 (]: Began executing node test.case_project.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m13:58:17.164753 [debug] [Thread-1 (]: Writing runtime sql for node "test.case_project.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:58:17.166754 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:58:17.167755 [debug] [Thread-1 (]: On test.case_project.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: BEGIN
[0m13:58:17.168754 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:58:17.169753 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:58:17.170753 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:58:17.170753 [debug] [Thread-1 (]: On test.case_project.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "test.case_project.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from "warehouse"."main_marts"."fct_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "warehouse"."main_marts"."dim_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:58:17.175753 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:58:17.178753 [debug] [Thread-1 (]: On test.case_project.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: ROLLBACK
[0m13:58:17.179752 [debug] [Thread-1 (]: Failed to rollback 'test.case_project.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4'
[0m13:58:17.179752 [debug] [Thread-1 (]: On test.case_project.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: Close
[0m13:58:17.180752 [info ] [Thread-1 (]: 18 of 24 PASS relationships_fct_orders_customer_id__customer_id__ref_dim_customers_  [[32mPASS[0m in 0.03s]
[0m13:58:17.182780 [debug] [Thread-1 (]: Finished running node test.case_project.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m13:58:17.182780 [debug] [Thread-1 (]: Began running node test.case_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:58:17.183779 [info ] [Thread-1 (]: 19 of 24 START test unique_dim_customers_customer_id ........................... [RUN]
[0m13:58:17.184452 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.case_project.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4, now test.case_project.unique_dim_customers_customer_id.15c9f1e2fd)
[0m13:58:17.185510 [debug] [Thread-1 (]: Began compiling node test.case_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:58:17.193507 [debug] [Thread-1 (]: Writing injected SQL for node "test.case_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:58:17.195508 [debug] [Thread-1 (]: Began executing node test.case_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:58:17.199507 [debug] [Thread-1 (]: Writing runtime sql for node "test.case_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:58:17.200508 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:58:17.201510 [debug] [Thread-1 (]: On test.case_project.unique_dim_customers_customer_id.15c9f1e2fd: BEGIN
[0m13:58:17.202513 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:58:17.203513 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:58:17.204512 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:58:17.204512 [debug] [Thread-1 (]: On test.case_project.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "test.case_project.unique_dim_customers_customer_id.15c9f1e2fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "warehouse"."main_marts"."dim_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:58:17.209509 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:58:17.211540 [debug] [Thread-1 (]: On test.case_project.unique_dim_customers_customer_id.15c9f1e2fd: ROLLBACK
[0m13:58:17.211540 [debug] [Thread-1 (]: Failed to rollback 'test.case_project.unique_dim_customers_customer_id.15c9f1e2fd'
[0m13:58:17.213103 [debug] [Thread-1 (]: On test.case_project.unique_dim_customers_customer_id.15c9f1e2fd: Close
[0m13:58:17.214108 [info ] [Thread-1 (]: 19 of 24 PASS unique_dim_customers_customer_id ................................. [[32mPASS[0m in 0.03s]
[0m13:58:17.215109 [debug] [Thread-1 (]: Finished running node test.case_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:58:17.216140 [debug] [Thread-1 (]: Began running node test.case_project.unique_dim_products_product_id.ef7b2a9985
[0m13:58:17.217113 [info ] [Thread-1 (]: 20 of 24 START test unique_dim_products_product_id ............................. [RUN]
[0m13:58:17.218112 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.case_project.unique_dim_customers_customer_id.15c9f1e2fd, now test.case_project.unique_dim_products_product_id.ef7b2a9985)
[0m13:58:17.218112 [debug] [Thread-1 (]: Began compiling node test.case_project.unique_dim_products_product_id.ef7b2a9985
[0m13:58:17.224141 [debug] [Thread-1 (]: Writing injected SQL for node "test.case_project.unique_dim_products_product_id.ef7b2a9985"
[0m13:58:17.225112 [debug] [Thread-1 (]: Began executing node test.case_project.unique_dim_products_product_id.ef7b2a9985
[0m13:58:17.229139 [debug] [Thread-1 (]: Writing runtime sql for node "test.case_project.unique_dim_products_product_id.ef7b2a9985"
[0m13:58:17.231112 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.unique_dim_products_product_id.ef7b2a9985"
[0m13:58:17.231112 [debug] [Thread-1 (]: On test.case_project.unique_dim_products_product_id.ef7b2a9985: BEGIN
[0m13:58:17.232139 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:58:17.233110 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:58:17.233110 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.unique_dim_products_product_id.ef7b2a9985"
[0m13:58:17.234109 [debug] [Thread-1 (]: On test.case_project.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "test.case_project.unique_dim_products_product_id.ef7b2a9985"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "warehouse"."main_marts"."dim_products"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:58:17.237877 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:58:17.237877 [debug] [Thread-1 (]: On test.case_project.unique_dim_products_product_id.ef7b2a9985: ROLLBACK
[0m13:58:17.240867 [debug] [Thread-1 (]: Failed to rollback 'test.case_project.unique_dim_products_product_id.ef7b2a9985'
[0m13:58:17.241655 [debug] [Thread-1 (]: On test.case_project.unique_dim_products_product_id.ef7b2a9985: Close
[0m13:58:17.243351 [info ] [Thread-1 (]: 20 of 24 PASS unique_dim_products_product_id ................................... [[32mPASS[0m in 0.03s]
[0m13:58:17.244350 [debug] [Thread-1 (]: Finished running node test.case_project.unique_dim_products_product_id.ef7b2a9985
[0m13:58:17.244350 [debug] [Thread-1 (]: Began running node test.case_project.unique_fct_orders_order_id.523ddb6ce5
[0m13:58:17.245349 [info ] [Thread-1 (]: 21 of 24 START test unique_fct_orders_order_id ................................. [RUN]
[0m13:58:17.246350 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.case_project.unique_dim_products_product_id.ef7b2a9985, now test.case_project.unique_fct_orders_order_id.523ddb6ce5)
[0m13:58:17.247350 [debug] [Thread-1 (]: Began compiling node test.case_project.unique_fct_orders_order_id.523ddb6ce5
[0m13:58:17.252667 [debug] [Thread-1 (]: Writing injected SQL for node "test.case_project.unique_fct_orders_order_id.523ddb6ce5"
[0m13:58:17.254679 [debug] [Thread-1 (]: Began executing node test.case_project.unique_fct_orders_order_id.523ddb6ce5
[0m13:58:17.258678 [debug] [Thread-1 (]: Writing runtime sql for node "test.case_project.unique_fct_orders_order_id.523ddb6ce5"
[0m13:58:17.260677 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.unique_fct_orders_order_id.523ddb6ce5"
[0m13:58:17.260677 [debug] [Thread-1 (]: On test.case_project.unique_fct_orders_order_id.523ddb6ce5: BEGIN
[0m13:58:17.261678 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:58:17.262678 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:58:17.263678 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.unique_fct_orders_order_id.523ddb6ce5"
[0m13:58:17.264678 [debug] [Thread-1 (]: On test.case_project.unique_fct_orders_order_id.523ddb6ce5: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "test.case_project.unique_fct_orders_order_id.523ddb6ce5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "warehouse"."main_marts"."fct_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:58:17.277553 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m13:58:17.279553 [debug] [Thread-1 (]: On test.case_project.unique_fct_orders_order_id.523ddb6ce5: ROLLBACK
[0m13:58:17.280552 [debug] [Thread-1 (]: Failed to rollback 'test.case_project.unique_fct_orders_order_id.523ddb6ce5'
[0m13:58:17.280552 [debug] [Thread-1 (]: On test.case_project.unique_fct_orders_order_id.523ddb6ce5: Close
[0m13:58:17.282552 [info ] [Thread-1 (]: 21 of 24 PASS unique_fct_orders_order_id ....................................... [[32mPASS[0m in 0.04s]
[0m13:58:17.283583 [debug] [Thread-1 (]: Finished running node test.case_project.unique_fct_orders_order_id.523ddb6ce5
[0m13:58:17.283583 [debug] [Thread-1 (]: Began running node test.case_project.unique_stg_customers_customer_id.c7614daada
[0m13:58:17.284552 [info ] [Thread-1 (]: 22 of 24 START test unique_stg_customers_customer_id ........................... [RUN]
[0m13:58:17.285551 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.case_project.unique_fct_orders_order_id.523ddb6ce5, now test.case_project.unique_stg_customers_customer_id.c7614daada)
[0m13:58:17.286582 [debug] [Thread-1 (]: Began compiling node test.case_project.unique_stg_customers_customer_id.c7614daada
[0m13:58:17.293582 [debug] [Thread-1 (]: Writing injected SQL for node "test.case_project.unique_stg_customers_customer_id.c7614daada"
[0m13:58:17.294555 [debug] [Thread-1 (]: Began executing node test.case_project.unique_stg_customers_customer_id.c7614daada
[0m13:58:17.298812 [debug] [Thread-1 (]: Writing runtime sql for node "test.case_project.unique_stg_customers_customer_id.c7614daada"
[0m13:58:17.300498 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.unique_stg_customers_customer_id.c7614daada"
[0m13:58:17.301495 [debug] [Thread-1 (]: On test.case_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m13:58:17.301495 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:58:17.302524 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:58:17.303411 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.unique_stg_customers_customer_id.c7614daada"
[0m13:58:17.304218 [debug] [Thread-1 (]: On test.case_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "test.case_project.unique_stg_customers_customer_id.c7614daada"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "warehouse"."main_staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:58:17.308987 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:58:17.311402 [debug] [Thread-1 (]: On test.case_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m13:58:17.312402 [debug] [Thread-1 (]: Failed to rollback 'test.case_project.unique_stg_customers_customer_id.c7614daada'
[0m13:58:17.313405 [debug] [Thread-1 (]: On test.case_project.unique_stg_customers_customer_id.c7614daada: Close
[0m13:58:17.314537 [info ] [Thread-1 (]: 22 of 24 PASS unique_stg_customers_customer_id ................................. [[32mPASS[0m in 0.03s]
[0m13:58:17.315537 [debug] [Thread-1 (]: Finished running node test.case_project.unique_stg_customers_customer_id.c7614daada
[0m13:58:17.316535 [debug] [Thread-1 (]: Began running node test.case_project.unique_stg_orders_order_id.e3b841c71a
[0m13:58:17.316535 [info ] [Thread-1 (]: 23 of 24 START test unique_stg_orders_order_id ................................. [RUN]
[0m13:58:17.318468 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.case_project.unique_stg_customers_customer_id.c7614daada, now test.case_project.unique_stg_orders_order_id.e3b841c71a)
[0m13:58:17.318468 [debug] [Thread-1 (]: Began compiling node test.case_project.unique_stg_orders_order_id.e3b841c71a
[0m13:58:17.325223 [debug] [Thread-1 (]: Writing injected SQL for node "test.case_project.unique_stg_orders_order_id.e3b841c71a"
[0m13:58:17.328221 [debug] [Thread-1 (]: Began executing node test.case_project.unique_stg_orders_order_id.e3b841c71a
[0m13:58:17.331219 [debug] [Thread-1 (]: Writing runtime sql for node "test.case_project.unique_stg_orders_order_id.e3b841c71a"
[0m13:58:17.333223 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.unique_stg_orders_order_id.e3b841c71a"
[0m13:58:17.334223 [debug] [Thread-1 (]: On test.case_project.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m13:58:17.334223 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:58:17.335250 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:58:17.336250 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.unique_stg_orders_order_id.e3b841c71a"
[0m13:58:17.336250 [debug] [Thread-1 (]: On test.case_project.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "test.case_project.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "warehouse"."main_staging"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:58:17.346218 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m13:58:17.351838 [debug] [Thread-1 (]: On test.case_project.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m13:58:17.353040 [debug] [Thread-1 (]: Failed to rollback 'test.case_project.unique_stg_orders_order_id.e3b841c71a'
[0m13:58:17.354038 [debug] [Thread-1 (]: On test.case_project.unique_stg_orders_order_id.e3b841c71a: Close
[0m13:58:17.354452 [info ] [Thread-1 (]: 23 of 24 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 0.04s]
[0m13:58:17.355507 [debug] [Thread-1 (]: Finished running node test.case_project.unique_stg_orders_order_id.e3b841c71a
[0m13:58:17.356510 [debug] [Thread-1 (]: Began running node test.case_project.unique_stg_products_product_id.7d950a1467
[0m13:58:17.357509 [info ] [Thread-1 (]: 24 of 24 START test unique_stg_products_product_id ............................. [RUN]
[0m13:58:17.358511 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.case_project.unique_stg_orders_order_id.e3b841c71a, now test.case_project.unique_stg_products_product_id.7d950a1467)
[0m13:58:17.358940 [debug] [Thread-1 (]: Began compiling node test.case_project.unique_stg_products_product_id.7d950a1467
[0m13:58:17.364898 [debug] [Thread-1 (]: Writing injected SQL for node "test.case_project.unique_stg_products_product_id.7d950a1467"
[0m13:58:17.365899 [debug] [Thread-1 (]: Began executing node test.case_project.unique_stg_products_product_id.7d950a1467
[0m13:58:17.369997 [debug] [Thread-1 (]: Writing runtime sql for node "test.case_project.unique_stg_products_product_id.7d950a1467"
[0m13:58:17.371999 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.unique_stg_products_product_id.7d950a1467"
[0m13:58:17.372996 [debug] [Thread-1 (]: On test.case_project.unique_stg_products_product_id.7d950a1467: BEGIN
[0m13:58:17.372996 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:58:17.373997 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:58:17.374997 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.unique_stg_products_product_id.7d950a1467"
[0m13:58:17.375999 [debug] [Thread-1 (]: On test.case_project.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "test.case_project.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "warehouse"."main_staging"."stg_products"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:58:17.378849 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:58:17.380856 [debug] [Thread-1 (]: On test.case_project.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m13:58:17.381884 [debug] [Thread-1 (]: Failed to rollback 'test.case_project.unique_stg_products_product_id.7d950a1467'
[0m13:58:17.382854 [debug] [Thread-1 (]: On test.case_project.unique_stg_products_product_id.7d950a1467: Close
[0m13:58:17.383884 [info ] [Thread-1 (]: 24 of 24 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.02s]
[0m13:58:17.384855 [debug] [Thread-1 (]: Finished running node test.case_project.unique_stg_products_product_id.7d950a1467
[0m13:58:17.385857 [debug] [MainThread]: Using duckdb connection "master"
[0m13:58:17.386855 [debug] [MainThread]: On master: BEGIN
[0m13:58:17.386855 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:58:17.387885 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:58:17.388893 [debug] [MainThread]: On master: COMMIT
[0m13:58:17.389855 [debug] [MainThread]: Using duckdb connection "master"
[0m13:58:17.389855 [debug] [MainThread]: On master: COMMIT
[0m13:58:17.390856 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:58:17.390856 [debug] [MainThread]: On master: Close
[0m13:58:17.391884 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:58:17.392891 [debug] [MainThread]: Connection 'list_warehouse_main_raw' was properly closed.
[0m13:58:17.392891 [debug] [MainThread]: Connection 'test.case_project.unique_stg_products_product_id.7d950a1467' was properly closed.
[0m13:58:17.393854 [info ] [MainThread]: 
[0m13:58:17.394857 [info ] [MainThread]: Finished running 24 data tests in 0 hours 0 minutes and 1.06 seconds (1.06s).
[0m13:58:17.399853 [debug] [MainThread]: Command end result
[0m13:58:17.437499 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\manss\Desktop\Case Project\target\manifest.json
[0m13:58:17.441501 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\manss\Desktop\Case Project\target\semantic_manifest.json
[0m13:58:17.453525 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\manss\Desktop\Case Project\target\run_results.json
[0m13:58:17.454499 [info ] [MainThread]: 
[0m13:58:17.454499 [info ] [MainThread]: [31mCompleted with 7 errors, 0 partial successes, and 0 warnings:[0m
[0m13:58:17.455496 [info ] [MainThread]: 
[0m13:58:17.456525 [error] [MainThread]: [31mFailure in test accepted_range_fct_order_items_quantity__1 (models\marts\schema.yml)[0m
[0m13:58:17.456525 [error] [MainThread]:   Compilation Error in test accepted_range_fct_order_items_quantity__1 (models\marts\schema.yml)
  'test_accepted_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:58:17.456525 [info ] [MainThread]: 
[0m13:58:17.456525 [error] [MainThread]: [31mFailure in test accepted_range_fct_order_items_unit_price__0 (models\marts\schema.yml)[0m
[0m13:58:17.456525 [error] [MainThread]:   Compilation Error in test accepted_range_fct_order_items_unit_price__0 (models\marts\schema.yml)
  'test_accepted_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:58:17.460431 [info ] [MainThread]: 
[0m13:58:17.460431 [error] [MainThread]: [31mFailure in test accepted_range_stg_items_quantity__1 (models\staging\schema.yml)[0m
[0m13:58:17.462214 [error] [MainThread]:   Compilation Error in test accepted_range_stg_items_quantity__1 (models\staging\schema.yml)
  'test_accepted_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:58:17.462534 [info ] [MainThread]: 
[0m13:58:17.463786 [error] [MainThread]: [31mFailure in test accepted_range_stg_items_unit_price__0 (models\staging\schema.yml)[0m
[0m13:58:17.463786 [error] [MainThread]:   Compilation Error in test accepted_range_stg_items_unit_price__0 (models\staging\schema.yml)
  'test_accepted_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:58:17.465522 [info ] [MainThread]: 
[0m13:58:17.465522 [error] [MainThread]: [31mFailure in test positive_value_stg_products_price (models\staging\schema.yml)[0m
[0m13:58:17.465522 [error] [MainThread]:   Compilation Error in test positive_value_stg_products_price (models\staging\schema.yml)
  'test_positive_value' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:58:17.465522 [info ] [MainThread]: 
[0m13:58:17.465522 [error] [MainThread]: [31mFailure in test relationships_fct_order_items_order_id__order_id__ref_fct_orders_ (models\marts\schema.yml)[0m
[0m13:58:17.465522 [error] [MainThread]:   Runtime Error in test relationships_fct_order_items_order_id__order_id__ref_fct_orders_ (models\marts\schema.yml)
  Catalog Error: Table with name fct_order_items does not exist!
  Did you mean "fct_orders"?
  
  LINE 16:     from "warehouse"."main_marts"."fct_order_items"
                    ^
[0m13:58:17.470009 [info ] [MainThread]: 
[0m13:58:17.470009 [info ] [MainThread]:   compiled code at target\compiled\case_project\models\marts\schema.yml\relationships_fct_order_items_6605ef9332585c82f278ac817835eb79.sql
[0m13:58:17.471016 [info ] [MainThread]: 
[0m13:58:17.471820 [error] [MainThread]: [31mFailure in test relationships_fct_order_items_product_id__product_id__ref_dim_products_ (models\marts\schema.yml)[0m
[0m13:58:17.473110 [error] [MainThread]:   Runtime Error in test relationships_fct_order_items_product_id__product_id__ref_dim_products_ (models\marts\schema.yml)
  Catalog Error: Table with name fct_order_items does not exist!
  Did you mean "fct_orders"?
  
  LINE 16:     from "warehouse"."main_marts"."fct_order_items"
                    ^
[0m13:58:17.474109 [info ] [MainThread]: 
[0m13:58:17.474109 [info ] [MainThread]:   compiled code at target\compiled\case_project\models\marts\schema.yml\relationships_fct_order_items_b0f28835da40fb8b0928f9f26aa86d50.sql
[0m13:58:17.475107 [info ] [MainThread]: 
[0m13:58:17.476106 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=7 SKIP=0 NO-OP=0 TOTAL=24
[0m13:58:17.477108 [debug] [MainThread]: Command `dbt test` failed at 13:58:17.477108 after 2.73 seconds
[0m13:58:17.478138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E6DEAD3160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E6DDDE3BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E6DE9522C0>]}
[0m13:58:17.479107 [debug] [MainThread]: Flushing usage events
[0m13:58:18.144436 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:50:35.212539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED4F6D31C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED51969E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED51969C60>]}


============================== 14:50:35.212539 | 2a009c62-27e3-4234-81ad-b88b2bfb8ce1 ==============================
[0m14:50:35.212539 [info ] [MainThread]: Running with dbt=1.10.9
[0m14:50:35.212539 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt test', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\manss\\Desktop\\Case Project\\logs', 'profiles_dir': 'C:\\Users\\manss\\Desktop\\Case Project', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True'}
[0m14:50:35.508621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2a009c62-27e3-4234-81ad-b88b2bfb8ce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED51AC18A0>]}
[0m14:50:35.602387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2a009c62-27e3-4234-81ad-b88b2bfb8ce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED51AC13C0>]}
[0m14:50:35.602387 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:50:35.954098 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m14:50:36.290539 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m14:50:36.290539 [debug] [MainThread]: Partial parsing: deleted file: case_project://tests\order_total_matches.sql
[0m14:50:36.461145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2a009c62-27e3-4234-81ad-b88b2bfb8ce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED520F0A60>]}
[0m14:50:36.650713 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\manss\Desktop\Case Project\target\manifest.json
[0m14:50:36.666484 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\manss\Desktop\Case Project\target\semantic_manifest.json
[0m14:50:36.710868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2a009c62-27e3-4234-81ad-b88b2bfb8ce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED5215D840>]}
[0m14:50:36.710868 [info ] [MainThread]: Found 4 seeds, 8 models, 23 data tests, 4 sources, 429 macros
[0m14:50:36.712608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a009c62-27e3-4234-81ad-b88b2bfb8ce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED5215D8A0>]}
[0m14:50:36.716806 [info ] [MainThread]: 
[0m14:50:36.716806 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:50:36.719202 [info ] [MainThread]: 
[0m14:50:36.720226 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:50:36.727225 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_marts'
[0m14:50:36.952513 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m14:50:36.955647 [debug] [ThreadPool]: On list_warehouse_main_marts: BEGIN
[0m14:50:36.955647 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:36.973008 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m14:50:36.973008 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m14:50:36.973008 [debug] [ThreadPool]: On list_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_marts"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'warehouse'
  
[0m14:50:36.988814 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m14:50:36.988814 [debug] [ThreadPool]: On list_warehouse_main_marts: ROLLBACK
[0m14:50:36.988814 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_marts'
[0m14:50:36.988814 [debug] [ThreadPool]: On list_warehouse_main_marts: Close
[0m14:50:36.999298 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_marts, now list_warehouse_main_raw)
[0m14:50:37.002136 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m14:50:37.002136 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m14:50:37.004148 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:50:37.004148 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:50:37.004148 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m14:50:37.006153 [debug] [ThreadPool]: On list_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_raw"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'warehouse'
  
[0m14:50:37.008157 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m14:50:37.010161 [debug] [ThreadPool]: On list_warehouse_main_raw: ROLLBACK
[0m14:50:37.010161 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_raw'
[0m14:50:37.012167 [debug] [ThreadPool]: On list_warehouse_main_raw: Close
[0m14:50:37.012167 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_raw, now list_warehouse_main_staging)
[0m14:50:37.016004 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_staging"
[0m14:50:37.016004 [debug] [ThreadPool]: On list_warehouse_main_staging: BEGIN
[0m14:50:37.016004 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:50:37.018008 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:50:37.018008 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_staging"
[0m14:50:37.018008 [debug] [ThreadPool]: On list_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_staging"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'warehouse'
  
[0m14:50:37.022018 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m14:50:37.024023 [debug] [ThreadPool]: On list_warehouse_main_staging: ROLLBACK
[0m14:50:37.024023 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_staging'
[0m14:50:37.024023 [debug] [ThreadPool]: On list_warehouse_main_staging: Close
[0m14:50:37.026028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a009c62-27e3-4234-81ad-b88b2bfb8ce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED51A52EF0>]}
[0m14:50:37.026028 [debug] [MainThread]: Using duckdb connection "master"
[0m14:50:37.026028 [debug] [MainThread]: On master: BEGIN
[0m14:50:37.026028 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:50:37.026028 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:50:37.026028 [debug] [MainThread]: On master: COMMIT
[0m14:50:37.026028 [debug] [MainThread]: Using duckdb connection "master"
[0m14:50:37.026028 [debug] [MainThread]: On master: COMMIT
[0m14:50:37.026028 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:50:37.026028 [debug] [MainThread]: On master: Close
[0m14:50:37.035856 [debug] [Thread-1 (]: Began running node test.case_project.accepted_range_fct_order_items_quantity__1.598bf9b560
[0m14:50:37.035856 [info ] [Thread-1 (]: 1 of 23 START test accepted_range_fct_order_items_quantity__1 .................. [RUN]
[0m14:50:37.035856 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.case_project.accepted_range_fct_order_items_quantity__1.598bf9b560'
[0m14:50:37.035856 [debug] [Thread-1 (]: Began compiling node test.case_project.accepted_range_fct_order_items_quantity__1.598bf9b560
[0m14:50:37.060803 [debug] [Thread-1 (]: Compilation Error in test accepted_range_fct_order_items_quantity__1 (models\marts\schema.yml)
  'test_accepted_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:50:37.060803 [error] [Thread-1 (]: 1 of 23 ERROR accepted_range_fct_order_items_quantity__1 ....................... [[31mERROR[0m in 0.02s]
[0m14:50:37.064065 [debug] [Thread-1 (]: Finished running node test.case_project.accepted_range_fct_order_items_quantity__1.598bf9b560
[0m14:50:37.064065 [debug] [Thread-1 (]: Began running node test.case_project.accepted_range_fct_order_items_unit_price__0.b5a85ed8ca
[0m14:50:37.064065 [debug] [Thread-4 (]: Marking all children of 'test.case_project.accepted_range_fct_order_items_quantity__1.598bf9b560' to be skipped because of status 'error'.  Reason: Compilation Error in test accepted_range_fct_order_items_quantity__1 (models\marts\schema.yml)
  'test_accepted_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m14:50:37.064065 [info ] [Thread-1 (]: 2 of 23 START test accepted_range_fct_order_items_unit_price__0 ................ [RUN]
[0m14:50:37.067894 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.case_project.accepted_range_fct_order_items_quantity__1.598bf9b560, now test.case_project.accepted_range_fct_order_items_unit_price__0.b5a85ed8ca)
[0m14:50:37.068894 [debug] [Thread-1 (]: Began compiling node test.case_project.accepted_range_fct_order_items_unit_price__0.b5a85ed8ca
[0m14:50:37.075069 [debug] [Thread-1 (]: Compilation Error in test accepted_range_fct_order_items_unit_price__0 (models\marts\schema.yml)
  'test_accepted_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:50:37.075069 [error] [Thread-1 (]: 2 of 23 ERROR accepted_range_fct_order_items_unit_price__0 ..................... [[31mERROR[0m in 0.01s]
[0m14:50:37.076738 [debug] [Thread-1 (]: Finished running node test.case_project.accepted_range_fct_order_items_unit_price__0.b5a85ed8ca
[0m14:50:37.076738 [debug] [Thread-1 (]: Began running node test.case_project.accepted_range_stg_items_quantity__1.44445fbd28
[0m14:50:37.077816 [debug] [Thread-4 (]: Marking all children of 'test.case_project.accepted_range_fct_order_items_unit_price__0.b5a85ed8ca' to be skipped because of status 'error'.  Reason: Compilation Error in test accepted_range_fct_order_items_unit_price__0 (models\marts\schema.yml)
  'test_accepted_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m14:50:37.078786 [info ] [Thread-1 (]: 3 of 23 START test accepted_range_stg_items_quantity__1 ........................ [RUN]
[0m14:50:37.079271 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.case_project.accepted_range_fct_order_items_unit_price__0.b5a85ed8ca, now test.case_project.accepted_range_stg_items_quantity__1.44445fbd28)
[0m14:50:37.080277 [debug] [Thread-1 (]: Began compiling node test.case_project.accepted_range_stg_items_quantity__1.44445fbd28
[0m14:50:37.087861 [debug] [Thread-1 (]: Compilation Error in test accepted_range_stg_items_quantity__1 (models\staging\schema.yml)
  'test_accepted_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:50:37.088861 [error] [Thread-1 (]: 3 of 23 ERROR accepted_range_stg_items_quantity__1 ............................. [[31mERROR[0m in 0.01s]
[0m14:50:37.089873 [debug] [Thread-1 (]: Finished running node test.case_project.accepted_range_stg_items_quantity__1.44445fbd28
[0m14:50:37.089873 [debug] [Thread-1 (]: Began running node test.case_project.accepted_range_stg_items_unit_price__0.9b0064827f
[0m14:50:37.090861 [debug] [Thread-4 (]: Marking all children of 'test.case_project.accepted_range_stg_items_quantity__1.44445fbd28' to be skipped because of status 'error'.  Reason: Compilation Error in test accepted_range_stg_items_quantity__1 (models\staging\schema.yml)
  'test_accepted_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m14:50:37.091403 [info ] [Thread-1 (]: 4 of 23 START test accepted_range_stg_items_unit_price__0 ...................... [RUN]
[0m14:50:37.092767 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.case_project.accepted_range_stg_items_quantity__1.44445fbd28, now test.case_project.accepted_range_stg_items_unit_price__0.9b0064827f)
[0m14:50:37.093774 [debug] [Thread-1 (]: Began compiling node test.case_project.accepted_range_stg_items_unit_price__0.9b0064827f
[0m14:50:37.099773 [debug] [Thread-1 (]: Compilation Error in test accepted_range_stg_items_unit_price__0 (models\staging\schema.yml)
  'test_accepted_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:50:37.100778 [error] [Thread-1 (]: 4 of 23 ERROR accepted_range_stg_items_unit_price__0 ........................... [[31mERROR[0m in 0.01s]
[0m14:50:37.101774 [debug] [Thread-1 (]: Finished running node test.case_project.accepted_range_stg_items_unit_price__0.9b0064827f
[0m14:50:37.102773 [debug] [Thread-1 (]: Began running node test.case_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m14:50:37.102773 [debug] [Thread-4 (]: Marking all children of 'test.case_project.accepted_range_stg_items_unit_price__0.9b0064827f' to be skipped because of status 'error'.  Reason: Compilation Error in test accepted_range_stg_items_unit_price__0 (models\staging\schema.yml)
  'test_accepted_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m14:50:37.103805 [info ] [Thread-1 (]: 5 of 23 START test not_null_dim_customers_customer_id .......................... [RUN]
[0m14:50:37.104774 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.case_project.accepted_range_stg_items_unit_price__0.9b0064827f, now test.case_project.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m14:50:37.105774 [debug] [Thread-1 (]: Began compiling node test.case_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m14:50:37.116774 [debug] [Thread-1 (]: Writing injected SQL for node "test.case_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m14:50:37.117774 [debug] [Thread-1 (]: Began executing node test.case_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m14:50:37.139409 [debug] [Thread-1 (]: Writing runtime sql for node "test.case_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m14:50:37.141381 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m14:50:37.142381 [debug] [Thread-1 (]: On test.case_project.not_null_dim_customers_customer_id.dd91cd1c8d: BEGIN
[0m14:50:37.142381 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:50:37.143412 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:50:37.144586 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m14:50:37.145558 [debug] [Thread-1 (]: On test.case_project.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "test.case_project.not_null_dim_customers_customer_id.dd91cd1c8d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "warehouse"."main_marts"."dim_customers"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m14:50:37.146595 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:50:37.150585 [debug] [Thread-1 (]: On test.case_project.not_null_dim_customers_customer_id.dd91cd1c8d: ROLLBACK
[0m14:50:37.150585 [debug] [Thread-1 (]: Failed to rollback 'test.case_project.not_null_dim_customers_customer_id.dd91cd1c8d'
[0m14:50:37.150585 [debug] [Thread-1 (]: On test.case_project.not_null_dim_customers_customer_id.dd91cd1c8d: Close
[0m14:50:37.150585 [info ] [Thread-1 (]: 5 of 23 PASS not_null_dim_customers_customer_id ................................ [[32mPASS[0m in 0.05s]
[0m14:50:37.150585 [debug] [Thread-1 (]: Finished running node test.case_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m14:50:37.150585 [debug] [Thread-1 (]: Began running node test.case_project.not_null_dim_products_product_id.c8aba288d1
[0m14:50:37.150585 [info ] [Thread-1 (]: 6 of 23 START test not_null_dim_products_product_id ............................ [RUN]
[0m14:50:37.150585 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.case_project.not_null_dim_customers_customer_id.dd91cd1c8d, now test.case_project.not_null_dim_products_product_id.c8aba288d1)
[0m14:50:37.150585 [debug] [Thread-1 (]: Began compiling node test.case_project.not_null_dim_products_product_id.c8aba288d1
[0m14:50:37.150585 [debug] [Thread-1 (]: Writing injected SQL for node "test.case_project.not_null_dim_products_product_id.c8aba288d1"
[0m14:50:37.166408 [debug] [Thread-1 (]: Began executing node test.case_project.not_null_dim_products_product_id.c8aba288d1
[0m14:50:37.170330 [debug] [Thread-1 (]: Writing runtime sql for node "test.case_project.not_null_dim_products_product_id.c8aba288d1"
[0m14:50:37.172623 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.not_null_dim_products_product_id.c8aba288d1"
[0m14:50:37.172623 [debug] [Thread-1 (]: On test.case_project.not_null_dim_products_product_id.c8aba288d1: BEGIN
[0m14:50:37.173847 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:50:37.174847 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:50:37.175820 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.not_null_dim_products_product_id.c8aba288d1"
[0m14:50:37.175820 [debug] [Thread-1 (]: On test.case_project.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "test.case_project.not_null_dim_products_product_id.c8aba288d1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "warehouse"."main_marts"."dim_products"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m14:50:37.176847 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:50:37.179368 [debug] [Thread-1 (]: On test.case_project.not_null_dim_products_product_id.c8aba288d1: ROLLBACK
[0m14:50:37.179368 [debug] [Thread-1 (]: Failed to rollback 'test.case_project.not_null_dim_products_product_id.c8aba288d1'
[0m14:50:37.181077 [debug] [Thread-1 (]: On test.case_project.not_null_dim_products_product_id.c8aba288d1: Close
[0m14:50:37.181077 [info ] [Thread-1 (]: 6 of 23 PASS not_null_dim_products_product_id .................................. [[32mPASS[0m in 0.03s]
[0m14:50:37.182212 [debug] [Thread-1 (]: Finished running node test.case_project.not_null_dim_products_product_id.c8aba288d1
[0m14:50:37.183212 [debug] [Thread-1 (]: Began running node test.case_project.not_null_fct_orders_order_id.4e687af8d0
[0m14:50:37.184212 [info ] [Thread-1 (]: 7 of 23 START test not_null_fct_orders_order_id ................................ [RUN]
[0m14:50:37.185183 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.case_project.not_null_dim_products_product_id.c8aba288d1, now test.case_project.not_null_fct_orders_order_id.4e687af8d0)
[0m14:50:37.186222 [debug] [Thread-1 (]: Began compiling node test.case_project.not_null_fct_orders_order_id.4e687af8d0
[0m14:50:37.191215 [debug] [Thread-1 (]: Writing injected SQL for node "test.case_project.not_null_fct_orders_order_id.4e687af8d0"
[0m14:50:37.192182 [debug] [Thread-1 (]: Began executing node test.case_project.not_null_fct_orders_order_id.4e687af8d0
[0m14:50:37.196181 [debug] [Thread-1 (]: Writing runtime sql for node "test.case_project.not_null_fct_orders_order_id.4e687af8d0"
[0m14:50:37.197908 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.not_null_fct_orders_order_id.4e687af8d0"
[0m14:50:37.197908 [debug] [Thread-1 (]: On test.case_project.not_null_fct_orders_order_id.4e687af8d0: BEGIN
[0m14:50:37.198941 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:50:37.200090 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:50:37.200090 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.not_null_fct_orders_order_id.4e687af8d0"
[0m14:50:37.201137 [debug] [Thread-1 (]: On test.case_project.not_null_fct_orders_order_id.4e687af8d0: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "test.case_project.not_null_fct_orders_order_id.4e687af8d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "warehouse"."main_marts"."fct_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m14:50:37.202136 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:50:37.203134 [debug] [Thread-1 (]: On test.case_project.not_null_fct_orders_order_id.4e687af8d0: ROLLBACK
[0m14:50:37.203134 [debug] [Thread-1 (]: Failed to rollback 'test.case_project.not_null_fct_orders_order_id.4e687af8d0'
[0m14:50:37.205747 [debug] [Thread-1 (]: On test.case_project.not_null_fct_orders_order_id.4e687af8d0: Close
[0m14:50:37.206547 [info ] [Thread-1 (]: 7 of 23 PASS not_null_fct_orders_order_id ...................................... [[32mPASS[0m in 0.02s]
[0m14:50:37.208554 [debug] [Thread-1 (]: Finished running node test.case_project.not_null_fct_orders_order_id.4e687af8d0
[0m14:50:37.208554 [debug] [Thread-1 (]: Began running node test.case_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m14:50:37.209553 [info ] [Thread-1 (]: 8 of 23 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m14:50:37.210553 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.case_project.not_null_fct_orders_order_id.4e687af8d0, now test.case_project.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m14:50:37.211553 [debug] [Thread-1 (]: Began compiling node test.case_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m14:50:37.217396 [debug] [Thread-1 (]: Writing injected SQL for node "test.case_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m14:50:37.218398 [debug] [Thread-1 (]: Began executing node test.case_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m14:50:37.222398 [debug] [Thread-1 (]: Writing runtime sql for node "test.case_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m14:50:37.224399 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m14:50:37.224399 [debug] [Thread-1 (]: On test.case_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m14:50:37.225398 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:50:37.226397 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:50:37.227398 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m14:50:37.227398 [debug] [Thread-1 (]: On test.case_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "test.case_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "warehouse"."main_staging"."stg_customers"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m14:50:37.230293 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:50:37.230293 [debug] [Thread-1 (]: On test.case_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m14:50:37.233406 [debug] [Thread-1 (]: Failed to rollback 'test.case_project.not_null_stg_customers_customer_id.e2cfb1f9aa'
[0m14:50:37.233406 [debug] [Thread-1 (]: On test.case_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m14:50:37.234517 [info ] [Thread-1 (]: 8 of 23 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.02s]
[0m14:50:37.235523 [debug] [Thread-1 (]: Finished running node test.case_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m14:50:37.236523 [debug] [Thread-1 (]: Began running node test.case_project.not_null_stg_items_order_id.f5d55da547
[0m14:50:37.237525 [info ] [Thread-1 (]: 9 of 23 START test not_null_stg_items_order_id ................................. [RUN]
[0m14:50:37.237948 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.case_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.case_project.not_null_stg_items_order_id.f5d55da547)
[0m14:50:37.238998 [debug] [Thread-1 (]: Began compiling node test.case_project.not_null_stg_items_order_id.f5d55da547
[0m14:50:37.241440 [debug] [Thread-1 (]: Writing injected SQL for node "test.case_project.not_null_stg_items_order_id.f5d55da547"
[0m14:50:37.241440 [debug] [Thread-1 (]: Began executing node test.case_project.not_null_stg_items_order_id.f5d55da547
[0m14:50:37.251420 [debug] [Thread-1 (]: Writing runtime sql for node "test.case_project.not_null_stg_items_order_id.f5d55da547"
[0m14:50:37.252419 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.not_null_stg_items_order_id.f5d55da547"
[0m14:50:37.253421 [debug] [Thread-1 (]: On test.case_project.not_null_stg_items_order_id.f5d55da547: BEGIN
[0m14:50:37.254421 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:50:37.255421 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:50:37.256078 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.not_null_stg_items_order_id.f5d55da547"
[0m14:50:37.257137 [debug] [Thread-1 (]: On test.case_project.not_null_stg_items_order_id.f5d55da547: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "test.case_project.not_null_stg_items_order_id.f5d55da547"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "warehouse"."main_staging"."stg_items"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m14:50:37.258138 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:50:37.259138 [debug] [Thread-1 (]: On test.case_project.not_null_stg_items_order_id.f5d55da547: ROLLBACK
[0m14:50:37.261270 [debug] [Thread-1 (]: Failed to rollback 'test.case_project.not_null_stg_items_order_id.f5d55da547'
[0m14:50:37.262360 [debug] [Thread-1 (]: On test.case_project.not_null_stg_items_order_id.f5d55da547: Close
[0m14:50:37.263367 [info ] [Thread-1 (]: 9 of 23 PASS not_null_stg_items_order_id ....................................... [[32mPASS[0m in 0.02s]
[0m14:50:37.264367 [debug] [Thread-1 (]: Finished running node test.case_project.not_null_stg_items_order_id.f5d55da547
[0m14:50:37.265368 [debug] [Thread-1 (]: Began running node test.case_project.not_null_stg_items_product_id.aa0688cb17
[0m14:50:37.265368 [info ] [Thread-1 (]: 10 of 23 START test not_null_stg_items_product_id .............................. [RUN]
[0m14:50:37.266367 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.case_project.not_null_stg_items_order_id.f5d55da547, now test.case_project.not_null_stg_items_product_id.aa0688cb17)
[0m14:50:37.267366 [debug] [Thread-1 (]: Began compiling node test.case_project.not_null_stg_items_product_id.aa0688cb17
[0m14:50:37.272417 [debug] [Thread-1 (]: Writing injected SQL for node "test.case_project.not_null_stg_items_product_id.aa0688cb17"
[0m14:50:37.274419 [debug] [Thread-1 (]: Began executing node test.case_project.not_null_stg_items_product_id.aa0688cb17
[0m14:50:37.277984 [debug] [Thread-1 (]: Writing runtime sql for node "test.case_project.not_null_stg_items_product_id.aa0688cb17"
[0m14:50:37.279986 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.not_null_stg_items_product_id.aa0688cb17"
[0m14:50:37.279986 [debug] [Thread-1 (]: On test.case_project.not_null_stg_items_product_id.aa0688cb17: BEGIN
[0m14:50:37.280984 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:50:37.281984 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:50:37.282984 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.not_null_stg_items_product_id.aa0688cb17"
[0m14:50:37.283983 [debug] [Thread-1 (]: On test.case_project.not_null_stg_items_product_id.aa0688cb17: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "test.case_project.not_null_stg_items_product_id.aa0688cb17"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "warehouse"."main_staging"."stg_items"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m14:50:37.285984 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:50:37.287984 [debug] [Thread-1 (]: On test.case_project.not_null_stg_items_product_id.aa0688cb17: ROLLBACK
[0m14:50:37.287984 [debug] [Thread-1 (]: Failed to rollback 'test.case_project.not_null_stg_items_product_id.aa0688cb17'
[0m14:50:37.288984 [debug] [Thread-1 (]: On test.case_project.not_null_stg_items_product_id.aa0688cb17: Close
[0m14:50:37.289984 [info ] [Thread-1 (]: 10 of 23 PASS not_null_stg_items_product_id .................................... [[32mPASS[0m in 0.02s]
[0m14:50:37.291050 [debug] [Thread-1 (]: Finished running node test.case_project.not_null_stg_items_product_id.aa0688cb17
[0m14:50:37.292051 [debug] [Thread-1 (]: Began running node test.case_project.not_null_stg_orders_order_id.81cfe2fe64
[0m14:50:37.293054 [info ] [Thread-1 (]: 11 of 23 START test not_null_stg_orders_order_id ............................... [RUN]
[0m14:50:37.294053 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.case_project.not_null_stg_items_product_id.aa0688cb17, now test.case_project.not_null_stg_orders_order_id.81cfe2fe64)
[0m14:50:37.294053 [debug] [Thread-1 (]: Began compiling node test.case_project.not_null_stg_orders_order_id.81cfe2fe64
[0m14:50:37.300050 [debug] [Thread-1 (]: Writing injected SQL for node "test.case_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m14:50:37.301054 [debug] [Thread-1 (]: Began executing node test.case_project.not_null_stg_orders_order_id.81cfe2fe64
[0m14:50:37.304052 [debug] [Thread-1 (]: Writing runtime sql for node "test.case_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m14:50:37.306054 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m14:50:37.307053 [debug] [Thread-1 (]: On test.case_project.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m14:50:37.307053 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:50:37.308051 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:50:37.309055 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m14:50:37.310053 [debug] [Thread-1 (]: On test.case_project.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "test.case_project.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "warehouse"."main_staging"."stg_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m14:50:37.311052 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:50:37.313052 [debug] [Thread-1 (]: On test.case_project.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m14:50:37.314052 [debug] [Thread-1 (]: Failed to rollback 'test.case_project.not_null_stg_orders_order_id.81cfe2fe64'
[0m14:50:37.315050 [debug] [Thread-1 (]: On test.case_project.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m14:50:37.316051 [info ] [Thread-1 (]: 11 of 23 PASS not_null_stg_orders_order_id ..................................... [[32mPASS[0m in 0.02s]
[0m14:50:37.317053 [debug] [Thread-1 (]: Finished running node test.case_project.not_null_stg_orders_order_id.81cfe2fe64
[0m14:50:37.318053 [debug] [Thread-1 (]: Began running node test.case_project.not_null_stg_orders_ordered_at.ed431172ca
[0m14:50:37.319053 [info ] [Thread-1 (]: 12 of 23 START test not_null_stg_orders_ordered_at ............................. [RUN]
[0m14:50:37.320053 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.case_project.not_null_stg_orders_order_id.81cfe2fe64, now test.case_project.not_null_stg_orders_ordered_at.ed431172ca)
[0m14:50:37.320053 [debug] [Thread-1 (]: Began compiling node test.case_project.not_null_stg_orders_ordered_at.ed431172ca
[0m14:50:37.327052 [debug] [Thread-1 (]: Writing injected SQL for node "test.case_project.not_null_stg_orders_ordered_at.ed431172ca"
[0m14:50:37.328051 [debug] [Thread-1 (]: Began executing node test.case_project.not_null_stg_orders_ordered_at.ed431172ca
[0m14:50:37.332051 [debug] [Thread-1 (]: Writing runtime sql for node "test.case_project.not_null_stg_orders_ordered_at.ed431172ca"
[0m14:50:37.333053 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.not_null_stg_orders_ordered_at.ed431172ca"
[0m14:50:37.334051 [debug] [Thread-1 (]: On test.case_project.not_null_stg_orders_ordered_at.ed431172ca: BEGIN
[0m14:50:37.335052 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:50:37.336051 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:50:37.336051 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.not_null_stg_orders_ordered_at.ed431172ca"
[0m14:50:37.337051 [debug] [Thread-1 (]: On test.case_project.not_null_stg_orders_ordered_at.ed431172ca: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "test.case_project.not_null_stg_orders_ordered_at.ed431172ca"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ordered_at
from "warehouse"."main_staging"."stg_orders"
where ordered_at is null



  
  
      
    ) dbt_internal_test
[0m14:50:37.338541 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:50:37.338541 [debug] [Thread-1 (]: On test.case_project.not_null_stg_orders_ordered_at.ed431172ca: ROLLBACK
[0m14:50:37.338541 [debug] [Thread-1 (]: Failed to rollback 'test.case_project.not_null_stg_orders_ordered_at.ed431172ca'
[0m14:50:37.338541 [debug] [Thread-1 (]: On test.case_project.not_null_stg_orders_ordered_at.ed431172ca: Close
[0m14:50:37.338541 [info ] [Thread-1 (]: 12 of 23 PASS not_null_stg_orders_ordered_at ................................... [[32mPASS[0m in 0.02s]
[0m14:50:37.344643 [debug] [Thread-1 (]: Finished running node test.case_project.not_null_stg_orders_ordered_at.ed431172ca
[0m14:50:37.345652 [debug] [Thread-1 (]: Began running node test.case_project.not_null_stg_products_product_id.6373b0acf3
[0m14:50:37.345652 [info ] [Thread-1 (]: 13 of 23 START test not_null_stg_products_product_id ........................... [RUN]
[0m14:50:37.347652 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.case_project.not_null_stg_orders_ordered_at.ed431172ca, now test.case_project.not_null_stg_products_product_id.6373b0acf3)
[0m14:50:37.347652 [debug] [Thread-1 (]: Began compiling node test.case_project.not_null_stg_products_product_id.6373b0acf3
[0m14:50:37.354763 [debug] [Thread-1 (]: Writing injected SQL for node "test.case_project.not_null_stg_products_product_id.6373b0acf3"
[0m14:50:37.355767 [debug] [Thread-1 (]: Began executing node test.case_project.not_null_stg_products_product_id.6373b0acf3
[0m14:50:37.359763 [debug] [Thread-1 (]: Writing runtime sql for node "test.case_project.not_null_stg_products_product_id.6373b0acf3"
[0m14:50:37.360765 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.not_null_stg_products_product_id.6373b0acf3"
[0m14:50:37.361768 [debug] [Thread-1 (]: On test.case_project.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m14:50:37.362767 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:50:37.363771 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:50:37.364797 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.not_null_stg_products_product_id.6373b0acf3"
[0m14:50:37.364797 [debug] [Thread-1 (]: On test.case_project.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "test.case_project.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "warehouse"."main_staging"."stg_products"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m14:50:37.366770 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:50:37.367770 [debug] [Thread-1 (]: On test.case_project.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m14:50:37.367770 [debug] [Thread-1 (]: Failed to rollback 'test.case_project.not_null_stg_products_product_id.6373b0acf3'
[0m14:50:37.367770 [debug] [Thread-1 (]: On test.case_project.not_null_stg_products_product_id.6373b0acf3: Close
[0m14:50:37.367770 [info ] [Thread-1 (]: 13 of 23 PASS not_null_stg_products_product_id ................................. [[32mPASS[0m in 0.02s]
[0m14:50:37.372500 [debug] [Thread-1 (]: Finished running node test.case_project.not_null_stg_products_product_id.6373b0acf3
[0m14:50:37.372500 [debug] [Thread-1 (]: Began running node test.case_project.positive_value_stg_products_price.e6c8fbc631
[0m14:50:37.373538 [info ] [Thread-1 (]: 14 of 23 START test positive_value_stg_products_price .......................... [RUN]
[0m14:50:37.375242 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.case_project.not_null_stg_products_product_id.6373b0acf3, now test.case_project.positive_value_stg_products_price.e6c8fbc631)
[0m14:50:37.375688 [debug] [Thread-1 (]: Began compiling node test.case_project.positive_value_stg_products_price.e6c8fbc631
[0m14:50:37.382944 [debug] [Thread-1 (]: Compilation Error in test positive_value_stg_products_price (models\staging\schema.yml)
  'test_positive_value' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:50:37.383944 [error] [Thread-1 (]: 14 of 23 ERROR positive_value_stg_products_price ............................... [[31mERROR[0m in 0.01s]
[0m14:50:37.384945 [debug] [Thread-1 (]: Finished running node test.case_project.positive_value_stg_products_price.e6c8fbc631
[0m14:50:37.385945 [debug] [Thread-1 (]: Began running node test.case_project.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec
[0m14:50:37.386268 [debug] [Thread-4 (]: Marking all children of 'test.case_project.positive_value_stg_products_price.e6c8fbc631' to be skipped because of status 'error'.  Reason: Compilation Error in test positive_value_stg_products_price (models\staging\schema.yml)
  'test_positive_value' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m14:50:37.387269 [info ] [Thread-1 (]: 15 of 23 START test relationships_fct_order_items_order_id__order_id__ref_fct_orders_  [RUN]
[0m14:50:37.387785 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.case_project.positive_value_stg_products_price.e6c8fbc631, now test.case_project.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec)
[0m14:50:37.387785 [debug] [Thread-1 (]: Began compiling node test.case_project.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec
[0m14:50:37.400155 [debug] [Thread-1 (]: Writing injected SQL for node "test.case_project.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec"
[0m14:50:37.401165 [debug] [Thread-1 (]: Began executing node test.case_project.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec
[0m14:50:37.401987 [debug] [Thread-1 (]: Writing runtime sql for node "test.case_project.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec"
[0m14:50:37.407143 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec"
[0m14:50:37.407143 [debug] [Thread-1 (]: On test.case_project.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec: BEGIN
[0m14:50:37.408084 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:50:37.408861 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:50:37.409898 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec"
[0m14:50:37.410898 [debug] [Thread-1 (]: On test.case_project.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "test.case_project.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select order_id as from_field
    from "warehouse"."main_marts"."fct_order_items"
    where order_id is not null
),

parent as (
    select order_id as to_field
    from "warehouse"."main_marts"."fct_orders"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m14:50:37.411868 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "test.case_project.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select order_id as from_field
    from "warehouse"."main_marts"."fct_order_items"
    where order_id is not null
),

parent as (
    select order_id as to_field
    from "warehouse"."main_marts"."fct_orders"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m14:50:37.412897 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m14:50:37.413868 [debug] [Thread-1 (]: On test.case_project.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec: ROLLBACK
[0m14:50:37.418677 [debug] [Thread-1 (]: Failed to rollback 'test.case_project.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec'
[0m14:50:37.419675 [debug] [Thread-1 (]: On test.case_project.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec: Close
[0m14:50:37.421677 [debug] [Thread-1 (]: Runtime Error in test relationships_fct_order_items_order_id__order_id__ref_fct_orders_ (models\marts\schema.yml)
  Catalog Error: Table with name fct_order_items does not exist!
  Did you mean "fct_orders"?
  
  LINE 16:     from "warehouse"."main_marts"."fct_order_items"
                    ^
[0m14:50:37.422676 [error] [Thread-1 (]: 15 of 23 ERROR relationships_fct_order_items_order_id__order_id__ref_fct_orders_  [[31mERROR[0m in 0.03s]
[0m14:50:37.423676 [debug] [Thread-1 (]: Finished running node test.case_project.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec
[0m14:50:37.423676 [debug] [Thread-1 (]: Began running node test.case_project.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1
[0m14:50:37.424675 [debug] [Thread-4 (]: Marking all children of 'test.case_project.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec' to be skipped because of status 'error'.  Reason: Runtime Error in test relationships_fct_order_items_order_id__order_id__ref_fct_orders_ (models\marts\schema.yml)
  Catalog Error: Table with name fct_order_items does not exist!
  Did you mean "fct_orders"?
  
  LINE 16:     from "warehouse"."main_marts"."fct_order_items"
                    ^.
[0m14:50:37.425603 [info ] [Thread-1 (]: 16 of 23 START test relationships_fct_order_items_product_id__product_id__ref_dim_products_  [RUN]
[0m14:50:37.426609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.case_project.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec, now test.case_project.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1)
[0m14:50:37.427640 [debug] [Thread-1 (]: Began compiling node test.case_project.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1
[0m14:50:37.434608 [debug] [Thread-1 (]: Writing injected SQL for node "test.case_project.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1"
[0m14:50:37.435608 [debug] [Thread-1 (]: Began executing node test.case_project.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1
[0m14:50:37.439608 [debug] [Thread-1 (]: Writing runtime sql for node "test.case_project.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1"
[0m14:50:37.440608 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1"
[0m14:50:37.441608 [debug] [Thread-1 (]: On test.case_project.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1: BEGIN
[0m14:50:37.442608 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:50:37.443608 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:50:37.443608 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1"
[0m14:50:37.444609 [debug] [Thread-1 (]: On test.case_project.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "test.case_project.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_id as from_field
    from "warehouse"."main_marts"."fct_order_items"
    where product_id is not null
),

parent as (
    select product_id as to_field
    from "warehouse"."main_marts"."dim_products"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m14:50:37.445608 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "test.case_project.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_id as from_field
    from "warehouse"."main_marts"."fct_order_items"
    where product_id is not null
),

parent as (
    select product_id as to_field
    from "warehouse"."main_marts"."dim_products"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m14:50:37.446608 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m14:50:37.446608 [debug] [Thread-1 (]: On test.case_project.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1: ROLLBACK
[0m14:50:37.448608 [debug] [Thread-1 (]: Failed to rollback 'test.case_project.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1'
[0m14:50:37.449608 [debug] [Thread-1 (]: On test.case_project.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1: Close
[0m14:50:37.451608 [debug] [Thread-1 (]: Runtime Error in test relationships_fct_order_items_product_id__product_id__ref_dim_products_ (models\marts\schema.yml)
  Catalog Error: Table with name fct_order_items does not exist!
  Did you mean "fct_orders"?
  
  LINE 16:     from "warehouse"."main_marts"."fct_order_items"
                    ^
[0m14:50:37.452608 [error] [Thread-1 (]: 16 of 23 ERROR relationships_fct_order_items_product_id__product_id__ref_dim_products_  [[31mERROR[0m in 0.03s]
[0m14:50:37.453608 [debug] [Thread-1 (]: Finished running node test.case_project.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1
[0m14:50:37.454608 [debug] [Thread-1 (]: Began running node test.case_project.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m14:50:37.454608 [debug] [Thread-4 (]: Marking all children of 'test.case_project.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1' to be skipped because of status 'error'.  Reason: Runtime Error in test relationships_fct_order_items_product_id__product_id__ref_dim_products_ (models\marts\schema.yml)
  Catalog Error: Table with name fct_order_items does not exist!
  Did you mean "fct_orders"?
  
  LINE 16:     from "warehouse"."main_marts"."fct_order_items"
                    ^.
[0m14:50:37.455608 [info ] [Thread-1 (]: 17 of 23 START test relationships_fct_orders_customer_id__customer_id__ref_dim_customers_  [RUN]
[0m14:50:37.456610 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.case_project.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1, now test.case_project.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4)
[0m14:50:37.457608 [debug] [Thread-1 (]: Began compiling node test.case_project.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m14:50:37.465697 [debug] [Thread-1 (]: Writing injected SQL for node "test.case_project.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m14:50:37.467698 [debug] [Thread-1 (]: Began executing node test.case_project.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m14:50:37.470697 [debug] [Thread-1 (]: Writing runtime sql for node "test.case_project.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m14:50:37.472696 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m14:50:37.473697 [debug] [Thread-1 (]: On test.case_project.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: BEGIN
[0m14:50:37.473697 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:50:37.474726 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:50:37.475694 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m14:50:37.475694 [debug] [Thread-1 (]: On test.case_project.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "test.case_project.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from "warehouse"."main_marts"."fct_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "warehouse"."main_marts"."dim_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m14:50:37.482237 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m14:50:37.484589 [debug] [Thread-1 (]: On test.case_project.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: ROLLBACK
[0m14:50:37.485632 [debug] [Thread-1 (]: Failed to rollback 'test.case_project.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4'
[0m14:50:37.485632 [debug] [Thread-1 (]: On test.case_project.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: Close
[0m14:50:37.485632 [info ] [Thread-1 (]: 17 of 23 PASS relationships_fct_orders_customer_id__customer_id__ref_dim_customers_  [[32mPASS[0m in 0.03s]
[0m14:50:37.485632 [debug] [Thread-1 (]: Finished running node test.case_project.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m14:50:37.485632 [debug] [Thread-1 (]: Began running node test.case_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m14:50:37.485632 [info ] [Thread-1 (]: 18 of 23 START test unique_dim_customers_customer_id ........................... [RUN]
[0m14:50:37.490452 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.case_project.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4, now test.case_project.unique_dim_customers_customer_id.15c9f1e2fd)
[0m14:50:37.491461 [debug] [Thread-1 (]: Began compiling node test.case_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m14:50:37.498682 [debug] [Thread-1 (]: Writing injected SQL for node "test.case_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m14:50:37.500656 [debug] [Thread-1 (]: Began executing node test.case_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m14:50:37.503683 [debug] [Thread-1 (]: Writing runtime sql for node "test.case_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m14:50:37.505870 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m14:50:37.506444 [debug] [Thread-1 (]: On test.case_project.unique_dim_customers_customer_id.15c9f1e2fd: BEGIN
[0m14:50:37.507225 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:50:37.508264 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:50:37.509236 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m14:50:37.509236 [debug] [Thread-1 (]: On test.case_project.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "test.case_project.unique_dim_customers_customer_id.15c9f1e2fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "warehouse"."main_marts"."dim_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:50:37.513231 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:50:37.515615 [debug] [Thread-1 (]: On test.case_project.unique_dim_customers_customer_id.15c9f1e2fd: ROLLBACK
[0m14:50:37.515615 [debug] [Thread-1 (]: Failed to rollback 'test.case_project.unique_dim_customers_customer_id.15c9f1e2fd'
[0m14:50:37.517620 [debug] [Thread-1 (]: On test.case_project.unique_dim_customers_customer_id.15c9f1e2fd: Close
[0m14:50:37.518305 [info ] [Thread-1 (]: 18 of 23 PASS unique_dim_customers_customer_id ................................. [[32mPASS[0m in 0.03s]
[0m14:50:37.519154 [debug] [Thread-1 (]: Finished running node test.case_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m14:50:37.519154 [debug] [Thread-1 (]: Began running node test.case_project.unique_dim_products_product_id.ef7b2a9985
[0m14:50:37.519154 [info ] [Thread-1 (]: 19 of 23 START test unique_dim_products_product_id ............................. [RUN]
[0m14:50:37.519154 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.case_project.unique_dim_customers_customer_id.15c9f1e2fd, now test.case_project.unique_dim_products_product_id.ef7b2a9985)
[0m14:50:37.519154 [debug] [Thread-1 (]: Began compiling node test.case_project.unique_dim_products_product_id.ef7b2a9985
[0m14:50:37.528278 [debug] [Thread-1 (]: Writing injected SQL for node "test.case_project.unique_dim_products_product_id.ef7b2a9985"
[0m14:50:37.529279 [debug] [Thread-1 (]: Began executing node test.case_project.unique_dim_products_product_id.ef7b2a9985
[0m14:50:37.533278 [debug] [Thread-1 (]: Writing runtime sql for node "test.case_project.unique_dim_products_product_id.ef7b2a9985"
[0m14:50:37.534251 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.unique_dim_products_product_id.ef7b2a9985"
[0m14:50:37.535252 [debug] [Thread-1 (]: On test.case_project.unique_dim_products_product_id.ef7b2a9985: BEGIN
[0m14:50:37.535252 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:50:37.536249 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:50:37.537280 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.unique_dim_products_product_id.ef7b2a9985"
[0m14:50:37.537985 [debug] [Thread-1 (]: On test.case_project.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "test.case_project.unique_dim_products_product_id.ef7b2a9985"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "warehouse"."main_marts"."dim_products"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:50:37.542052 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:50:37.544051 [debug] [Thread-1 (]: On test.case_project.unique_dim_products_product_id.ef7b2a9985: ROLLBACK
[0m14:50:37.545052 [debug] [Thread-1 (]: Failed to rollback 'test.case_project.unique_dim_products_product_id.ef7b2a9985'
[0m14:50:37.545052 [debug] [Thread-1 (]: On test.case_project.unique_dim_products_product_id.ef7b2a9985: Close
[0m14:50:37.546052 [info ] [Thread-1 (]: 19 of 23 PASS unique_dim_products_product_id ................................... [[32mPASS[0m in 0.03s]
[0m14:50:37.547055 [debug] [Thread-1 (]: Finished running node test.case_project.unique_dim_products_product_id.ef7b2a9985
[0m14:50:37.548053 [debug] [Thread-1 (]: Began running node test.case_project.unique_fct_orders_order_id.523ddb6ce5
[0m14:50:37.549054 [info ] [Thread-1 (]: 20 of 23 START test unique_fct_orders_order_id ................................. [RUN]
[0m14:50:37.550083 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.case_project.unique_dim_products_product_id.ef7b2a9985, now test.case_project.unique_fct_orders_order_id.523ddb6ce5)
[0m14:50:37.550083 [debug] [Thread-1 (]: Began compiling node test.case_project.unique_fct_orders_order_id.523ddb6ce5
[0m14:50:37.556083 [debug] [Thread-1 (]: Writing injected SQL for node "test.case_project.unique_fct_orders_order_id.523ddb6ce5"
[0m14:50:37.556770 [debug] [Thread-1 (]: Began executing node test.case_project.unique_fct_orders_order_id.523ddb6ce5
[0m14:50:37.562555 [debug] [Thread-1 (]: Writing runtime sql for node "test.case_project.unique_fct_orders_order_id.523ddb6ce5"
[0m14:50:37.563565 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.unique_fct_orders_order_id.523ddb6ce5"
[0m14:50:37.564561 [debug] [Thread-1 (]: On test.case_project.unique_fct_orders_order_id.523ddb6ce5: BEGIN
[0m14:50:37.565564 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:50:37.565564 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:50:37.566591 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.unique_fct_orders_order_id.523ddb6ce5"
[0m14:50:37.567562 [debug] [Thread-1 (]: On test.case_project.unique_fct_orders_order_id.523ddb6ce5: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "test.case_project.unique_fct_orders_order_id.523ddb6ce5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "warehouse"."main_marts"."fct_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:50:37.580689 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m14:50:37.582689 [debug] [Thread-1 (]: On test.case_project.unique_fct_orders_order_id.523ddb6ce5: ROLLBACK
[0m14:50:37.583691 [debug] [Thread-1 (]: Failed to rollback 'test.case_project.unique_fct_orders_order_id.523ddb6ce5'
[0m14:50:37.583691 [debug] [Thread-1 (]: On test.case_project.unique_fct_orders_order_id.523ddb6ce5: Close
[0m14:50:37.584721 [info ] [Thread-1 (]: 20 of 23 PASS unique_fct_orders_order_id ....................................... [[32mPASS[0m in 0.04s]
[0m14:50:37.585688 [debug] [Thread-1 (]: Finished running node test.case_project.unique_fct_orders_order_id.523ddb6ce5
[0m14:50:37.586719 [debug] [Thread-1 (]: Began running node test.case_project.unique_stg_customers_customer_id.c7614daada
[0m14:50:37.587689 [info ] [Thread-1 (]: 21 of 23 START test unique_stg_customers_customer_id ........................... [RUN]
[0m14:50:37.587689 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.case_project.unique_fct_orders_order_id.523ddb6ce5, now test.case_project.unique_stg_customers_customer_id.c7614daada)
[0m14:50:37.588904 [debug] [Thread-1 (]: Began compiling node test.case_project.unique_stg_customers_customer_id.c7614daada
[0m14:50:37.593904 [debug] [Thread-1 (]: Writing injected SQL for node "test.case_project.unique_stg_customers_customer_id.c7614daada"
[0m14:50:37.594904 [debug] [Thread-1 (]: Began executing node test.case_project.unique_stg_customers_customer_id.c7614daada
[0m14:50:37.594904 [debug] [Thread-1 (]: Writing runtime sql for node "test.case_project.unique_stg_customers_customer_id.c7614daada"
[0m14:50:37.594904 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.unique_stg_customers_customer_id.c7614daada"
[0m14:50:37.594904 [debug] [Thread-1 (]: On test.case_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m14:50:37.594904 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:50:37.594904 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:50:37.594904 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.unique_stg_customers_customer_id.c7614daada"
[0m14:50:37.594904 [debug] [Thread-1 (]: On test.case_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "test.case_project.unique_stg_customers_customer_id.c7614daada"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "warehouse"."main_staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:50:37.594904 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:50:37.594904 [debug] [Thread-1 (]: On test.case_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m14:50:37.610590 [debug] [Thread-1 (]: Failed to rollback 'test.case_project.unique_stg_customers_customer_id.c7614daada'
[0m14:50:37.611366 [debug] [Thread-1 (]: On test.case_project.unique_stg_customers_customer_id.c7614daada: Close
[0m14:50:37.612404 [info ] [Thread-1 (]: 21 of 23 PASS unique_stg_customers_customer_id ................................. [[32mPASS[0m in 0.02s]
[0m14:50:37.613375 [debug] [Thread-1 (]: Finished running node test.case_project.unique_stg_customers_customer_id.c7614daada
[0m14:50:37.614464 [debug] [Thread-1 (]: Began running node test.case_project.unique_stg_orders_order_id.e3b841c71a
[0m14:50:37.615425 [info ] [Thread-1 (]: 22 of 23 START test unique_stg_orders_order_id ................................. [RUN]
[0m14:50:37.616402 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.case_project.unique_stg_customers_customer_id.c7614daada, now test.case_project.unique_stg_orders_order_id.e3b841c71a)
[0m14:50:37.616887 [debug] [Thread-1 (]: Began compiling node test.case_project.unique_stg_orders_order_id.e3b841c71a
[0m14:50:37.622478 [debug] [Thread-1 (]: Writing injected SQL for node "test.case_project.unique_stg_orders_order_id.e3b841c71a"
[0m14:50:37.623479 [debug] [Thread-1 (]: Began executing node test.case_project.unique_stg_orders_order_id.e3b841c71a
[0m14:50:37.624111 [debug] [Thread-1 (]: Writing runtime sql for node "test.case_project.unique_stg_orders_order_id.e3b841c71a"
[0m14:50:37.629391 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.unique_stg_orders_order_id.e3b841c71a"
[0m14:50:37.629391 [debug] [Thread-1 (]: On test.case_project.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m14:50:37.630268 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:50:37.630922 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:50:37.631959 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.unique_stg_orders_order_id.e3b841c71a"
[0m14:50:37.632959 [debug] [Thread-1 (]: On test.case_project.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "test.case_project.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "warehouse"."main_staging"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:50:37.644262 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m14:50:37.646983 [debug] [Thread-1 (]: On test.case_project.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m14:50:37.646983 [debug] [Thread-1 (]: Failed to rollback 'test.case_project.unique_stg_orders_order_id.e3b841c71a'
[0m14:50:37.646983 [debug] [Thread-1 (]: On test.case_project.unique_stg_orders_order_id.e3b841c71a: Close
[0m14:50:37.648988 [info ] [Thread-1 (]: 22 of 23 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 0.03s]
[0m14:50:37.650236 [debug] [Thread-1 (]: Finished running node test.case_project.unique_stg_orders_order_id.e3b841c71a
[0m14:50:37.651270 [debug] [Thread-1 (]: Began running node test.case_project.unique_stg_products_product_id.7d950a1467
[0m14:50:37.652246 [info ] [Thread-1 (]: 23 of 23 START test unique_stg_products_product_id ............................. [RUN]
[0m14:50:37.652246 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.case_project.unique_stg_orders_order_id.e3b841c71a, now test.case_project.unique_stg_products_product_id.7d950a1467)
[0m14:50:37.653273 [debug] [Thread-1 (]: Began compiling node test.case_project.unique_stg_products_product_id.7d950a1467
[0m14:50:37.658439 [debug] [Thread-1 (]: Writing injected SQL for node "test.case_project.unique_stg_products_product_id.7d950a1467"
[0m14:50:37.660410 [debug] [Thread-1 (]: Began executing node test.case_project.unique_stg_products_product_id.7d950a1467
[0m14:50:37.663473 [debug] [Thread-1 (]: Writing runtime sql for node "test.case_project.unique_stg_products_product_id.7d950a1467"
[0m14:50:37.665583 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.unique_stg_products_product_id.7d950a1467"
[0m14:50:37.666316 [debug] [Thread-1 (]: On test.case_project.unique_stg_products_product_id.7d950a1467: BEGIN
[0m14:50:37.666316 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:50:37.667349 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:50:37.668348 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.unique_stg_products_product_id.7d950a1467"
[0m14:50:37.669320 [debug] [Thread-1 (]: On test.case_project.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "test.case_project.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "warehouse"."main_staging"."stg_products"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:50:37.672318 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:50:37.672955 [debug] [Thread-1 (]: On test.case_project.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m14:50:37.672955 [debug] [Thread-1 (]: Failed to rollback 'test.case_project.unique_stg_products_product_id.7d950a1467'
[0m14:50:37.672955 [debug] [Thread-1 (]: On test.case_project.unique_stg_products_product_id.7d950a1467: Close
[0m14:50:37.672955 [info ] [Thread-1 (]: 23 of 23 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.02s]
[0m14:50:37.677916 [debug] [Thread-1 (]: Finished running node test.case_project.unique_stg_products_product_id.7d950a1467
[0m14:50:37.678664 [debug] [MainThread]: Using duckdb connection "master"
[0m14:50:37.678664 [debug] [MainThread]: On master: BEGIN
[0m14:50:37.678664 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:50:37.678664 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:50:37.678664 [debug] [MainThread]: On master: COMMIT
[0m14:50:37.678664 [debug] [MainThread]: Using duckdb connection "master"
[0m14:50:37.678664 [debug] [MainThread]: On master: COMMIT
[0m14:50:37.678664 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:50:37.678664 [debug] [MainThread]: On master: Close
[0m14:50:37.684861 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:50:37.685898 [debug] [MainThread]: Connection 'list_warehouse_main_staging' was properly closed.
[0m14:50:37.685898 [debug] [MainThread]: Connection 'test.case_project.unique_stg_products_product_id.7d950a1467' was properly closed.
[0m14:50:37.686898 [info ] [MainThread]: 
[0m14:50:37.687870 [info ] [MainThread]: Finished running 23 data tests in 0 hours 0 minutes and 0.97 seconds (0.97s).
[0m14:50:37.692664 [debug] [MainThread]: Command end result
[0m14:50:37.730777 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\manss\Desktop\Case Project\target\manifest.json
[0m14:50:37.733774 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\manss\Desktop\Case Project\target\semantic_manifest.json
[0m14:50:37.733774 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\manss\Desktop\Case Project\target\run_results.json
[0m14:50:37.733774 [info ] [MainThread]: 
[0m14:50:37.733774 [info ] [MainThread]: [31mCompleted with 7 errors, 0 partial successes, and 0 warnings:[0m
[0m14:50:37.733774 [info ] [MainThread]: 
[0m14:50:37.733774 [error] [MainThread]: [31mFailure in test accepted_range_fct_order_items_quantity__1 (models\marts\schema.yml)[0m
[0m14:50:37.749536 [error] [MainThread]:   Compilation Error in test accepted_range_fct_order_items_quantity__1 (models\marts\schema.yml)
  'test_accepted_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:50:37.749536 [info ] [MainThread]: 
[0m14:50:37.750687 [error] [MainThread]: [31mFailure in test accepted_range_fct_order_items_unit_price__0 (models\marts\schema.yml)[0m
[0m14:50:37.751722 [error] [MainThread]:   Compilation Error in test accepted_range_fct_order_items_unit_price__0 (models\marts\schema.yml)
  'test_accepted_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:50:37.752686 [info ] [MainThread]: 
[0m14:50:37.753687 [error] [MainThread]: [31mFailure in test accepted_range_stg_items_quantity__1 (models\staging\schema.yml)[0m
[0m14:50:37.754690 [error] [MainThread]:   Compilation Error in test accepted_range_stg_items_quantity__1 (models\staging\schema.yml)
  'test_accepted_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:50:37.755689 [info ] [MainThread]: 
[0m14:50:37.755689 [error] [MainThread]: [31mFailure in test accepted_range_stg_items_unit_price__0 (models\staging\schema.yml)[0m
[0m14:50:37.756687 [error] [MainThread]:   Compilation Error in test accepted_range_stg_items_unit_price__0 (models\staging\schema.yml)
  'test_accepted_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:50:37.757686 [info ] [MainThread]: 
[0m14:50:37.758686 [error] [MainThread]: [31mFailure in test positive_value_stg_products_price (models\staging\schema.yml)[0m
[0m14:50:37.758686 [error] [MainThread]:   Compilation Error in test positive_value_stg_products_price (models\staging\schema.yml)
  'test_positive_value' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:50:37.759816 [info ] [MainThread]: 
[0m14:50:37.760815 [error] [MainThread]: [31mFailure in test relationships_fct_order_items_order_id__order_id__ref_fct_orders_ (models\marts\schema.yml)[0m
[0m14:50:37.761816 [error] [MainThread]:   Runtime Error in test relationships_fct_order_items_order_id__order_id__ref_fct_orders_ (models\marts\schema.yml)
  Catalog Error: Table with name fct_order_items does not exist!
  Did you mean "fct_orders"?
  
  LINE 16:     from "warehouse"."main_marts"."fct_order_items"
                    ^
[0m14:50:37.761816 [info ] [MainThread]: 
[0m14:50:37.762816 [info ] [MainThread]:   compiled code at target\compiled\case_project\models\marts\schema.yml\relationships_fct_order_items_6605ef9332585c82f278ac817835eb79.sql
[0m14:50:37.763817 [info ] [MainThread]: 
[0m14:50:37.764815 [error] [MainThread]: [31mFailure in test relationships_fct_order_items_product_id__product_id__ref_dim_products_ (models\marts\schema.yml)[0m
[0m14:50:37.765816 [error] [MainThread]:   Runtime Error in test relationships_fct_order_items_product_id__product_id__ref_dim_products_ (models\marts\schema.yml)
  Catalog Error: Table with name fct_order_items does not exist!
  Did you mean "fct_orders"?
  
  LINE 16:     from "warehouse"."main_marts"."fct_order_items"
                    ^
[0m14:50:37.765816 [info ] [MainThread]: 
[0m14:50:37.766816 [info ] [MainThread]:   compiled code at target\compiled\case_project\models\marts\schema.yml\relationships_fct_order_items_b0f28835da40fb8b0928f9f26aa86d50.sql
[0m14:50:37.767815 [info ] [MainThread]: 
[0m14:50:37.768817 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=7 SKIP=0 NO-OP=0 TOTAL=23
[0m14:50:37.769816 [debug] [MainThread]: Command `dbt test` failed at 14:50:37.769816 after 2.67 seconds
[0m14:50:37.770817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED4F6D31C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED51A51DE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED51968C10>]}
[0m14:50:37.770817 [debug] [MainThread]: Flushing usage events
[0m14:50:38.446545 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:54:27.213734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E501C531F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E503F53BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E503F53D90>]}


============================== 14:54:27.213734 | 1ec5d17c-0de9-402a-b4a4-a1c9b070b8f7 ==============================
[0m14:54:27.213734 [info ] [MainThread]: Running with dbt=1.10.9
[0m14:54:27.213734 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\manss\\Desktop\\Case Project\\logs', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': 'C:\\Users\\manss\\Desktop\\Case Project'}
[0m14:54:27.517085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ec5d17c-0de9-402a-b4a4-a1c9b070b8f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E50412FAC0>]}
[0m14:54:27.586779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1ec5d17c-0de9-402a-b4a4-a1c9b070b8f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E503E976A0>]}
[0m14:54:27.602519 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:54:27.956505 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m14:54:28.283219 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m14:54:28.284219 [debug] [MainThread]: Partial parsing: updated file: case_project://models\marts\schema.yml
[0m14:54:28.285219 [debug] [MainThread]: Partial parsing: updated file: case_project://models\staging\schema.yml
[0m14:54:28.665309 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m14:54:28.665309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1ec5d17c-0de9-402a-b4a4-a1c9b070b8f7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E50575F2B0>]}
[0m14:54:28.946636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ec5d17c-0de9-402a-b4a4-a1c9b070b8f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E505881270>]}
[0m14:54:29.098285 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\manss\Desktop\Case Project\target\manifest.json
[0m14:54:29.098285 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\manss\Desktop\Case Project\target\semantic_manifest.json
[0m14:54:29.130209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ec5d17c-0de9-402a-b4a4-a1c9b070b8f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E505880730>]}
[0m14:54:29.130209 [info ] [MainThread]: Found 4 seeds, 8 models, 18 data tests, 4 sources, 429 macros
[0m14:54:29.130209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ec5d17c-0de9-402a-b4a4-a1c9b070b8f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E505882A40>]}
[0m14:54:29.147215 [info ] [MainThread]: 
[0m14:54:29.148245 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:54:29.149214 [info ] [MainThread]: 
[0m14:54:29.150315 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:54:29.160335 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m14:54:29.373206 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m14:54:29.374205 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m14:54:29.375204 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:54:29.384884 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m14:54:29.384884 [debug] [ThreadPool]: On list_warehouse: Close
[0m14:54:29.384884 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m14:54:29.384884 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m14:54:29.384884 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:54:29.384884 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:54:29.400942 [debug] [ThreadPool]: On list_warehouse: Close
[0m14:54:29.400942 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_marts)
[0m14:54:29.400942 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_marts"
"
[0m14:54:29.400942 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m14:54:29.400942 [debug] [ThreadPool]: On create_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_marts"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m14:54:29.400942 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:54:29.400942 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:54:29.400942 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m14:54:29.400942 [debug] [ThreadPool]: On create_warehouse_main_marts: BEGIN
[0m14:54:29.400942 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:54:29.416944 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m14:54:29.416944 [debug] [ThreadPool]: On create_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_marts"} */

    
    
        create schema if not exists "warehouse"."main_marts"
    
[0m14:54:29.418120 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:54:29.419121 [debug] [ThreadPool]: On create_warehouse_main_marts: COMMIT
[0m14:54:29.420122 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m14:54:29.420122 [debug] [ThreadPool]: On create_warehouse_main_marts: COMMIT
[0m14:54:29.421092 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:54:29.422122 [debug] [ThreadPool]: On create_warehouse_main_marts: Close
[0m14:54:29.423096 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_warehouse_main_marts, now create_warehouse_main_staging)
[0m14:54:29.423096 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_staging"
"
[0m14:54:29.426121 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m14:54:29.427121 [debug] [ThreadPool]: On create_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m14:54:29.427121 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:54:29.428121 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:54:29.430119 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m14:54:29.430119 [debug] [ThreadPool]: On create_warehouse_main_staging: BEGIN
[0m14:54:29.431094 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:54:29.431094 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m14:54:29.431094 [debug] [ThreadPool]: On create_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_staging"} */

    
    
        create schema if not exists "warehouse"."main_staging"
    
[0m14:54:29.431094 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:54:29.431094 [debug] [ThreadPool]: On create_warehouse_main_staging: COMMIT
[0m14:54:29.431094 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m14:54:29.431094 [debug] [ThreadPool]: On create_warehouse_main_staging: COMMIT
[0m14:54:29.431094 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:54:29.431094 [debug] [ThreadPool]: On create_warehouse_main_staging: Close
[0m14:54:29.431094 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_marts'
[0m14:54:29.431094 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m14:54:29.447186 [debug] [ThreadPool]: On list_warehouse_main_marts: BEGIN
[0m14:54:29.447186 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:54:29.447186 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:54:29.447186 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m14:54:29.447186 [debug] [ThreadPool]: On list_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_marts"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'warehouse'
  
[0m14:54:29.463059 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m14:54:29.464769 [debug] [ThreadPool]: On list_warehouse_main_marts: ROLLBACK
[0m14:54:29.465732 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_marts'
[0m14:54:29.466794 [debug] [ThreadPool]: On list_warehouse_main_marts: Close
[0m14:54:29.466794 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_marts, now list_warehouse_main_staging)
[0m14:54:29.470824 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_staging"
[0m14:54:29.470824 [debug] [ThreadPool]: On list_warehouse_main_staging: BEGIN
[0m14:54:29.471795 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:54:29.472706 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:54:29.472706 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_staging"
[0m14:54:29.472706 [debug] [ThreadPool]: On list_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_staging"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'warehouse'
  
[0m14:54:29.472706 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m14:54:29.472706 [debug] [ThreadPool]: On list_warehouse_main_staging: ROLLBACK
[0m14:54:29.472706 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_staging'
[0m14:54:29.472706 [debug] [ThreadPool]: On list_warehouse_main_staging: Close
[0m14:54:29.472706 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_staging, now list_warehouse_main_raw)
[0m14:54:29.472706 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m14:54:29.472706 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m14:54:29.472706 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:54:29.472706 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:54:29.487923 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m14:54:29.487923 [debug] [ThreadPool]: On list_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_raw"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'warehouse'
  
[0m14:54:29.487923 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m14:54:29.487923 [debug] [ThreadPool]: On list_warehouse_main_raw: ROLLBACK
[0m14:54:29.487923 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_raw'
[0m14:54:29.487923 [debug] [ThreadPool]: On list_warehouse_main_raw: Close
[0m14:54:29.487923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ec5d17c-0de9-402a-b4a4-a1c9b070b8f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E503F52200>]}
[0m14:54:29.487923 [debug] [MainThread]: Using duckdb connection "master"
[0m14:54:29.487923 [debug] [MainThread]: On master: BEGIN
[0m14:54:29.498293 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:54:29.498293 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:54:29.498293 [debug] [MainThread]: On master: COMMIT
[0m14:54:29.498293 [debug] [MainThread]: Using duckdb connection "master"
[0m14:54:29.498293 [debug] [MainThread]: On master: COMMIT
[0m14:54:29.498293 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:54:29.498293 [debug] [MainThread]: On master: Close
[0m14:54:29.506887 [debug] [Thread-1 (]: Began running node model.case_project.stg_customers
[0m14:54:29.507894 [info ] [Thread-1 (]: 1 of 8 START sql view model main_staging.stg_customers ......................... [RUN]
[0m14:54:29.508892 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.case_project.stg_customers'
[0m14:54:29.509992 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_customers
[0m14:54:29.519991 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_customers"
[0m14:54:29.520992 [debug] [Thread-1 (]: Began executing node model.case_project.stg_customers
[0m14:54:29.549359 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_customers"
[0m14:54:29.549359 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m14:54:29.549359 [debug] [Thread-1 (]: On model.case_project.stg_customers: BEGIN
[0m14:54:29.549359 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:54:29.562660 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:54:29.562660 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m14:54:29.563832 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */

  
  create view "warehouse"."main_staging"."stg_customers__dbt_tmp" as (
    -- models/staging/stg_customers.sql
with src as (
  select * from "warehouse"."main_raw"."raw_customers"
),
clean as (
  select
    cast(id as varchar) as customer_id,
    regexp_replace(name, '^(Mr\.|Mrs\.|Ms\.|Dr\.|MD)\s+', '') as clean_name
  from src
)
select
  customer_id,
  split_part(clean_name, ' ', 1) as first_name,
  split_part(clean_name, ' ', 2) as last_name
from clean
  );

[0m14:54:29.564833 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:54:29.573192 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m14:54:29.574192 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */
alter view "warehouse"."main_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m14:54:29.575164 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:54:29.578997 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m14:54:29.580000 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */
alter view "warehouse"."main_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m14:54:29.580968 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:54:29.596073 [debug] [Thread-1 (]: On model.case_project.stg_customers: COMMIT
[0m14:54:29.597074 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m14:54:29.598074 [debug] [Thread-1 (]: On model.case_project.stg_customers: COMMIT
[0m14:54:29.601104 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:54:29.609734 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m14:54:29.610733 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */

      drop view if exists "warehouse"."main_staging"."stg_customers__dbt_backup" cascade
    
[0m14:54:29.611622 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:54:29.614409 [debug] [Thread-1 (]: On model.case_project.stg_customers: Close
[0m14:54:29.616414 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ec5d17c-0de9-402a-b4a4-a1c9b070b8f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E500244160>]}
[0m14:54:29.616414 [info ] [Thread-1 (]: 1 of 8 OK created sql view model main_staging.stg_customers .................... [[32mOK[0m in 0.11s]
[0m14:54:29.616414 [debug] [Thread-1 (]: Finished running node model.case_project.stg_customers
[0m14:54:29.616414 [debug] [Thread-1 (]: Began running node model.case_project.stg_items
[0m14:54:29.616414 [info ] [Thread-1 (]: 2 of 8 START sql view model main_staging.stg_items ............................. [RUN]
[0m14:54:29.616414 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_customers, now model.case_project.stg_items)
[0m14:54:29.616414 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_items
[0m14:54:29.627333 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_items"
[0m14:54:29.628880 [debug] [Thread-1 (]: Began executing node model.case_project.stg_items
[0m14:54:29.633389 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_items"
[0m14:54:29.633389 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m14:54:29.633389 [debug] [Thread-1 (]: On model.case_project.stg_items: BEGIN
[0m14:54:29.633389 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:29.633389 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:54:29.633389 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m14:54:29.639297 [debug] [Thread-1 (]: On model.case_project.stg_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_items"} */

  
  create view "warehouse"."main_staging"."stg_items__dbt_tmp" as (
    -- models/staging/stg_items.sql
with src as (
  select * from "warehouse"."main_raw"."raw_items"
)
select
  cast(id as varchar)        as item_id,
  cast(order_id as varchar)  as order_id,
  cast(sku as varchar)       as product_id,
  1                          as quantity
from src
  );

[0m14:54:29.640337 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:54:29.644333 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m14:54:29.644333 [debug] [Thread-1 (]: On model.case_project.stg_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_items"} */
alter view "warehouse"."main_staging"."stg_items" rename to "stg_items__dbt_backup"
[0m14:54:29.645334 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:54:29.649537 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m14:54:29.650538 [debug] [Thread-1 (]: On model.case_project.stg_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_items"} */
alter view "warehouse"."main_staging"."stg_items__dbt_tmp" rename to "stg_items"
[0m14:54:29.651537 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:54:29.653509 [debug] [Thread-1 (]: On model.case_project.stg_items: COMMIT
[0m14:54:29.653509 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m14:54:29.654508 [debug] [Thread-1 (]: On model.case_project.stg_items: COMMIT
[0m14:54:29.656282 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:54:29.660075 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m14:54:29.661032 [debug] [Thread-1 (]: On model.case_project.stg_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_items"} */

      drop view if exists "warehouse"."main_staging"."stg_items__dbt_backup" cascade
    
[0m14:54:29.661032 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:54:29.664310 [debug] [Thread-1 (]: On model.case_project.stg_items: Close
[0m14:54:29.664310 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ec5d17c-0de9-402a-b4a4-a1c9b070b8f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E505E51180>]}
[0m14:54:29.666317 [info ] [Thread-1 (]: 2 of 8 OK created sql view model main_staging.stg_items ........................ [[32mOK[0m in 0.05s]
[0m14:54:29.667024 [debug] [Thread-1 (]: Finished running node model.case_project.stg_items
[0m14:54:29.668060 [debug] [Thread-1 (]: Began running node model.case_project.stg_orders
[0m14:54:29.669031 [info ] [Thread-1 (]: 3 of 8 START sql view model main_staging.stg_orders ............................ [RUN]
[0m14:54:29.669031 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_items, now model.case_project.stg_orders)
[0m14:54:29.670028 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_orders
[0m14:54:29.674029 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_orders"
[0m14:54:29.675312 [debug] [Thread-1 (]: Began executing node model.case_project.stg_orders
[0m14:54:29.682342 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_orders"
[0m14:54:29.683552 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m14:54:29.684553 [debug] [Thread-1 (]: On model.case_project.stg_orders: BEGIN
[0m14:54:29.685554 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:29.686552 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:54:29.686552 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m14:54:29.687552 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */

  
  create view "warehouse"."main_staging"."stg_orders__dbt_tmp" as (
    with src as (
  select * from "warehouse"."main_raw"."raw_orders"
)
select
  cast(id as varchar)                 as order_id,
  cast(customer as varchar)           as customer_id,
  cast(store_id as varchar)           as store_id,
  cast(ordered_at as timestamp)       as ordered_at,
  cast(subtotal as double)            as subtotal,
  cast(tax_paid as double)            as tax_paid,
  cast(order_total as double)         as order_total
from src
  );

[0m14:54:29.688553 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:54:29.693553 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m14:54:29.693553 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */
alter view "warehouse"."main_staging"."stg_orders" rename to "stg_orders__dbt_backup"
[0m14:54:29.694550 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:54:29.698668 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m14:54:29.699665 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */
alter view "warehouse"."main_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m14:54:29.700666 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:54:29.702667 [debug] [Thread-1 (]: On model.case_project.stg_orders: COMMIT
[0m14:54:29.703665 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m14:54:29.703665 [debug] [Thread-1 (]: On model.case_project.stg_orders: COMMIT
[0m14:54:29.705843 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:54:29.709848 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m14:54:29.710847 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */

      drop view if exists "warehouse"."main_staging"."stg_orders__dbt_backup" cascade
    
[0m14:54:29.711849 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:54:29.713849 [debug] [Thread-1 (]: On model.case_project.stg_orders: Close
[0m14:54:29.714849 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ec5d17c-0de9-402a-b4a4-a1c9b070b8f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E500244160>]}
[0m14:54:29.715848 [info ] [Thread-1 (]: 3 of 8 OK created sql view model main_staging.stg_orders ....................... [[32mOK[0m in 0.05s]
[0m14:54:29.715848 [debug] [Thread-1 (]: Finished running node model.case_project.stg_orders
[0m14:54:29.715848 [debug] [Thread-1 (]: Began running node model.case_project.stg_products
[0m14:54:29.715848 [info ] [Thread-1 (]: 4 of 8 START sql view model main_staging.stg_products .......................... [RUN]
[0m14:54:29.715848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_orders, now model.case_project.stg_products)
[0m14:54:29.715848 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_products
[0m14:54:29.715848 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_products"
[0m14:54:29.715848 [debug] [Thread-1 (]: Began executing node model.case_project.stg_products
[0m14:54:29.715848 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_products"
[0m14:54:29.715848 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m14:54:29.731632 [debug] [Thread-1 (]: On model.case_project.stg_products: BEGIN
[0m14:54:29.732754 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:29.732754 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:54:29.733752 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m14:54:29.734756 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */

  
  create view "warehouse"."main_staging"."stg_products__dbt_tmp" as (
    -- models/staging/stg_products.sql
with src as (select * from "warehouse"."main_raw"."raw_products")
select
  cast(sku as varchar)      as product_id,
  lower(trim(name))        as product_name,
  cast(price as double)    as price
from src
  );

[0m14:54:29.735723 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:54:29.740721 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m14:54:29.740721 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */
alter view "warehouse"."main_staging"."stg_products" rename to "stg_products__dbt_backup"
[0m14:54:29.741723 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:54:29.747881 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m14:54:29.748886 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */
alter view "warehouse"."main_staging"."stg_products__dbt_tmp" rename to "stg_products"
[0m14:54:29.749881 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:54:29.751852 [debug] [Thread-1 (]: On model.case_project.stg_products: COMMIT
[0m14:54:29.752850 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m14:54:29.752850 [debug] [Thread-1 (]: On model.case_project.stg_products: COMMIT
[0m14:54:29.754850 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:54:29.758851 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m14:54:29.758851 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */

      drop view if exists "warehouse"."main_staging"."stg_products__dbt_backup" cascade
    
[0m14:54:29.758851 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:54:29.758851 [debug] [Thread-1 (]: On model.case_project.stg_products: Close
[0m14:54:29.764266 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ec5d17c-0de9-402a-b4a4-a1c9b070b8f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E505DF0040>]}
[0m14:54:29.765273 [info ] [Thread-1 (]: 4 of 8 OK created sql view model main_staging.stg_products ..................... [[32mOK[0m in 0.04s]
[0m14:54:29.766271 [debug] [Thread-1 (]: Finished running node model.case_project.stg_products
[0m14:54:29.767272 [debug] [Thread-1 (]: Began running node model.case_project.dim_customers
[0m14:54:29.768272 [info ] [Thread-1 (]: 5 of 8 START sql table model main_marts.dim_customers .......................... [RUN]
[0m14:54:29.768986 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_products, now model.case_project.dim_customers)
[0m14:54:29.770022 [debug] [Thread-1 (]: Began compiling node model.case_project.dim_customers
[0m14:54:29.774044 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.dim_customers"
[0m14:54:29.775044 [debug] [Thread-1 (]: Began executing node model.case_project.dim_customers
[0m14:54:29.799725 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.dim_customers"
[0m14:54:29.799725 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m14:54:29.799725 [debug] [Thread-1 (]: On model.case_project.dim_customers: BEGIN
[0m14:54:29.799725 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:29.805980 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:54:29.807018 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m14:54:29.807990 [debug] [Thread-1 (]: On model.case_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_customers"} */

  
    
    

    create  table
      "warehouse"."main_marts"."dim_customers__dbt_tmp"
  
    as (
      -- models/marts/dim_customers.sql


with base as (
    select
        customer_id,
        first_name,
        last_name,
        (first_name || ' ' || coalesce(last_name, '')) as customer_name
    from "warehouse"."main_staging"."stg_customers"
),

orders as (
    select
        customer_id,
        min(ordered_at) as first_order_at,
        max(ordered_at) as most_recent_order_at,
        count(*)        as order_count,
        sum(order_total) as lifetime_value
    from "warehouse"."main_staging"."stg_orders"
    group by 1
)

select
    b.customer_id,
    b.first_name,
    b.last_name,
    b.customer_name,
    o.first_order_at,
    o.most_recent_order_at,
    coalesce(o.order_count, 0)      as order_count,
    coalesce(o.lifetime_value, 0.0) as lifetime_value
from base b
left join orders o using (customer_id)
    );
  
  
[0m14:54:29.817065 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m14:54:29.820100 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m14:54:29.820100 [debug] [Thread-1 (]: On model.case_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_customers"} */
alter table "warehouse"."main_marts"."dim_customers" rename to "dim_customers__dbt_backup"
[0m14:54:29.820100 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:54:29.820100 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m14:54:29.820100 [debug] [Thread-1 (]: On model.case_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_customers"} */
alter table "warehouse"."main_marts"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m14:54:29.820100 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:54:29.820100 [debug] [Thread-1 (]: On model.case_project.dim_customers: COMMIT
[0m14:54:29.820100 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m14:54:29.836014 [debug] [Thread-1 (]: On model.case_project.dim_customers: COMMIT
[0m14:54:29.839202 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:54:29.842127 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m14:54:29.843123 [debug] [Thread-1 (]: On model.case_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_customers"} */

      drop table if exists "warehouse"."main_marts"."dim_customers__dbt_backup" cascade
    
[0m14:54:29.845046 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:54:29.846051 [debug] [Thread-1 (]: On model.case_project.dim_customers: Close
[0m14:54:29.847698 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ec5d17c-0de9-402a-b4a4-a1c9b070b8f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E505CCA620>]}
[0m14:54:29.848786 [info ] [Thread-1 (]: 5 of 8 OK created sql table model main_marts.dim_customers ..................... [[32mOK[0m in 0.08s]
[0m14:54:29.849302 [debug] [Thread-1 (]: Finished running node model.case_project.dim_customers
[0m14:54:29.850397 [debug] [Thread-1 (]: Began running node model.case_project.fct_orders
[0m14:54:29.851396 [info ] [Thread-1 (]: 6 of 8 START sql table model main_marts.fct_orders ............................. [RUN]
[0m14:54:29.852365 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.dim_customers, now model.case_project.fct_orders)
[0m14:54:29.852365 [debug] [Thread-1 (]: Began compiling node model.case_project.fct_orders
[0m14:54:29.857653 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.fct_orders"
[0m14:54:29.858653 [debug] [Thread-1 (]: Began executing node model.case_project.fct_orders
[0m14:54:29.914419 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.fct_orders"
[0m14:54:29.916388 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m14:54:29.916388 [debug] [Thread-1 (]: On model.case_project.fct_orders: BEGIN
[0m14:54:29.917418 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:29.917418 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:54:29.917418 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m14:54:29.917418 [debug] [Thread-1 (]: On model.case_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_orders"} */

  
    
    

    create  table
      "warehouse"."main_marts"."fct_orders__dbt_tmp"
  
    as (
      -- models/marts/fct_orders.sql


select
    o.order_id,
    o.customer_id,
    o.store_id,
    o.ordered_at,
    cast(date_trunc('day', o.ordered_at) as date) as order_date,
    o.subtotal,
    o.tax_paid,
    o.order_total
from "warehouse"."main_staging"."stg_orders" o
    );
  
  
[0m14:54:29.949564 [debug] [Thread-1 (]: SQL status: OK in 0.031 seconds
[0m14:54:29.949564 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m14:54:29.949564 [debug] [Thread-1 (]: On model.case_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_orders"} */
alter table "warehouse"."main_marts"."fct_orders" rename to "fct_orders__dbt_backup"
[0m14:54:29.949564 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:54:29.949564 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m14:54:29.949564 [debug] [Thread-1 (]: On model.case_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_orders"} */
alter table "warehouse"."main_marts"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m14:54:29.949564 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:54:29.965684 [debug] [Thread-1 (]: On model.case_project.fct_orders: COMMIT
[0m14:54:29.965684 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m14:54:29.966847 [debug] [Thread-1 (]: On model.case_project.fct_orders: COMMIT
[0m14:54:29.990955 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m14:54:29.995048 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m14:54:29.996047 [debug] [Thread-1 (]: On model.case_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_orders"} */

      drop table if exists "warehouse"."main_marts"."fct_orders__dbt_backup" cascade
    
[0m14:54:29.998051 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:54:30.000049 [debug] [Thread-1 (]: On model.case_project.fct_orders: Close
[0m14:54:30.001049 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ec5d17c-0de9-402a-b4a4-a1c9b070b8f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E505D2B820>]}
[0m14:54:30.002048 [info ] [Thread-1 (]: 6 of 8 OK created sql table model main_marts.fct_orders ........................ [[32mOK[0m in 0.15s]
[0m14:54:30.003052 [debug] [Thread-1 (]: Finished running node model.case_project.fct_orders
[0m14:54:30.004080 [debug] [Thread-1 (]: Began running node model.case_project.dim_products
[0m14:54:30.005067 [info ] [Thread-1 (]: 7 of 8 START sql table model main_marts.dim_products ........................... [RUN]
[0m14:54:30.006047 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.fct_orders, now model.case_project.dim_products)
[0m14:54:30.007081 [debug] [Thread-1 (]: Began compiling node model.case_project.dim_products
[0m14:54:30.011088 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.dim_products"
[0m14:54:30.012078 [debug] [Thread-1 (]: Began executing node model.case_project.dim_products
[0m14:54:30.018048 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.dim_products"
[0m14:54:30.019048 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_products"
[0m14:54:30.020049 [debug] [Thread-1 (]: On model.case_project.dim_products: BEGIN
[0m14:54:30.021050 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:30.022048 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:54:30.022048 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_products"
[0m14:54:30.023048 [debug] [Thread-1 (]: On model.case_project.dim_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_products"} */

  
    
    

    create  table
      "warehouse"."main_marts"."dim_products__dbt_tmp"
  
    as (
      -- models/marts/dim_products.sql


select
    p.product_id,
    p.product_name,
    p.price as current_list_price
from "warehouse"."main_staging"."stg_products" p
    );
  
  
[0m14:54:30.024047 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:54:30.030228 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_products"
[0m14:54:30.031013 [debug] [Thread-1 (]: On model.case_project.dim_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_products"} */
alter table "warehouse"."main_marts"."dim_products" rename to "dim_products__dbt_backup"
[0m14:54:30.032065 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:54:30.035856 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_products"
[0m14:54:30.035856 [debug] [Thread-1 (]: On model.case_project.dim_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_products"} */
alter table "warehouse"."main_marts"."dim_products__dbt_tmp" rename to "dim_products"
[0m14:54:30.035856 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:54:30.035856 [debug] [Thread-1 (]: On model.case_project.dim_products: COMMIT
[0m14:54:30.042071 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_products"
[0m14:54:30.042071 [debug] [Thread-1 (]: On model.case_project.dim_products: COMMIT
[0m14:54:30.044081 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:54:30.048109 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_products"
[0m14:54:30.048109 [debug] [Thread-1 (]: On model.case_project.dim_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_products"} */

      drop table if exists "warehouse"."main_marts"."dim_products__dbt_backup" cascade
    
[0m14:54:30.050156 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:54:30.052187 [debug] [Thread-1 (]: On model.case_project.dim_products: Close
[0m14:54:30.053184 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ec5d17c-0de9-402a-b4a4-a1c9b070b8f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E505682080>]}
[0m14:54:30.054184 [info ] [Thread-1 (]: 7 of 8 OK created sql table model main_marts.dim_products ...................... [[32mOK[0m in 0.05s]
[0m14:54:30.055154 [debug] [Thread-1 (]: Finished running node model.case_project.dim_products
[0m14:54:30.056156 [debug] [Thread-1 (]: Began running node model.case_project.fct_order_items
[0m14:54:30.056156 [info ] [Thread-1 (]: 8 of 8 START sql table model main_marts.fct_order_items ........................ [RUN]
[0m14:54:30.056156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.dim_products, now model.case_project.fct_order_items)
[0m14:54:30.056156 [debug] [Thread-1 (]: Began compiling node model.case_project.fct_order_items
[0m14:54:30.056156 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.fct_order_items"
[0m14:54:30.056156 [debug] [Thread-1 (]: Began executing node model.case_project.fct_order_items
[0m14:54:30.056156 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.fct_order_items"
[0m14:54:30.056156 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_order_items"
[0m14:54:30.056156 [debug] [Thread-1 (]: On model.case_project.fct_order_items: BEGIN
[0m14:54:30.056156 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:30.071968 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:54:30.071968 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_order_items"
[0m14:54:30.073140 [debug] [Thread-1 (]: On model.case_project.fct_order_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_order_items"} */

  
    
    

    create  table
      "warehouse"."main_marts"."fct_order_items__dbt_tmp"
  
    as (
      -- models/marts/fct_order_items.sql


with items as (
    select
        order_id,
        product_id,
        quantity,
        unit_price
    from "warehouse"."main_staging"."stg_items"
),
prod as (
    select
        product_id,
        product_name,
        price as current_list_price
    from "warehouse"."main_staging"."stg_products"
)

select
    i.order_id,
    i.product_id,
    p.product_name,
    i.quantity,
    i.price,
    (i.quantity * i.unit_price) as line_revenue,
    p.current_list_price
from items i
left join prod p using (product_id)
    );
  
  
[0m14:54:30.074141 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_order_items"} */

  
    
    

    create  table
      "warehouse"."main_marts"."fct_order_items__dbt_tmp"
  
    as (
      -- models/marts/fct_order_items.sql


with items as (
    select
        order_id,
        product_id,
        quantity,
        unit_price
    from "warehouse"."main_staging"."stg_items"
),
prod as (
    select
        product_id,
        product_name,
        price as current_list_price
    from "warehouse"."main_staging"."stg_products"
)

select
    i.order_id,
    i.product_id,
    p.product_name,
    i.quantity,
    i.price,
    (i.quantity * i.unit_price) as line_revenue,
    p.current_list_price
from items i
left join prod p using (product_id)
    );
  
  
[0m14:54:30.075171 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m14:54:30.076139 [debug] [Thread-1 (]: On model.case_project.fct_order_items: ROLLBACK
[0m14:54:30.084101 [debug] [Thread-1 (]: Failed to rollback 'model.case_project.fct_order_items'
[0m14:54:30.085101 [debug] [Thread-1 (]: On model.case_project.fct_order_items: Close
[0m14:54:30.086100 [debug] [Thread-1 (]: Runtime Error in model fct_order_items (models\marts\fct_order_items.sql)
  Binder Error: Referenced column "unit_price" not found in FROM clause!
  Candidate bindings: "item_id", "quantity", "product_id"
  
  LINE 19:         unit_price
                   ^
[0m14:54:30.087100 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ec5d17c-0de9-402a-b4a4-a1c9b070b8f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E503EE7A90>]}
[0m14:54:30.088106 [error] [Thread-1 (]: 8 of 8 ERROR creating sql table model main_marts.fct_order_items ............... [[31mERROR[0m in 0.03s]
[0m14:54:30.089105 [debug] [Thread-1 (]: Finished running node model.case_project.fct_order_items
[0m14:54:30.090102 [debug] [Thread-4 (]: Marking all children of 'model.case_project.fct_order_items' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_order_items (models\marts\fct_order_items.sql)
  Binder Error: Referenced column "unit_price" not found in FROM clause!
  Candidate bindings: "item_id", "quantity", "product_id"
  
  LINE 19:         unit_price
                   ^.
[0m14:54:30.092101 [debug] [MainThread]: Using duckdb connection "master"
[0m14:54:30.092897 [debug] [MainThread]: On master: BEGIN
[0m14:54:30.092897 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:54:30.092897 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:54:30.092897 [debug] [MainThread]: On master: COMMIT
[0m14:54:30.092897 [debug] [MainThread]: Using duckdb connection "master"
[0m14:54:30.092897 [debug] [MainThread]: On master: COMMIT
[0m14:54:30.092897 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:54:30.097608 [debug] [MainThread]: On master: Close
[0m14:54:30.098336 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:54:30.099010 [debug] [MainThread]: Connection 'create_warehouse_main_staging' was properly closed.
[0m14:54:30.099010 [debug] [MainThread]: Connection 'list_warehouse_main_raw' was properly closed.
[0m14:54:30.100015 [debug] [MainThread]: Connection 'model.case_project.fct_order_items' was properly closed.
[0m14:54:30.101014 [info ] [MainThread]: 
[0m14:54:30.101532 [info ] [MainThread]: Finished running 4 table models, 4 view models in 0 hours 0 minutes and 0.95 seconds (0.95s).
[0m14:54:30.103569 [debug] [MainThread]: Command end result
[0m14:54:30.141131 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\manss\Desktop\Case Project\target\manifest.json
[0m14:54:30.143146 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\manss\Desktop\Case Project\target\semantic_manifest.json
[0m14:54:30.154468 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\manss\Desktop\Case Project\target\run_results.json
[0m14:54:30.154468 [info ] [MainThread]: 
[0m14:54:30.155468 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:54:30.156466 [info ] [MainThread]: 
[0m14:54:30.157439 [error] [MainThread]: [31mFailure in model fct_order_items (models\marts\fct_order_items.sql)[0m
[0m14:54:30.158121 [error] [MainThread]:   Runtime Error in model fct_order_items (models\marts\fct_order_items.sql)
  Binder Error: Referenced column "unit_price" not found in FROM clause!
  Candidate bindings: "item_id", "quantity", "product_id"
  
  LINE 19:         unit_price
                   ^
[0m14:54:30.159127 [info ] [MainThread]: 
[0m14:54:30.160127 [info ] [MainThread]:   compiled code at target\compiled\case_project\models\marts\fct_order_items.sql
[0m14:54:30.160127 [info ] [MainThread]: 
[0m14:54:30.161127 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=8
[0m14:54:30.161970 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m14:54:30.163007 [debug] [MainThread]: Command `dbt run` failed at 14:54:30.163007 after 3.04 seconds
[0m14:54:30.164008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E501C531F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5056DF190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E500B39270>]}
[0m14:54:30.165014 [debug] [MainThread]: Flushing usage events
[0m14:54:30.916289 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:55:00.813896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026850913160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026852C03B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026852C03D60>]}


============================== 14:55:00.820682 | 9b1b4860-008c-4401-b239-e0ac80948550 ==============================
[0m14:55:00.820682 [info ] [MainThread]: Running with dbt=1.10.9
[0m14:55:00.820682 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt seed', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'printer_width': '80', 'quiet': 'False', 'empty': 'None', 'log_path': 'C:\\Users\\manss\\Desktop\\Case Project\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\manss\\Desktop\\Case Project', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m14:55:01.132345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9b1b4860-008c-4401-b239-e0ac80948550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026852CFCC10>]}
[0m14:55:01.221643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9b1b4860-008c-4401-b239-e0ac80948550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026852C01E70>]}
[0m14:55:01.225671 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:55:01.581216 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m14:55:01.898275 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:55:01.899275 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:55:01.994450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b1b4860-008c-4401-b239-e0ac80948550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268542D8100>]}
[0m14:55:02.205488 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\manss\Desktop\Case Project\target\manifest.json
[0m14:55:02.208485 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\manss\Desktop\Case Project\target\semantic_manifest.json
[0m14:55:02.237923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b1b4860-008c-4401-b239-e0ac80948550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026853243490>]}
[0m14:55:02.237923 [info ] [MainThread]: Found 4 seeds, 8 models, 18 data tests, 4 sources, 429 macros
[0m14:55:02.242889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b1b4860-008c-4401-b239-e0ac80948550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268531C01C0>]}
[0m14:55:02.245895 [info ] [MainThread]: 
[0m14:55:02.246896 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:55:02.246896 [info ] [MainThread]: 
[0m14:55:02.248448 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:55:02.256767 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m14:55:02.472006 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m14:55:02.473371 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m14:55:02.473371 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:55:02.498533 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m14:55:02.499498 [debug] [ThreadPool]: On list_warehouse: Close
[0m14:55:02.500527 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_raw)
[0m14:55:02.501498 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_raw"
"
[0m14:55:02.508498 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_raw"
[0m14:55:02.508498 [debug] [ThreadPool]: On create_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_raw"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m14:55:02.508498 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:55:02.508498 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:55:02.514775 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_raw"
[0m14:55:02.514775 [debug] [ThreadPool]: On create_warehouse_main_raw: BEGIN
[0m14:55:02.515774 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:55:02.516804 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_raw"
[0m14:55:02.517774 [debug] [ThreadPool]: On create_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_raw"} */

    
    
        create schema if not exists "warehouse"."main_raw"
    
[0m14:55:02.517774 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:55:02.518804 [debug] [ThreadPool]: On create_warehouse_main_raw: COMMIT
[0m14:55:02.519803 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_raw"
[0m14:55:02.520774 [debug] [ThreadPool]: On create_warehouse_main_raw: COMMIT
[0m14:55:02.520774 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:55:02.521774 [debug] [ThreadPool]: On create_warehouse_main_raw: Close
[0m14:55:02.524772 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_marts'
[0m14:55:02.531359 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m14:55:02.532359 [debug] [ThreadPool]: On list_warehouse_main_marts: BEGIN
[0m14:55:02.533359 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:55:02.534359 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:55:02.534359 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m14:55:02.535359 [debug] [ThreadPool]: On list_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_marts"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'warehouse'
  
[0m14:55:02.549440 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m14:55:02.549891 [debug] [ThreadPool]: On list_warehouse_main_marts: ROLLBACK
[0m14:55:02.549891 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_marts'
[0m14:55:02.549891 [debug] [ThreadPool]: On list_warehouse_main_marts: Close
[0m14:55:02.549891 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_marts, now list_warehouse_main_raw)
[0m14:55:02.556909 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m14:55:02.556909 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m14:55:02.556909 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:55:02.556909 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:55:02.556909 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m14:55:02.556909 [debug] [ThreadPool]: On list_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_raw"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'warehouse'
  
[0m14:55:02.564265 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m14:55:02.566516 [debug] [ThreadPool]: On list_warehouse_main_raw: ROLLBACK
[0m14:55:02.567514 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_raw'
[0m14:55:02.567514 [debug] [ThreadPool]: On list_warehouse_main_raw: Close
[0m14:55:02.568516 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_raw, now list_warehouse_main_staging)
[0m14:55:02.572516 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_staging"
[0m14:55:02.573514 [debug] [ThreadPool]: On list_warehouse_main_staging: BEGIN
[0m14:55:02.573514 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:55:02.575515 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m14:55:02.576515 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_staging"
[0m14:55:02.576515 [debug] [ThreadPool]: On list_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_staging"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'warehouse'
  
[0m14:55:02.577516 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m14:55:02.577516 [debug] [ThreadPool]: On list_warehouse_main_staging: ROLLBACK
[0m14:55:02.583094 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_staging'
[0m14:55:02.584157 [debug] [ThreadPool]: On list_warehouse_main_staging: Close
[0m14:55:02.584618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b1b4860-008c-4401-b239-e0ac80948550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002685307CEE0>]}
[0m14:55:02.584618 [debug] [MainThread]: Using duckdb connection "master"
[0m14:55:02.584618 [debug] [MainThread]: On master: BEGIN
[0m14:55:02.584618 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:55:02.584618 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:55:02.584618 [debug] [MainThread]: On master: COMMIT
[0m14:55:02.590078 [debug] [MainThread]: Using duckdb connection "master"
[0m14:55:02.590078 [debug] [MainThread]: On master: COMMIT
[0m14:55:02.591419 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:55:02.591419 [debug] [MainThread]: On master: Close
[0m14:55:02.597076 [debug] [Thread-1 (]: Began running node seed.case_project.raw_customers
[0m14:55:02.597076 [info ] [Thread-1 (]: 1 of 4 START seed file main_raw.raw_customers .................................. [RUN]
[0m14:55:02.598074 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.case_project.raw_customers'
[0m14:55:02.599076 [debug] [Thread-1 (]: Began compiling node seed.case_project.raw_customers
[0m14:55:02.600074 [debug] [Thread-1 (]: Began executing node seed.case_project.raw_customers
[0m14:55:02.639205 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_customers"
[0m14:55:02.640175 [debug] [Thread-1 (]: On seed.case_project.raw_customers: BEGIN
[0m14:55:02.641176 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:55:02.642209 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:55:02.643176 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_customers"
[0m14:55:02.643176 [debug] [Thread-1 (]: On seed.case_project.raw_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "seed.case_project.raw_customers"} */
truncate table "warehouse"."main_raw"."raw_customers"
[0m14:55:02.644174 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:55:02.659709 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_customers"
[0m14:55:02.660717 [debug] [Thread-1 (]: On seed.case_project.raw_customers: 
          COPY "warehouse"."main_raw"."raw_customers" FROM 'C:\Users\manss\Desktop\Case Project\seeds\raw_customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m14:55:02.669111 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m14:55:02.674112 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.case_project.raw_customers"
[0m14:55:02.688871 [debug] [Thread-1 (]: On seed.case_project.raw_customers: COMMIT
[0m14:55:02.688871 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_customers"
[0m14:55:02.688871 [debug] [Thread-1 (]: On seed.case_project.raw_customers: COMMIT
[0m14:55:02.695941 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:55:02.695941 [debug] [Thread-1 (]: On seed.case_project.raw_customers: Close
[0m14:55:02.702832 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b1b4860-008c-4401-b239-e0ac80948550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026854350910>]}
[0m14:55:02.703858 [info ] [Thread-1 (]: 1 of 4 OK loaded seed file main_raw.raw_customers .............................. [[32mINSERT 930[0m in 0.10s]
[0m14:55:02.704832 [debug] [Thread-1 (]: Finished running node seed.case_project.raw_customers
[0m14:55:02.705831 [debug] [Thread-1 (]: Began running node seed.case_project.raw_items
[0m14:55:02.706830 [info ] [Thread-1 (]: 2 of 4 START seed file main_raw.raw_items ...................................... [RUN]
[0m14:55:02.707254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.case_project.raw_customers, now seed.case_project.raw_items)
[0m14:55:02.708260 [debug] [Thread-1 (]: Began compiling node seed.case_project.raw_items
[0m14:55:02.708260 [debug] [Thread-1 (]: Began executing node seed.case_project.raw_items
[0m14:55:03.249590 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_items"
[0m14:55:03.250591 [debug] [Thread-1 (]: On seed.case_project.raw_items: BEGIN
[0m14:55:03.251594 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:03.252604 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:55:03.253621 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_items"
[0m14:55:03.253621 [debug] [Thread-1 (]: On seed.case_project.raw_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "seed.case_project.raw_items"} */
truncate table "warehouse"."main_raw"."raw_items"
[0m14:55:03.255621 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:55:03.257622 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_items"
[0m14:55:03.258594 [debug] [Thread-1 (]: On seed.case_project.raw_items: 
          COPY "warehouse"."main_raw"."raw_items" FROM 'C:\Users\manss\Desktop\Case Project\seeds\raw_items.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m14:55:03.327638 [debug] [Thread-1 (]: SQL status: OK in 0.072 seconds
[0m14:55:03.327638 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.case_project.raw_items"
[0m14:55:03.334715 [debug] [Thread-1 (]: On seed.case_project.raw_items: COMMIT
[0m14:55:03.334715 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_items"
[0m14:55:03.334715 [debug] [Thread-1 (]: On seed.case_project.raw_items: COMMIT
[0m14:55:03.373590 [debug] [Thread-1 (]: SQL status: OK in 0.036 seconds
[0m14:55:03.374583 [debug] [Thread-1 (]: On seed.case_project.raw_items: Close
[0m14:55:03.375584 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b1b4860-008c-4401-b239-e0ac80948550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268507922C0>]}
[0m14:55:03.376584 [info ] [Thread-1 (]: 2 of 4 OK loaded seed file main_raw.raw_items .................................. [[32mINSERT 90183[0m in 0.67s]
[0m14:55:03.377583 [debug] [Thread-1 (]: Finished running node seed.case_project.raw_items
[0m14:55:03.378584 [debug] [Thread-1 (]: Began running node seed.case_project.raw_orders
[0m14:55:03.379585 [info ] [Thread-1 (]: 3 of 4 START seed file main_raw.raw_orders ..................................... [RUN]
[0m14:55:03.380584 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.case_project.raw_items, now seed.case_project.raw_orders)
[0m14:55:03.381584 [debug] [Thread-1 (]: Began compiling node seed.case_project.raw_orders
[0m14:55:03.382585 [debug] [Thread-1 (]: Began executing node seed.case_project.raw_orders
[0m14:55:06.972339 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_orders"
[0m14:55:06.973338 [debug] [Thread-1 (]: On seed.case_project.raw_orders: BEGIN
[0m14:55:06.974338 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:06.975338 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:55:06.975338 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_orders"
[0m14:55:06.976369 [debug] [Thread-1 (]: On seed.case_project.raw_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "seed.case_project.raw_orders"} */
truncate table "warehouse"."main_raw"."raw_orders"
[0m14:55:06.977368 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:55:06.979006 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_orders"
[0m14:55:06.980511 [debug] [Thread-1 (]: On seed.case_project.raw_orders: 
          COPY "warehouse"."main_raw"."raw_orders" FROM 'C:\Users\manss\Desktop\Case Project\seeds\raw_orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m14:55:07.098498 [debug] [Thread-1 (]: SQL status: OK in 0.122 seconds
[0m14:55:07.103985 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.case_project.raw_orders"
[0m14:55:07.105426 [debug] [Thread-1 (]: On seed.case_project.raw_orders: COMMIT
[0m14:55:07.105426 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_orders"
[0m14:55:07.105426 [debug] [Thread-1 (]: On seed.case_project.raw_orders: COMMIT
[0m14:55:07.143456 [debug] [Thread-1 (]: SQL status: OK in 0.034 seconds
[0m14:55:07.144456 [debug] [Thread-1 (]: On seed.case_project.raw_orders: Close
[0m14:55:07.145457 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b1b4860-008c-4401-b239-e0ac80948550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268542955A0>]}
[0m14:55:07.146459 [info ] [Thread-1 (]: 3 of 4 OK loaded seed file main_raw.raw_orders ................................. [[32mINSERT 63148[0m in 3.77s]
[0m14:55:07.147459 [debug] [Thread-1 (]: Finished running node seed.case_project.raw_orders
[0m14:55:07.148456 [debug] [Thread-1 (]: Began running node seed.case_project.raw_products
[0m14:55:07.148456 [info ] [Thread-1 (]: 4 of 4 START seed file main_raw.raw_products ................................... [RUN]
[0m14:55:07.149456 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.case_project.raw_orders, now seed.case_project.raw_products)
[0m14:55:07.150524 [debug] [Thread-1 (]: Began compiling node seed.case_project.raw_products
[0m14:55:07.150524 [debug] [Thread-1 (]: Began executing node seed.case_project.raw_products
[0m14:55:07.161525 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_products"
[0m14:55:07.162525 [debug] [Thread-1 (]: On seed.case_project.raw_products: BEGIN
[0m14:55:07.163524 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:07.164524 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:55:07.164524 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_products"
[0m14:55:07.165555 [debug] [Thread-1 (]: On seed.case_project.raw_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "seed.case_project.raw_products"} */
truncate table "warehouse"."main_raw"."raw_products"
[0m14:55:07.166525 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:55:07.168556 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_products"
[0m14:55:07.169555 [debug] [Thread-1 (]: On seed.case_project.raw_products: 
          COPY "warehouse"."main_raw"."raw_products" FROM 'C:\Users\manss\Desktop\Case Project\seeds\raw_products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m14:55:07.171525 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:55:07.172525 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.case_project.raw_products"
[0m14:55:07.175525 [debug] [Thread-1 (]: On seed.case_project.raw_products: COMMIT
[0m14:55:07.176523 [debug] [Thread-1 (]: Using duckdb connection "seed.case_project.raw_products"
[0m14:55:07.177525 [debug] [Thread-1 (]: On seed.case_project.raw_products: COMMIT
[0m14:55:07.369124 [debug] [Thread-1 (]: SQL status: OK in 0.191 seconds
[0m14:55:07.369124 [debug] [Thread-1 (]: On seed.case_project.raw_products: Close
[0m14:55:07.369124 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b1b4860-008c-4401-b239-e0ac80948550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268542955A0>]}
[0m14:55:07.369124 [info ] [Thread-1 (]: 4 of 4 OK loaded seed file main_raw.raw_products ............................... [[32mINSERT 10[0m in 0.22s]
[0m14:55:07.369124 [debug] [Thread-1 (]: Finished running node seed.case_project.raw_products
[0m14:55:07.374795 [debug] [MainThread]: Using duckdb connection "master"
[0m14:55:07.375803 [debug] [MainThread]: On master: BEGIN
[0m14:55:07.376111 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:55:07.376111 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:55:07.376111 [debug] [MainThread]: On master: COMMIT
[0m14:55:07.376111 [debug] [MainThread]: Using duckdb connection "master"
[0m14:55:07.376111 [debug] [MainThread]: On master: COMMIT
[0m14:55:07.376111 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:55:07.376111 [debug] [MainThread]: On master: Close
[0m14:55:07.376111 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:55:07.376111 [debug] [MainThread]: Connection 'create_warehouse_main_raw' was properly closed.
[0m14:55:07.381714 [debug] [MainThread]: Connection 'list_warehouse_main_staging' was properly closed.
[0m14:55:07.381714 [debug] [MainThread]: Connection 'seed.case_project.raw_products' was properly closed.
[0m14:55:07.383064 [info ] [MainThread]: 
[0m14:55:07.383858 [info ] [MainThread]: Finished running 4 seeds in 0 hours 0 minutes and 5.14 seconds (5.14s).
[0m14:55:07.385903 [debug] [MainThread]: Command end result
[0m14:55:07.420520 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\manss\Desktop\Case Project\target\manifest.json
[0m14:55:07.424828 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\manss\Desktop\Case Project\target\semantic_manifest.json
[0m14:55:07.435272 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\manss\Desktop\Case Project\target\run_results.json
[0m14:55:07.435272 [info ] [MainThread]: 
[0m14:55:07.436274 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:55:07.437274 [info ] [MainThread]: 
[0m14:55:07.438274 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m14:55:07.439274 [debug] [MainThread]: Command `dbt seed` succeeded at 14:55:07.439274 after 6.72 seconds
[0m14:55:07.440272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026850913160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026852A06860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002685435A5C0>]}
[0m14:55:07.440272 [debug] [MainThread]: Flushing usage events
[0m14:55:08.092446 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:55:15.067825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023907313160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023909603B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023909603D60>]}


============================== 14:55:15.072955 | 8cee1806-c2ed-4877-bad6-063de2c639bf ==============================
[0m14:55:15.072955 [info ] [MainThread]: Running with dbt=1.10.9
[0m14:55:15.073956 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\manss\\Desktop\\Case Project\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\manss\\Desktop\\Case Project', 'static_parser': 'True', 'write_json': 'True'}
[0m14:55:15.369039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8cee1806-c2ed-4877-bad6-063de2c639bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239096FCC10>]}
[0m14:55:15.452488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8cee1806-c2ed-4877-bad6-063de2c639bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239095BBF70>]}
[0m14:55:15.456389 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:55:15.813771 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m14:55:16.124237 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:55:16.125237 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:55:16.223274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8cee1806-c2ed-4877-bad6-063de2c639bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023909D14100>]}
[0m14:55:16.431590 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\manss\Desktop\Case Project\target\manifest.json
[0m14:55:16.431590 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\manss\Desktop\Case Project\target\semantic_manifest.json
[0m14:55:16.466277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8cee1806-c2ed-4877-bad6-063de2c639bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023909C56FB0>]}
[0m14:55:16.466277 [info ] [MainThread]: Found 4 seeds, 8 models, 18 data tests, 4 sources, 429 macros
[0m14:55:16.466277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8cee1806-c2ed-4877-bad6-063de2c639bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023909C55FF0>]}
[0m14:55:16.472837 [info ] [MainThread]: 
[0m14:55:16.472837 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:55:16.472837 [info ] [MainThread]: 
[0m14:55:16.472837 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:55:16.483884 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m14:55:16.700176 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m14:55:16.701176 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m14:55:16.701176 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:55:16.723361 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m14:55:16.728832 [debug] [ThreadPool]: On list_warehouse: Close
[0m14:55:16.730292 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m14:55:16.730292 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m14:55:16.730292 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:55:16.730292 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:55:16.735762 [debug] [ThreadPool]: On list_warehouse: Close
[0m14:55:16.737181 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_marts)
[0m14:55:16.737181 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_marts"
"
[0m14:55:16.744273 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m14:55:16.744273 [debug] [ThreadPool]: On create_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_marts"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m14:55:16.744273 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:55:16.744273 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:55:16.750664 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m14:55:16.751041 [debug] [ThreadPool]: On create_warehouse_main_marts: BEGIN
[0m14:55:16.751041 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:55:16.751041 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m14:55:16.751041 [debug] [ThreadPool]: On create_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_marts"} */

    
    
        create schema if not exists "warehouse"."main_marts"
    
[0m14:55:16.751041 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:55:16.751041 [debug] [ThreadPool]: On create_warehouse_main_marts: COMMIT
[0m14:55:16.751041 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m14:55:16.751041 [debug] [ThreadPool]: On create_warehouse_main_marts: COMMIT
[0m14:55:16.756542 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:55:16.757585 [debug] [ThreadPool]: On create_warehouse_main_marts: Close
[0m14:55:16.758050 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_warehouse_main_marts, now create_warehouse_main_staging)
[0m14:55:16.758050 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_staging"
"
[0m14:55:16.758050 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m14:55:16.758050 [debug] [ThreadPool]: On create_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m14:55:16.763461 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:55:16.764501 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:55:16.765501 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m14:55:16.766500 [debug] [ThreadPool]: On create_warehouse_main_staging: BEGIN
[0m14:55:16.767499 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:55:16.767499 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m14:55:16.768499 [debug] [ThreadPool]: On create_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_staging"} */

    
    
        create schema if not exists "warehouse"."main_staging"
    
[0m14:55:16.769498 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:55:16.770498 [debug] [ThreadPool]: On create_warehouse_main_staging: COMMIT
[0m14:55:16.770498 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m14:55:16.771500 [debug] [ThreadPool]: On create_warehouse_main_staging: COMMIT
[0m14:55:16.772499 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:55:16.772499 [debug] [ThreadPool]: On create_warehouse_main_staging: Close
[0m14:55:16.775631 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_raw'
[0m14:55:16.783514 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m14:55:16.784519 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m14:55:16.784519 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:55:16.785514 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:55:16.786514 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m14:55:16.787514 [debug] [ThreadPool]: On list_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_raw"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'warehouse'
  
[0m14:55:16.801336 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m14:55:16.802336 [debug] [ThreadPool]: On list_warehouse_main_raw: ROLLBACK
[0m14:55:16.804334 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_raw'
[0m14:55:16.804334 [debug] [ThreadPool]: On list_warehouse_main_raw: Close
[0m14:55:16.805335 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_raw, now list_warehouse_main_marts)
[0m14:55:16.809690 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m14:55:16.810662 [debug] [ThreadPool]: On list_warehouse_main_marts: BEGIN
[0m14:55:16.810662 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:55:16.811661 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:55:16.812689 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m14:55:16.812689 [debug] [ThreadPool]: On list_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_marts"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'warehouse'
  
[0m14:55:16.816689 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m14:55:16.817659 [debug] [ThreadPool]: On list_warehouse_main_marts: ROLLBACK
[0m14:55:16.818692 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_marts'
[0m14:55:16.819689 [debug] [ThreadPool]: On list_warehouse_main_marts: Close
[0m14:55:16.820658 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_marts, now list_warehouse_main_staging)
[0m14:55:16.823705 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_staging"
[0m14:55:16.823705 [debug] [ThreadPool]: On list_warehouse_main_staging: BEGIN
[0m14:55:16.823705 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:55:16.826012 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:55:16.827023 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_staging"
[0m14:55:16.827539 [debug] [ThreadPool]: On list_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_staging"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'warehouse'
  
[0m14:55:16.827539 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m14:55:16.832960 [debug] [ThreadPool]: On list_warehouse_main_staging: ROLLBACK
[0m14:55:16.832960 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_staging'
[0m14:55:16.834417 [debug] [ThreadPool]: On list_warehouse_main_staging: Close
[0m14:55:16.834417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8cee1806-c2ed-4877-bad6-063de2c639bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023905694B50>]}
[0m14:55:16.834417 [debug] [MainThread]: Using duckdb connection "master"
[0m14:55:16.834417 [debug] [MainThread]: On master: BEGIN
[0m14:55:16.834417 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:55:16.834417 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:55:16.834417 [debug] [MainThread]: On master: COMMIT
[0m14:55:16.839809 [debug] [MainThread]: Using duckdb connection "master"
[0m14:55:16.839809 [debug] [MainThread]: On master: COMMIT
[0m14:55:16.841239 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:55:16.841239 [debug] [MainThread]: On master: Close
[0m14:55:16.841239 [debug] [Thread-1 (]: Began running node model.case_project.stg_customers
[0m14:55:16.846795 [info ] [Thread-1 (]: 1 of 8 START sql view model main_staging.stg_customers ......................... [RUN]
[0m14:55:16.847857 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.case_project.stg_customers'
[0m14:55:16.847857 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_customers
[0m14:55:16.860684 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_customers"
[0m14:55:16.862149 [debug] [Thread-1 (]: Began executing node model.case_project.stg_customers
[0m14:55:16.899083 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_customers"
[0m14:55:16.902426 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m14:55:16.902426 [debug] [Thread-1 (]: On model.case_project.stg_customers: BEGIN
[0m14:55:16.903433 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:55:16.903902 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:55:16.903902 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m14:55:16.903902 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */

  
  create view "warehouse"."main_staging"."stg_customers__dbt_tmp" as (
    -- models/staging/stg_customers.sql
with src as (
  select * from "warehouse"."main_raw"."raw_customers"
),
clean as (
  select
    cast(id as varchar) as customer_id,
    regexp_replace(name, '^(Mr\.|Mrs\.|Ms\.|Dr\.|MD)\s+', '') as clean_name
  from src
)
select
  customer_id,
  split_part(clean_name, ' ', 1) as first_name,
  split_part(clean_name, ' ', 2) as last_name
from clean
  );

[0m14:55:16.906740 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:55:16.910795 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m14:55:16.916300 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */
alter view "warehouse"."main_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m14:55:16.917809 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:55:16.922946 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m14:55:16.923944 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */
alter view "warehouse"."main_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m14:55:16.924914 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:55:16.938827 [debug] [Thread-1 (]: On model.case_project.stg_customers: COMMIT
[0m14:55:16.938827 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m14:55:16.938827 [debug] [Thread-1 (]: On model.case_project.stg_customers: COMMIT
[0m14:55:16.945557 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:55:16.952610 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m14:55:16.952610 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */

      drop view if exists "warehouse"."main_staging"."stg_customers__dbt_backup" cascade
    
[0m14:55:16.952610 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:55:16.959507 [debug] [Thread-1 (]: On model.case_project.stg_customers: Close
[0m14:55:16.959507 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cee1806-c2ed-4877-bad6-063de2c639bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023909687040>]}
[0m14:55:16.959507 [info ] [Thread-1 (]: 1 of 8 OK created sql view model main_staging.stg_customers .................... [[32mOK[0m in 0.11s]
[0m14:55:16.964876 [debug] [Thread-1 (]: Finished running node model.case_project.stg_customers
[0m14:55:16.965882 [debug] [Thread-1 (]: Began running node model.case_project.stg_items
[0m14:55:16.966277 [info ] [Thread-1 (]: 2 of 8 START sql view model main_staging.stg_items ............................. [RUN]
[0m14:55:16.966277 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_customers, now model.case_project.stg_items)
[0m14:55:16.966277 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_items
[0m14:55:16.971843 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_items"
[0m14:55:16.973893 [debug] [Thread-1 (]: Began executing node model.case_project.stg_items
[0m14:55:16.979213 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_items"
[0m14:55:16.980213 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m14:55:16.981212 [debug] [Thread-1 (]: On model.case_project.stg_items: BEGIN
[0m14:55:16.982213 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:16.983213 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:55:16.983213 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m14:55:16.984212 [debug] [Thread-1 (]: On model.case_project.stg_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_items"} */

  
  create view "warehouse"."main_staging"."stg_items__dbt_tmp" as (
    -- models/staging/stg_items.sql
with src as (
  select * from "warehouse"."main_raw"."raw_items"
)
select
  cast(id as varchar)        as item_id,
  cast(order_id as varchar)  as order_id,
  cast(sku as varchar)       as product_id,
  1                          as quantity
from src
  );

[0m14:55:16.985212 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:55:16.990210 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m14:55:16.990210 [debug] [Thread-1 (]: On model.case_project.stg_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_items"} */
alter view "warehouse"."main_staging"."stg_items" rename to "stg_items__dbt_backup"
[0m14:55:16.991210 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:55:16.996212 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m14:55:16.997212 [debug] [Thread-1 (]: On model.case_project.stg_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_items"} */
alter view "warehouse"."main_staging"."stg_items__dbt_tmp" rename to "stg_items"
[0m14:55:16.998213 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:55:17.000213 [debug] [Thread-1 (]: On model.case_project.stg_items: COMMIT
[0m14:55:17.001213 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m14:55:17.001213 [debug] [Thread-1 (]: On model.case_project.stg_items: COMMIT
[0m14:55:17.003216 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:55:17.008212 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m14:55:17.009214 [debug] [Thread-1 (]: On model.case_project.stg_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_items"} */

      drop view if exists "warehouse"."main_staging"."stg_items__dbt_backup" cascade
    
[0m14:55:17.009214 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:55:17.009214 [debug] [Thread-1 (]: On model.case_project.stg_items: Close
[0m14:55:17.013479 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cee1806-c2ed-4877-bad6-063de2c639bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002390B1C3D90>]}
[0m14:55:17.015489 [info ] [Thread-1 (]: 2 of 8 OK created sql view model main_staging.stg_items ........................ [[32mOK[0m in 0.05s]
[0m14:55:17.015831 [debug] [Thread-1 (]: Finished running node model.case_project.stg_items
[0m14:55:17.016837 [debug] [Thread-1 (]: Began running node model.case_project.stg_orders
[0m14:55:17.017836 [info ] [Thread-1 (]: 3 of 8 START sql view model main_staging.stg_orders ............................ [RUN]
[0m14:55:17.018965 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_items, now model.case_project.stg_orders)
[0m14:55:17.018965 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_orders
[0m14:55:17.024006 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_orders"
[0m14:55:17.025000 [debug] [Thread-1 (]: Began executing node model.case_project.stg_orders
[0m14:55:17.030970 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_orders"
[0m14:55:17.031974 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m14:55:17.033001 [debug] [Thread-1 (]: On model.case_project.stg_orders: BEGIN
[0m14:55:17.034002 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:17.034972 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:55:17.034972 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m14:55:17.035972 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */

  
  create view "warehouse"."main_staging"."stg_orders__dbt_tmp" as (
    with src as (
  select * from "warehouse"."main_raw"."raw_orders"
)
select
  cast(id as varchar)                 as order_id,
  cast(customer as varchar)           as customer_id,
  cast(store_id as varchar)           as store_id,
  cast(ordered_at as timestamp)       as ordered_at,
  cast(subtotal as double)            as subtotal,
  cast(tax_paid as double)            as tax_paid,
  cast(order_total as double)         as order_total
from src
  );

[0m14:55:17.037002 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:55:17.042125 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m14:55:17.043096 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */
alter view "warehouse"."main_staging"."stg_orders" rename to "stg_orders__dbt_backup"
[0m14:55:17.044096 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:55:17.048093 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m14:55:17.049095 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */
alter view "warehouse"."main_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m14:55:17.050095 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:55:17.052093 [debug] [Thread-1 (]: On model.case_project.stg_orders: COMMIT
[0m14:55:17.053093 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m14:55:17.054097 [debug] [Thread-1 (]: On model.case_project.stg_orders: COMMIT
[0m14:55:17.056096 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:55:17.060095 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m14:55:17.061093 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */

      drop view if exists "warehouse"."main_staging"."stg_orders__dbt_backup" cascade
    
[0m14:55:17.062094 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:55:17.064096 [debug] [Thread-1 (]: On model.case_project.stg_orders: Close
[0m14:55:17.065094 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cee1806-c2ed-4877-bad6-063de2c639bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002390B0400A0>]}
[0m14:55:17.066093 [info ] [Thread-1 (]: 3 of 8 OK created sql view model main_staging.stg_orders ....................... [[32mOK[0m in 0.05s]
[0m14:55:17.067094 [debug] [Thread-1 (]: Finished running node model.case_project.stg_orders
[0m14:55:17.068095 [debug] [Thread-1 (]: Began running node model.case_project.stg_products
[0m14:55:17.069094 [info ] [Thread-1 (]: 4 of 8 START sql view model main_staging.stg_products .......................... [RUN]
[0m14:55:17.070095 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_orders, now model.case_project.stg_products)
[0m14:55:17.071095 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_products
[0m14:55:17.075149 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_products"
[0m14:55:17.076148 [debug] [Thread-1 (]: Began executing node model.case_project.stg_products
[0m14:55:17.083148 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_products"
[0m14:55:17.085148 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m14:55:17.086148 [debug] [Thread-1 (]: On model.case_project.stg_products: BEGIN
[0m14:55:17.086148 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:17.087147 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:55:17.087147 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m14:55:17.087147 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */

  
  create view "warehouse"."main_staging"."stg_products__dbt_tmp" as (
    -- models/staging/stg_products.sql
with src as (select * from "warehouse"."main_raw"."raw_products")
select
  cast(sku as varchar)      as product_id,
  lower(trim(name))        as product_name,
  cast(price as double)    as price
from src
  );

[0m14:55:17.089831 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:55:17.093896 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m14:55:17.094896 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */
alter view "warehouse"."main_staging"."stg_products" rename to "stg_products__dbt_backup"
[0m14:55:17.095896 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:55:17.099896 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m14:55:17.100896 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */
alter view "warehouse"."main_staging"."stg_products__dbt_tmp" rename to "stg_products"
[0m14:55:17.101899 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:55:17.103898 [debug] [Thread-1 (]: On model.case_project.stg_products: COMMIT
[0m14:55:17.104898 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m14:55:17.106149 [debug] [Thread-1 (]: On model.case_project.stg_products: COMMIT
[0m14:55:17.108146 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:55:17.112149 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m14:55:17.113146 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */

      drop view if exists "warehouse"."main_staging"."stg_products__dbt_backup" cascade
    
[0m14:55:17.115121 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:55:17.116128 [debug] [Thread-1 (]: On model.case_project.stg_products: Close
[0m14:55:17.117126 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cee1806-c2ed-4877-bad6-063de2c639bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023909686950>]}
[0m14:55:17.119127 [info ] [Thread-1 (]: 4 of 8 OK created sql view model main_staging.stg_products ..................... [[32mOK[0m in 0.05s]
[0m14:55:17.120128 [debug] [Thread-1 (]: Finished running node model.case_project.stg_products
[0m14:55:17.121128 [debug] [Thread-1 (]: Began running node model.case_project.dim_customers
[0m14:55:17.122128 [info ] [Thread-1 (]: 5 of 8 START sql table model main_marts.dim_customers .......................... [RUN]
[0m14:55:17.123128 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_products, now model.case_project.dim_customers)
[0m14:55:17.124128 [debug] [Thread-1 (]: Began compiling node model.case_project.dim_customers
[0m14:55:17.128632 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.dim_customers"
[0m14:55:17.129615 [debug] [Thread-1 (]: Began executing node model.case_project.dim_customers
[0m14:55:17.153923 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.dim_customers"
[0m14:55:17.153923 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m14:55:17.153923 [debug] [Thread-1 (]: On model.case_project.dim_customers: BEGIN
[0m14:55:17.159339 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:17.159339 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:55:17.160377 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m14:55:17.161376 [debug] [Thread-1 (]: On model.case_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_customers"} */

  
    
    

    create  table
      "warehouse"."main_marts"."dim_customers__dbt_tmp"
  
    as (
      -- models/marts/dim_customers.sql


with base as (
    select
        customer_id,
        first_name,
        last_name,
        (first_name || ' ' || coalesce(last_name, '')) as customer_name
    from "warehouse"."main_staging"."stg_customers"
),

orders as (
    select
        customer_id,
        min(ordered_at) as first_order_at,
        max(ordered_at) as most_recent_order_at,
        count(*)        as order_count,
        sum(order_total) as lifetime_value
    from "warehouse"."main_staging"."stg_orders"
    group by 1
)

select
    b.customer_id,
    b.first_name,
    b.last_name,
    b.customer_name,
    o.first_order_at,
    o.most_recent_order_at,
    coalesce(o.order_count, 0)      as order_count,
    coalesce(o.lifetime_value, 0.0) as lifetime_value
from base b
left join orders o using (customer_id)
    );
  
  
[0m14:55:17.171345 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m14:55:17.175243 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m14:55:17.176245 [debug] [Thread-1 (]: On model.case_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_customers"} */
alter table "warehouse"."main_marts"."dim_customers" rename to "dim_customers__dbt_backup"
[0m14:55:17.177245 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:55:17.183245 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m14:55:17.184245 [debug] [Thread-1 (]: On model.case_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_customers"} */
alter table "warehouse"."main_marts"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m14:55:17.184245 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:55:17.191245 [debug] [Thread-1 (]: On model.case_project.dim_customers: COMMIT
[0m14:55:17.192244 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m14:55:17.193244 [debug] [Thread-1 (]: On model.case_project.dim_customers: COMMIT
[0m14:55:17.195245 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:55:17.195245 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m14:55:17.195245 [debug] [Thread-1 (]: On model.case_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_customers"} */

      drop table if exists "warehouse"."main_marts"."dim_customers__dbt_backup" cascade
    
[0m14:55:17.202437 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:55:17.202437 [debug] [Thread-1 (]: On model.case_project.dim_customers: Close
[0m14:55:17.202437 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cee1806-c2ed-4877-bad6-063de2c639bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002390B2BD9C0>]}
[0m14:55:17.202437 [info ] [Thread-1 (]: 5 of 8 OK created sql table model main_marts.dim_customers ..................... [[32mOK[0m in 0.08s]
[0m14:55:17.202437 [debug] [Thread-1 (]: Finished running node model.case_project.dim_customers
[0m14:55:17.207916 [debug] [Thread-1 (]: Began running node model.case_project.fct_orders
[0m14:55:17.208925 [info ] [Thread-1 (]: 6 of 8 START sql table model main_marts.fct_orders ............................. [RUN]
[0m14:55:17.209402 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.dim_customers, now model.case_project.fct_orders)
[0m14:55:17.209402 [debug] [Thread-1 (]: Began compiling node model.case_project.fct_orders
[0m14:55:17.214878 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.fct_orders"
[0m14:55:17.216465 [debug] [Thread-1 (]: Began executing node model.case_project.fct_orders
[0m14:55:17.221620 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.fct_orders"
[0m14:55:17.223581 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m14:55:17.224580 [debug] [Thread-1 (]: On model.case_project.fct_orders: BEGIN
[0m14:55:17.225580 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:17.225580 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:55:17.226580 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m14:55:17.227580 [debug] [Thread-1 (]: On model.case_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_orders"} */

  
    
    

    create  table
      "warehouse"."main_marts"."fct_orders__dbt_tmp"
  
    as (
      -- models/marts/fct_orders.sql


select
    o.order_id,
    o.customer_id,
    o.store_id,
    o.ordered_at,
    cast(date_trunc('day', o.ordered_at) as date) as order_date,
    o.subtotal,
    o.tax_paid,
    o.order_total
from "warehouse"."main_staging"."stg_orders" o
    );
  
  
[0m14:55:17.259567 [debug] [Thread-1 (]: SQL status: OK in 0.032 seconds
[0m14:55:17.264539 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m14:55:17.264539 [debug] [Thread-1 (]: On model.case_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_orders"} */
alter table "warehouse"."main_marts"."fct_orders" rename to "fct_orders__dbt_backup"
[0m14:55:17.265537 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:55:17.269567 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m14:55:17.270573 [debug] [Thread-1 (]: On model.case_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_orders"} */
alter table "warehouse"."main_marts"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m14:55:17.271539 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:55:17.274567 [debug] [Thread-1 (]: On model.case_project.fct_orders: COMMIT
[0m14:55:17.274567 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m14:55:17.274567 [debug] [Thread-1 (]: On model.case_project.fct_orders: COMMIT
[0m14:55:17.299450 [debug] [Thread-1 (]: SQL status: OK in 0.028 seconds
[0m14:55:17.306102 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m14:55:17.306102 [debug] [Thread-1 (]: On model.case_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_orders"} */

      drop table if exists "warehouse"."main_marts"."fct_orders__dbt_backup" cascade
    
[0m14:55:17.306102 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:55:17.312035 [debug] [Thread-1 (]: On model.case_project.fct_orders: Close
[0m14:55:17.313043 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cee1806-c2ed-4877-bad6-063de2c639bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023908D3DED0>]}
[0m14:55:17.313043 [info ] [Thread-1 (]: 6 of 8 OK created sql table model main_marts.fct_orders ........................ [[32mOK[0m in 0.10s]
[0m14:55:17.313043 [debug] [Thread-1 (]: Finished running node model.case_project.fct_orders
[0m14:55:17.313043 [debug] [Thread-1 (]: Began running node model.case_project.dim_products
[0m14:55:17.313043 [info ] [Thread-1 (]: 7 of 8 START sql table model main_marts.dim_products ........................... [RUN]
[0m14:55:17.313043 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.fct_orders, now model.case_project.dim_products)
[0m14:55:17.319014 [debug] [Thread-1 (]: Began compiling node model.case_project.dim_products
[0m14:55:17.325086 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.dim_products"
[0m14:55:17.326086 [debug] [Thread-1 (]: Began executing node model.case_project.dim_products
[0m14:55:17.331085 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.dim_products"
[0m14:55:17.333088 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_products"
[0m14:55:17.334088 [debug] [Thread-1 (]: On model.case_project.dim_products: BEGIN
[0m14:55:17.334088 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:17.335087 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:55:17.336086 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_products"
[0m14:55:17.336086 [debug] [Thread-1 (]: On model.case_project.dim_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_products"} */

  
    
    

    create  table
      "warehouse"."main_marts"."dim_products__dbt_tmp"
  
    as (
      -- models/marts/dim_products.sql


select
    p.product_id,
    p.product_name,
    p.price as current_list_price
from "warehouse"."main_staging"."stg_products" p
    );
  
  
[0m14:55:17.338086 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:55:17.342086 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_products"
[0m14:55:17.343086 [debug] [Thread-1 (]: On model.case_project.dim_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_products"} */
alter table "warehouse"."main_marts"."dim_products" rename to "dim_products__dbt_backup"
[0m14:55:17.344305 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:55:17.348310 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_products"
[0m14:55:17.349312 [debug] [Thread-1 (]: On model.case_project.dim_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_products"} */
alter table "warehouse"."main_marts"."dim_products__dbt_tmp" rename to "dim_products"
[0m14:55:17.350311 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:55:17.353005 [debug] [Thread-1 (]: On model.case_project.dim_products: COMMIT
[0m14:55:17.354014 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_products"
[0m14:55:17.354014 [debug] [Thread-1 (]: On model.case_project.dim_products: COMMIT
[0m14:55:17.356638 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:55:17.360701 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_products"
[0m14:55:17.361708 [debug] [Thread-1 (]: On model.case_project.dim_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_products"} */

      drop table if exists "warehouse"."main_marts"."dim_products__dbt_backup" cascade
    
[0m14:55:17.362439 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:55:17.362439 [debug] [Thread-1 (]: On model.case_project.dim_products: Close
[0m14:55:17.362439 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cee1806-c2ed-4877-bad6-063de2c639bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239097237F0>]}
[0m14:55:17.362439 [info ] [Thread-1 (]: 7 of 8 OK created sql table model main_marts.dim_products ...................... [[32mOK[0m in 0.05s]
[0m14:55:17.367643 [debug] [Thread-1 (]: Finished running node model.case_project.dim_products
[0m14:55:17.368650 [debug] [Thread-1 (]: Began running node model.case_project.fct_order_items
[0m14:55:17.369651 [info ] [Thread-1 (]: 8 of 8 START sql table model main_marts.fct_order_items ........................ [RUN]
[0m14:55:17.370683 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.dim_products, now model.case_project.fct_order_items)
[0m14:55:17.371681 [debug] [Thread-1 (]: Began compiling node model.case_project.fct_order_items
[0m14:55:17.375489 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.fct_order_items"
[0m14:55:17.377489 [debug] [Thread-1 (]: Began executing node model.case_project.fct_order_items
[0m14:55:17.382161 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.fct_order_items"
[0m14:55:17.385181 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_order_items"
[0m14:55:17.385181 [debug] [Thread-1 (]: On model.case_project.fct_order_items: BEGIN
[0m14:55:17.386350 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:17.387320 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:55:17.388320 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_order_items"
[0m14:55:17.388320 [debug] [Thread-1 (]: On model.case_project.fct_order_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_order_items"} */

  
    
    

    create  table
      "warehouse"."main_marts"."fct_order_items__dbt_tmp"
  
    as (
      -- models/marts/fct_order_items.sql


with items as (
    select
        order_id,
        product_id,
        quantity,
        unit_price
    from "warehouse"."main_staging"."stg_items"
),
prod as (
    select
        product_id,
        product_name,
        price as current_list_price
    from "warehouse"."main_staging"."stg_products"
)

select
    i.order_id,
    i.product_id,
    p.product_name,
    i.quantity,
    i.price,
    (i.quantity * i.unit_price) as line_revenue,
    p.current_list_price
from items i
left join prod p using (product_id)
    );
  
  
[0m14:55:17.390167 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_order_items"} */

  
    
    

    create  table
      "warehouse"."main_marts"."fct_order_items__dbt_tmp"
  
    as (
      -- models/marts/fct_order_items.sql


with items as (
    select
        order_id,
        product_id,
        quantity,
        unit_price
    from "warehouse"."main_staging"."stg_items"
),
prod as (
    select
        product_id,
        product_name,
        price as current_list_price
    from "warehouse"."main_staging"."stg_products"
)

select
    i.order_id,
    i.product_id,
    p.product_name,
    i.quantity,
    i.price,
    (i.quantity * i.unit_price) as line_revenue,
    p.current_list_price
from items i
left join prod p using (product_id)
    );
  
  
[0m14:55:17.390167 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m14:55:17.390167 [debug] [Thread-1 (]: On model.case_project.fct_order_items: ROLLBACK
[0m14:55:17.396934 [debug] [Thread-1 (]: Failed to rollback 'model.case_project.fct_order_items'
[0m14:55:17.396934 [debug] [Thread-1 (]: On model.case_project.fct_order_items: Close
[0m14:55:17.402380 [debug] [Thread-1 (]: Runtime Error in model fct_order_items (models\marts\fct_order_items.sql)
  Binder Error: Referenced column "unit_price" not found in FROM clause!
  Candidate bindings: "item_id", "quantity", "product_id"
  
  LINE 19:         unit_price
                   ^
[0m14:55:17.403387 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cee1806-c2ed-4877-bad6-063de2c639bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239097237F0>]}
[0m14:55:17.404420 [error] [Thread-1 (]: 8 of 8 ERROR creating sql table model main_marts.fct_order_items ............... [[31mERROR[0m in 0.03s]
[0m14:55:17.405387 [debug] [Thread-1 (]: Finished running node model.case_project.fct_order_items
[0m14:55:17.406385 [debug] [Thread-4 (]: Marking all children of 'model.case_project.fct_order_items' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_order_items (models\marts\fct_order_items.sql)
  Binder Error: Referenced column "unit_price" not found in FROM clause!
  Candidate bindings: "item_id", "quantity", "product_id"
  
  LINE 19:         unit_price
                   ^.
[0m14:55:17.408387 [debug] [MainThread]: Using duckdb connection "master"
[0m14:55:17.408387 [debug] [MainThread]: On master: BEGIN
[0m14:55:17.409386 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:55:17.410388 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:55:17.410388 [debug] [MainThread]: On master: COMMIT
[0m14:55:17.411388 [debug] [MainThread]: Using duckdb connection "master"
[0m14:55:17.411388 [debug] [MainThread]: On master: COMMIT
[0m14:55:17.413031 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:55:17.413031 [debug] [MainThread]: On master: Close
[0m14:55:17.414086 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:55:17.415085 [debug] [MainThread]: Connection 'create_warehouse_main_staging' was properly closed.
[0m14:55:17.415085 [debug] [MainThread]: Connection 'list_warehouse_main_staging' was properly closed.
[0m14:55:17.416085 [debug] [MainThread]: Connection 'model.case_project.fct_order_items' was properly closed.
[0m14:55:17.416085 [info ] [MainThread]: 
[0m14:55:17.417085 [info ] [MainThread]: Finished running 4 table models, 4 view models in 0 hours 0 minutes and 0.94 seconds (0.94s).
[0m14:55:17.418362 [debug] [MainThread]: Command end result
[0m14:55:17.458914 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\manss\Desktop\Case Project\target\manifest.json
[0m14:55:17.461912 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\manss\Desktop\Case Project\target\semantic_manifest.json
[0m14:55:17.472844 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\manss\Desktop\Case Project\target\run_results.json
[0m14:55:17.473392 [info ] [MainThread]: 
[0m14:55:17.473392 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:55:17.473392 [info ] [MainThread]: 
[0m14:55:17.473392 [error] [MainThread]: [31mFailure in model fct_order_items (models\marts\fct_order_items.sql)[0m
[0m14:55:17.473392 [error] [MainThread]:   Runtime Error in model fct_order_items (models\marts\fct_order_items.sql)
  Binder Error: Referenced column "unit_price" not found in FROM clause!
  Candidate bindings: "item_id", "quantity", "product_id"
  
  LINE 19:         unit_price
                   ^
[0m14:55:17.473392 [info ] [MainThread]: 
[0m14:55:17.478792 [info ] [MainThread]:   compiled code at target\compiled\case_project\models\marts\fct_order_items.sql
[0m14:55:17.479799 [info ] [MainThread]: 
[0m14:55:17.480326 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=8
[0m14:55:17.482352 [debug] [MainThread]: Command `dbt run` failed at 14:55:17.482352 after 2.51 seconds
[0m14:55:17.483450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023907313160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239096FFC70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023909D164A0>]}
[0m14:55:17.484455 [debug] [MainThread]: Flushing usage events
[0m14:55:18.317980 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:57:31.118460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B243B31F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B266A3BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B266A3D90>]}


============================== 14:57:31.118460 | 2b3096b0-49f4-48c6-9420-d99ccf6f2c97 ==============================
[0m14:57:31.118460 [info ] [MainThread]: Running with dbt=1.10.9
[0m14:57:31.118460 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'log_path': 'C:\\Users\\manss\\Desktop\\Case Project\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\manss\\Desktop\\Case Project', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m14:57:31.414750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b3096b0-49f4-48c6-9420-d99ccf6f2c97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B267BFCA0>]}
[0m14:57:31.492804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b3096b0-49f4-48c6-9420-d99ccf6f2c97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B266A1EA0>]}
[0m14:57:31.492804 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:57:31.853130 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m14:57:32.165815 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m14:57:32.165815 [debug] [MainThread]: Partial parsing: updated file: case_project://models\staging\schema.yml
[0m14:57:32.165815 [debug] [MainThread]: Partial parsing: updated file: case_project://models\marts\fct_order_items.sql
[0m14:57:32.165815 [debug] [MainThread]: Partial parsing: updated file: case_project://models\staging\stg_items.sql
[0m14:57:32.655098 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m14:57:32.656066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2b3096b0-49f4-48c6-9420-d99ccf6f2c97', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B27F2AAD0>]}
[0m14:57:32.821682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b3096b0-49f4-48c6-9420-d99ccf6f2c97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B27FC1510>]}
[0m14:57:32.970525 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\manss\Desktop\Case Project\target\manifest.json
[0m14:57:32.970525 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\manss\Desktop\Case Project\target\semantic_manifest.json
[0m14:57:33.002750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b3096b0-49f4-48c6-9420-d99ccf6f2c97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B27FC07C0>]}
[0m14:57:33.002750 [info ] [MainThread]: Found 4 seeds, 8 models, 18 data tests, 4 sources, 429 macros
[0m14:57:33.002750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b3096b0-49f4-48c6-9420-d99ccf6f2c97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B27FC05B0>]}
[0m14:57:33.002750 [info ] [MainThread]: 
[0m14:57:33.002750 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:57:33.002750 [info ] [MainThread]: 
[0m14:57:33.018519 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:57:33.025739 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m14:57:33.230699 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m14:57:33.231699 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m14:57:33.232699 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:57:33.242863 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m14:57:33.242863 [debug] [ThreadPool]: On list_warehouse: Close
[0m14:57:33.259018 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m14:57:33.259018 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m14:57:33.259018 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:57:33.259018 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:57:33.259018 [debug] [ThreadPool]: On list_warehouse: Close
[0m14:57:33.259018 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_marts)
[0m14:57:33.259018 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_marts"
"
[0m14:57:33.259018 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m14:57:33.275147 [debug] [ThreadPool]: On create_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_marts"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m14:57:33.276319 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:57:33.277292 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:57:33.278316 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m14:57:33.279316 [debug] [ThreadPool]: On create_warehouse_main_marts: BEGIN
[0m14:57:33.280288 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:57:33.280288 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m14:57:33.281330 [debug] [ThreadPool]: On create_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_marts"} */

    
    
        create schema if not exists "warehouse"."main_marts"
    
[0m14:57:33.281330 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:57:33.282286 [debug] [ThreadPool]: On create_warehouse_main_marts: COMMIT
[0m14:57:33.283318 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m14:57:33.284320 [debug] [ThreadPool]: On create_warehouse_main_marts: COMMIT
[0m14:57:33.284320 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:57:33.285318 [debug] [ThreadPool]: On create_warehouse_main_marts: Close
[0m14:57:33.286316 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_warehouse_main_marts, now create_warehouse_main_staging)
[0m14:57:33.287287 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_staging"
"
[0m14:57:33.289316 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m14:57:33.290314 [debug] [ThreadPool]: On create_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m14:57:33.290314 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:57:33.290314 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:57:33.290314 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m14:57:33.290314 [debug] [ThreadPool]: On create_warehouse_main_staging: BEGIN
[0m14:57:33.290314 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:57:33.290314 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m14:57:33.290314 [debug] [ThreadPool]: On create_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_staging"} */

    
    
        create schema if not exists "warehouse"."main_staging"
    
[0m14:57:33.290314 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:57:33.290314 [debug] [ThreadPool]: On create_warehouse_main_staging: COMMIT
[0m14:57:33.290314 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m14:57:33.290314 [debug] [ThreadPool]: On create_warehouse_main_staging: COMMIT
[0m14:57:33.290314 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:57:33.290314 [debug] [ThreadPool]: On create_warehouse_main_staging: Close
[0m14:57:33.290314 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_marts'
[0m14:57:33.310075 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m14:57:33.310075 [debug] [ThreadPool]: On list_warehouse_main_marts: BEGIN
[0m14:57:33.310075 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:57:33.312081 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:57:33.312081 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m14:57:33.312081 [debug] [ThreadPool]: On list_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_marts"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'warehouse'
  
[0m14:57:33.321840 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m14:57:33.321840 [debug] [ThreadPool]: On list_warehouse_main_marts: ROLLBACK
[0m14:57:33.321840 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_marts'
[0m14:57:33.321840 [debug] [ThreadPool]: On list_warehouse_main_marts: Close
[0m14:57:33.321840 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_marts, now list_warehouse_main_raw)
[0m14:57:33.321840 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m14:57:33.321840 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m14:57:33.321840 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:57:33.321840 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:57:33.337627 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m14:57:33.337627 [debug] [ThreadPool]: On list_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_raw"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'warehouse'
  
[0m14:57:33.341779 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m14:57:33.342776 [debug] [ThreadPool]: On list_warehouse_main_raw: ROLLBACK
[0m14:57:33.343776 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_raw'
[0m14:57:33.343776 [debug] [ThreadPool]: On list_warehouse_main_raw: Close
[0m14:57:33.344746 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_raw, now list_warehouse_main_staging)
[0m14:57:33.348776 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_staging"
[0m14:57:33.348776 [debug] [ThreadPool]: On list_warehouse_main_staging: BEGIN
[0m14:57:33.349747 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:57:33.350747 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:57:33.350747 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_staging"
[0m14:57:33.351776 [debug] [ThreadPool]: On list_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_staging"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'warehouse'
  
[0m14:57:33.354485 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m14:57:33.356488 [debug] [ThreadPool]: On list_warehouse_main_staging: ROLLBACK
[0m14:57:33.357458 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_staging'
[0m14:57:33.357458 [debug] [ThreadPool]: On list_warehouse_main_staging: Close
[0m14:57:33.359617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b3096b0-49f4-48c6-9420-d99ccf6f2c97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B227F5240>]}
[0m14:57:33.359617 [debug] [MainThread]: Using duckdb connection "master"
[0m14:57:33.360612 [debug] [MainThread]: On master: BEGIN
[0m14:57:33.361616 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:57:33.361616 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:57:33.362612 [debug] [MainThread]: On master: COMMIT
[0m14:57:33.362612 [debug] [MainThread]: Using duckdb connection "master"
[0m14:57:33.363612 [debug] [MainThread]: On master: COMMIT
[0m14:57:33.364613 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:57:33.364613 [debug] [MainThread]: On master: Close
[0m14:57:33.365403 [debug] [Thread-1 (]: Began running node model.case_project.stg_customers
[0m14:57:33.365403 [info ] [Thread-1 (]: 1 of 8 START sql view model main_staging.stg_customers ......................... [RUN]
[0m14:57:33.365403 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.case_project.stg_customers'
[0m14:57:33.365403 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_customers
[0m14:57:33.381563 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_customers"
[0m14:57:33.383532 [debug] [Thread-1 (]: Began executing node model.case_project.stg_customers
[0m14:57:33.407324 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_customers"
[0m14:57:33.407324 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m14:57:33.423421 [debug] [Thread-1 (]: On model.case_project.stg_customers: BEGIN
[0m14:57:33.423421 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:57:33.423421 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:57:33.423421 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m14:57:33.423421 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */

  
  create view "warehouse"."main_staging"."stg_customers__dbt_tmp" as (
    -- models/staging/stg_customers.sql
with src as (
  select * from "warehouse"."main_raw"."raw_customers"
),
clean as (
  select
    cast(id as varchar) as customer_id,
    regexp_replace(name, '^(Mr\.|Mrs\.|Ms\.|Dr\.|MD)\s+', '') as clean_name
  from src
)
select
  customer_id,
  split_part(clean_name, ' ', 1) as first_name,
  split_part(clean_name, ' ', 2) as last_name
from clean
  );

[0m14:57:33.423421 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:57:33.423421 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m14:57:33.423421 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */
alter view "warehouse"."main_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m14:57:33.423421 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:57:33.439138 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m14:57:33.439138 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */
alter view "warehouse"."main_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m14:57:33.439138 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:57:33.455169 [debug] [Thread-1 (]: On model.case_project.stg_customers: COMMIT
[0m14:57:33.455169 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m14:57:33.455169 [debug] [Thread-1 (]: On model.case_project.stg_customers: COMMIT
[0m14:57:33.462550 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:57:33.462550 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m14:57:33.470929 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */

      drop view if exists "warehouse"."main_staging"."stg_customers__dbt_backup" cascade
    
[0m14:57:33.470929 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:57:33.470929 [debug] [Thread-1 (]: On model.case_project.stg_customers: Close
[0m14:57:33.470929 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b3096b0-49f4-48c6-9420-d99ccf6f2c97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B23120160>]}
[0m14:57:33.470929 [info ] [Thread-1 (]: 1 of 8 OK created sql view model main_staging.stg_customers .................... [[32mOK[0m in 0.11s]
[0m14:57:33.470929 [debug] [Thread-1 (]: Finished running node model.case_project.stg_customers
[0m14:57:33.470929 [debug] [Thread-1 (]: Began running node model.case_project.stg_items
[0m14:57:33.470929 [info ] [Thread-1 (]: 2 of 8 START sql view model main_staging.stg_items ............................. [RUN]
[0m14:57:33.470929 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_customers, now model.case_project.stg_items)
[0m14:57:33.470929 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_items
[0m14:57:33.486861 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_items"
[0m14:57:33.488943 [debug] [Thread-1 (]: Began executing node model.case_project.stg_items
[0m14:57:33.494060 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_items"
[0m14:57:33.495026 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m14:57:33.496025 [debug] [Thread-1 (]: On model.case_project.stg_items: BEGIN
[0m14:57:33.496025 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:57:33.497027 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:57:33.498026 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m14:57:33.499026 [debug] [Thread-1 (]: On model.case_project.stg_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_items"} */

  
  create view "warehouse"."main_staging"."stg_items__dbt_tmp" as (
    with src as (
  select * from "warehouse"."main_raw"."raw_items"
)
select
  cast(order_id as varchar) as order_id,  -- FK to orders
  cast(sku      as varchar) as product_id, 
  1                           as quantity  
from src
  );

[0m14:57:33.500026 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:57:33.504024 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m14:57:33.505026 [debug] [Thread-1 (]: On model.case_project.stg_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_items"} */
alter view "warehouse"."main_staging"."stg_items" rename to "stg_items__dbt_backup"
[0m14:57:33.506026 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:57:33.510025 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m14:57:33.511026 [debug] [Thread-1 (]: On model.case_project.stg_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_items"} */
alter view "warehouse"."main_staging"."stg_items__dbt_tmp" rename to "stg_items"
[0m14:57:33.511346 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:57:33.513346 [debug] [Thread-1 (]: On model.case_project.stg_items: COMMIT
[0m14:57:33.514346 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m14:57:33.514346 [debug] [Thread-1 (]: On model.case_project.stg_items: COMMIT
[0m14:57:33.516379 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:57:33.519348 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m14:57:33.521128 [debug] [Thread-1 (]: On model.case_project.stg_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_items"} */

      drop view if exists "warehouse"."main_staging"."stg_items__dbt_backup" cascade
    
[0m14:57:33.522472 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:57:33.523473 [debug] [Thread-1 (]: On model.case_project.stg_items: Close
[0m14:57:33.525020 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b3096b0-49f4-48c6-9420-d99ccf6f2c97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B2853CD00>]}
[0m14:57:33.525818 [info ] [Thread-1 (]: 2 of 8 OK created sql view model main_staging.stg_items ........................ [[32mOK[0m in 0.05s]
[0m14:57:33.525818 [debug] [Thread-1 (]: Finished running node model.case_project.stg_items
[0m14:57:33.525818 [debug] [Thread-1 (]: Began running node model.case_project.stg_orders
[0m14:57:33.525818 [info ] [Thread-1 (]: 3 of 8 START sql view model main_staging.stg_orders ............................ [RUN]
[0m14:57:33.525818 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_items, now model.case_project.stg_orders)
[0m14:57:33.525818 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_orders
[0m14:57:33.535741 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_orders"
[0m14:57:33.537805 [debug] [Thread-1 (]: Began executing node model.case_project.stg_orders
[0m14:57:33.539745 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_orders"
[0m14:57:33.539745 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m14:57:33.539745 [debug] [Thread-1 (]: On model.case_project.stg_orders: BEGIN
[0m14:57:33.545836 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:57:33.546894 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:57:33.547895 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m14:57:33.547895 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */

  
  create view "warehouse"."main_staging"."stg_orders__dbt_tmp" as (
    with src as (
  select * from "warehouse"."main_raw"."raw_orders"
)
select
  cast(id as varchar)                 as order_id,
  cast(customer as varchar)           as customer_id,
  cast(store_id as varchar)           as store_id,
  cast(ordered_at as timestamp)       as ordered_at,
  cast(subtotal as double)            as subtotal,
  cast(tax_paid as double)            as tax_paid,
  cast(order_total as double)         as order_total
from src
  );

[0m14:57:33.548894 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:57:33.553893 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m14:57:33.554894 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */
alter view "warehouse"."main_staging"."stg_orders" rename to "stg_orders__dbt_backup"
[0m14:57:33.555894 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:57:33.559755 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m14:57:33.560760 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */
alter view "warehouse"."main_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m14:57:33.560760 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:57:33.563791 [debug] [Thread-1 (]: On model.case_project.stg_orders: COMMIT
[0m14:57:33.563791 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m14:57:33.564791 [debug] [Thread-1 (]: On model.case_project.stg_orders: COMMIT
[0m14:57:33.566763 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:57:33.570045 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m14:57:33.570045 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */

      drop view if exists "warehouse"."main_staging"."stg_orders__dbt_backup" cascade
    
[0m14:57:33.572090 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:57:33.573099 [debug] [Thread-1 (]: On model.case_project.stg_orders: Close
[0m14:57:33.574099 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b3096b0-49f4-48c6-9420-d99ccf6f2c97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B285ADB70>]}
[0m14:57:33.574099 [info ] [Thread-1 (]: 3 of 8 OK created sql view model main_staging.stg_orders ....................... [[32mOK[0m in 0.05s]
[0m14:57:33.574099 [debug] [Thread-1 (]: Finished running node model.case_project.stg_orders
[0m14:57:33.574099 [debug] [Thread-1 (]: Began running node model.case_project.stg_products
[0m14:57:33.574099 [info ] [Thread-1 (]: 4 of 8 START sql view model main_staging.stg_products .......................... [RUN]
[0m14:57:33.574099 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_orders, now model.case_project.stg_products)
[0m14:57:33.574099 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_products
[0m14:57:33.574099 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_products"
[0m14:57:33.574099 [debug] [Thread-1 (]: Began executing node model.case_project.stg_products
[0m14:57:33.574099 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_products"
[0m14:57:33.590873 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m14:57:33.591883 [debug] [Thread-1 (]: On model.case_project.stg_products: BEGIN
[0m14:57:33.592200 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:57:33.593204 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:57:33.593978 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m14:57:33.594463 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */

  
  create view "warehouse"."main_staging"."stg_products__dbt_tmp" as (
    -- models/staging/stg_products.sql
with src as (select * from "warehouse"."main_raw"."raw_products")
select
  cast(sku as varchar)      as product_id,
  lower(trim(name))        as product_name,
  cast(price as double)    as price
from src
  );

[0m14:57:33.596531 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:57:33.601617 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m14:57:33.602618 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */
alter view "warehouse"."main_staging"."stg_products" rename to "stg_products__dbt_backup"
[0m14:57:33.603618 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:57:33.608363 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m14:57:33.609365 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */
alter view "warehouse"."main_staging"."stg_products__dbt_tmp" rename to "stg_products"
[0m14:57:33.610364 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:57:33.612363 [debug] [Thread-1 (]: On model.case_project.stg_products: COMMIT
[0m14:57:33.613363 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m14:57:33.613363 [debug] [Thread-1 (]: On model.case_project.stg_products: COMMIT
[0m14:57:33.615362 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:57:33.618363 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m14:57:33.619363 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */

      drop view if exists "warehouse"."main_staging"."stg_products__dbt_backup" cascade
    
[0m14:57:33.621207 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:57:33.622599 [debug] [Thread-1 (]: On model.case_project.stg_products: Close
[0m14:57:33.623666 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b3096b0-49f4-48c6-9420-d99ccf6f2c97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B26D0BBE0>]}
[0m14:57:33.624667 [info ] [Thread-1 (]: 4 of 8 OK created sql view model main_staging.stg_products ..................... [[32mOK[0m in 0.05s]
[0m14:57:33.625666 [debug] [Thread-1 (]: Finished running node model.case_project.stg_products
[0m14:57:33.626637 [debug] [Thread-1 (]: Began running node model.case_project.dim_customers
[0m14:57:33.626637 [info ] [Thread-1 (]: 5 of 8 START sql table model main_marts.dim_customers .......................... [RUN]
[0m14:57:33.627666 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_products, now model.case_project.dim_customers)
[0m14:57:33.628666 [debug] [Thread-1 (]: Began compiling node model.case_project.dim_customers
[0m14:57:33.629641 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.dim_customers"
[0m14:57:33.629641 [debug] [Thread-1 (]: Began executing node model.case_project.dim_customers
[0m14:57:33.658883 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.dim_customers"
[0m14:57:33.660882 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m14:57:33.661883 [debug] [Thread-1 (]: On model.case_project.dim_customers: BEGIN
[0m14:57:33.661883 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:57:33.662882 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:57:33.663882 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m14:57:33.663882 [debug] [Thread-1 (]: On model.case_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_customers"} */

  
    
    

    create  table
      "warehouse"."main_marts"."dim_customers__dbt_tmp"
  
    as (
      -- models/marts/dim_customers.sql


with base as (
    select
        customer_id,
        first_name,
        last_name,
        (first_name || ' ' || coalesce(last_name, '')) as customer_name
    from "warehouse"."main_staging"."stg_customers"
),

orders as (
    select
        customer_id,
        min(ordered_at) as first_order_at,
        max(ordered_at) as most_recent_order_at,
        count(*)        as order_count,
        sum(order_total) as lifetime_value
    from "warehouse"."main_staging"."stg_orders"
    group by 1
)

select
    b.customer_id,
    b.first_name,
    b.last_name,
    b.customer_name,
    o.first_order_at,
    o.most_recent_order_at,
    coalesce(o.order_count, 0)      as order_count,
    coalesce(o.lifetime_value, 0.0) as lifetime_value
from base b
left join orders o using (customer_id)
    );
  
  
[0m14:57:33.673943 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m14:57:33.677942 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m14:57:33.679035 [debug] [Thread-1 (]: On model.case_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_customers"} */
alter table "warehouse"."main_marts"."dim_customers" rename to "dim_customers__dbt_backup"
[0m14:57:33.679035 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:57:33.685034 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m14:57:33.685034 [debug] [Thread-1 (]: On model.case_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_customers"} */
alter table "warehouse"."main_marts"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m14:57:33.685034 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:57:33.685034 [debug] [Thread-1 (]: On model.case_project.dim_customers: COMMIT
[0m14:57:33.685034 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m14:57:33.685034 [debug] [Thread-1 (]: On model.case_project.dim_customers: COMMIT
[0m14:57:33.685034 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:57:33.749751 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m14:57:33.749751 [debug] [Thread-1 (]: On model.case_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_customers"} */

      drop table if exists "warehouse"."main_marts"."dim_customers__dbt_backup" cascade
    
[0m14:57:33.751755 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:57:33.751755 [debug] [Thread-1 (]: On model.case_project.dim_customers: Close
[0m14:57:33.751755 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b3096b0-49f4-48c6-9420-d99ccf6f2c97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B285A3C10>]}
[0m14:57:33.751755 [info ] [Thread-1 (]: 5 of 8 OK created sql table model main_marts.dim_customers ..................... [[32mOK[0m in 0.12s]
[0m14:57:33.751755 [debug] [Thread-1 (]: Finished running node model.case_project.dim_customers
[0m14:57:33.751755 [debug] [Thread-1 (]: Began running node model.case_project.fct_orders
[0m14:57:33.751755 [info ] [Thread-1 (]: 6 of 8 START sql table model main_marts.fct_orders ............................. [RUN]
[0m14:57:33.759823 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.dim_customers, now model.case_project.fct_orders)
[0m14:57:33.759823 [debug] [Thread-1 (]: Began compiling node model.case_project.fct_orders
[0m14:57:33.763936 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.fct_orders"
[0m14:57:33.764936 [debug] [Thread-1 (]: Began executing node model.case_project.fct_orders
[0m14:57:33.769934 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.fct_orders"
[0m14:57:33.770934 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m14:57:33.771932 [debug] [Thread-1 (]: On model.case_project.fct_orders: BEGIN
[0m14:57:33.771932 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:57:33.772934 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:57:33.773934 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m14:57:33.774904 [debug] [Thread-1 (]: On model.case_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_orders"} */

  
    
    

    create  table
      "warehouse"."main_marts"."fct_orders__dbt_tmp"
  
    as (
      -- models/marts/fct_orders.sql


select
    o.order_id,
    o.customer_id,
    o.store_id,
    o.ordered_at,
    cast(date_trunc('day', o.ordered_at) as date) as order_date,
    o.subtotal,
    o.tax_paid,
    o.order_total
from "warehouse"."main_staging"."stg_orders" o
    );
  
  
[0m14:57:33.804415 [debug] [Thread-1 (]: SQL status: OK in 0.031 seconds
[0m14:57:33.810697 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m14:57:33.810697 [debug] [Thread-1 (]: On model.case_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_orders"} */
alter table "warehouse"."main_marts"."fct_orders" rename to "fct_orders__dbt_backup"
[0m14:57:33.810697 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:57:33.816765 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m14:57:33.817775 [debug] [Thread-1 (]: On model.case_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_orders"} */
alter table "warehouse"."main_marts"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m14:57:33.818775 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:57:33.820801 [debug] [Thread-1 (]: On model.case_project.fct_orders: COMMIT
[0m14:57:33.821801 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m14:57:33.822816 [debug] [Thread-1 (]: On model.case_project.fct_orders: COMMIT
[0m14:57:33.837960 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m14:57:33.837960 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m14:57:33.837960 [debug] [Thread-1 (]: On model.case_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_orders"} */

      drop table if exists "warehouse"."main_marts"."fct_orders__dbt_backup" cascade
    
[0m14:57:33.837960 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:57:33.837960 [debug] [Thread-1 (]: On model.case_project.fct_orders: Close
[0m14:57:33.837960 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b3096b0-49f4-48c6-9420-d99ccf6f2c97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B285D1600>]}
[0m14:57:33.837960 [info ] [Thread-1 (]: 6 of 8 OK created sql table model main_marts.fct_orders ........................ [[32mOK[0m in 0.09s]
[0m14:57:33.853786 [debug] [Thread-1 (]: Finished running node model.case_project.fct_orders
[0m14:57:33.853786 [debug] [Thread-1 (]: Began running node model.case_project.dim_products
[0m14:57:33.854925 [info ] [Thread-1 (]: 7 of 8 START sql table model main_marts.dim_products ........................... [RUN]
[0m14:57:33.855952 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.fct_orders, now model.case_project.dim_products)
[0m14:57:33.856948 [debug] [Thread-1 (]: Began compiling node model.case_project.dim_products
[0m14:57:33.860923 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.dim_products"
[0m14:57:33.861922 [debug] [Thread-1 (]: Began executing node model.case_project.dim_products
[0m14:57:33.868920 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.dim_products"
[0m14:57:33.869924 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_products"
[0m14:57:33.870925 [debug] [Thread-1 (]: On model.case_project.dim_products: BEGIN
[0m14:57:33.871923 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:57:33.872921 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:57:33.873923 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_products"
[0m14:57:33.873923 [debug] [Thread-1 (]: On model.case_project.dim_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_products"} */

  
    
    

    create  table
      "warehouse"."main_marts"."dim_products__dbt_tmp"
  
    as (
      -- models/marts/dim_products.sql


select
    p.product_id,
    p.product_name,
    p.price as current_list_price
from "warehouse"."main_staging"."stg_products" p
    );
  
  
[0m14:57:33.875922 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:57:33.880925 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_products"
[0m14:57:33.880925 [debug] [Thread-1 (]: On model.case_project.dim_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_products"} */
alter table "warehouse"."main_marts"."dim_products" rename to "dim_products__dbt_backup"
[0m14:57:33.881924 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:57:33.886925 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_products"
[0m14:57:33.887923 [debug] [Thread-1 (]: On model.case_project.dim_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_products"} */
alter table "warehouse"."main_marts"."dim_products__dbt_tmp" rename to "dim_products"
[0m14:57:33.888923 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:57:33.891923 [debug] [Thread-1 (]: On model.case_project.dim_products: COMMIT
[0m14:57:33.891923 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_products"
[0m14:57:33.892920 [debug] [Thread-1 (]: On model.case_project.dim_products: COMMIT
[0m14:57:33.894922 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:57:33.898920 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_products"
[0m14:57:33.898920 [debug] [Thread-1 (]: On model.case_project.dim_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_products"} */

      drop table if exists "warehouse"."main_marts"."dim_products__dbt_backup" cascade
    
[0m14:57:33.901104 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:57:33.903104 [debug] [Thread-1 (]: On model.case_project.dim_products: Close
[0m14:57:33.904104 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b3096b0-49f4-48c6-9420-d99ccf6f2c97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B26725E40>]}
[0m14:57:33.905102 [info ] [Thread-1 (]: 7 of 8 OK created sql table model main_marts.dim_products ...................... [[32mOK[0m in 0.05s]
[0m14:57:33.906104 [debug] [Thread-1 (]: Finished running node model.case_project.dim_products
[0m14:57:33.906104 [debug] [Thread-1 (]: Began running node model.case_project.fct_order_items
[0m14:57:33.907103 [info ] [Thread-1 (]: 8 of 8 START sql table model main_marts.fct_order_items ........................ [RUN]
[0m14:57:33.908273 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.dim_products, now model.case_project.fct_order_items)
[0m14:57:33.909272 [debug] [Thread-1 (]: Began compiling node model.case_project.fct_order_items
[0m14:57:33.913271 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.fct_order_items"
[0m14:57:33.914271 [debug] [Thread-1 (]: Began executing node model.case_project.fct_order_items
[0m14:57:33.914271 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.fct_order_items"
[0m14:57:33.914271 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_order_items"
[0m14:57:33.914271 [debug] [Thread-1 (]: On model.case_project.fct_order_items: BEGIN
[0m14:57:33.914271 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:57:33.914271 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:57:33.914271 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_order_items"
[0m14:57:33.914271 [debug] [Thread-1 (]: On model.case_project.fct_order_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_order_items"} */

  
    
    

    create  table
      "warehouse"."main_marts"."fct_order_items__dbt_tmp"
  
    as (
      -- models/marts/fct_order_items.sql


with items as (
  select
    order_id,
    product_id,
    quantity
  from "warehouse"."main_staging"."stg_items"
),
prod as (
  select
    product_id,
    product_name,
    price as unit_price
  from "warehouse"."main_staging"."stg_products"
)

select
  i.order_id,
  i.product_id,
  p.product_name,
  i.quantity,
  p.unit_price,
  i.quantity * p.unit_price as line_revenue
from items i
left join prod p using (product_id)
    );
  
  
[0m14:57:33.963770 [debug] [Thread-1 (]: SQL status: OK in 0.039 seconds
[0m14:57:33.967769 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_order_items"
[0m14:57:33.968770 [debug] [Thread-1 (]: On model.case_project.fct_order_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_order_items"} */
alter table "warehouse"."main_marts"."fct_order_items__dbt_tmp" rename to "fct_order_items"
[0m14:57:33.969769 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:57:33.969769 [debug] [Thread-1 (]: On model.case_project.fct_order_items: COMMIT
[0m14:57:33.969769 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_order_items"
[0m14:57:33.969769 [debug] [Thread-1 (]: On model.case_project.fct_order_items: COMMIT
[0m14:57:33.985861 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m14:57:33.985861 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_order_items"
[0m14:57:33.985861 [debug] [Thread-1 (]: On model.case_project.fct_order_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_order_items"} */

      drop table if exists "warehouse"."main_marts"."fct_order_items__dbt_backup" cascade
    
[0m14:57:33.985861 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:57:33.985861 [debug] [Thread-1 (]: On model.case_project.fct_order_items: Close
[0m14:57:34.001766 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b3096b0-49f4-48c6-9420-d99ccf6f2c97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B27D33880>]}
[0m14:57:34.001766 [info ] [Thread-1 (]: 8 of 8 OK created sql table model main_marts.fct_order_items ................... [[32mOK[0m in 0.09s]
[0m14:57:34.001766 [debug] [Thread-1 (]: Finished running node model.case_project.fct_order_items
[0m14:57:34.001766 [debug] [MainThread]: Using duckdb connection "master"
[0m14:57:34.001766 [debug] [MainThread]: On master: BEGIN
[0m14:57:34.001766 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:57:34.001766 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:57:34.001766 [debug] [MainThread]: On master: COMMIT
[0m14:57:34.001766 [debug] [MainThread]: Using duckdb connection "master"
[0m14:57:34.001766 [debug] [MainThread]: On master: COMMIT
[0m14:57:34.001766 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:57:34.001766 [debug] [MainThread]: On master: Close
[0m14:57:34.001766 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:57:34.001766 [debug] [MainThread]: Connection 'create_warehouse_main_staging' was properly closed.
[0m14:57:34.001766 [debug] [MainThread]: Connection 'list_warehouse_main_staging' was properly closed.
[0m14:57:34.001766 [debug] [MainThread]: Connection 'model.case_project.fct_order_items' was properly closed.
[0m14:57:34.001766 [info ] [MainThread]: 
[0m14:57:34.001766 [info ] [MainThread]: Finished running 4 table models, 4 view models in 0 hours 0 minutes and 1.00 seconds (1.00s).
[0m14:57:34.016860 [debug] [MainThread]: Command end result
[0m14:57:34.051921 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\manss\Desktop\Case Project\target\manifest.json
[0m14:57:34.056221 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\manss\Desktop\Case Project\target\semantic_manifest.json
[0m14:57:34.060226 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\manss\Desktop\Case Project\target\run_results.json
[0m14:57:34.060226 [info ] [MainThread]: 
[0m14:57:34.060226 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:57:34.060226 [info ] [MainThread]: 
[0m14:57:34.060226 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m14:57:34.060226 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m14:57:34.060226 [debug] [MainThread]: Command `dbt run` succeeded at 14:57:34.060226 after 3.04 seconds
[0m14:57:34.060226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B243B31F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B256E3250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B267BC790>]}
[0m14:57:34.071861 [debug] [MainThread]: Flushing usage events
[0m14:57:34.821303 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:58:11.182563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F2D4D31F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F2F5C7B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F2D831390>]}


============================== 14:58:11.199813 | 2e55d5de-7068-4443-b34d-64f7fe560940 ==============================
[0m14:58:11.199813 [info ] [MainThread]: Running with dbt=1.10.9
[0m14:58:11.201814 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt test', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\manss\\Desktop\\Case Project\\logs', 'profiles_dir': 'C:\\Users\\manss\\Desktop\\Case Project', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m14:58:11.492739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e55d5de-7068-4443-b34d-64f7fe560940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F2D821180>]}
[0m14:58:11.575247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e55d5de-7068-4443-b34d-64f7fe560940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F2EF89390>]}
[0m14:58:11.578893 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:58:11.930659 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m14:58:12.243680 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:58:12.243680 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:58:12.342227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e55d5de-7068-4443-b34d-64f7fe560940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F2FED0130>]}
[0m14:58:12.540253 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\manss\Desktop\Case Project\target\manifest.json
[0m14:58:12.543751 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\manss\Desktop\Case Project\target\semantic_manifest.json
[0m14:58:12.584118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e55d5de-7068-4443-b34d-64f7fe560940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F2FEDF0D0>]}
[0m14:58:12.584118 [info ] [MainThread]: Found 4 seeds, 8 models, 18 data tests, 4 sources, 429 macros
[0m14:58:12.584118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e55d5de-7068-4443-b34d-64f7fe560940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F2FEDEEF0>]}
[0m14:58:12.589335 [info ] [MainThread]: 
[0m14:58:12.589335 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:58:12.591473 [info ] [MainThread]: 
[0m14:58:12.592821 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:58:12.602807 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_staging'
[0m14:58:12.796516 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_staging"
[0m14:58:12.796516 [debug] [ThreadPool]: On list_warehouse_main_staging: BEGIN
[0m14:58:12.796516 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:58:12.828567 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m14:58:12.828567 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_staging"
[0m14:58:12.828567 [debug] [ThreadPool]: On list_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_staging"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'warehouse'
  
[0m14:58:12.844366 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m14:58:12.844366 [debug] [ThreadPool]: On list_warehouse_main_staging: ROLLBACK
[0m14:58:12.844366 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_staging'
[0m14:58:12.844366 [debug] [ThreadPool]: On list_warehouse_main_staging: Close
[0m14:58:12.844366 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_staging, now list_warehouse_main_raw)
[0m14:58:12.844366 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m14:58:12.844366 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m14:58:12.844366 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:58:12.844366 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:58:12.844366 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m14:58:12.860222 [debug] [ThreadPool]: On list_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_raw"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'warehouse'
  
[0m14:58:12.861952 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m14:58:12.861952 [debug] [ThreadPool]: On list_warehouse_main_raw: ROLLBACK
[0m14:58:12.861952 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_raw'
[0m14:58:12.861952 [debug] [ThreadPool]: On list_warehouse_main_raw: Close
[0m14:58:12.861952 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_raw, now list_warehouse_main_marts)
[0m14:58:12.861952 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m14:58:12.861952 [debug] [ThreadPool]: On list_warehouse_main_marts: BEGIN
[0m14:58:12.861952 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:58:12.861952 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:58:12.861952 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m14:58:12.861952 [debug] [ThreadPool]: On list_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_marts"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'warehouse'
  
[0m14:58:12.876983 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m14:58:12.878983 [debug] [ThreadPool]: On list_warehouse_main_marts: ROLLBACK
[0m14:58:12.879984 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_marts'
[0m14:58:12.879984 [debug] [ThreadPool]: On list_warehouse_main_marts: Close
[0m14:58:12.882146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e55d5de-7068-4443-b34d-64f7fe560940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F2FEDEEF0>]}
[0m14:58:12.882146 [debug] [MainThread]: Using duckdb connection "master"
[0m14:58:12.883153 [debug] [MainThread]: On master: BEGIN
[0m14:58:12.884156 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:58:12.884156 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:58:12.884156 [debug] [MainThread]: On master: COMMIT
[0m14:58:12.884156 [debug] [MainThread]: Using duckdb connection "master"
[0m14:58:12.884156 [debug] [MainThread]: On master: COMMIT
[0m14:58:12.884156 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:58:12.884156 [debug] [MainThread]: On master: Close
[0m14:58:12.884156 [debug] [Thread-1 (]: Began running node test.case_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m14:58:12.884156 [info ] [Thread-1 (]: 1 of 18 START test not_null_dim_customers_customer_id .......................... [RUN]
[0m14:58:12.884156 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.case_project.not_null_dim_customers_customer_id.dd91cd1c8d'
[0m14:58:12.884156 [debug] [Thread-1 (]: Began compiling node test.case_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m14:58:12.916551 [debug] [Thread-1 (]: Writing injected SQL for node "test.case_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m14:58:12.918523 [debug] [Thread-1 (]: Began executing node test.case_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m14:58:12.934204 [debug] [Thread-1 (]: Writing runtime sql for node "test.case_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m14:58:12.934204 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m14:58:12.934204 [debug] [Thread-1 (]: On test.case_project.not_null_dim_customers_customer_id.dd91cd1c8d: BEGIN
[0m14:58:12.934204 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:58:12.934204 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:58:12.934204 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m14:58:12.934204 [debug] [Thread-1 (]: On test.case_project.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "test.case_project.not_null_dim_customers_customer_id.dd91cd1c8d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "warehouse"."main_marts"."dim_customers"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m14:58:12.934204 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:58:12.951223 [debug] [Thread-1 (]: On test.case_project.not_null_dim_customers_customer_id.dd91cd1c8d: ROLLBACK
[0m14:58:12.952222 [debug] [Thread-1 (]: Failed to rollback 'test.case_project.not_null_dim_customers_customer_id.dd91cd1c8d'
[0m14:58:12.953215 [debug] [Thread-1 (]: On test.case_project.not_null_dim_customers_customer_id.dd91cd1c8d: Close
[0m14:58:12.954222 [info ] [Thread-1 (]: 1 of 18 PASS not_null_dim_customers_customer_id ................................ [[32mPASS[0m in 0.07s]
[0m14:58:12.955192 [debug] [Thread-1 (]: Finished running node test.case_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m14:58:12.955192 [debug] [Thread-1 (]: Began running node test.case_project.not_null_dim_products_product_id.c8aba288d1
[0m14:58:12.956192 [info ] [Thread-1 (]: 2 of 18 START test not_null_dim_products_product_id ............................ [RUN]
[0m14:58:12.957201 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.case_project.not_null_dim_customers_customer_id.dd91cd1c8d, now test.case_project.not_null_dim_products_product_id.c8aba288d1)
[0m14:58:12.958238 [debug] [Thread-1 (]: Began compiling node test.case_project.not_null_dim_products_product_id.c8aba288d1
[0m14:58:12.962237 [debug] [Thread-1 (]: Writing injected SQL for node "test.case_project.not_null_dim_products_product_id.c8aba288d1"
[0m14:58:12.962237 [debug] [Thread-1 (]: Began executing node test.case_project.not_null_dim_products_product_id.c8aba288d1
[0m14:58:12.962237 [debug] [Thread-1 (]: Writing runtime sql for node "test.case_project.not_null_dim_products_product_id.c8aba288d1"
[0m14:58:12.962237 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.not_null_dim_products_product_id.c8aba288d1"
[0m14:58:12.962237 [debug] [Thread-1 (]: On test.case_project.not_null_dim_products_product_id.c8aba288d1: BEGIN
[0m14:58:12.962237 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:12.962237 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:58:12.962237 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.not_null_dim_products_product_id.c8aba288d1"
[0m14:58:12.962237 [debug] [Thread-1 (]: On test.case_project.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "test.case_project.not_null_dim_products_product_id.c8aba288d1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "warehouse"."main_marts"."dim_products"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m14:58:12.962237 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:58:12.962237 [debug] [Thread-1 (]: On test.case_project.not_null_dim_products_product_id.c8aba288d1: ROLLBACK
[0m14:58:12.962237 [debug] [Thread-1 (]: Failed to rollback 'test.case_project.not_null_dim_products_product_id.c8aba288d1'
[0m14:58:12.962237 [debug] [Thread-1 (]: On test.case_project.not_null_dim_products_product_id.c8aba288d1: Close
[0m14:58:12.962237 [info ] [Thread-1 (]: 2 of 18 PASS not_null_dim_products_product_id .................................. [[32mPASS[0m in 0.01s]
[0m14:58:12.978285 [debug] [Thread-1 (]: Finished running node test.case_project.not_null_dim_products_product_id.c8aba288d1
[0m14:58:12.979395 [debug] [Thread-1 (]: Began running node test.case_project.not_null_fct_orders_order_id.4e687af8d0
[0m14:58:12.980395 [info ] [Thread-1 (]: 3 of 18 START test not_null_fct_orders_order_id ................................ [RUN]
[0m14:58:12.981395 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.case_project.not_null_dim_products_product_id.c8aba288d1, now test.case_project.not_null_fct_orders_order_id.4e687af8d0)
[0m14:58:12.981395 [debug] [Thread-1 (]: Began compiling node test.case_project.not_null_fct_orders_order_id.4e687af8d0
[0m14:58:12.988423 [debug] [Thread-1 (]: Writing injected SQL for node "test.case_project.not_null_fct_orders_order_id.4e687af8d0"
[0m14:58:12.990391 [debug] [Thread-1 (]: Began executing node test.case_project.not_null_fct_orders_order_id.4e687af8d0
[0m14:58:12.993425 [debug] [Thread-1 (]: Writing runtime sql for node "test.case_project.not_null_fct_orders_order_id.4e687af8d0"
[0m14:58:12.995392 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.not_null_fct_orders_order_id.4e687af8d0"
[0m14:58:12.995392 [debug] [Thread-1 (]: On test.case_project.not_null_fct_orders_order_id.4e687af8d0: BEGIN
[0m14:58:12.996420 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:12.997392 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:58:12.998392 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.not_null_fct_orders_order_id.4e687af8d0"
[0m14:58:12.998392 [debug] [Thread-1 (]: On test.case_project.not_null_fct_orders_order_id.4e687af8d0: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "test.case_project.not_null_fct_orders_order_id.4e687af8d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "warehouse"."main_marts"."fct_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m14:58:13.000392 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:58:13.001422 [debug] [Thread-1 (]: On test.case_project.not_null_fct_orders_order_id.4e687af8d0: ROLLBACK
[0m14:58:13.002390 [debug] [Thread-1 (]: Failed to rollback 'test.case_project.not_null_fct_orders_order_id.4e687af8d0'
[0m14:58:13.003390 [debug] [Thread-1 (]: On test.case_project.not_null_fct_orders_order_id.4e687af8d0: Close
[0m14:58:13.004392 [info ] [Thread-1 (]: 3 of 18 PASS not_null_fct_orders_order_id ...................................... [[32mPASS[0m in 0.02s]
[0m14:58:13.005391 [debug] [Thread-1 (]: Finished running node test.case_project.not_null_fct_orders_order_id.4e687af8d0
[0m14:58:13.006392 [debug] [Thread-1 (]: Began running node test.case_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m14:58:13.006392 [info ] [Thread-1 (]: 4 of 18 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m14:58:13.007392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.case_project.not_null_fct_orders_order_id.4e687af8d0, now test.case_project.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m14:58:13.008392 [debug] [Thread-1 (]: Began compiling node test.case_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m14:58:13.011041 [debug] [Thread-1 (]: Writing injected SQL for node "test.case_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m14:58:13.011041 [debug] [Thread-1 (]: Began executing node test.case_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m14:58:13.018907 [debug] [Thread-1 (]: Writing runtime sql for node "test.case_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m14:58:13.020975 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m14:58:13.022037 [debug] [Thread-1 (]: On test.case_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m14:58:13.022037 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:13.023007 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:58:13.024396 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m14:58:13.025197 [debug] [Thread-1 (]: On test.case_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "test.case_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "warehouse"."main_staging"."stg_customers"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m14:58:13.025197 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:58:13.025197 [debug] [Thread-1 (]: On test.case_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m14:58:13.025197 [debug] [Thread-1 (]: Failed to rollback 'test.case_project.not_null_stg_customers_customer_id.e2cfb1f9aa'
[0m14:58:13.025197 [debug] [Thread-1 (]: On test.case_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m14:58:13.025197 [info ] [Thread-1 (]: 4 of 18 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.02s]
[0m14:58:13.031516 [debug] [Thread-1 (]: Finished running node test.case_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m14:58:13.032644 [debug] [Thread-1 (]: Began running node test.case_project.not_null_stg_items_order_id.f5d55da547
[0m14:58:13.033675 [info ] [Thread-1 (]: 5 of 18 START test not_null_stg_items_order_id ................................. [RUN]
[0m14:58:13.034645 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.case_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.case_project.not_null_stg_items_order_id.f5d55da547)
[0m14:58:13.034645 [debug] [Thread-1 (]: Began compiling node test.case_project.not_null_stg_items_order_id.f5d55da547
[0m14:58:13.040498 [debug] [Thread-1 (]: Writing injected SQL for node "test.case_project.not_null_stg_items_order_id.f5d55da547"
[0m14:58:13.041499 [debug] [Thread-1 (]: Began executing node test.case_project.not_null_stg_items_order_id.f5d55da547
[0m14:58:13.045498 [debug] [Thread-1 (]: Writing runtime sql for node "test.case_project.not_null_stg_items_order_id.f5d55da547"
[0m14:58:13.046468 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.not_null_stg_items_order_id.f5d55da547"
[0m14:58:13.047468 [debug] [Thread-1 (]: On test.case_project.not_null_stg_items_order_id.f5d55da547: BEGIN
[0m14:58:13.047468 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:13.048470 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:58:13.048470 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.not_null_stg_items_order_id.f5d55da547"
[0m14:58:13.048470 [debug] [Thread-1 (]: On test.case_project.not_null_stg_items_order_id.f5d55da547: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "test.case_project.not_null_stg_items_order_id.f5d55da547"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "warehouse"."main_staging"."stg_items"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m14:58:13.048470 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:58:13.053131 [debug] [Thread-1 (]: On test.case_project.not_null_stg_items_order_id.f5d55da547: ROLLBACK
[0m14:58:13.053131 [debug] [Thread-1 (]: Failed to rollback 'test.case_project.not_null_stg_items_order_id.f5d55da547'
[0m14:58:13.053131 [debug] [Thread-1 (]: On test.case_project.not_null_stg_items_order_id.f5d55da547: Close
[0m14:58:13.053131 [info ] [Thread-1 (]: 5 of 18 PASS not_null_stg_items_order_id ....................................... [[32mPASS[0m in 0.02s]
[0m14:58:13.057158 [debug] [Thread-1 (]: Finished running node test.case_project.not_null_stg_items_order_id.f5d55da547
[0m14:58:13.057158 [debug] [Thread-1 (]: Began running node test.case_project.not_null_stg_items_product_id.aa0688cb17
[0m14:58:13.058194 [info ] [Thread-1 (]: 6 of 18 START test not_null_stg_items_product_id ............................... [RUN]
[0m14:58:13.059165 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.case_project.not_null_stg_items_order_id.f5d55da547, now test.case_project.not_null_stg_items_product_id.aa0688cb17)
[0m14:58:13.060197 [debug] [Thread-1 (]: Began compiling node test.case_project.not_null_stg_items_product_id.aa0688cb17
[0m14:58:13.065384 [debug] [Thread-1 (]: Writing injected SQL for node "test.case_project.not_null_stg_items_product_id.aa0688cb17"
[0m14:58:13.066386 [debug] [Thread-1 (]: Began executing node test.case_project.not_null_stg_items_product_id.aa0688cb17
[0m14:58:13.071384 [debug] [Thread-1 (]: Writing runtime sql for node "test.case_project.not_null_stg_items_product_id.aa0688cb17"
[0m14:58:13.072973 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.not_null_stg_items_product_id.aa0688cb17"
[0m14:58:13.073979 [debug] [Thread-1 (]: On test.case_project.not_null_stg_items_product_id.aa0688cb17: BEGIN
[0m14:58:13.073979 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:13.074978 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:58:13.075978 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.not_null_stg_items_product_id.aa0688cb17"
[0m14:58:13.076978 [debug] [Thread-1 (]: On test.case_project.not_null_stg_items_product_id.aa0688cb17: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "test.case_project.not_null_stg_items_product_id.aa0688cb17"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "warehouse"."main_staging"."stg_items"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m14:58:13.077977 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:58:13.079978 [debug] [Thread-1 (]: On test.case_project.not_null_stg_items_product_id.aa0688cb17: ROLLBACK
[0m14:58:13.079978 [debug] [Thread-1 (]: Failed to rollback 'test.case_project.not_null_stg_items_product_id.aa0688cb17'
[0m14:58:13.080979 [debug] [Thread-1 (]: On test.case_project.not_null_stg_items_product_id.aa0688cb17: Close
[0m14:58:13.081978 [info ] [Thread-1 (]: 6 of 18 PASS not_null_stg_items_product_id ..................................... [[32mPASS[0m in 0.02s]
[0m14:58:13.082842 [debug] [Thread-1 (]: Finished running node test.case_project.not_null_stg_items_product_id.aa0688cb17
[0m14:58:13.083893 [debug] [Thread-1 (]: Began running node test.case_project.not_null_stg_orders_order_id.81cfe2fe64
[0m14:58:13.083893 [info ] [Thread-1 (]: 7 of 18 START test not_null_stg_orders_order_id ................................ [RUN]
[0m14:58:13.083893 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.case_project.not_null_stg_items_product_id.aa0688cb17, now test.case_project.not_null_stg_orders_order_id.81cfe2fe64)
[0m14:58:13.086824 [debug] [Thread-1 (]: Began compiling node test.case_project.not_null_stg_orders_order_id.81cfe2fe64
[0m14:58:13.091642 [debug] [Thread-1 (]: Writing injected SQL for node "test.case_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m14:58:13.093639 [debug] [Thread-1 (]: Began executing node test.case_project.not_null_stg_orders_order_id.81cfe2fe64
[0m14:58:13.096642 [debug] [Thread-1 (]: Writing runtime sql for node "test.case_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m14:58:13.097643 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m14:58:13.098643 [debug] [Thread-1 (]: On test.case_project.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m14:58:13.099643 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:13.100640 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:58:13.100640 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m14:58:13.101643 [debug] [Thread-1 (]: On test.case_project.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "test.case_project.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "warehouse"."main_staging"."stg_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m14:58:13.103347 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:58:13.105383 [debug] [Thread-1 (]: On test.case_project.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m14:58:13.105383 [debug] [Thread-1 (]: Failed to rollback 'test.case_project.not_null_stg_orders_order_id.81cfe2fe64'
[0m14:58:13.106353 [debug] [Thread-1 (]: On test.case_project.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m14:58:13.107355 [info ] [Thread-1 (]: 7 of 18 PASS not_null_stg_orders_order_id ...................................... [[32mPASS[0m in 0.02s]
[0m14:58:13.108668 [debug] [Thread-1 (]: Finished running node test.case_project.not_null_stg_orders_order_id.81cfe2fe64
[0m14:58:13.109421 [debug] [Thread-1 (]: Began running node test.case_project.not_null_stg_orders_ordered_at.ed431172ca
[0m14:58:13.110281 [info ] [Thread-1 (]: 8 of 18 START test not_null_stg_orders_ordered_at .............................. [RUN]
[0m14:58:13.111290 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.case_project.not_null_stg_orders_order_id.81cfe2fe64, now test.case_project.not_null_stg_orders_ordered_at.ed431172ca)
[0m14:58:13.111290 [debug] [Thread-1 (]: Began compiling node test.case_project.not_null_stg_orders_ordered_at.ed431172ca
[0m14:58:13.117025 [debug] [Thread-1 (]: Writing injected SQL for node "test.case_project.not_null_stg_orders_ordered_at.ed431172ca"
[0m14:58:13.119034 [debug] [Thread-1 (]: Began executing node test.case_project.not_null_stg_orders_ordered_at.ed431172ca
[0m14:58:13.122031 [debug] [Thread-1 (]: Writing runtime sql for node "test.case_project.not_null_stg_orders_ordered_at.ed431172ca"
[0m14:58:13.123032 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.not_null_stg_orders_ordered_at.ed431172ca"
[0m14:58:13.123032 [debug] [Thread-1 (]: On test.case_project.not_null_stg_orders_ordered_at.ed431172ca: BEGIN
[0m14:58:13.123032 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:13.123032 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:58:13.123032 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.not_null_stg_orders_ordered_at.ed431172ca"
[0m14:58:13.123032 [debug] [Thread-1 (]: On test.case_project.not_null_stg_orders_ordered_at.ed431172ca: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "test.case_project.not_null_stg_orders_ordered_at.ed431172ca"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ordered_at
from "warehouse"."main_staging"."stg_orders"
where ordered_at is null



  
  
      
    ) dbt_internal_test
[0m14:58:13.128618 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:58:13.129550 [debug] [Thread-1 (]: On test.case_project.not_null_stg_orders_ordered_at.ed431172ca: ROLLBACK
[0m14:58:13.129550 [debug] [Thread-1 (]: Failed to rollback 'test.case_project.not_null_stg_orders_ordered_at.ed431172ca'
[0m14:58:13.129550 [debug] [Thread-1 (]: On test.case_project.not_null_stg_orders_ordered_at.ed431172ca: Close
[0m14:58:13.129550 [info ] [Thread-1 (]: 8 of 18 PASS not_null_stg_orders_ordered_at .................................... [[32mPASS[0m in 0.02s]
[0m14:58:13.129550 [debug] [Thread-1 (]: Finished running node test.case_project.not_null_stg_orders_ordered_at.ed431172ca
[0m14:58:13.135561 [debug] [Thread-1 (]: Began running node test.case_project.not_null_stg_products_product_id.6373b0acf3
[0m14:58:13.136485 [info ] [Thread-1 (]: 9 of 18 START test not_null_stg_products_product_id ............................ [RUN]
[0m14:58:13.137570 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.case_project.not_null_stg_orders_ordered_at.ed431172ca, now test.case_project.not_null_stg_products_product_id.6373b0acf3)
[0m14:58:13.137570 [debug] [Thread-1 (]: Began compiling node test.case_project.not_null_stg_products_product_id.6373b0acf3
[0m14:58:13.142610 [debug] [Thread-1 (]: Writing injected SQL for node "test.case_project.not_null_stg_products_product_id.6373b0acf3"
[0m14:58:13.144770 [debug] [Thread-1 (]: Began executing node test.case_project.not_null_stg_products_product_id.6373b0acf3
[0m14:58:13.147803 [debug] [Thread-1 (]: Writing runtime sql for node "test.case_project.not_null_stg_products_product_id.6373b0acf3"
[0m14:58:13.149771 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.not_null_stg_products_product_id.6373b0acf3"
[0m14:58:13.150636 [debug] [Thread-1 (]: On test.case_project.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m14:58:13.150636 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:13.152722 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:58:13.152722 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.not_null_stg_products_product_id.6373b0acf3"
[0m14:58:13.153721 [debug] [Thread-1 (]: On test.case_project.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "test.case_project.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "warehouse"."main_staging"."stg_products"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m14:58:13.154717 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:58:13.156722 [debug] [Thread-1 (]: On test.case_project.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m14:58:13.157722 [debug] [Thread-1 (]: Failed to rollback 'test.case_project.not_null_stg_products_product_id.6373b0acf3'
[0m14:58:13.158723 [debug] [Thread-1 (]: On test.case_project.not_null_stg_products_product_id.6373b0acf3: Close
[0m14:58:13.159722 [info ] [Thread-1 (]: 9 of 18 PASS not_null_stg_products_product_id .................................. [[32mPASS[0m in 0.02s]
[0m14:58:13.160721 [debug] [Thread-1 (]: Finished running node test.case_project.not_null_stg_products_product_id.6373b0acf3
[0m14:58:13.161722 [debug] [Thread-1 (]: Began running node test.case_project.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec
[0m14:58:13.162722 [info ] [Thread-1 (]: 10 of 18 START test relationships_fct_order_items_order_id__order_id__ref_fct_orders_  [RUN]
[0m14:58:13.163719 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.case_project.not_null_stg_products_product_id.6373b0acf3, now test.case_project.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec)
[0m14:58:13.164723 [debug] [Thread-1 (]: Began compiling node test.case_project.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec
[0m14:58:13.176809 [debug] [Thread-1 (]: Writing injected SQL for node "test.case_project.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec"
[0m14:58:13.177811 [debug] [Thread-1 (]: Began executing node test.case_project.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec
[0m14:58:13.180838 [debug] [Thread-1 (]: Writing runtime sql for node "test.case_project.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec"
[0m14:58:13.180838 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec"
[0m14:58:13.185152 [debug] [Thread-1 (]: On test.case_project.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec: BEGIN
[0m14:58:13.186152 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:13.187153 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:58:13.188149 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec"
[0m14:58:13.188149 [debug] [Thread-1 (]: On test.case_project.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "test.case_project.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select order_id as from_field
    from "warehouse"."main_marts"."fct_order_items"
    where order_id is not null
),

parent as (
    select order_id as to_field
    from "warehouse"."main_marts"."fct_orders"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m14:58:13.209840 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m14:58:13.212840 [debug] [Thread-1 (]: On test.case_project.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec: ROLLBACK
[0m14:58:13.212840 [debug] [Thread-1 (]: Failed to rollback 'test.case_project.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec'
[0m14:58:13.212840 [debug] [Thread-1 (]: On test.case_project.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec: Close
[0m14:58:13.212840 [info ] [Thread-1 (]: 10 of 18 PASS relationships_fct_order_items_order_id__order_id__ref_fct_orders_  [[32mPASS[0m in 0.05s]
[0m14:58:13.212840 [debug] [Thread-1 (]: Finished running node test.case_project.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec
[0m14:58:13.212840 [debug] [Thread-1 (]: Began running node test.case_project.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1
[0m14:58:13.212840 [info ] [Thread-1 (]: 11 of 18 START test relationships_fct_order_items_product_id__product_id__ref_dim_products_  [RUN]
[0m14:58:13.212840 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.case_project.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec, now test.case_project.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1)
[0m14:58:13.212840 [debug] [Thread-1 (]: Began compiling node test.case_project.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1
[0m14:58:13.212840 [debug] [Thread-1 (]: Writing injected SQL for node "test.case_project.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1"
[0m14:58:13.212840 [debug] [Thread-1 (]: Began executing node test.case_project.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1
[0m14:58:13.232009 [debug] [Thread-1 (]: Writing runtime sql for node "test.case_project.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1"
[0m14:58:13.234503 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1"
[0m14:58:13.234812 [debug] [Thread-1 (]: On test.case_project.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1: BEGIN
[0m14:58:13.235842 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:13.235842 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:58:13.235842 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1"
[0m14:58:13.235842 [debug] [Thread-1 (]: On test.case_project.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "test.case_project.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_id as from_field
    from "warehouse"."main_marts"."fct_order_items"
    where product_id is not null
),

parent as (
    select product_id as to_field
    from "warehouse"."main_marts"."dim_products"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m14:58:13.241433 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:58:13.241433 [debug] [Thread-1 (]: On test.case_project.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1: ROLLBACK
[0m14:58:13.246681 [debug] [Thread-1 (]: Failed to rollback 'test.case_project.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1'
[0m14:58:13.247500 [debug] [Thread-1 (]: On test.case_project.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1: Close
[0m14:58:13.247500 [info ] [Thread-1 (]: 11 of 18 PASS relationships_fct_order_items_product_id__product_id__ref_dim_products_  [[32mPASS[0m in 0.03s]
[0m14:58:13.247500 [debug] [Thread-1 (]: Finished running node test.case_project.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1
[0m14:58:13.247500 [debug] [Thread-1 (]: Began running node test.case_project.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m14:58:13.247500 [info ] [Thread-1 (]: 12 of 18 START test relationships_fct_orders_customer_id__customer_id__ref_dim_customers_  [RUN]
[0m14:58:13.247500 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.case_project.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1, now test.case_project.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4)
[0m14:58:13.247500 [debug] [Thread-1 (]: Began compiling node test.case_project.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m14:58:13.259645 [debug] [Thread-1 (]: Writing injected SQL for node "test.case_project.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m14:58:13.260615 [debug] [Thread-1 (]: Began executing node test.case_project.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m14:58:13.264810 [debug] [Thread-1 (]: Writing runtime sql for node "test.case_project.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m14:58:13.265812 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m14:58:13.266811 [debug] [Thread-1 (]: On test.case_project.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: BEGIN
[0m14:58:13.266811 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:13.267812 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:58:13.269121 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m14:58:13.269727 [debug] [Thread-1 (]: On test.case_project.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "test.case_project.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from "warehouse"."main_marts"."fct_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "warehouse"."main_marts"."dim_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m14:58:13.275788 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:58:13.276128 [debug] [Thread-1 (]: On test.case_project.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: ROLLBACK
[0m14:58:13.276128 [debug] [Thread-1 (]: Failed to rollback 'test.case_project.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4'
[0m14:58:13.276128 [debug] [Thread-1 (]: On test.case_project.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: Close
[0m14:58:13.276128 [info ] [Thread-1 (]: 12 of 18 PASS relationships_fct_orders_customer_id__customer_id__ref_dim_customers_  [[32mPASS[0m in 0.03s]
[0m14:58:13.281397 [debug] [Thread-1 (]: Finished running node test.case_project.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m14:58:13.282271 [debug] [Thread-1 (]: Began running node test.case_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m14:58:13.282271 [info ] [Thread-1 (]: 13 of 18 START test unique_dim_customers_customer_id ........................... [RUN]
[0m14:58:13.282271 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.case_project.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4, now test.case_project.unique_dim_customers_customer_id.15c9f1e2fd)
[0m14:58:13.282271 [debug] [Thread-1 (]: Began compiling node test.case_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m14:58:13.294394 [debug] [Thread-1 (]: Writing injected SQL for node "test.case_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m14:58:13.295363 [debug] [Thread-1 (]: Began executing node test.case_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m14:58:13.299494 [debug] [Thread-1 (]: Writing runtime sql for node "test.case_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m14:58:13.300493 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m14:58:13.301463 [debug] [Thread-1 (]: On test.case_project.unique_dim_customers_customer_id.15c9f1e2fd: BEGIN
[0m14:58:13.302492 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:13.303491 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:58:13.303491 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m14:58:13.303491 [debug] [Thread-1 (]: On test.case_project.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "test.case_project.unique_dim_customers_customer_id.15c9f1e2fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "warehouse"."main_marts"."dim_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:58:13.303491 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:58:13.309929 [debug] [Thread-1 (]: On test.case_project.unique_dim_customers_customer_id.15c9f1e2fd: ROLLBACK
[0m14:58:13.312037 [debug] [Thread-1 (]: Failed to rollback 'test.case_project.unique_dim_customers_customer_id.15c9f1e2fd'
[0m14:58:13.312037 [debug] [Thread-1 (]: On test.case_project.unique_dim_customers_customer_id.15c9f1e2fd: Close
[0m14:58:13.313035 [info ] [Thread-1 (]: 13 of 18 PASS unique_dim_customers_customer_id ................................. [[32mPASS[0m in 0.03s]
[0m14:58:13.314034 [debug] [Thread-1 (]: Finished running node test.case_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m14:58:13.315034 [debug] [Thread-1 (]: Began running node test.case_project.unique_dim_products_product_id.ef7b2a9985
[0m14:58:13.316035 [info ] [Thread-1 (]: 14 of 18 START test unique_dim_products_product_id ............................. [RUN]
[0m14:58:13.317034 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.case_project.unique_dim_customers_customer_id.15c9f1e2fd, now test.case_project.unique_dim_products_product_id.ef7b2a9985)
[0m14:58:13.318036 [debug] [Thread-1 (]: Began compiling node test.case_project.unique_dim_products_product_id.ef7b2a9985
[0m14:58:13.322943 [debug] [Thread-1 (]: Writing injected SQL for node "test.case_project.unique_dim_products_product_id.ef7b2a9985"
[0m14:58:13.324022 [debug] [Thread-1 (]: Began executing node test.case_project.unique_dim_products_product_id.ef7b2a9985
[0m14:58:13.328075 [debug] [Thread-1 (]: Writing runtime sql for node "test.case_project.unique_dim_products_product_id.ef7b2a9985"
[0m14:58:13.329077 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.unique_dim_products_product_id.ef7b2a9985"
[0m14:58:13.329887 [debug] [Thread-1 (]: On test.case_project.unique_dim_products_product_id.ef7b2a9985: BEGIN
[0m14:58:13.330893 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:13.331411 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:58:13.332242 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.unique_dim_products_product_id.ef7b2a9985"
[0m14:58:13.333248 [debug] [Thread-1 (]: On test.case_project.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "test.case_project.unique_dim_products_product_id.ef7b2a9985"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "warehouse"."main_marts"."dim_products"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:58:13.335247 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:58:13.337248 [debug] [Thread-1 (]: On test.case_project.unique_dim_products_product_id.ef7b2a9985: ROLLBACK
[0m14:58:13.338712 [debug] [Thread-1 (]: Failed to rollback 'test.case_project.unique_dim_products_product_id.ef7b2a9985'
[0m14:58:13.338712 [debug] [Thread-1 (]: On test.case_project.unique_dim_products_product_id.ef7b2a9985: Close
[0m14:58:13.338712 [info ] [Thread-1 (]: 14 of 18 PASS unique_dim_products_product_id ................................... [[32mPASS[0m in 0.02s]
[0m14:58:13.338712 [debug] [Thread-1 (]: Finished running node test.case_project.unique_dim_products_product_id.ef7b2a9985
[0m14:58:13.338712 [debug] [Thread-1 (]: Began running node test.case_project.unique_fct_orders_order_id.523ddb6ce5
[0m14:58:13.338712 [info ] [Thread-1 (]: 15 of 18 START test unique_fct_orders_order_id ................................. [RUN]
[0m14:58:13.343802 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.case_project.unique_dim_products_product_id.ef7b2a9985, now test.case_project.unique_fct_orders_order_id.523ddb6ce5)
[0m14:58:13.344503 [debug] [Thread-1 (]: Began compiling node test.case_project.unique_fct_orders_order_id.523ddb6ce5
[0m14:58:13.344503 [debug] [Thread-1 (]: Writing injected SQL for node "test.case_project.unique_fct_orders_order_id.523ddb6ce5"
[0m14:58:13.350780 [debug] [Thread-1 (]: Began executing node test.case_project.unique_fct_orders_order_id.523ddb6ce5
[0m14:58:13.354790 [debug] [Thread-1 (]: Writing runtime sql for node "test.case_project.unique_fct_orders_order_id.523ddb6ce5"
[0m14:58:13.355790 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.unique_fct_orders_order_id.523ddb6ce5"
[0m14:58:13.355790 [debug] [Thread-1 (]: On test.case_project.unique_fct_orders_order_id.523ddb6ce5: BEGIN
[0m14:58:13.356790 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:13.357790 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:58:13.357790 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.unique_fct_orders_order_id.523ddb6ce5"
[0m14:58:13.358988 [debug] [Thread-1 (]: On test.case_project.unique_fct_orders_order_id.523ddb6ce5: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "test.case_project.unique_fct_orders_order_id.523ddb6ce5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "warehouse"."main_marts"."fct_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:58:13.370827 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m14:58:13.373531 [debug] [Thread-1 (]: On test.case_project.unique_fct_orders_order_id.523ddb6ce5: ROLLBACK
[0m14:58:13.373531 [debug] [Thread-1 (]: Failed to rollback 'test.case_project.unique_fct_orders_order_id.523ddb6ce5'
[0m14:58:13.373531 [debug] [Thread-1 (]: On test.case_project.unique_fct_orders_order_id.523ddb6ce5: Close
[0m14:58:13.373531 [info ] [Thread-1 (]: 15 of 18 PASS unique_fct_orders_order_id ....................................... [[32mPASS[0m in 0.03s]
[0m14:58:13.373531 [debug] [Thread-1 (]: Finished running node test.case_project.unique_fct_orders_order_id.523ddb6ce5
[0m14:58:13.373531 [debug] [Thread-1 (]: Began running node test.case_project.unique_stg_customers_customer_id.c7614daada
[0m14:58:13.378596 [info ] [Thread-1 (]: 16 of 18 START test unique_stg_customers_customer_id ........................... [RUN]
[0m14:58:13.379390 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.case_project.unique_fct_orders_order_id.523ddb6ce5, now test.case_project.unique_stg_customers_customer_id.c7614daada)
[0m14:58:13.379390 [debug] [Thread-1 (]: Began compiling node test.case_project.unique_stg_customers_customer_id.c7614daada
[0m14:58:13.385524 [debug] [Thread-1 (]: Writing injected SQL for node "test.case_project.unique_stg_customers_customer_id.c7614daada"
[0m14:58:13.386532 [debug] [Thread-1 (]: Began executing node test.case_project.unique_stg_customers_customer_id.c7614daada
[0m14:58:13.390563 [debug] [Thread-1 (]: Writing runtime sql for node "test.case_project.unique_stg_customers_customer_id.c7614daada"
[0m14:58:13.391562 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.unique_stg_customers_customer_id.c7614daada"
[0m14:58:13.392530 [debug] [Thread-1 (]: On test.case_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m14:58:13.392530 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:13.393531 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:58:13.394563 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.unique_stg_customers_customer_id.c7614daada"
[0m14:58:13.395562 [debug] [Thread-1 (]: On test.case_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "test.case_project.unique_stg_customers_customer_id.c7614daada"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "warehouse"."main_staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:58:13.399450 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:58:13.400781 [debug] [Thread-1 (]: On test.case_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m14:58:13.400781 [debug] [Thread-1 (]: Failed to rollback 'test.case_project.unique_stg_customers_customer_id.c7614daada'
[0m14:58:13.400781 [debug] [Thread-1 (]: On test.case_project.unique_stg_customers_customer_id.c7614daada: Close
[0m14:58:13.400781 [info ] [Thread-1 (]: 16 of 18 PASS unique_stg_customers_customer_id ................................. [[32mPASS[0m in 0.02s]
[0m14:58:13.406362 [debug] [Thread-1 (]: Finished running node test.case_project.unique_stg_customers_customer_id.c7614daada
[0m14:58:13.407374 [debug] [Thread-1 (]: Began running node test.case_project.unique_stg_orders_order_id.e3b841c71a
[0m14:58:13.408640 [info ] [Thread-1 (]: 17 of 18 START test unique_stg_orders_order_id ................................. [RUN]
[0m14:58:13.409640 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.case_project.unique_stg_customers_customer_id.c7614daada, now test.case_project.unique_stg_orders_order_id.e3b841c71a)
[0m14:58:13.409640 [debug] [Thread-1 (]: Began compiling node test.case_project.unique_stg_orders_order_id.e3b841c71a
[0m14:58:13.415398 [debug] [Thread-1 (]: Writing injected SQL for node "test.case_project.unique_stg_orders_order_id.e3b841c71a"
[0m14:58:13.416404 [debug] [Thread-1 (]: Began executing node test.case_project.unique_stg_orders_order_id.e3b841c71a
[0m14:58:13.420405 [debug] [Thread-1 (]: Writing runtime sql for node "test.case_project.unique_stg_orders_order_id.e3b841c71a"
[0m14:58:13.421965 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.unique_stg_orders_order_id.e3b841c71a"
[0m14:58:13.421965 [debug] [Thread-1 (]: On test.case_project.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m14:58:13.421965 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:13.421965 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:58:13.421965 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.unique_stg_orders_order_id.e3b841c71a"
[0m14:58:13.421965 [debug] [Thread-1 (]: On test.case_project.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "test.case_project.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "warehouse"."main_staging"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:58:13.435640 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m14:58:13.441090 [debug] [Thread-1 (]: On test.case_project.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m14:58:13.442033 [debug] [Thread-1 (]: Failed to rollback 'test.case_project.unique_stg_orders_order_id.e3b841c71a'
[0m14:58:13.442033 [debug] [Thread-1 (]: On test.case_project.unique_stg_orders_order_id.e3b841c71a: Close
[0m14:58:13.442033 [info ] [Thread-1 (]: 17 of 18 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 0.03s]
[0m14:58:13.442033 [debug] [Thread-1 (]: Finished running node test.case_project.unique_stg_orders_order_id.e3b841c71a
[0m14:58:13.442033 [debug] [Thread-1 (]: Began running node test.case_project.unique_stg_products_product_id.7d950a1467
[0m14:58:13.442033 [info ] [Thread-1 (]: 18 of 18 START test unique_stg_products_product_id ............................. [RUN]
[0m14:58:13.442033 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.case_project.unique_stg_orders_order_id.e3b841c71a, now test.case_project.unique_stg_products_product_id.7d950a1467)
[0m14:58:13.447999 [debug] [Thread-1 (]: Began compiling node test.case_project.unique_stg_products_product_id.7d950a1467
[0m14:58:13.453037 [debug] [Thread-1 (]: Writing injected SQL for node "test.case_project.unique_stg_products_product_id.7d950a1467"
[0m14:58:13.454035 [debug] [Thread-1 (]: Began executing node test.case_project.unique_stg_products_product_id.7d950a1467
[0m14:58:13.457142 [debug] [Thread-1 (]: Writing runtime sql for node "test.case_project.unique_stg_products_product_id.7d950a1467"
[0m14:58:13.459144 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.unique_stg_products_product_id.7d950a1467"
[0m14:58:13.459144 [debug] [Thread-1 (]: On test.case_project.unique_stg_products_product_id.7d950a1467: BEGIN
[0m14:58:13.460144 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:13.461143 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:58:13.461143 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.unique_stg_products_product_id.7d950a1467"
[0m14:58:13.462803 [debug] [Thread-1 (]: On test.case_project.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "test.case_project.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "warehouse"."main_staging"."stg_products"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:58:13.465953 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:58:13.467950 [debug] [Thread-1 (]: On test.case_project.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m14:58:13.468952 [debug] [Thread-1 (]: Failed to rollback 'test.case_project.unique_stg_products_product_id.7d950a1467'
[0m14:58:13.468952 [debug] [Thread-1 (]: On test.case_project.unique_stg_products_product_id.7d950a1467: Close
[0m14:58:13.470386 [info ] [Thread-1 (]: 18 of 18 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.03s]
[0m14:58:13.470386 [debug] [Thread-1 (]: Finished running node test.case_project.unique_stg_products_product_id.7d950a1467
[0m14:58:13.470386 [debug] [MainThread]: Using duckdb connection "master"
[0m14:58:13.470386 [debug] [MainThread]: On master: BEGIN
[0m14:58:13.474827 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:58:13.475776 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:58:13.476534 [debug] [MainThread]: On master: COMMIT
[0m14:58:13.476534 [debug] [MainThread]: Using duckdb connection "master"
[0m14:58:13.476534 [debug] [MainThread]: On master: COMMIT
[0m14:58:13.476534 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:58:13.476534 [debug] [MainThread]: On master: Close
[0m14:58:13.476534 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:58:13.476534 [debug] [MainThread]: Connection 'list_warehouse_main_marts' was properly closed.
[0m14:58:13.476534 [debug] [MainThread]: Connection 'test.case_project.unique_stg_products_product_id.7d950a1467' was properly closed.
[0m14:58:13.476534 [info ] [MainThread]: 
[0m14:58:13.476534 [info ] [MainThread]: Finished running 18 data tests in 0 hours 0 minutes and 0.88 seconds (0.88s).
[0m14:58:13.486650 [debug] [MainThread]: Command end result
[0m14:58:13.522726 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\manss\Desktop\Case Project\target\manifest.json
[0m14:58:13.525725 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\manss\Desktop\Case Project\target\semantic_manifest.json
[0m14:58:13.525725 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\manss\Desktop\Case Project\target\run_results.json
[0m14:58:13.525725 [info ] [MainThread]: 
[0m14:58:13.525725 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:58:13.525725 [info ] [MainThread]: 
[0m14:58:13.525725 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=18
[0m14:58:13.541789 [debug] [MainThread]: Command `dbt test` succeeded at 14:58:13.541414 after 2.44 seconds
[0m14:58:13.542426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F2D4D31F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F2CED5420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F2FE80250>]}
[0m14:58:13.542426 [debug] [MainThread]: Flushing usage events
[0m14:58:14.256660 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:08:55.252842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000151E70C31C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000151E93B3D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000151E93B3F40>]}


============================== 15:08:55.252842 | 14268ad7-5934-4f91-a0a9-867ce399dc95 ==============================
[0m15:08:55.252842 [info ] [MainThread]: Running with dbt=1.10.9
[0m15:08:55.252842 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\manss\\Desktop\\Case Project', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'False', 'printer_width': '80', 'quiet': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\manss\\Desktop\\Case Project\\logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m15:08:55.540216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '14268ad7-5934-4f91-a0a9-867ce399dc95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000151E94AE980>]}
[0m15:08:55.627658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '14268ad7-5934-4f91-a0a9-867ce399dc95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000151E93B1F30>]}
[0m15:08:55.630558 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m15:08:55.962235 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m15:08:56.289731 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 4 files added, 0 files changed.
[0m15:08:56.289731 [debug] [MainThread]: Partial parsing: added file: case_project://models\marts\core\dm_product_performance.sql
[0m15:08:56.289731 [debug] [MainThread]: Partial parsing: added file: case_project://models\marts\core\dm_sales_daily.sql
[0m15:08:56.289731 [debug] [MainThread]: Partial parsing: added file: case_project://models\marts\core\schema.yml
[0m15:08:56.289731 [debug] [MainThread]: Partial parsing: added file: case_project://models\marts\core\dm_customer_performance.sql
[0m15:08:56.915492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '14268ad7-5934-4f91-a0a9-867ce399dc95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000151EACCC130>]}
[0m15:08:57.071083 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\manss\Desktop\Case Project\target\manifest.json
[0m15:08:57.071083 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\manss\Desktop\Case Project\target\semantic_manifest.json
[0m15:08:57.113996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '14268ad7-5934-4f91-a0a9-867ce399dc95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000151EACCD6F0>]}
[0m15:08:57.118944 [info ] [MainThread]: Found 4 seeds, 11 models, 22 data tests, 4 sources, 429 macros
[0m15:08:57.120104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14268ad7-5934-4f91-a0a9-867ce399dc95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000151EACCD750>]}
[0m15:08:57.123073 [info ] [MainThread]: 
[0m15:08:57.124072 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:08:57.124072 [info ] [MainThread]: 
[0m15:08:57.126104 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:08:57.135547 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m15:08:57.352483 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m15:08:57.368257 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m15:08:57.368257 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:57.383998 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m15:08:57.383998 [debug] [ThreadPool]: On list_warehouse: Close
[0m15:08:57.383998 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m15:08:57.383998 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m15:08:57.383998 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:08:57.383998 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:08:57.383998 [debug] [ThreadPool]: On list_warehouse: Close
[0m15:08:57.383998 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_staging)
[0m15:08:57.383998 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_staging"
"
[0m15:08:57.399806 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m15:08:57.399806 [debug] [ThreadPool]: On create_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m15:08:57.399806 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:08:57.399806 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:08:57.399806 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m15:08:57.399806 [debug] [ThreadPool]: On create_warehouse_main_staging: BEGIN
[0m15:08:57.399806 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:08:57.399806 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m15:08:57.399806 [debug] [ThreadPool]: On create_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_staging"} */

    
    
        create schema if not exists "warehouse"."main_staging"
    
[0m15:08:57.399806 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:08:57.399806 [debug] [ThreadPool]: On create_warehouse_main_staging: COMMIT
[0m15:08:57.399806 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m15:08:57.399806 [debug] [ThreadPool]: On create_warehouse_main_staging: COMMIT
[0m15:08:57.399806 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:08:57.399806 [debug] [ThreadPool]: On create_warehouse_main_staging: Close
[0m15:08:57.415843 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_warehouse_main_staging, now create_warehouse_main_marts)
[0m15:08:57.417000 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_marts"
"
[0m15:08:57.420000 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m15:08:57.420000 [debug] [ThreadPool]: On create_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_marts"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m15:08:57.421002 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:08:57.422000 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:08:57.422970 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m15:08:57.424000 [debug] [ThreadPool]: On create_warehouse_main_marts: BEGIN
[0m15:08:57.424969 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:08:57.424969 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m15:08:57.426000 [debug] [ThreadPool]: On create_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_marts"} */

    
    
        create schema if not exists "warehouse"."main_marts"
    
[0m15:08:57.426990 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:08:57.428004 [debug] [ThreadPool]: On create_warehouse_main_marts: COMMIT
[0m15:08:57.428004 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m15:08:57.429004 [debug] [ThreadPool]: On create_warehouse_main_marts: COMMIT
[0m15:08:57.429004 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:08:57.429970 [debug] [ThreadPool]: On create_warehouse_main_marts: Close
[0m15:08:57.433192 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_raw'
[0m15:08:57.439193 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m15:08:57.440193 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m15:08:57.441194 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:57.441194 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:08:57.442193 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m15:08:57.442193 [debug] [ThreadPool]: On list_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_raw"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'warehouse'
  
[0m15:08:57.455822 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m15:08:57.457673 [debug] [ThreadPool]: On list_warehouse_main_raw: ROLLBACK
[0m15:08:57.457673 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_raw'
[0m15:08:57.457673 [debug] [ThreadPool]: On list_warehouse_main_raw: Close
[0m15:08:57.457673 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_raw, now list_warehouse_main_marts)
[0m15:08:57.457673 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m15:08:57.457673 [debug] [ThreadPool]: On list_warehouse_main_marts: BEGIN
[0m15:08:57.457673 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:08:57.457673 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:08:57.457673 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m15:08:57.457673 [debug] [ThreadPool]: On list_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_marts"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'warehouse'
  
[0m15:08:57.457673 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m15:08:57.457673 [debug] [ThreadPool]: On list_warehouse_main_marts: ROLLBACK
[0m15:08:57.472674 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_marts'
[0m15:08:57.472674 [debug] [ThreadPool]: On list_warehouse_main_marts: Close
[0m15:08:57.472674 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_marts, now list_warehouse_main_staging)
[0m15:08:57.472674 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_staging"
[0m15:08:57.472674 [debug] [ThreadPool]: On list_warehouse_main_staging: BEGIN
[0m15:08:57.472674 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:08:57.472674 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:08:57.472674 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_staging"
[0m15:08:57.472674 [debug] [ThreadPool]: On list_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_staging"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'warehouse'
  
[0m15:08:57.472674 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m15:08:57.472674 [debug] [ThreadPool]: On list_warehouse_main_staging: ROLLBACK
[0m15:08:57.472674 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_staging'
[0m15:08:57.472674 [debug] [ThreadPool]: On list_warehouse_main_staging: Close
[0m15:08:57.488764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14268ad7-5934-4f91-a0a9-867ce399dc95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000151E94C6B00>]}
[0m15:08:57.488764 [debug] [MainThread]: Using duckdb connection "master"
[0m15:08:57.488764 [debug] [MainThread]: On master: BEGIN
[0m15:08:57.488764 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:08:57.488764 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:08:57.488764 [debug] [MainThread]: On master: COMMIT
[0m15:08:57.488764 [debug] [MainThread]: Using duckdb connection "master"
[0m15:08:57.488764 [debug] [MainThread]: On master: COMMIT
[0m15:08:57.488764 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:08:57.488764 [debug] [MainThread]: On master: Close
[0m15:08:57.488764 [debug] [Thread-1 (]: Began running node model.case_project.stg_customers
[0m15:08:57.488764 [info ] [Thread-1 (]: 1 of 11 START sql view model main_staging.stg_customers ........................ [RUN]
[0m15:08:57.488764 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.case_project.stg_customers'
[0m15:08:57.488764 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_customers
[0m15:08:57.504874 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_customers"
[0m15:08:57.504874 [debug] [Thread-1 (]: Began executing node model.case_project.stg_customers
[0m15:08:57.550156 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_customers"
[0m15:08:57.552128 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m15:08:57.552128 [debug] [Thread-1 (]: On model.case_project.stg_customers: BEGIN
[0m15:08:57.553129 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:08:57.554129 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:08:57.555129 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m15:08:57.556125 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */

  
  create view "warehouse"."main_staging"."stg_customers__dbt_tmp" as (
    -- models/staging/stg_customers.sql
with src as (
  select * from "warehouse"."main_raw"."raw_customers"
),
clean as (
  select
    cast(id as varchar) as customer_id,
    regexp_replace(name, '^(Mr\.|Mrs\.|Ms\.|Dr\.|MD)\s+', '') as clean_name
  from src
)
select
  customer_id,
  split_part(clean_name, ' ', 1) as first_name,
  split_part(clean_name, ' ', 2) as last_name
from clean
  );

[0m15:08:57.557128 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:08:57.565128 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m15:08:57.566128 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */
alter view "warehouse"."main_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m15:08:57.567129 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:08:57.571128 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m15:08:57.571128 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */
alter view "warehouse"."main_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m15:08:57.572129 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:08:57.587246 [debug] [Thread-1 (]: On model.case_project.stg_customers: COMMIT
[0m15:08:57.587246 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m15:08:57.587246 [debug] [Thread-1 (]: On model.case_project.stg_customers: COMMIT
[0m15:08:57.591435 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:08:57.591435 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m15:08:57.591435 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */

      drop view if exists "warehouse"."main_staging"."stg_customers__dbt_backup" cascade
    
[0m15:08:57.603171 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:08:57.603171 [debug] [Thread-1 (]: On model.case_project.stg_customers: Close
[0m15:08:57.603171 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14268ad7-5934-4f91-a0a9-867ce399dc95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000151E5E24100>]}
[0m15:08:57.603171 [info ] [Thread-1 (]: 1 of 11 OK created sql view model main_staging.stg_customers ................... [[32mOK[0m in 0.11s]
[0m15:08:57.603171 [debug] [Thread-1 (]: Finished running node model.case_project.stg_customers
[0m15:08:57.603171 [debug] [Thread-1 (]: Began running node model.case_project.stg_items
[0m15:08:57.603171 [info ] [Thread-1 (]: 2 of 11 START sql view model main_staging.stg_items ............................ [RUN]
[0m15:08:57.603171 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_customers, now model.case_project.stg_items)
[0m15:08:57.603171 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_items
[0m15:08:57.603171 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_items"
[0m15:08:57.619601 [debug] [Thread-1 (]: Began executing node model.case_project.stg_items
[0m15:08:57.625153 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_items"
[0m15:08:57.626779 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m15:08:57.627775 [debug] [Thread-1 (]: On model.case_project.stg_items: BEGIN
[0m15:08:57.627775 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:08:57.628806 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:08:57.629779 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m15:08:57.630777 [debug] [Thread-1 (]: On model.case_project.stg_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_items"} */

  
  create view "warehouse"."main_staging"."stg_items__dbt_tmp" as (
    with src as (
  select * from "warehouse"."main_raw"."raw_items"
)
select
  cast(order_id as varchar) as order_id,  -- FK to orders
  cast(sku      as varchar) as product_id, 
  1                           as quantity  
from src
  );

[0m15:08:57.631204 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:08:57.633923 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m15:08:57.633923 [debug] [Thread-1 (]: On model.case_project.stg_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_items"} */
alter view "warehouse"."main_staging"."stg_items" rename to "stg_items__dbt_backup"
[0m15:08:57.638120 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:08:57.638857 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m15:08:57.638857 [debug] [Thread-1 (]: On model.case_project.stg_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_items"} */
alter view "warehouse"."main_staging"."stg_items__dbt_tmp" rename to "stg_items"
[0m15:08:57.638857 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:08:57.645033 [debug] [Thread-1 (]: On model.case_project.stg_items: COMMIT
[0m15:08:57.646068 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m15:08:57.647068 [debug] [Thread-1 (]: On model.case_project.stg_items: COMMIT
[0m15:08:57.648784 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:08:57.652203 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m15:08:57.653264 [debug] [Thread-1 (]: On model.case_project.stg_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_items"} */

      drop view if exists "warehouse"."main_staging"."stg_items__dbt_backup" cascade
    
[0m15:08:57.654262 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:08:57.656262 [debug] [Thread-1 (]: On model.case_project.stg_items: Close
[0m15:08:57.657261 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14268ad7-5934-4f91-a0a9-867ce399dc95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000151EB28C0D0>]}
[0m15:08:57.658262 [info ] [Thread-1 (]: 2 of 11 OK created sql view model main_staging.stg_items ....................... [[32mOK[0m in 0.05s]
[0m15:08:57.659262 [debug] [Thread-1 (]: Finished running node model.case_project.stg_items
[0m15:08:57.660262 [debug] [Thread-1 (]: Began running node model.case_project.stg_orders
[0m15:08:57.661263 [info ] [Thread-1 (]: 3 of 11 START sql view model main_staging.stg_orders ........................... [RUN]
[0m15:08:57.662263 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_items, now model.case_project.stg_orders)
[0m15:08:57.662263 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_orders
[0m15:08:57.665262 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_orders"
[0m15:08:57.665262 [debug] [Thread-1 (]: Began executing node model.case_project.stg_orders
[0m15:08:57.665262 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_orders"
[0m15:08:57.665262 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m15:08:57.665262 [debug] [Thread-1 (]: On model.case_project.stg_orders: BEGIN
[0m15:08:57.665262 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:08:57.665262 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:08:57.665262 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m15:08:57.665262 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */

  
  create view "warehouse"."main_staging"."stg_orders__dbt_tmp" as (
    with src as (
  select * from "warehouse"."main_raw"."raw_orders"
)
select
  cast(id as varchar)                 as order_id,
  cast(customer as varchar)           as customer_id,
  cast(store_id as varchar)           as store_id,
  cast(ordered_at as timestamp)       as ordered_at,
  cast(subtotal as double)            as subtotal,
  cast(tax_paid as double)            as tax_paid,
  cast(order_total as double)         as order_total
from src
  );

[0m15:08:57.665262 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:08:57.683194 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m15:08:57.684199 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */
alter view "warehouse"."main_staging"."stg_orders" rename to "stg_orders__dbt_backup"
[0m15:08:57.685170 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:08:57.689173 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m15:08:57.690174 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */
alter view "warehouse"."main_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m15:08:57.691170 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:08:57.693168 [debug] [Thread-1 (]: On model.case_project.stg_orders: COMMIT
[0m15:08:57.694170 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m15:08:57.694170 [debug] [Thread-1 (]: On model.case_project.stg_orders: COMMIT
[0m15:08:57.696168 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:08:57.696168 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m15:08:57.700534 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */

      drop view if exists "warehouse"."main_staging"."stg_orders__dbt_backup" cascade
    
[0m15:08:57.701540 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:08:57.704262 [debug] [Thread-1 (]: On model.case_project.stg_orders: Close
[0m15:08:57.705271 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14268ad7-5934-4f91-a0a9-867ce399dc95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000151EB2E7FD0>]}
[0m15:08:57.706269 [info ] [Thread-1 (]: 3 of 11 OK created sql view model main_staging.stg_orders ...................... [[32mOK[0m in 0.04s]
[0m15:08:57.707485 [debug] [Thread-1 (]: Finished running node model.case_project.stg_orders
[0m15:08:57.708259 [debug] [Thread-1 (]: Began running node model.case_project.stg_products
[0m15:08:57.708259 [info ] [Thread-1 (]: 4 of 11 START sql view model main_staging.stg_products ......................... [RUN]
[0m15:08:57.708259 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_orders, now model.case_project.stg_products)
[0m15:08:57.708259 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_products
[0m15:08:57.714438 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_products"
[0m15:08:57.715477 [debug] [Thread-1 (]: Began executing node model.case_project.stg_products
[0m15:08:57.720504 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_products"
[0m15:08:57.721476 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m15:08:57.721476 [debug] [Thread-1 (]: On model.case_project.stg_products: BEGIN
[0m15:08:57.722641 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:08:57.723641 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:08:57.724641 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m15:08:57.724641 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */

  
  create view "warehouse"."main_staging"."stg_products__dbt_tmp" as (
    -- models/staging/stg_products.sql
with src as (select * from "warehouse"."main_raw"."raw_products")
select
  cast(sku as varchar)      as product_id,
  lower(trim(name))        as product_name,
  cast(price as double)    as price
from src
  );

[0m15:08:57.726093 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:08:57.730821 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m15:08:57.732105 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */
alter view "warehouse"."main_staging"."stg_products" rename to "stg_products__dbt_backup"
[0m15:08:57.733146 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:08:57.738585 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m15:08:57.738585 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */
alter view "warehouse"."main_staging"."stg_products__dbt_tmp" rename to "stg_products"
[0m15:08:57.738585 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:08:57.742328 [debug] [Thread-1 (]: On model.case_project.stg_products: COMMIT
[0m15:08:57.743176 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m15:08:57.743176 [debug] [Thread-1 (]: On model.case_project.stg_products: COMMIT
[0m15:08:57.743176 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:08:57.749220 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m15:08:57.749220 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */

      drop view if exists "warehouse"."main_staging"."stg_products__dbt_backup" cascade
    
[0m15:08:57.751531 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:08:57.752537 [debug] [Thread-1 (]: On model.case_project.stg_products: Close
[0m15:08:57.753536 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14268ad7-5934-4f91-a0a9-867ce399dc95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000151EB2CB820>]}
[0m15:08:57.754538 [info ] [Thread-1 (]: 4 of 11 OK created sql view model main_staging.stg_products .................... [[32mOK[0m in 0.05s]
[0m15:08:57.755539 [debug] [Thread-1 (]: Finished running node model.case_project.stg_products
[0m15:08:57.756537 [debug] [Thread-1 (]: Began running node model.case_project.dim_customers
[0m15:08:57.757536 [info ] [Thread-1 (]: 5 of 11 START sql table model main_marts.dim_customers ......................... [RUN]
[0m15:08:57.758537 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_products, now model.case_project.dim_customers)
[0m15:08:57.759537 [debug] [Thread-1 (]: Began compiling node model.case_project.dim_customers
[0m15:08:57.763537 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.dim_customers"
[0m15:08:57.765539 [debug] [Thread-1 (]: Began executing node model.case_project.dim_customers
[0m15:08:57.791238 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.dim_customers"
[0m15:08:57.792206 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m15:08:57.793211 [debug] [Thread-1 (]: On model.case_project.dim_customers: BEGIN
[0m15:08:57.794208 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:08:57.795208 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:08:57.795208 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m15:08:57.796206 [debug] [Thread-1 (]: On model.case_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_customers"} */

  
    
    

    create  table
      "warehouse"."main_marts"."dim_customers__dbt_tmp"
  
    as (
      -- models/marts/dim_customers.sql


with base as (
    select
        customer_id,
        first_name,
        last_name,
        (first_name || ' ' || coalesce(last_name, '')) as customer_name
    from "warehouse"."main_staging"."stg_customers"
),

orders as (
    select
        customer_id,
        min(ordered_at) as first_order_at,
        max(ordered_at) as most_recent_order_at,
        count(*)        as order_count,
        sum(order_total) as lifetime_value
    from "warehouse"."main_staging"."stg_orders"
    group by 1
)

select
    b.customer_id,
    b.first_name,
    b.last_name,
    b.customer_name,
    o.first_order_at,
    o.most_recent_order_at,
    coalesce(o.order_count, 0)      as order_count,
    coalesce(o.lifetime_value, 0.0) as lifetime_value
from base b
left join orders o using (customer_id)
    );
  
  
[0m15:08:57.805206 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m15:08:57.805206 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m15:08:57.805206 [debug] [Thread-1 (]: On model.case_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_customers"} */
alter table "warehouse"."main_marts"."dim_customers" rename to "dim_customers__dbt_backup"
[0m15:08:57.805206 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:08:57.805206 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m15:08:57.805206 [debug] [Thread-1 (]: On model.case_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_customers"} */
alter table "warehouse"."main_marts"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m15:08:57.805206 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:08:57.821145 [debug] [Thread-1 (]: On model.case_project.dim_customers: COMMIT
[0m15:08:57.821145 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m15:08:57.821145 [debug] [Thread-1 (]: On model.case_project.dim_customers: COMMIT
[0m15:08:57.821145 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:08:57.830223 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m15:08:57.832227 [debug] [Thread-1 (]: On model.case_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_customers"} */

      drop table if exists "warehouse"."main_marts"."dim_customers__dbt_backup" cascade
    
[0m15:08:57.832227 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:08:57.835448 [debug] [Thread-1 (]: On model.case_project.dim_customers: Close
[0m15:08:57.835448 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14268ad7-5934-4f91-a0a9-867ce399dc95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000151EB33B430>]}
[0m15:08:57.837187 [info ] [Thread-1 (]: 5 of 11 OK created sql table model main_marts.dim_customers .................... [[32mOK[0m in 0.08s]
[0m15:08:57.838186 [debug] [Thread-1 (]: Finished running node model.case_project.dim_customers
[0m15:08:57.838794 [debug] [Thread-1 (]: Began running node model.case_project.fct_orders
[0m15:08:57.839496 [info ] [Thread-1 (]: 6 of 11 START sql table model main_marts.fct_orders ............................ [RUN]
[0m15:08:57.840767 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.dim_customers, now model.case_project.fct_orders)
[0m15:08:57.841765 [debug] [Thread-1 (]: Began compiling node model.case_project.fct_orders
[0m15:08:57.897401 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.fct_orders"
[0m15:08:57.898401 [debug] [Thread-1 (]: Began executing node model.case_project.fct_orders
[0m15:08:57.903564 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.fct_orders"
[0m15:08:57.904533 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m15:08:57.905532 [debug] [Thread-1 (]: On model.case_project.fct_orders: BEGIN
[0m15:08:57.905532 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:08:57.906531 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:08:57.907531 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m15:08:57.908531 [debug] [Thread-1 (]: On model.case_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_orders"} */

  
    
    

    create  table
      "warehouse"."main_marts"."fct_orders__dbt_tmp"
  
    as (
      -- models/marts/fct_orders.sql


select
    o.order_id,
    o.customer_id,
    o.store_id,
    o.ordered_at,
    cast(date_trunc('day', o.ordered_at) as date) as order_date,
    o.subtotal,
    o.tax_paid,
    o.order_total
from "warehouse"."main_staging"."stg_orders" o
    );
  
  
[0m15:08:57.935999 [debug] [Thread-1 (]: SQL status: OK in 0.031 seconds
[0m15:08:57.935999 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m15:08:57.935999 [debug] [Thread-1 (]: On model.case_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_orders"} */
alter table "warehouse"."main_marts"."fct_orders" rename to "fct_orders__dbt_backup"
[0m15:08:57.935999 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:08:57.948961 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m15:08:57.948961 [debug] [Thread-1 (]: On model.case_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_orders"} */
alter table "warehouse"."main_marts"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m15:08:57.951460 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:08:57.951460 [debug] [Thread-1 (]: On model.case_project.fct_orders: COMMIT
[0m15:08:57.951460 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m15:08:57.951460 [debug] [Thread-1 (]: On model.case_project.fct_orders: COMMIT
[0m15:08:57.978545 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m15:08:57.978545 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m15:08:57.983180 [debug] [Thread-1 (]: On model.case_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_orders"} */

      drop table if exists "warehouse"."main_marts"."fct_orders__dbt_backup" cascade
    
[0m15:08:57.983180 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:08:57.986633 [debug] [Thread-1 (]: On model.case_project.fct_orders: Close
[0m15:08:57.986633 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14268ad7-5934-4f91-a0a9-867ce399dc95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000151EB33B430>]}
[0m15:08:57.988638 [info ] [Thread-1 (]: 6 of 11 OK created sql table model main_marts.fct_orders ....................... [[32mOK[0m in 0.15s]
[0m15:08:57.988638 [debug] [Thread-1 (]: Finished running node model.case_project.fct_orders
[0m15:08:57.988638 [debug] [Thread-1 (]: Began running node model.case_project.dim_products
[0m15:08:57.991189 [info ] [Thread-1 (]: 7 of 11 START sql table model main_marts.dim_products .......................... [RUN]
[0m15:08:57.991189 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.fct_orders, now model.case_project.dim_products)
[0m15:08:57.991189 [debug] [Thread-1 (]: Began compiling node model.case_project.dim_products
[0m15:08:57.998291 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.dim_products"
[0m15:08:58.000182 [debug] [Thread-1 (]: Began executing node model.case_project.dim_products
[0m15:08:58.000566 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.dim_products"
[0m15:08:58.007066 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_products"
[0m15:08:58.007713 [debug] [Thread-1 (]: On model.case_project.dim_products: BEGIN
[0m15:08:58.008724 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:08:58.009718 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:08:58.010721 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_products"
[0m15:08:58.010721 [debug] [Thread-1 (]: On model.case_project.dim_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_products"} */

  
    
    

    create  table
      "warehouse"."main_marts"."dim_products__dbt_tmp"
  
    as (
      -- models/marts/dim_products.sql


select
    p.product_id,
    p.product_name,
    p.price as current_list_price
from "warehouse"."main_staging"."stg_products" p
    );
  
  
[0m15:08:58.013138 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:08:58.018741 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_products"
[0m15:08:58.019740 [debug] [Thread-1 (]: On model.case_project.dim_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_products"} */
alter table "warehouse"."main_marts"."dim_products" rename to "dim_products__dbt_backup"
[0m15:08:58.020743 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:08:58.024769 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_products"
[0m15:08:58.025936 [debug] [Thread-1 (]: On model.case_project.dim_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_products"} */
alter table "warehouse"."main_marts"."dim_products__dbt_tmp" rename to "dim_products"
[0m15:08:58.026910 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:08:58.028936 [debug] [Thread-1 (]: On model.case_project.dim_products: COMMIT
[0m15:08:58.029905 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_products"
[0m15:08:58.030936 [debug] [Thread-1 (]: On model.case_project.dim_products: COMMIT
[0m15:08:58.031904 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:08:58.035904 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_products"
[0m15:08:58.036905 [debug] [Thread-1 (]: On model.case_project.dim_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_products"} */

      drop table if exists "warehouse"."main_marts"."dim_products__dbt_backup" cascade
    
[0m15:08:58.038654 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:08:58.040788 [debug] [Thread-1 (]: On model.case_project.dim_products: Close
[0m15:08:58.041783 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14268ad7-5934-4f91-a0a9-867ce399dc95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000151E6F759C0>]}
[0m15:08:58.042785 [info ] [Thread-1 (]: 7 of 11 OK created sql table model main_marts.dim_products ..................... [[32mOK[0m in 0.05s]
[0m15:08:58.043347 [debug] [Thread-1 (]: Finished running node model.case_project.dim_products
[0m15:08:58.044384 [debug] [Thread-1 (]: Began running node model.case_project.fct_order_items
[0m15:08:58.045355 [info ] [Thread-1 (]: 8 of 11 START sql table model main_marts.fct_order_items ....................... [RUN]
[0m15:08:58.046357 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.dim_products, now model.case_project.fct_order_items)
[0m15:08:58.047355 [debug] [Thread-1 (]: Began compiling node model.case_project.fct_order_items
[0m15:08:58.051383 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.fct_order_items"
[0m15:08:58.052383 [debug] [Thread-1 (]: Began executing node model.case_project.fct_order_items
[0m15:08:58.057542 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.fct_order_items"
[0m15:08:58.058542 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_order_items"
[0m15:08:58.058542 [debug] [Thread-1 (]: On model.case_project.fct_order_items: BEGIN
[0m15:08:58.059510 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:08:58.060542 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:08:58.061546 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_order_items"
[0m15:08:58.061546 [debug] [Thread-1 (]: On model.case_project.fct_order_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_order_items"} */

  
    
    

    create  table
      "warehouse"."main_marts"."fct_order_items__dbt_tmp"
  
    as (
      -- models/marts/fct_order_items.sql


with items as (
  select
    order_id,
    product_id,
    quantity
  from "warehouse"."main_staging"."stg_items"
),
prod as (
  select
    product_id,
    product_name,
    price as unit_price
  from "warehouse"."main_staging"."stg_products"
)

select
  i.order_id,
  i.product_id,
  p.product_name,
  i.quantity,
  p.unit_price,
  i.quantity * p.unit_price as line_revenue
from items i
left join prod p using (product_id)
    );
  
  
[0m15:08:58.101512 [debug] [Thread-1 (]: SQL status: OK in 0.039 seconds
[0m15:08:58.105704 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_order_items"
[0m15:08:58.106707 [debug] [Thread-1 (]: On model.case_project.fct_order_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_order_items"} */
alter table "warehouse"."main_marts"."fct_order_items" rename to "fct_order_items__dbt_backup"
[0m15:08:58.107709 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:08:58.110707 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_order_items"
[0m15:08:58.110707 [debug] [Thread-1 (]: On model.case_project.fct_order_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_order_items"} */
alter table "warehouse"."main_marts"."fct_order_items__dbt_tmp" rename to "fct_order_items"
[0m15:08:58.110707 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:08:58.110707 [debug] [Thread-1 (]: On model.case_project.fct_order_items: COMMIT
[0m15:08:58.110707 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_order_items"
[0m15:08:58.110707 [debug] [Thread-1 (]: On model.case_project.fct_order_items: COMMIT
[0m15:08:58.126704 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m15:08:58.142704 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_order_items"
[0m15:08:58.142704 [debug] [Thread-1 (]: On model.case_project.fct_order_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_order_items"} */

      drop table if exists "warehouse"."main_marts"."fct_order_items__dbt_backup" cascade
    
[0m15:08:58.142704 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:08:58.142704 [debug] [Thread-1 (]: On model.case_project.fct_order_items: Close
[0m15:08:58.142704 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14268ad7-5934-4f91-a0a9-867ce399dc95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000151E95EA080>]}
[0m15:08:58.142704 [info ] [Thread-1 (]: 8 of 11 OK created sql table model main_marts.fct_order_items .................. [[32mOK[0m in 0.10s]
[0m15:08:58.142704 [debug] [Thread-1 (]: Finished running node model.case_project.fct_order_items
[0m15:08:58.142704 [debug] [Thread-1 (]: Began running node model.case_project.dm_customer_performance
[0m15:08:58.142704 [info ] [Thread-1 (]: 9 of 11 START sql table model main_marts.dm_customer_performance ............... [RUN]
[0m15:08:58.142704 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.fct_order_items, now model.case_project.dm_customer_performance)
[0m15:08:58.142704 [debug] [Thread-1 (]: Began compiling node model.case_project.dm_customer_performance
[0m15:08:58.142704 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.dm_customer_performance"
[0m15:08:58.158812 [debug] [Thread-1 (]: Began executing node model.case_project.dm_customer_performance
[0m15:08:58.163552 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.dm_customer_performance"
[0m15:08:58.165950 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dm_customer_performance"
[0m15:08:58.166800 [debug] [Thread-1 (]: On model.case_project.dm_customer_performance: BEGIN
[0m15:08:58.167561 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:08:58.167910 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:08:58.168978 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dm_customer_performance"
[0m15:08:58.169948 [debug] [Thread-1 (]: On model.case_project.dm_customer_performance: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dm_customer_performance"} */

  
    
    

    create  table
      "warehouse"."main_marts"."dm_customer_performance__dbt_tmp"
  
    as (
      -- models/marts/core/dm_customer_performance.sql


select
  customer_id,
  customer_name,
  order_count,
  lifetime_value,
  case when order_count >= 2 then 1 else 0 end               as is_repeat_customer,
  lifetime_value * 1.0 / nullif(order_count, 0)              as avg_order_value,
  cast(first_order_at as date)                                as first_order_date,
  cast(most_recent_order_at as date)                          as last_order_date,
  date_diff('day', cast(most_recent_order_at as date), current_date) as recency_days
from "warehouse"."main_marts"."dim_customers"
order by lifetime_value desc;
    );
  
  
[0m15:08:58.173078 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dm_customer_performance"} */

  
    
    

    create  table
      "warehouse"."main_marts"."dm_customer_performance__dbt_tmp"
  
    as (
      -- models/marts/core/dm_customer_performance.sql


select
  customer_id,
  customer_name,
  order_count,
  lifetime_value,
  case when order_count >= 2 then 1 else 0 end               as is_repeat_customer,
  lifetime_value * 1.0 / nullif(order_count, 0)              as avg_order_value,
  cast(first_order_at as date)                                as first_order_date,
  cast(most_recent_order_at as date)                          as last_order_date,
  date_diff('day', cast(most_recent_order_at as date), current_date) as recency_days
from "warehouse"."main_marts"."dim_customers"
order by lifetime_value desc;
    );
  
  
[0m15:08:58.173078 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m15:08:58.174487 [debug] [Thread-1 (]: On model.case_project.dm_customer_performance: ROLLBACK
[0m15:08:58.180463 [debug] [Thread-1 (]: Failed to rollback 'model.case_project.dm_customer_performance'
[0m15:08:58.180463 [debug] [Thread-1 (]: On model.case_project.dm_customer_performance: Close
[0m15:08:58.180463 [debug] [Thread-1 (]: Runtime Error in model dm_customer_performance (models\marts\core\dm_customer_performance.sql)
  Parser Error: syntax error at or near ";"
[0m15:08:58.180463 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14268ad7-5934-4f91-a0a9-867ce399dc95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000151E6F759C0>]}
[0m15:08:58.180463 [error] [Thread-1 (]: 9 of 11 ERROR creating sql table model main_marts.dm_customer_performance ...... [[31mERROR[0m in 0.04s]
[0m15:08:58.186711 [debug] [Thread-1 (]: Finished running node model.case_project.dm_customer_performance
[0m15:08:58.187718 [debug] [Thread-1 (]: Began running node model.case_project.dm_sales_daily
[0m15:08:58.188715 [debug] [Thread-4 (]: Marking all children of 'model.case_project.dm_customer_performance' to be skipped because of status 'error'.  Reason: Runtime Error in model dm_customer_performance (models\marts\core\dm_customer_performance.sql)
  Parser Error: syntax error at or near ";".
[0m15:08:58.189716 [info ] [Thread-1 (]: 10 of 11 START sql table model main_marts.dm_sales_daily ....................... [RUN]
[0m15:08:58.190717 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.dm_customer_performance, now model.case_project.dm_sales_daily)
[0m15:08:58.191715 [debug] [Thread-1 (]: Began compiling node model.case_project.dm_sales_daily
[0m15:08:58.195991 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.dm_sales_daily"
[0m15:08:58.196962 [debug] [Thread-1 (]: Began executing node model.case_project.dm_sales_daily
[0m15:08:58.202602 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.dm_sales_daily"
[0m15:08:58.204347 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dm_sales_daily"
[0m15:08:58.204347 [debug] [Thread-1 (]: On model.case_project.dm_sales_daily: BEGIN
[0m15:08:58.205383 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:08:58.206382 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:08:58.207381 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dm_sales_daily"
[0m15:08:58.207381 [debug] [Thread-1 (]: On model.case_project.dm_sales_daily: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dm_sales_daily"} */

  
    
    

    create  table
      "warehouse"."main_marts"."dm_sales_daily__dbt_tmp"
  
    as (
      -- models/marts/core/dm_sales_daily.sql


with o as (
  select
    order_date,
    order_id,
    customer_id,
    order_total
  from "warehouse"."main_marts"."fct_orders"
),
c as (
  select
    customer_id,
    cast(first_order_at as date) as first_order_date
  from "warehouse"."main_marts"."dim_customers"
),
j as (
  select
    o.*,
    case when o.order_date = c.first_order_date then 1 else 0 end as is_new_customer
  from o
  left join c using (customer_id)
)
select
  order_date,
  count(distinct order_id)                                        as orders,
  sum(order_total)                                                as revenue,
  avg(order_total)                                                as aov,
  count(distinct customer_id)                                     as unique_customers,
  sum(is_new_customer)                                            as new_customers,
  (count(distinct customer_id) - sum(is_new_customer))            as returning_customers
from j
group by 1
order by 1;
    );
  
  
[0m15:08:58.208352 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dm_sales_daily"} */

  
    
    

    create  table
      "warehouse"."main_marts"."dm_sales_daily__dbt_tmp"
  
    as (
      -- models/marts/core/dm_sales_daily.sql


with o as (
  select
    order_date,
    order_id,
    customer_id,
    order_total
  from "warehouse"."main_marts"."fct_orders"
),
c as (
  select
    customer_id,
    cast(first_order_at as date) as first_order_date
  from "warehouse"."main_marts"."dim_customers"
),
j as (
  select
    o.*,
    case when o.order_date = c.first_order_date then 1 else 0 end as is_new_customer
  from o
  left join c using (customer_id)
)
select
  order_date,
  count(distinct order_id)                                        as orders,
  sum(order_total)                                                as revenue,
  avg(order_total)                                                as aov,
  count(distinct customer_id)                                     as unique_customers,
  sum(is_new_customer)                                            as new_customers,
  (count(distinct customer_id) - sum(is_new_customer))            as returning_customers
from j
group by 1
order by 1;
    );
  
  
[0m15:08:58.209354 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m15:08:58.210384 [debug] [Thread-1 (]: On model.case_project.dm_sales_daily: ROLLBACK
[0m15:08:58.212381 [debug] [Thread-1 (]: Failed to rollback 'model.case_project.dm_sales_daily'
[0m15:08:58.212381 [debug] [Thread-1 (]: On model.case_project.dm_sales_daily: Close
[0m15:08:58.215132 [debug] [Thread-1 (]: Runtime Error in model dm_sales_daily (models\marts\core\dm_sales_daily.sql)
  Parser Error: syntax error at or near ";"
[0m15:08:58.215132 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14268ad7-5934-4f91-a0a9-867ce399dc95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000151E95EA080>]}
[0m15:08:58.215132 [error] [Thread-1 (]: 10 of 11 ERROR creating sql table model main_marts.dm_sales_daily .............. [[31mERROR[0m in 0.02s]
[0m15:08:58.215132 [debug] [Thread-1 (]: Finished running node model.case_project.dm_sales_daily
[0m15:08:58.215132 [debug] [Thread-1 (]: Began running node model.case_project.dm_product_performance
[0m15:08:58.215132 [debug] [Thread-4 (]: Marking all children of 'model.case_project.dm_sales_daily' to be skipped because of status 'error'.  Reason: Runtime Error in model dm_sales_daily (models\marts\core\dm_sales_daily.sql)
  Parser Error: syntax error at or near ";".
[0m15:08:58.215132 [info ] [Thread-1 (]: 11 of 11 START sql table model main_marts.dm_product_performance ............... [RUN]
[0m15:08:58.215132 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.dm_sales_daily, now model.case_project.dm_product_performance)
[0m15:08:58.221382 [debug] [Thread-1 (]: Began compiling node model.case_project.dm_product_performance
[0m15:08:58.225464 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.dm_product_performance"
[0m15:08:58.226465 [debug] [Thread-1 (]: Began executing node model.case_project.dm_product_performance
[0m15:08:58.232635 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.dm_product_performance"
[0m15:08:58.234637 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dm_product_performance"
[0m15:08:58.235638 [debug] [Thread-1 (]: On model.case_project.dm_product_performance: BEGIN
[0m15:08:58.235638 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:08:58.235638 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:08:58.235638 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dm_product_performance"
[0m15:08:58.235638 [debug] [Thread-1 (]: On model.case_project.dm_product_performance: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dm_product_performance"} */

  
    
    

    create  table
      "warehouse"."main_marts"."dm_product_performance__dbt_tmp"
  
    as (
      -- models/marts/core/dm_product_performance.sql


with li as (
  select
    product_id,
    product_name,
    quantity,
    line_revenue
  from "warehouse"."main_marts"."fct_order_items"
)
select
  product_id,
  product_name,
  sum(quantity)                               as units_sold,
  sum(line_revenue)                           as revenue,
  sum(line_revenue) * 1.0 / nullif(sum(quantity), 0) as realized_unit_price
from li
group by 1,2
order by revenue desc;
    );
  
  
[0m15:08:58.235638 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dm_product_performance"} */

  
    
    

    create  table
      "warehouse"."main_marts"."dm_product_performance__dbt_tmp"
  
    as (
      -- models/marts/core/dm_product_performance.sql


with li as (
  select
    product_id,
    product_name,
    quantity,
    line_revenue
  from "warehouse"."main_marts"."fct_order_items"
)
select
  product_id,
  product_name,
  sum(quantity)                               as units_sold,
  sum(line_revenue)                           as revenue,
  sum(line_revenue) * 1.0 / nullif(sum(quantity), 0) as realized_unit_price
from li
group by 1,2
order by revenue desc;
    );
  
  
[0m15:08:58.235638 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m15:08:58.235638 [debug] [Thread-1 (]: On model.case_project.dm_product_performance: ROLLBACK
[0m15:08:58.235638 [debug] [Thread-1 (]: Failed to rollback 'model.case_project.dm_product_performance'
[0m15:08:58.235638 [debug] [Thread-1 (]: On model.case_project.dm_product_performance: Close
[0m15:08:58.235638 [debug] [Thread-1 (]: Runtime Error in model dm_product_performance (models\marts\core\dm_product_performance.sql)
  Parser Error: syntax error at or near ";"
[0m15:08:58.235638 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14268ad7-5934-4f91-a0a9-867ce399dc95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000151E6A70550>]}
[0m15:08:58.235638 [error] [Thread-1 (]: 11 of 11 ERROR creating sql table model main_marts.dm_product_performance ...... [[31mERROR[0m in 0.02s]
[0m15:08:58.235638 [debug] [Thread-1 (]: Finished running node model.case_project.dm_product_performance
[0m15:08:58.248144 [debug] [Thread-4 (]: Marking all children of 'model.case_project.dm_product_performance' to be skipped because of status 'error'.  Reason: Runtime Error in model dm_product_performance (models\marts\core\dm_product_performance.sql)
  Parser Error: syntax error at or near ";".
[0m15:08:58.250062 [debug] [MainThread]: Using duckdb connection "master"
[0m15:08:58.250062 [debug] [MainThread]: On master: BEGIN
[0m15:08:58.251062 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:08:58.252062 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:08:58.252062 [debug] [MainThread]: On master: COMMIT
[0m15:08:58.253061 [debug] [MainThread]: Using duckdb connection "master"
[0m15:08:58.254062 [debug] [MainThread]: On master: COMMIT
[0m15:08:58.254062 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:08:58.255062 [debug] [MainThread]: On master: Close
[0m15:08:58.256062 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:08:58.256062 [debug] [MainThread]: Connection 'create_warehouse_main_marts' was properly closed.
[0m15:08:58.257062 [debug] [MainThread]: Connection 'list_warehouse_main_staging' was properly closed.
[0m15:08:58.257062 [debug] [MainThread]: Connection 'model.case_project.dm_product_performance' was properly closed.
[0m15:08:58.257062 [info ] [MainThread]: 
[0m15:08:58.257062 [info ] [MainThread]: Finished running 7 table models, 4 view models in 0 hours 0 minutes and 1.13 seconds (1.13s).
[0m15:08:58.261493 [debug] [MainThread]: Command end result
[0m15:08:58.300623 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\manss\Desktop\Case Project\target\manifest.json
[0m15:08:58.304623 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\manss\Desktop\Case Project\target\semantic_manifest.json
[0m15:08:58.314625 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\manss\Desktop\Case Project\target\run_results.json
[0m15:08:58.315621 [info ] [MainThread]: 
[0m15:08:58.316621 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m15:08:58.317621 [info ] [MainThread]: 
[0m15:08:58.317621 [error] [MainThread]: [31mFailure in model dm_customer_performance (models\marts\core\dm_customer_performance.sql)[0m
[0m15:08:58.318620 [error] [MainThread]:   Runtime Error in model dm_customer_performance (models\marts\core\dm_customer_performance.sql)
  Parser Error: syntax error at or near ";"
[0m15:08:58.319621 [info ] [MainThread]: 
[0m15:08:58.319621 [info ] [MainThread]:   compiled code at target\compiled\case_project\models\marts\core\dm_customer_performance.sql
[0m15:08:58.320622 [info ] [MainThread]: 
[0m15:08:58.321623 [error] [MainThread]: [31mFailure in model dm_sales_daily (models\marts\core\dm_sales_daily.sql)[0m
[0m15:08:58.322621 [error] [MainThread]:   Runtime Error in model dm_sales_daily (models\marts\core\dm_sales_daily.sql)
  Parser Error: syntax error at or near ";"
[0m15:08:58.322621 [info ] [MainThread]: 
[0m15:08:58.323621 [info ] [MainThread]:   compiled code at target\compiled\case_project\models\marts\core\dm_sales_daily.sql
[0m15:08:58.324620 [info ] [MainThread]: 
[0m15:08:58.325621 [error] [MainThread]: [31mFailure in model dm_product_performance (models\marts\core\dm_product_performance.sql)[0m
[0m15:08:58.325621 [error] [MainThread]:   Runtime Error in model dm_product_performance (models\marts\core\dm_product_performance.sql)
  Parser Error: syntax error at or near ";"
[0m15:08:58.326622 [info ] [MainThread]: 
[0m15:08:58.328031 [info ] [MainThread]:   compiled code at target\compiled\case_project\models\marts\core\dm_product_performance.sql
[0m15:08:58.328031 [info ] [MainThread]: 
[0m15:08:58.329138 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=11
[0m15:08:58.330136 [debug] [MainThread]: Command `dbt run` failed at 15:08:58.330136 after 3.17 seconds
[0m15:08:58.331136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000151E70C31C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000151E94ACC40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000151E84236D0>]}
[0m15:08:58.332136 [debug] [MainThread]: Flushing usage events
[0m15:08:59.100125 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:11:55.341149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015794CF3220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015796FEBC70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015796FEBE50>]}


============================== 15:11:55.346182 | f176fcc2-657f-4472-b866-fc7a949e712e ==============================
[0m15:11:55.346182 [info ] [MainThread]: Running with dbt=1.10.9
[0m15:11:55.347151 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run -s marts.core.* --full-refresh', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'empty': 'False', 'log_path': 'C:\\Users\\manss\\Desktop\\Case Project\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\manss\\Desktop\\Case Project', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True'}
[0m15:11:55.634552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f176fcc2-657f-4472-b866-fc7a949e712e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015796748880>]}
[0m15:11:55.712268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f176fcc2-657f-4472-b866-fc7a949e712e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015796FE9F00>]}
[0m15:11:55.712268 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m15:11:56.056047 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m15:11:56.392833 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m15:11:56.394838 [debug] [MainThread]: Partial parsing: updated file: case_project://models\marts\core\dm_product_performance.sql
[0m15:11:56.394838 [debug] [MainThread]: Partial parsing: updated file: case_project://models\marts\core\dm_customer_performance.sql
[0m15:11:56.394838 [debug] [MainThread]: Partial parsing: updated file: case_project://models\marts\core\dm_sales_daily.sql
[0m15:11:57.024491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f176fcc2-657f-4472-b866-fc7a949e712e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157988FC130>]}
[0m15:11:57.178509 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\manss\Desktop\Case Project\target\manifest.json
[0m15:11:57.178509 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\manss\Desktop\Case Project\target\semantic_manifest.json
[0m15:11:57.222749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f176fcc2-657f-4472-b866-fc7a949e712e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157988FFAC0>]}
[0m15:11:57.223750 [info ] [MainThread]: Found 4 seeds, 11 models, 22 data tests, 4 sources, 429 macros
[0m15:11:57.224184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f176fcc2-657f-4472-b866-fc7a949e712e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157988FFB50>]}
[0m15:11:57.226639 [info ] [MainThread]: 
[0m15:11:57.227644 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:11:57.227644 [info ] [MainThread]: 
[0m15:11:57.229602 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:11:57.233171 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m15:11:57.443980 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m15:11:57.443980 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m15:11:57.444981 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:11:57.461762 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m15:11:57.461762 [debug] [ThreadPool]: On list_warehouse: Close
[0m15:11:57.461762 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_marts)
[0m15:11:57.461762 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_marts"
"
[0m15:11:57.481058 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m15:11:57.482028 [debug] [ThreadPool]: On create_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_marts"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m15:11:57.482028 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:11:57.483058 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:11:57.485058 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m15:11:57.485058 [debug] [ThreadPool]: On create_warehouse_main_marts: BEGIN
[0m15:11:57.486028 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:11:57.487054 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m15:11:57.487054 [debug] [ThreadPool]: On create_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_marts"} */

    
    
        create schema if not exists "warehouse"."main_marts"
    
[0m15:11:57.488058 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:11:57.489058 [debug] [ThreadPool]: On create_warehouse_main_marts: COMMIT
[0m15:11:57.490030 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m15:11:57.490030 [debug] [ThreadPool]: On create_warehouse_main_marts: COMMIT
[0m15:11:57.491058 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:11:57.491058 [debug] [ThreadPool]: On create_warehouse_main_marts: Close
[0m15:11:57.494058 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_raw'
[0m15:11:57.501058 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m15:11:57.502028 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m15:11:57.502028 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:11:57.503057 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:11:57.504058 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m15:11:57.504058 [debug] [ThreadPool]: On list_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_raw"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'warehouse'
  
[0m15:11:57.509057 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m15:11:57.509057 [debug] [ThreadPool]: On list_warehouse_main_raw: ROLLBACK
[0m15:11:57.509057 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_raw'
[0m15:11:57.509057 [debug] [ThreadPool]: On list_warehouse_main_raw: Close
[0m15:11:57.509057 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_raw, now list_warehouse_main_staging)
[0m15:11:57.525920 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_staging"
[0m15:11:57.525920 [debug] [ThreadPool]: On list_warehouse_main_staging: BEGIN
[0m15:11:57.526921 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:11:57.527891 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:11:57.527891 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_staging"
[0m15:11:57.528891 [debug] [ThreadPool]: On list_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_staging"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'warehouse'
  
[0m15:11:57.531890 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m15:11:57.533890 [debug] [ThreadPool]: On list_warehouse_main_staging: ROLLBACK
[0m15:11:57.534891 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_staging'
[0m15:11:57.534891 [debug] [ThreadPool]: On list_warehouse_main_staging: Close
[0m15:11:57.535921 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_staging, now list_warehouse_main_marts)
[0m15:11:57.539921 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m15:11:57.539921 [debug] [ThreadPool]: On list_warehouse_main_marts: BEGIN
[0m15:11:57.541058 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:11:57.541058 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:11:57.542028 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m15:11:57.543026 [debug] [ThreadPool]: On list_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_marts"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'warehouse'
  
[0m15:11:57.546057 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m15:11:57.547028 [debug] [ThreadPool]: On list_warehouse_main_marts: ROLLBACK
[0m15:11:57.548058 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_marts'
[0m15:11:57.549027 [debug] [ThreadPool]: On list_warehouse_main_marts: Close
[0m15:11:57.550057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f176fcc2-657f-4472-b866-fc7a949e712e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001579893C8B0>]}
[0m15:11:57.551057 [debug] [MainThread]: Using duckdb connection "master"
[0m15:11:57.552026 [debug] [MainThread]: On master: BEGIN
[0m15:11:57.552026 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:11:57.553058 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:11:57.553058 [debug] [MainThread]: On master: COMMIT
[0m15:11:57.554028 [debug] [MainThread]: Using duckdb connection "master"
[0m15:11:57.555040 [debug] [MainThread]: On master: COMMIT
[0m15:11:57.556027 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:11:57.556361 [debug] [MainThread]: On master: Close
[0m15:11:57.560487 [debug] [Thread-1 (]: Began running node model.case_project.dm_customer_performance
[0m15:11:57.561517 [info ] [Thread-1 (]: 1 of 3 START sql table model main_marts.dm_customer_performance ................ [RUN]
[0m15:11:57.562505 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.case_project.dm_customer_performance'
[0m15:11:57.563517 [debug] [Thread-1 (]: Began compiling node model.case_project.dm_customer_performance
[0m15:11:57.565506 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.dm_customer_performance"
[0m15:11:57.565506 [debug] [Thread-1 (]: Began executing node model.case_project.dm_customer_performance
[0m15:11:57.616507 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.dm_customer_performance"
[0m15:11:57.618536 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dm_customer_performance"
[0m15:11:57.618536 [debug] [Thread-1 (]: On model.case_project.dm_customer_performance: BEGIN
[0m15:11:57.618536 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:11:57.618536 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:11:57.618536 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dm_customer_performance"
[0m15:11:57.618536 [debug] [Thread-1 (]: On model.case_project.dm_customer_performance: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dm_customer_performance"} */

  
    
    

    create  table
      "warehouse"."main_marts"."dm_customer_performance__dbt_tmp"
  
    as (
      -- models/marts/core/dm_customer_performance.sql


select
  customer_id,
  customer_name,
  order_count,
  lifetime_value,
  case when order_count >= 2 then 1 else 0 end               as is_repeat_customer,
  lifetime_value * 1.0 / nullif(order_count, 0)              as avg_order_value,
  cast(first_order_at as date)                                as first_order_date,
  cast(most_recent_order_at as date)                          as last_order_date,
  date_diff('day', cast(most_recent_order_at as date), current_date) as recency_days
from "warehouse"."main_marts"."dim_customers"
    );
  
  
[0m15:11:57.625729 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m15:11:57.637452 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dm_customer_performance"
[0m15:11:57.637452 [debug] [Thread-1 (]: On model.case_project.dm_customer_performance: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dm_customer_performance"} */
alter table "warehouse"."main_marts"."dm_customer_performance__dbt_tmp" rename to "dm_customer_performance"
[0m15:11:57.638452 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:11:57.654453 [debug] [Thread-1 (]: On model.case_project.dm_customer_performance: COMMIT
[0m15:11:57.655452 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dm_customer_performance"
[0m15:11:57.656452 [debug] [Thread-1 (]: On model.case_project.dm_customer_performance: COMMIT
[0m15:11:57.658509 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:11:57.665514 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dm_customer_performance"
[0m15:11:57.665514 [debug] [Thread-1 (]: On model.case_project.dm_customer_performance: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dm_customer_performance"} */

      drop table if exists "warehouse"."main_marts"."dm_customer_performance__dbt_backup" cascade
    
[0m15:11:57.665514 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:11:57.665514 [debug] [Thread-1 (]: On model.case_project.dm_customer_performance: Close
[0m15:11:57.665514 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f176fcc2-657f-4472-b866-fc7a949e712e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015798E6D5D0>]}
[0m15:11:57.665514 [info ] [Thread-1 (]: 1 of 3 OK created sql table model main_marts.dm_customer_performance ........... [[32mOK[0m in 0.10s]
[0m15:11:57.665514 [debug] [Thread-1 (]: Finished running node model.case_project.dm_customer_performance
[0m15:11:57.665514 [debug] [Thread-1 (]: Began running node model.case_project.dm_product_performance
[0m15:11:57.677308 [info ] [Thread-1 (]: 2 of 3 START sql table model main_marts.dm_product_performance ................. [RUN]
[0m15:11:57.677308 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.dm_customer_performance, now model.case_project.dm_product_performance)
[0m15:11:57.677308 [debug] [Thread-1 (]: Began compiling node model.case_project.dm_product_performance
[0m15:11:57.683712 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.dm_product_performance"
[0m15:11:57.685028 [debug] [Thread-1 (]: Began executing node model.case_project.dm_product_performance
[0m15:11:57.691445 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.dm_product_performance"
[0m15:11:57.692452 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dm_product_performance"
[0m15:11:57.693451 [debug] [Thread-1 (]: On model.case_project.dm_product_performance: BEGIN
[0m15:11:57.694449 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:11:57.695450 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:11:57.695450 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dm_product_performance"
[0m15:11:57.696450 [debug] [Thread-1 (]: On model.case_project.dm_product_performance: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dm_product_performance"} */

  
    
    

    create  table
      "warehouse"."main_marts"."dm_product_performance__dbt_tmp"
  
    as (
      -- models/marts/core/dm_product_performance.sql


with li as (
  select product_id, product_name, quantity, line_revenue
  from "warehouse"."main_marts"."fct_order_items"
)
select
  product_id,
  product_name,
  sum(quantity)                                    as units_sold,
  sum(line_revenue)                                as revenue,
  sum(line_revenue) * 1.0 / nullif(sum(quantity), 0) as realized_unit_price
from li
group by 1,2
    );
  
  
[0m15:11:57.706252 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m15:11:57.711250 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dm_product_performance"
[0m15:11:57.711250 [debug] [Thread-1 (]: On model.case_project.dm_product_performance: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dm_product_performance"} */
alter table "warehouse"."main_marts"."dm_product_performance__dbt_tmp" rename to "dm_product_performance"
[0m15:11:57.712251 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:11:57.714250 [debug] [Thread-1 (]: On model.case_project.dm_product_performance: COMMIT
[0m15:11:57.715250 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dm_product_performance"
[0m15:11:57.716249 [debug] [Thread-1 (]: On model.case_project.dm_product_performance: COMMIT
[0m15:11:57.718255 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:11:57.721249 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dm_product_performance"
[0m15:11:57.722250 [debug] [Thread-1 (]: On model.case_project.dm_product_performance: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dm_product_performance"} */

      drop table if exists "warehouse"."main_marts"."dm_product_performance__dbt_backup" cascade
    
[0m15:11:57.723250 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:11:57.725250 [debug] [Thread-1 (]: On model.case_project.dm_product_performance: Close
[0m15:11:57.725250 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f176fcc2-657f-4472-b866-fc7a949e712e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157989BD750>]}
[0m15:11:57.726250 [info ] [Thread-1 (]: 2 of 3 OK created sql table model main_marts.dm_product_performance ............ [[32mOK[0m in 0.05s]
[0m15:11:57.727249 [debug] [Thread-1 (]: Finished running node model.case_project.dm_product_performance
[0m15:11:57.727249 [debug] [Thread-1 (]: Began running node model.case_project.dm_sales_daily
[0m15:11:57.729301 [info ] [Thread-1 (]: 3 of 3 START sql table model main_marts.dm_sales_daily ......................... [RUN]
[0m15:11:57.729301 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.dm_product_performance, now model.case_project.dm_sales_daily)
[0m15:11:57.729301 [debug] [Thread-1 (]: Began compiling node model.case_project.dm_sales_daily
[0m15:11:57.735698 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.dm_sales_daily"
[0m15:11:57.737113 [debug] [Thread-1 (]: Began executing node model.case_project.dm_sales_daily
[0m15:11:57.739828 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.dm_sales_daily"
[0m15:11:57.739828 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dm_sales_daily"
[0m15:11:57.739828 [debug] [Thread-1 (]: On model.case_project.dm_sales_daily: BEGIN
[0m15:11:57.745304 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:11:57.746032 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:11:57.747071 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dm_sales_daily"
[0m15:11:57.748039 [debug] [Thread-1 (]: On model.case_project.dm_sales_daily: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dm_sales_daily"} */

  
    
    

    create  table
      "warehouse"."main_marts"."dm_sales_daily__dbt_tmp"
  
    as (
      -- models/marts/core/dm_sales_daily.sql


with o as (
  select order_date, order_id, customer_id, order_total
  from "warehouse"."main_marts"."fct_orders"
),
c as (
  select customer_id, cast(first_order_at as date) as first_order_date
  from "warehouse"."main_marts"."dim_customers"
),
j as (
  select
    o.*,
    case when o.order_date = c.first_order_date then 1 else 0 end as is_new_customer
  from o
  left join c using (customer_id)
)
select
  order_date,
  count(distinct order_id)                         as orders,
  sum(order_total)                                 as revenue,
  avg(order_total)                                 as aov,
  count(distinct customer_id)                      as unique_customers,
  sum(is_new_customer)                             as new_customers,
  (count(distinct customer_id) - sum(is_new_customer)) as returning_customers
from j
group by 1
    );
  
  
[0m15:11:57.775093 [debug] [Thread-1 (]: SQL status: OK in 0.033 seconds
[0m15:11:57.785471 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dm_sales_daily"
[0m15:11:57.785471 [debug] [Thread-1 (]: On model.case_project.dm_sales_daily: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dm_sales_daily"} */
alter table "warehouse"."main_marts"."dm_sales_daily__dbt_tmp" rename to "dm_sales_daily"
[0m15:11:57.787475 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:11:57.789480 [debug] [Thread-1 (]: On model.case_project.dm_sales_daily: COMMIT
[0m15:11:57.789480 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dm_sales_daily"
[0m15:11:57.790985 [debug] [Thread-1 (]: On model.case_project.dm_sales_daily: COMMIT
[0m15:11:57.790985 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:11:57.796887 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dm_sales_daily"
[0m15:11:57.796887 [debug] [Thread-1 (]: On model.case_project.dm_sales_daily: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dm_sales_daily"} */

      drop table if exists "warehouse"."main_marts"."dm_sales_daily__dbt_backup" cascade
    
[0m15:11:57.796887 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:11:57.798891 [debug] [Thread-1 (]: On model.case_project.dm_sales_daily: Close
[0m15:11:57.800896 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f176fcc2-657f-4472-b866-fc7a949e712e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157989BD750>]}
[0m15:11:57.800896 [info ] [Thread-1 (]: 3 of 3 OK created sql table model main_marts.dm_sales_daily .................... [[32mOK[0m in 0.07s]
[0m15:11:57.800896 [debug] [Thread-1 (]: Finished running node model.case_project.dm_sales_daily
[0m15:11:57.800896 [debug] [MainThread]: Using duckdb connection "master"
[0m15:11:57.800896 [debug] [MainThread]: On master: BEGIN
[0m15:11:57.800896 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:11:57.800896 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:11:57.806701 [debug] [MainThread]: On master: COMMIT
[0m15:11:57.807396 [debug] [MainThread]: Using duckdb connection "master"
[0m15:11:57.807396 [debug] [MainThread]: On master: COMMIT
[0m15:11:57.809018 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:11:57.809018 [debug] [MainThread]: On master: Close
[0m15:11:57.810054 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:11:57.810524 [debug] [MainThread]: Connection 'create_warehouse_main_marts' was properly closed.
[0m15:11:57.811237 [debug] [MainThread]: Connection 'list_warehouse_main_marts' was properly closed.
[0m15:11:57.811237 [debug] [MainThread]: Connection 'model.case_project.dm_sales_daily' was properly closed.
[0m15:11:57.812509 [info ] [MainThread]: 
[0m15:11:57.812509 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m15:11:57.815505 [debug] [MainThread]: Command end result
[0m15:11:57.853253 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\manss\Desktop\Case Project\target\manifest.json
[0m15:11:57.857146 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\manss\Desktop\Case Project\target\semantic_manifest.json
[0m15:11:57.864550 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\manss\Desktop\Case Project\target\run_results.json
[0m15:11:57.864550 [info ] [MainThread]: 
[0m15:11:57.864550 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:11:57.864550 [info ] [MainThread]: 
[0m15:11:57.864550 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m15:11:57.864550 [debug] [MainThread]: Command `dbt run` succeeded at 15:11:57.864550 after 2.63 seconds
[0m15:11:57.864550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015794CF3220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015796748880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015796FE9F00>]}
[0m15:11:57.864550 [debug] [MainThread]: Flushing usage events
[0m15:11:58.552062 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:12:06.412738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201F31231F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201F52179D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201F4454DF0>]}


============================== 15:12:06.412738 | 6df8acaa-e76b-4b25-92b3-5b47915df1da ==============================
[0m15:12:06.412738 [info ] [MainThread]: Running with dbt=1.10.9
[0m15:12:06.412738 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\manss\\Desktop\\Case Project', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt test -s marts/core/schema.yml', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'quiet': 'False', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\manss\\Desktop\\Case Project\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m15:12:06.696145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6df8acaa-e76b-4b25-92b3-5b47915df1da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201F5356B00>]}
[0m15:12:06.776245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6df8acaa-e76b-4b25-92b3-5b47915df1da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201F53D0FD0>]}
[0m15:12:06.792818 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m15:12:07.133588 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m15:12:07.462936 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:12:07.462936 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:12:07.566032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6df8acaa-e76b-4b25-92b3-5b47915df1da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201F6B013C0>]}
[0m15:12:07.758730 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\manss\Desktop\Case Project\target\manifest.json
[0m15:12:07.758730 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\manss\Desktop\Case Project\target\semantic_manifest.json
[0m15:12:07.806010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6df8acaa-e76b-4b25-92b3-5b47915df1da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201F5A76BF0>]}
[0m15:12:07.806010 [info ] [MainThread]: Found 4 seeds, 11 models, 22 data tests, 4 sources, 429 macros
[0m15:12:07.806010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6df8acaa-e76b-4b25-92b3-5b47915df1da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201F6B170D0>]}
[0m15:12:07.806010 [warn ] [MainThread]: The selection criterion 'marts/core/schema.yml' does not match any enabled nodes
[0m15:12:07.806010 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:12:07.815798 [debug] [MainThread]: Command end result
[0m15:12:07.853155 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\manss\Desktop\Case Project\target\manifest.json
[0m15:12:07.857126 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\manss\Desktop\Case Project\target\semantic_manifest.json
[0m15:12:07.861403 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\manss\Desktop\Case Project\target\run_results.json
[0m15:12:07.862401 [debug] [MainThread]: Command `dbt test` succeeded at 15:12:07.862401 after 1.54 seconds
[0m15:12:07.863401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201F31231F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201F6B00C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201F5492770>]}
[0m15:12:07.863401 [debug] [MainThread]: Flushing usage events
[0m15:12:08.572648 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:13:17.680476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B00633160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B02A1E800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B02A1E9E0>]}


============================== 15:13:17.697405 | cf09fd29-3619-4c82-a2e6-bbd71bc34bef ==============================
[0m15:13:17.697405 [info ] [MainThread]: Running with dbt=1.10.9
[0m15:13:17.699374 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt test -s path:models/marts/core/', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'log_path': 'C:\\Users\\manss\\Desktop\\Case Project\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\manss\\Desktop\\Case Project', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m15:13:17.978620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf09fd29-3619-4c82-a2e6-bbd71bc34bef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B02B465C0>]}
[0m15:13:18.064198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf09fd29-3619-4c82-a2e6-bbd71bc34bef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B029AFD00>]}
[0m15:13:18.064198 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m15:13:18.415457 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m15:13:18.726829 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:13:18.726829 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:13:18.821539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf09fd29-3619-4c82-a2e6-bbd71bc34bef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B041215A0>]}
[0m15:13:19.022266 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\manss\Desktop\Case Project\target\manifest.json
[0m15:13:19.025220 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\manss\Desktop\Case Project\target\semantic_manifest.json
[0m15:13:19.056318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf09fd29-3619-4c82-a2e6-bbd71bc34bef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B041368F0>]}
[0m15:13:19.056318 [info ] [MainThread]: Found 4 seeds, 11 models, 22 data tests, 4 sources, 429 macros
[0m15:13:19.056318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf09fd29-3619-4c82-a2e6-bbd71bc34bef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B04137F40>]}
[0m15:13:19.074142 [info ] [MainThread]: 
[0m15:13:19.075122 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:13:19.076128 [info ] [MainThread]: 
[0m15:13:19.077132 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:13:19.086158 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_raw'
[0m15:13:19.296367 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m15:13:19.296367 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m15:13:19.296367 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:13:19.312327 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m15:13:19.312327 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m15:13:19.312327 [debug] [ThreadPool]: On list_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_raw"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'warehouse'
  
[0m15:13:19.330061 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m15:13:19.330061 [debug] [ThreadPool]: On list_warehouse_main_raw: ROLLBACK
[0m15:13:19.330061 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_raw'
[0m15:13:19.330061 [debug] [ThreadPool]: On list_warehouse_main_raw: Close
[0m15:13:19.343803 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_raw, now list_warehouse_main_staging)
[0m15:13:19.347926 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_staging"
[0m15:13:19.347926 [debug] [ThreadPool]: On list_warehouse_main_staging: BEGIN
[0m15:13:19.348926 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:13:19.349897 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:13:19.349897 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_staging"
[0m15:13:19.350927 [debug] [ThreadPool]: On list_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_staging"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'warehouse'
  
[0m15:13:19.354085 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m15:13:19.355055 [debug] [ThreadPool]: On list_warehouse_main_staging: ROLLBACK
[0m15:13:19.356085 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_staging'
[0m15:13:19.357315 [debug] [ThreadPool]: On list_warehouse_main_staging: Close
[0m15:13:19.357315 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_staging, now list_warehouse_main_marts)
[0m15:13:19.361351 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m15:13:19.362352 [debug] [ThreadPool]: On list_warehouse_main_marts: BEGIN
[0m15:13:19.362352 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:13:19.363356 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:13:19.364322 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m15:13:19.364322 [debug] [ThreadPool]: On list_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_marts"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'warehouse'
  
[0m15:13:19.368321 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m15:13:19.368321 [debug] [ThreadPool]: On list_warehouse_main_marts: ROLLBACK
[0m15:13:19.368321 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_marts'
[0m15:13:19.368321 [debug] [ThreadPool]: On list_warehouse_main_marts: Close
[0m15:13:19.368321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf09fd29-3619-4c82-a2e6-bbd71bc34bef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B04134790>]}
[0m15:13:19.368321 [debug] [MainThread]: Using duckdb connection "master"
[0m15:13:19.368321 [debug] [MainThread]: On master: BEGIN
[0m15:13:19.368321 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:13:19.368321 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:13:19.368321 [debug] [MainThread]: On master: COMMIT
[0m15:13:19.368321 [debug] [MainThread]: Using duckdb connection "master"
[0m15:13:19.368321 [debug] [MainThread]: On master: COMMIT
[0m15:13:19.368321 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:13:19.368321 [debug] [MainThread]: On master: Close
[0m15:13:19.368321 [debug] [Thread-1 (]: Began running node test.case_project.not_null_dm_customer_performance_customer_id.eb8a07fb0e
[0m15:13:19.384078 [info ] [Thread-1 (]: 1 of 4 START test not_null_dm_customer_performance_customer_id ................. [RUN]
[0m15:13:19.384078 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.case_project.not_null_dm_customer_performance_customer_id.eb8a07fb0e'
[0m15:13:19.384078 [debug] [Thread-1 (]: Began compiling node test.case_project.not_null_dm_customer_performance_customer_id.eb8a07fb0e
[0m15:13:19.406058 [debug] [Thread-1 (]: Writing injected SQL for node "test.case_project.not_null_dm_customer_performance_customer_id.eb8a07fb0e"
[0m15:13:19.408028 [debug] [Thread-1 (]: Began executing node test.case_project.not_null_dm_customer_performance_customer_id.eb8a07fb0e
[0m15:13:19.430499 [debug] [Thread-1 (]: Writing runtime sql for node "test.case_project.not_null_dm_customer_performance_customer_id.eb8a07fb0e"
[0m15:13:19.431467 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.not_null_dm_customer_performance_customer_id.eb8a07fb0e"
[0m15:13:19.432470 [debug] [Thread-1 (]: On test.case_project.not_null_dm_customer_performance_customer_id.eb8a07fb0e: BEGIN
[0m15:13:19.432470 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:13:19.432470 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:13:19.432470 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.not_null_dm_customer_performance_customer_id.eb8a07fb0e"
[0m15:13:19.432470 [debug] [Thread-1 (]: On test.case_project.not_null_dm_customer_performance_customer_id.eb8a07fb0e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "test.case_project.not_null_dm_customer_performance_customer_id.eb8a07fb0e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "warehouse"."main_marts"."dm_customer_performance"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m15:13:19.432470 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:13:19.432470 [debug] [Thread-1 (]: On test.case_project.not_null_dm_customer_performance_customer_id.eb8a07fb0e: ROLLBACK
[0m15:13:19.432470 [debug] [Thread-1 (]: Failed to rollback 'test.case_project.not_null_dm_customer_performance_customer_id.eb8a07fb0e'
[0m15:13:19.432470 [debug] [Thread-1 (]: On test.case_project.not_null_dm_customer_performance_customer_id.eb8a07fb0e: Close
[0m15:13:19.432470 [info ] [Thread-1 (]: 1 of 4 PASS not_null_dm_customer_performance_customer_id ....................... [[32mPASS[0m in 0.05s]
[0m15:13:19.432470 [debug] [Thread-1 (]: Finished running node test.case_project.not_null_dm_customer_performance_customer_id.eb8a07fb0e
[0m15:13:19.432470 [debug] [Thread-1 (]: Began running node test.case_project.not_null_dm_product_performance_product_id.d706c880bb
[0m15:13:19.432470 [info ] [Thread-1 (]: 2 of 4 START test not_null_dm_product_performance_product_id ................... [RUN]
[0m15:13:19.448177 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.case_project.not_null_dm_customer_performance_customer_id.eb8a07fb0e, now test.case_project.not_null_dm_product_performance_product_id.d706c880bb)
[0m15:13:19.448177 [debug] [Thread-1 (]: Began compiling node test.case_project.not_null_dm_product_performance_product_id.d706c880bb
[0m15:13:19.448177 [debug] [Thread-1 (]: Writing injected SQL for node "test.case_project.not_null_dm_product_performance_product_id.d706c880bb"
[0m15:13:19.448177 [debug] [Thread-1 (]: Began executing node test.case_project.not_null_dm_product_performance_product_id.d706c880bb
[0m15:13:19.448177 [debug] [Thread-1 (]: Writing runtime sql for node "test.case_project.not_null_dm_product_performance_product_id.d706c880bb"
[0m15:13:19.448177 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.not_null_dm_product_performance_product_id.d706c880bb"
[0m15:13:19.448177 [debug] [Thread-1 (]: On test.case_project.not_null_dm_product_performance_product_id.d706c880bb: BEGIN
[0m15:13:19.448177 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:13:19.463891 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:13:19.465026 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.not_null_dm_product_performance_product_id.d706c880bb"
[0m15:13:19.466024 [debug] [Thread-1 (]: On test.case_project.not_null_dm_product_performance_product_id.d706c880bb: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "test.case_project.not_null_dm_product_performance_product_id.d706c880bb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "warehouse"."main_marts"."dm_product_performance"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m15:13:19.466996 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:13:19.468994 [debug] [Thread-1 (]: On test.case_project.not_null_dm_product_performance_product_id.d706c880bb: ROLLBACK
[0m15:13:19.469994 [debug] [Thread-1 (]: Failed to rollback 'test.case_project.not_null_dm_product_performance_product_id.d706c880bb'
[0m15:13:19.469994 [debug] [Thread-1 (]: On test.case_project.not_null_dm_product_performance_product_id.d706c880bb: Close
[0m15:13:19.470995 [info ] [Thread-1 (]: 2 of 4 PASS not_null_dm_product_performance_product_id ......................... [[32mPASS[0m in 0.02s]
[0m15:13:19.472145 [debug] [Thread-1 (]: Finished running node test.case_project.not_null_dm_product_performance_product_id.d706c880bb
[0m15:13:19.473181 [debug] [Thread-1 (]: Began running node test.case_project.not_null_dm_product_performance_product_name.42262fd437
[0m15:13:19.474181 [info ] [Thread-1 (]: 3 of 4 START test not_null_dm_product_performance_product_name ................. [RUN]
[0m15:13:19.475152 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.case_project.not_null_dm_product_performance_product_id.d706c880bb, now test.case_project.not_null_dm_product_performance_product_name.42262fd437)
[0m15:13:19.476152 [debug] [Thread-1 (]: Began compiling node test.case_project.not_null_dm_product_performance_product_name.42262fd437
[0m15:13:19.482187 [debug] [Thread-1 (]: Writing injected SQL for node "test.case_project.not_null_dm_product_performance_product_name.42262fd437"
[0m15:13:19.484624 [debug] [Thread-1 (]: Began executing node test.case_project.not_null_dm_product_performance_product_name.42262fd437
[0m15:13:19.487630 [debug] [Thread-1 (]: Writing runtime sql for node "test.case_project.not_null_dm_product_performance_product_name.42262fd437"
[0m15:13:19.487630 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.not_null_dm_product_performance_product_name.42262fd437"
[0m15:13:19.487630 [debug] [Thread-1 (]: On test.case_project.not_null_dm_product_performance_product_name.42262fd437: BEGIN
[0m15:13:19.487630 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:13:19.487630 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:13:19.487630 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.not_null_dm_product_performance_product_name.42262fd437"
[0m15:13:19.487630 [debug] [Thread-1 (]: On test.case_project.not_null_dm_product_performance_product_name.42262fd437: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "test.case_project.not_null_dm_product_performance_product_name.42262fd437"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_name
from "warehouse"."main_marts"."dm_product_performance"
where product_name is null



  
  
      
    ) dbt_internal_test
[0m15:13:19.495209 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:13:19.497367 [debug] [Thread-1 (]: On test.case_project.not_null_dm_product_performance_product_name.42262fd437: ROLLBACK
[0m15:13:19.499373 [debug] [Thread-1 (]: Failed to rollback 'test.case_project.not_null_dm_product_performance_product_name.42262fd437'
[0m15:13:19.499373 [debug] [Thread-1 (]: On test.case_project.not_null_dm_product_performance_product_name.42262fd437: Close
[0m15:13:19.499373 [info ] [Thread-1 (]: 3 of 4 PASS not_null_dm_product_performance_product_name ....................... [[32mPASS[0m in 0.03s]
[0m15:13:19.501867 [debug] [Thread-1 (]: Finished running node test.case_project.not_null_dm_product_performance_product_name.42262fd437
[0m15:13:19.501867 [debug] [Thread-1 (]: Began running node test.case_project.not_null_dm_sales_daily_order_date.326c26920f
[0m15:13:19.501867 [info ] [Thread-1 (]: 4 of 4 START test not_null_dm_sales_daily_order_date ........................... [RUN]
[0m15:13:19.501867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.case_project.not_null_dm_product_performance_product_name.42262fd437, now test.case_project.not_null_dm_sales_daily_order_date.326c26920f)
[0m15:13:19.501867 [debug] [Thread-1 (]: Began compiling node test.case_project.not_null_dm_sales_daily_order_date.326c26920f
[0m15:13:19.510593 [debug] [Thread-1 (]: Writing injected SQL for node "test.case_project.not_null_dm_sales_daily_order_date.326c26920f"
[0m15:13:19.512594 [debug] [Thread-1 (]: Began executing node test.case_project.not_null_dm_sales_daily_order_date.326c26920f
[0m15:13:19.515592 [debug] [Thread-1 (]: Writing runtime sql for node "test.case_project.not_null_dm_sales_daily_order_date.326c26920f"
[0m15:13:19.517796 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.not_null_dm_sales_daily_order_date.326c26920f"
[0m15:13:19.517796 [debug] [Thread-1 (]: On test.case_project.not_null_dm_sales_daily_order_date.326c26920f: BEGIN
[0m15:13:19.518796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:13:19.519796 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:13:19.520796 [debug] [Thread-1 (]: Using duckdb connection "test.case_project.not_null_dm_sales_daily_order_date.326c26920f"
[0m15:13:19.520796 [debug] [Thread-1 (]: On test.case_project.not_null_dm_sales_daily_order_date.326c26920f: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "test.case_project.not_null_dm_sales_daily_order_date.326c26920f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_date
from "warehouse"."main_marts"."dm_sales_daily"
where order_date is null



  
  
      
    ) dbt_internal_test
[0m15:13:19.522571 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:13:19.523608 [debug] [Thread-1 (]: On test.case_project.not_null_dm_sales_daily_order_date.326c26920f: ROLLBACK
[0m15:13:19.524842 [debug] [Thread-1 (]: Failed to rollback 'test.case_project.not_null_dm_sales_daily_order_date.326c26920f'
[0m15:13:19.526164 [debug] [Thread-1 (]: On test.case_project.not_null_dm_sales_daily_order_date.326c26920f: Close
[0m15:13:19.526994 [info ] [Thread-1 (]: 4 of 4 PASS not_null_dm_sales_daily_order_date ................................. [[32mPASS[0m in 0.03s]
[0m15:13:19.528101 [debug] [Thread-1 (]: Finished running node test.case_project.not_null_dm_sales_daily_order_date.326c26920f
[0m15:13:19.530102 [debug] [MainThread]: Using duckdb connection "master"
[0m15:13:19.530102 [debug] [MainThread]: On master: BEGIN
[0m15:13:19.531100 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:13:19.532102 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:13:19.533102 [debug] [MainThread]: On master: COMMIT
[0m15:13:19.533512 [debug] [MainThread]: Using duckdb connection "master"
[0m15:13:19.534140 [debug] [MainThread]: On master: COMMIT
[0m15:13:19.535145 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:13:19.535145 [debug] [MainThread]: On master: Close
[0m15:13:19.536145 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:13:19.537146 [debug] [MainThread]: Connection 'list_warehouse_main_marts' was properly closed.
[0m15:13:19.537146 [debug] [MainThread]: Connection 'test.case_project.not_null_dm_sales_daily_order_date.326c26920f' was properly closed.
[0m15:13:19.538146 [info ] [MainThread]: 
[0m15:13:19.539145 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m15:13:19.540146 [debug] [MainThread]: Command end result
[0m15:13:19.578888 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\manss\Desktop\Case Project\target\manifest.json
[0m15:13:19.582115 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\manss\Desktop\Case Project\target\semantic_manifest.json
[0m15:13:19.592113 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\manss\Desktop\Case Project\target\run_results.json
[0m15:13:19.592113 [info ] [MainThread]: 
[0m15:13:19.592113 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:13:19.592113 [info ] [MainThread]: 
[0m15:13:19.592113 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m15:13:19.592113 [debug] [MainThread]: Command `dbt test` succeeded at 15:13:19.592113 after 2.00 seconds
[0m15:13:19.592113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B00633160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B004B22C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B04120B80>]}
[0m15:13:19.592113 [debug] [MainThread]: Flushing usage events
[0m15:13:20.270344 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:32:01.518571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f290f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fc6bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fc7d30>]}


============================== 21:32:01.520841 | e40a3fc5-86b5-4bd3-9969-2f7a21c2159f ==============================
[0m21:32:01.520841 [info ] [MainThread]: Running with dbt=1.10.10
[0m21:32:01.521074 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'introspect': 'True', 'quiet': 'False', 'profiles_dir': '/Volumes/The Disk/projects/Case Project main', 'log_format': 'default', 'printer_width': '80', 'log_path': '/Volumes/The Disk/projects/Case Project main/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'write_json': 'True', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'log_cache_events': 'False', 'invocation_command': 'dbt init .', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:32:01.529400 [info ] [MainThread]: Setting up your profile.
[0m21:32:06.956275 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": true, "command_wall_clock_time": 5.4751897, "process_in_blocks": "0", "process_kernel_time": 0.073434, "process_mem_max_rss": "127107072", "process_out_blocks": "0", "process_user_time": 0.963828}
[0m21:32:06.957440 [debug] [MainThread]: Command `dbt init` succeeded at 21:32:06.957287 after 5.48 seconds
[0m21:32:06.957970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f290f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058f4ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10525e0e0>]}
[0m21:32:06.958450 [debug] [MainThread]: Flushing usage events
[0m21:32:07.405661 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:32:11.398873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10601bc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ccc9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ccce20>]}


============================== 21:32:11.400299 | 75cf2a10-98a4-41cd-9c6f-8ddbc4954742 ==============================
[0m21:32:11.400299 [info ] [MainThread]: Running with dbt=1.10.10
[0m21:32:11.400543 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'no_print': 'None', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Volumes/The Disk/projects/Case Project main', 'log_cache_events': 'False', 'warn_error': 'None', 'empty': 'False', 'log_path': '/Volumes/The Disk/projects/Case Project main/logs', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'fail_fast': 'False', 'cache_selected_only': 'False', 'use_colors': 'True', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'debug': 'False', 'introspect': 'True', 'invocation_command': 'dbt run'}
[0m21:32:11.514363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75cf2a10-98a4-41cd-9c6f-8ddbc4954742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045b43d0>]}
[0m21:32:11.536720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75cf2a10-98a4-41cd-9c6f-8ddbc4954742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10648dae0>]}
[0m21:32:11.537495 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m21:32:11.721058 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m21:32:11.776004 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m21:32:11.776241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '75cf2a10-98a4-41cd-9c6f-8ddbc4954742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107489030>]}
[0m21:32:12.268070 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m21:32:12.268339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '75cf2a10-98a4-41cd-9c6f-8ddbc4954742', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111a4a90>]}
[0m21:32:12.345782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75cf2a10-98a4-41cd-9c6f-8ddbc4954742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113b1ff0>]}
[0m21:32:12.391605 [debug] [MainThread]: Wrote artifact WritableManifest to /Volumes/The Disk/projects/Case Project main/target/manifest.json
[0m21:32:12.394924 [debug] [MainThread]: Wrote artifact SemanticManifest to /Volumes/The Disk/projects/Case Project main/target/semantic_manifest.json
[0m21:32:12.407105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75cf2a10-98a4-41cd-9c6f-8ddbc4954742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113b3d30>]}
[0m21:32:12.407342 [info ] [MainThread]: Found 10 models, 4 seeds, 37 data tests, 4 sources, 429 macros
[0m21:32:12.407479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75cf2a10-98a4-41cd-9c6f-8ddbc4954742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113b17e0>]}
[0m21:32:12.408358 [info ] [MainThread]: 
[0m21:32:12.408496 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:32:12.408602 [info ] [MainThread]: 
[0m21:32:12.408797 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:32:12.410876 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m21:32:12.476442 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m21:32:12.476646 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m21:32:12.476756 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:32:12.493733 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m21:32:12.494261 [debug] [ThreadPool]: On list_warehouse: Close
[0m21:32:12.495278 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m21:32:12.495428 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m21:32:12.495540 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:32:12.495868 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:32:12.496235 [debug] [ThreadPool]: On list_warehouse: Close
[0m21:32:12.496479 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_marts)
[0m21:32:12.496665 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_marts"
"
[0m21:32:12.499059 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m21:32:12.499182 [debug] [ThreadPool]: On create_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_marts"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m21:32:12.499279 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:32:12.499563 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:32:12.499971 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m21:32:12.500070 [debug] [ThreadPool]: On create_warehouse_main_marts: BEGIN
[0m21:32:12.500215 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:32:12.500306 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m21:32:12.500395 [debug] [ThreadPool]: On create_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_marts"} */

    
    
        create schema if not exists "warehouse"."main_marts"
    
[0m21:32:12.500589 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:32:12.500840 [debug] [ThreadPool]: On create_warehouse_main_marts: COMMIT
[0m21:32:12.500938 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m21:32:12.501039 [debug] [ThreadPool]: On create_warehouse_main_marts: COMMIT
[0m21:32:12.501172 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:32:12.501267 [debug] [ThreadPool]: On create_warehouse_main_marts: Close
[0m21:32:12.501444 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_warehouse_main_marts, now create_warehouse_main_staging)
[0m21:32:12.501577 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_staging"
"
[0m21:32:12.502303 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m21:32:12.502419 [debug] [ThreadPool]: On create_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m21:32:12.502517 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:32:12.502747 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:32:12.503102 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m21:32:12.503201 [debug] [ThreadPool]: On create_warehouse_main_staging: BEGIN
[0m21:32:12.503342 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:32:12.503431 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m21:32:12.503521 [debug] [ThreadPool]: On create_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_staging"} */

    
    
        create schema if not exists "warehouse"."main_staging"
    
[0m21:32:12.503670 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:32:12.503908 [debug] [ThreadPool]: On create_warehouse_main_staging: COMMIT
[0m21:32:12.504025 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m21:32:12.504121 [debug] [ThreadPool]: On create_warehouse_main_staging: COMMIT
[0m21:32:12.504252 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:32:12.504347 [debug] [ThreadPool]: On create_warehouse_main_staging: Close
[0m21:32:12.504991 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_warehouse_main_staging, now list_warehouse_main_marts)
[0m21:32:12.506896 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m21:32:12.506995 [debug] [ThreadPool]: On list_warehouse_main_marts: BEGIN
[0m21:32:12.507080 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:32:12.507234 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:32:12.507325 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m21:32:12.507420 [debug] [ThreadPool]: On list_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_marts"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'warehouse'
  
[0m21:32:12.511811 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m21:32:12.512289 [debug] [ThreadPool]: On list_warehouse_main_marts: ROLLBACK
[0m21:32:12.512789 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_marts'
[0m21:32:12.512915 [debug] [ThreadPool]: On list_warehouse_main_marts: Close
[0m21:32:12.513085 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_marts, now list_warehouse_main_staging)
[0m21:32:12.514542 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_staging"
[0m21:32:12.514642 [debug] [ThreadPool]: On list_warehouse_main_staging: BEGIN
[0m21:32:12.514726 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:32:12.514876 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:32:12.514977 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_staging"
[0m21:32:12.515083 [debug] [ThreadPool]: On list_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_staging"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'warehouse'
  
[0m21:32:12.516193 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:32:12.516669 [debug] [ThreadPool]: On list_warehouse_main_staging: ROLLBACK
[0m21:32:12.516798 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_staging'
[0m21:32:12.516894 [debug] [ThreadPool]: On list_warehouse_main_staging: Close
[0m21:32:12.517056 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_staging, now list_warehouse_main_raw)
[0m21:32:12.517719 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m21:32:12.517999 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m21:32:12.518087 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:32:12.518244 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:32:12.518339 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m21:32:12.518436 [debug] [ThreadPool]: On list_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_raw"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'warehouse'
  
[0m21:32:12.519573 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:32:12.519943 [debug] [ThreadPool]: On list_warehouse_main_raw: ROLLBACK
[0m21:32:12.520062 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_raw'
[0m21:32:12.520153 [debug] [ThreadPool]: On list_warehouse_main_raw: Close
[0m21:32:12.520502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75cf2a10-98a4-41cd-9c6f-8ddbc4954742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044191b0>]}
[0m21:32:12.520688 [debug] [MainThread]: Using duckdb connection "master"
[0m21:32:12.520787 [debug] [MainThread]: On master: BEGIN
[0m21:32:12.520874 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:32:12.521030 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:32:12.521124 [debug] [MainThread]: On master: COMMIT
[0m21:32:12.521219 [debug] [MainThread]: Using duckdb connection "master"
[0m21:32:12.521308 [debug] [MainThread]: On master: COMMIT
[0m21:32:12.521441 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:32:12.521536 [debug] [MainThread]: On master: Close
[0m21:32:12.522600 [debug] [Thread-1 (]: Began running node model.case_project.stg_customers
[0m21:32:12.522778 [info ] [Thread-1 (]: 1 of 10 START sql view model main_staging.stg_customers ........................ [RUN]
[0m21:32:12.522951 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_main_raw, now model.case_project.stg_customers)
[0m21:32:12.523081 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_customers
[0m21:32:12.525929 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_customers"
[0m21:32:12.529592 [debug] [Thread-1 (]: Began executing node model.case_project.stg_customers
[0m21:32:12.540462 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_customers"
[0m21:32:12.544371 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m21:32:12.544498 [debug] [Thread-1 (]: On model.case_project.stg_customers: BEGIN
[0m21:32:12.544607 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:32:12.544827 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:32:12.544947 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m21:32:12.545074 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */

  
  create view "warehouse"."main_staging"."stg_customers__dbt_tmp" as (
    -- models/staging/stg_customers.sql
with src as (select * from "warehouse"."main_raw"."raw_customers")
select
  cast(id as varchar) as customer_id,
  initcap(trim(name)) as customer_name
from src
  );

[0m21:32:12.546302 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */

  
  create view "warehouse"."main_staging"."stg_customers__dbt_tmp" as (
    -- models/staging/stg_customers.sql
with src as (select * from "warehouse"."main_raw"."raw_customers")
select
  cast(id as varchar) as customer_id,
  initcap(trim(name)) as customer_name
from src
  );

[0m21:32:12.546440 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m21:32:12.546610 [debug] [Thread-1 (]: On model.case_project.stg_customers: ROLLBACK
[0m21:32:12.549232 [debug] [Thread-1 (]: Failed to rollback 'model.case_project.stg_customers'
[0m21:32:12.549382 [debug] [Thread-1 (]: On model.case_project.stg_customers: Close
[0m21:32:12.549756 [debug] [Thread-1 (]: Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Catalog Error: Scalar Function with name initcap does not exist!
  Did you mean "ilike_escape"?
  
  LINE 9:   initcap(trim(name)) as customer_name
            ^
[0m21:32:12.550608 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75cf2a10-98a4-41cd-9c6f-8ddbc4954742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ac4340>]}
[0m21:32:12.550878 [error] [Thread-1 (]: 1 of 10 ERROR creating sql view model main_staging.stg_customers ............... [[31mERROR[0m in 0.03s]
[0m21:32:12.551106 [debug] [Thread-1 (]: Finished running node model.case_project.stg_customers
[0m21:32:12.551258 [debug] [Thread-1 (]: Began running node model.case_project.stg_items
[0m21:32:12.551434 [debug] [Thread-4 (]: Marking all children of 'model.case_project.stg_customers' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Catalog Error: Scalar Function with name initcap does not exist!
  Did you mean "ilike_escape"?
  
  LINE 9:   initcap(trim(name)) as customer_name
            ^.
[0m21:32:12.551600 [info ] [Thread-1 (]: 2 of 10 START sql view model main_staging.stg_items ............................ [RUN]
[0m21:32:12.552025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_customers, now model.case_project.stg_items)
[0m21:32:12.552148 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_items
[0m21:32:12.553314 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_items"
[0m21:32:12.556278 [debug] [Thread-1 (]: Began executing node model.case_project.stg_items
[0m21:32:12.558741 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_items"
[0m21:32:12.561071 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m21:32:12.561207 [debug] [Thread-1 (]: On model.case_project.stg_items: BEGIN
[0m21:32:12.561318 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:32:12.561576 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:32:12.561710 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m21:32:12.561845 [debug] [Thread-1 (]: On model.case_project.stg_items: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_items"} */

  
  create view "warehouse"."main_staging"."stg_items__dbt_tmp" as (
    with src as (
  select * from "warehouse"."main_raw"."raw_items"
)
select
  cast(order_id as varchar) as order_id,  -- FK to orders
  cast(sku      as varchar) as product_id, 
  1                           as quantity  -- Assumption: one row = one item
from src
  );

[0m21:32:12.562133 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:32:12.564536 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m21:32:12.564667 [debug] [Thread-1 (]: On model.case_project.stg_items: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_items"} */
alter view "warehouse"."main_staging"."stg_items" rename to "stg_items__dbt_backup"
[0m21:32:12.564915 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:32:12.565955 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m21:32:12.566078 [debug] [Thread-1 (]: On model.case_project.stg_items: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_items"} */
alter view "warehouse"."main_staging"."stg_items__dbt_tmp" rename to "stg_items"
[0m21:32:12.566257 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:32:12.570356 [debug] [Thread-1 (]: On model.case_project.stg_items: COMMIT
[0m21:32:12.570488 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m21:32:12.570597 [debug] [Thread-1 (]: On model.case_project.stg_items: COMMIT
[0m21:32:12.573939 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:32:12.575973 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m21:32:12.576099 [debug] [Thread-1 (]: On model.case_project.stg_items: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_items"} */

      drop view if exists "warehouse"."main_staging"."stg_items__dbt_backup" cascade
    
[0m21:32:12.578311 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:32:12.579228 [debug] [Thread-1 (]: On model.case_project.stg_items: Close
[0m21:32:12.579455 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75cf2a10-98a4-41cd-9c6f-8ddbc4954742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ac4340>]}
[0m21:32:12.579693 [info ] [Thread-1 (]: 2 of 10 OK created sql view model main_staging.stg_items ....................... [[32mOK[0m in 0.03s]
[0m21:32:12.579899 [debug] [Thread-1 (]: Finished running node model.case_project.stg_items
[0m21:32:12.580043 [debug] [Thread-1 (]: Began running node model.case_project.stg_orders
[0m21:32:12.580210 [info ] [Thread-1 (]: 3 of 10 START sql view model main_staging.stg_orders ........................... [RUN]
[0m21:32:12.580403 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_items, now model.case_project.stg_orders)
[0m21:32:12.580533 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_orders
[0m21:32:12.581566 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_orders"
[0m21:32:12.584180 [debug] [Thread-1 (]: Began executing node model.case_project.stg_orders
[0m21:32:12.585610 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_orders"
[0m21:32:12.587574 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m21:32:12.587727 [debug] [Thread-1 (]: On model.case_project.stg_orders: BEGIN
[0m21:32:12.587936 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:32:12.588236 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:32:12.588365 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m21:32:12.588502 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */

  
  create view "warehouse"."main_staging"."stg_orders__dbt_tmp" as (
    with src as (
  select * from "warehouse"."main_raw"."raw_orders"
)
select
  cast(id as varchar)                 as order_id,
  cast(customer as varchar)           as customer_id,
  cast(store_id as varchar)           as store_id,
  cast(ordered_at as timestamp)       as ordered_at,
  cast(subtotal as decimal(10,2))            as subtotal,
  cast(tax_paid as decimal(10,2))            as tax_paid,
  cast(order_total as decimal(10,2))         as order_total
from src
  );

[0m21:32:12.588863 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:32:12.590130 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m21:32:12.590255 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */
alter view "warehouse"."main_staging"."stg_orders" rename to "stg_orders__dbt_backup"
[0m21:32:12.590474 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:32:12.592308 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m21:32:12.592434 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */
alter view "warehouse"."main_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m21:32:12.592628 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:32:12.593120 [debug] [Thread-1 (]: On model.case_project.stg_orders: COMMIT
[0m21:32:12.593239 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m21:32:12.593345 [debug] [Thread-1 (]: On model.case_project.stg_orders: COMMIT
[0m21:32:12.595364 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:32:12.596267 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m21:32:12.596391 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */

      drop view if exists "warehouse"."main_staging"."stg_orders__dbt_backup" cascade
    
[0m21:32:12.598028 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:32:12.598435 [debug] [Thread-1 (]: On model.case_project.stg_orders: Close
[0m21:32:12.598660 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75cf2a10-98a4-41cd-9c6f-8ddbc4954742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ac4340>]}
[0m21:32:12.598896 [info ] [Thread-1 (]: 3 of 10 OK created sql view model main_staging.stg_orders ...................... [[32mOK[0m in 0.02s]
[0m21:32:12.599104 [debug] [Thread-1 (]: Finished running node model.case_project.stg_orders
[0m21:32:12.599253 [debug] [Thread-1 (]: Began running node model.case_project.stg_products
[0m21:32:12.599474 [info ] [Thread-1 (]: 4 of 10 START sql view model main_staging.stg_products ......................... [RUN]
[0m21:32:12.599689 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_orders, now model.case_project.stg_products)
[0m21:32:12.599826 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_products
[0m21:32:12.600865 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_products"
[0m21:32:12.603594 [debug] [Thread-1 (]: Began executing node model.case_project.stg_products
[0m21:32:12.605072 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_products"
[0m21:32:12.607436 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m21:32:12.607554 [debug] [Thread-1 (]: On model.case_project.stg_products: BEGIN
[0m21:32:12.607661 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:32:12.607859 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:32:12.607980 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m21:32:12.608109 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */

  
  create view "warehouse"."main_staging"."stg_products__dbt_tmp" as (
    -- models/staging/stg_products.sql
with src as (select * from "warehouse"."main_raw"."raw_products")
select
  cast(sku as varchar)      as product_id,
  trim(name)                as product_name, 
  cast(price as decimal(10,2))    as price
from src
  );

[0m21:32:12.608390 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:32:12.609486 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m21:32:12.609604 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */
alter view "warehouse"."main_staging"."stg_products" rename to "stg_products__dbt_backup"
[0m21:32:12.609789 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:32:12.610815 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m21:32:12.610940 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */
alter view "warehouse"."main_staging"."stg_products__dbt_tmp" rename to "stg_products"
[0m21:32:12.611121 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:32:12.611610 [debug] [Thread-1 (]: On model.case_project.stg_products: COMMIT
[0m21:32:12.611726 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m21:32:12.611830 [debug] [Thread-1 (]: On model.case_project.stg_products: COMMIT
[0m21:32:12.613868 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:32:12.614711 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m21:32:12.614824 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */

      drop view if exists "warehouse"."main_staging"."stg_products__dbt_backup" cascade
    
[0m21:32:12.616850 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:32:12.617822 [debug] [Thread-1 (]: On model.case_project.stg_products: Close
[0m21:32:12.618022 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75cf2a10-98a4-41cd-9c6f-8ddbc4954742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ac4340>]}
[0m21:32:12.618236 [info ] [Thread-1 (]: 4 of 10 OK created sql view model main_staging.stg_products .................... [[32mOK[0m in 0.02s]
[0m21:32:12.618437 [debug] [Thread-1 (]: Finished running node model.case_project.stg_products
[0m21:32:12.618575 [debug] [Thread-1 (]: Began running node model.case_project.dim_customers
[0m21:32:12.618762 [info ] [Thread-1 (]: 5 of 10 SKIP relation main_marts.dim_customers ................................. [[33mSKIP[0m]
[0m21:32:12.618903 [debug] [Thread-1 (]: Finished running node model.case_project.dim_customers
[0m21:32:12.619032 [debug] [Thread-1 (]: Began running node model.case_project.fct_orders
[0m21:32:12.619196 [info ] [Thread-1 (]: 6 of 10 START sql view model main_marts.fct_orders ............................. [RUN]
[0m21:32:12.619342 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_products, now model.case_project.fct_orders)
[0m21:32:12.619466 [debug] [Thread-1 (]: Began compiling node model.case_project.fct_orders
[0m21:32:12.620414 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.fct_orders"
[0m21:32:12.622320 [debug] [Thread-1 (]: Began executing node model.case_project.fct_orders
[0m21:32:12.623616 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.fct_orders"
[0m21:32:12.626355 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m21:32:12.626471 [debug] [Thread-1 (]: On model.case_project.fct_orders: BEGIN
[0m21:32:12.626576 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:32:12.626766 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:32:12.626884 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m21:32:12.627008 [debug] [Thread-1 (]: On model.case_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_orders"} */

  
  create view "warehouse"."main_marts"."fct_orders__dbt_tmp" as (
    select
  o.order_id,
  o.customer_id,
  cast(o.ordered_at as date) as order_date,
  cast(date_trunc('month', o.ordered_at) as date) as order_month,
  o.subtotal,
  o.tax_paid,
  o.order_total
from "warehouse"."main_staging"."stg_orders" as o;
  );

[0m21:32:12.627294 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_orders"} */

  
  create view "warehouse"."main_marts"."fct_orders__dbt_tmp" as (
    select
  o.order_id,
  o.customer_id,
  cast(o.ordered_at as date) as order_date,
  cast(date_trunc('month', o.ordered_at) as date) as order_month,
  o.subtotal,
  o.tax_paid,
  o.order_total
from "warehouse"."main_staging"."stg_orders" as o;
  );

[0m21:32:12.627412 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m21:32:12.627551 [debug] [Thread-1 (]: On model.case_project.fct_orders: ROLLBACK
[0m21:32:12.627908 [debug] [Thread-1 (]: Failed to rollback 'model.case_project.fct_orders'
[0m21:32:12.628020 [debug] [Thread-1 (]: On model.case_project.fct_orders: Close
[0m21:32:12.628343 [debug] [Thread-1 (]: Runtime Error in model fct_orders (models/marts/fct_orders.sql)
  Parser Error: syntax error at or near ";"
[0m21:32:12.628504 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75cf2a10-98a4-41cd-9c6f-8ddbc4954742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ac4340>]}
[0m21:32:12.628712 [error] [Thread-1 (]: 6 of 10 ERROR creating sql view model main_marts.fct_orders .................... [[31mERROR[0m in 0.01s]
[0m21:32:12.628910 [debug] [Thread-1 (]: Finished running node model.case_project.fct_orders
[0m21:32:12.629048 [debug] [Thread-1 (]: Began running node model.case_project.fct_order_items
[0m21:32:12.629210 [debug] [Thread-4 (]: Marking all children of 'model.case_project.fct_orders' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_orders (models/marts/fct_orders.sql)
  Parser Error: syntax error at or near ";".
[0m21:32:12.629358 [info ] [Thread-1 (]: 7 of 10 START sql view model main_marts.fct_order_items ........................ [RUN]
[0m21:32:12.629616 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.fct_orders, now model.case_project.fct_order_items)
[0m21:32:12.629753 [debug] [Thread-1 (]: Began compiling node model.case_project.fct_order_items
[0m21:32:12.631018 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.fct_order_items"
[0m21:32:12.633969 [debug] [Thread-1 (]: Began executing node model.case_project.fct_order_items
[0m21:32:12.635248 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.fct_order_items"
[0m21:32:12.637651 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_order_items"
[0m21:32:12.637791 [debug] [Thread-1 (]: On model.case_project.fct_order_items: BEGIN
[0m21:32:12.637995 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:32:12.638239 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:32:12.638365 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_order_items"
[0m21:32:12.638552 [debug] [Thread-1 (]: On model.case_project.fct_order_items: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_order_items"} */

  
  create view "warehouse"."main_marts"."fct_order_items__dbt_tmp" as (
    with
items as (
  select
    i.order_id,
    i.product_id,
    i.quantity
  from "warehouse"."main_staging"."stg_items" as i
),
orders as (
  select
    o.order_id,
    o.customer_id,
    cast(o.ordered_at as date) as order_date,
    cast(date_trunc('month', o.ordered_at) as date) as order_month
  from "warehouse"."main_staging"."stg_orders" as o
),
products as (
  select
    p.product_id,
    p.product_name,
    p.price as unit_price,
    case
      when p.product_id like 'BEV%' then 'drinks'
      when p.product_id like 'JAF%' then 'sandwiches'
      else 'other'
    end as product_category
  from "warehouse"."main_staging"."stg_products" as p
)
select
  o.order_id,
  o.customer_id,
  o.order_date,
  o.order_month,
  pr.product_id,
  pr.product_name,
  pr.product_category,
  coalesce(it.quantity, 1) as quantity,
  pr.unit_price,
  coalesce(it.quantity, 1) * pr.unit_price as line_revenue
from items it
join orders o   using (order_id)
join products pr using (product_id);
  );

[0m21:32:12.638897 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_order_items"} */

  
  create view "warehouse"."main_marts"."fct_order_items__dbt_tmp" as (
    with
items as (
  select
    i.order_id,
    i.product_id,
    i.quantity
  from "warehouse"."main_staging"."stg_items" as i
),
orders as (
  select
    o.order_id,
    o.customer_id,
    cast(o.ordered_at as date) as order_date,
    cast(date_trunc('month', o.ordered_at) as date) as order_month
  from "warehouse"."main_staging"."stg_orders" as o
),
products as (
  select
    p.product_id,
    p.product_name,
    p.price as unit_price,
    case
      when p.product_id like 'BEV%' then 'drinks'
      when p.product_id like 'JAF%' then 'sandwiches'
      else 'other'
    end as product_category
  from "warehouse"."main_staging"."stg_products" as p
)
select
  o.order_id,
  o.customer_id,
  o.order_date,
  o.order_month,
  pr.product_id,
  pr.product_name,
  pr.product_category,
  coalesce(it.quantity, 1) as quantity,
  pr.unit_price,
  coalesce(it.quantity, 1) * pr.unit_price as line_revenue
from items it
join orders o   using (order_id)
join products pr using (product_id);
  );

[0m21:32:12.639052 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m21:32:12.639226 [debug] [Thread-1 (]: On model.case_project.fct_order_items: ROLLBACK
[0m21:32:12.639573 [debug] [Thread-1 (]: Failed to rollback 'model.case_project.fct_order_items'
[0m21:32:12.639687 [debug] [Thread-1 (]: On model.case_project.fct_order_items: Close
[0m21:32:12.640054 [debug] [Thread-1 (]: Runtime Error in model fct_order_items (models/marts/fct_order_items.sql)
  Parser Error: syntax error at or near ";"
[0m21:32:12.640259 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75cf2a10-98a4-41cd-9c6f-8ddbc4954742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113b3d30>]}
[0m21:32:12.640502 [error] [Thread-1 (]: 7 of 10 ERROR creating sql view model main_marts.fct_order_items ............... [[31mERROR[0m in 0.01s]
[0m21:32:12.640708 [debug] [Thread-1 (]: Finished running node model.case_project.fct_order_items
[0m21:32:12.640854 [debug] [Thread-1 (]: Began running node model.case_project.customer_pareto
[0m21:32:12.641030 [debug] [Thread-4 (]: Marking all children of 'model.case_project.fct_order_items' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_order_items (models/marts/fct_order_items.sql)
  Parser Error: syntax error at or near ";".
[0m21:32:12.641159 [info ] [Thread-1 (]: 8 of 10 SKIP relation main_marts.customer_pareto ............................... [[33mSKIP[0m]
[0m21:32:12.641361 [debug] [Thread-1 (]: Finished running node model.case_project.customer_pareto
[0m21:32:12.641496 [debug] [Thread-1 (]: Began running node model.case_project.orders_fact
[0m21:32:12.641628 [info ] [Thread-1 (]: 9 of 10 SKIP relation main_marts.orders_fact ................................... [[33mSKIP[0m]
[0m21:32:12.641807 [debug] [Thread-1 (]: Finished running node model.case_project.orders_fact
[0m21:32:12.642045 [debug] [Thread-1 (]: Began running node model.case_project.monthly_summary
[0m21:32:12.642212 [info ] [Thread-1 (]: 10 of 10 SKIP relation main_marts.monthly_summary .............................. [[33mSKIP[0m]
[0m21:32:12.642379 [debug] [Thread-1 (]: Finished running node model.case_project.monthly_summary
[0m21:32:12.642750 [debug] [MainThread]: Using duckdb connection "master"
[0m21:32:12.642864 [debug] [MainThread]: On master: BEGIN
[0m21:32:12.642961 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:32:12.643136 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:32:12.643241 [debug] [MainThread]: On master: COMMIT
[0m21:32:12.643345 [debug] [MainThread]: Using duckdb connection "master"
[0m21:32:12.643441 [debug] [MainThread]: On master: COMMIT
[0m21:32:12.643576 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:32:12.643680 [debug] [MainThread]: On master: Close
[0m21:32:12.643811 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:32:12.643905 [debug] [MainThread]: Connection 'model.case_project.fct_order_items' was properly closed.
[0m21:32:12.644034 [info ] [MainThread]: 
[0m21:32:12.644150 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m21:32:12.644643 [debug] [MainThread]: Command end result
[0m21:32:12.659267 [debug] [MainThread]: Wrote artifact WritableManifest to /Volumes/The Disk/projects/Case Project main/target/manifest.json
[0m21:32:12.660720 [debug] [MainThread]: Wrote artifact SemanticManifest to /Volumes/The Disk/projects/Case Project main/target/semantic_manifest.json
[0m21:32:12.664781 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Volumes/The Disk/projects/Case Project main/target/run_results.json
[0m21:32:12.664899 [info ] [MainThread]: 
[0m21:32:12.665048 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m21:32:12.665175 [info ] [MainThread]: 
[0m21:32:12.665323 [error] [MainThread]: [31mFailure in model stg_customers (models/staging/stg_customers.sql)[0m
[0m21:32:12.665464 [error] [MainThread]:   Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Catalog Error: Scalar Function with name initcap does not exist!
  Did you mean "ilike_escape"?
  
  LINE 9:   initcap(trim(name)) as customer_name
            ^
[0m21:32:12.665569 [info ] [MainThread]: 
[0m21:32:12.665703 [info ] [MainThread]:   compiled code at target/compiled/case_project/models/staging/stg_customers.sql
[0m21:32:12.665806 [info ] [MainThread]: 
[0m21:32:12.665937 [error] [MainThread]: [31mFailure in model fct_orders (models/marts/fct_orders.sql)[0m
[0m21:32:12.666067 [error] [MainThread]:   Runtime Error in model fct_orders (models/marts/fct_orders.sql)
  Parser Error: syntax error at or near ";"
[0m21:32:12.666165 [info ] [MainThread]: 
[0m21:32:12.666300 [info ] [MainThread]:   compiled code at target/compiled/case_project/models/marts/fct_orders.sql
[0m21:32:12.666405 [info ] [MainThread]: 
[0m21:32:12.666535 [error] [MainThread]: [31mFailure in model fct_order_items (models/marts/fct_order_items.sql)[0m
[0m21:32:12.666659 [error] [MainThread]:   Runtime Error in model fct_order_items (models/marts/fct_order_items.sql)
  Parser Error: syntax error at or near ";"
[0m21:32:12.666756 [info ] [MainThread]: 
[0m21:32:12.666872 [info ] [MainThread]:   compiled code at target/compiled/case_project/models/marts/fct_order_items.sql
[0m21:32:12.666977 [info ] [MainThread]: 
[0m21:32:12.667095 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=3 SKIP=4 NO-OP=0 TOTAL=10
[0m21:32:12.667321 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 4 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m21:32:12.668348 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2970126, "process_in_blocks": "0", "process_kernel_time": 0.132384, "process_mem_max_rss": "182829056", "process_out_blocks": "0", "process_user_time": 1.941322}
[0m21:32:12.668500 [debug] [MainThread]: Command `dbt run` failed at 21:32:12.668471 after 1.30 seconds
[0m21:32:12.668638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10601bc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111427e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111c02b0>]}
[0m21:32:12.668766 [debug] [MainThread]: Flushing usage events
[0m21:32:13.130831 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:34:39.452462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106435630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100c7f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100c7af0>]}


============================== 21:34:39.454174 | f1857abd-4334-4b7e-b05e-552d71ae1cca ==============================
[0m21:34:39.454174 [info ] [MainThread]: Running with dbt=1.10.10
[0m21:34:39.454425 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'log_format': 'default', 'partial_parse': 'True', 'invocation_command': 'dbt run', 'use_colors': 'True', 'no_print': 'None', 'printer_width': '80', 'profiles_dir': '/Volumes/The Disk/projects/Case Project main', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'debug': 'False', 'log_path': '/Volumes/The Disk/projects/Case Project main/logs', 'cache_selected_only': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'target_path': 'None', 'log_cache_events': 'False', 'introspect': 'True'}
[0m21:34:39.567987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f1857abd-4334-4b7e-b05e-552d71ae1cca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101cae60>]}
[0m21:34:39.589223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f1857abd-4334-4b7e-b05e-552d71ae1cca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100265f0>]}
[0m21:34:39.589912 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m21:34:39.628919 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m21:34:39.702633 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 7 files changed.
[0m21:34:39.702915 [debug] [MainThread]: Partial parsing: updated file: case_project://models/marts/dim_customers.sql
[0m21:34:39.703071 [debug] [MainThread]: Partial parsing: updated file: case_project://models/marts/fct_orders.sql
[0m21:34:39.703211 [debug] [MainThread]: Partial parsing: updated file: case_project://models/marts/customer_pareto.sql
[0m21:34:39.703349 [debug] [MainThread]: Partial parsing: updated file: case_project://models/marts/fct_order_items.sql
[0m21:34:39.703487 [debug] [MainThread]: Partial parsing: updated file: case_project://models/staging/stg_customers.sql
[0m21:34:39.703621 [debug] [MainThread]: Partial parsing: updated file: case_project://models/marts/monthly_summary.sql
[0m21:34:39.703752 [debug] [MainThread]: Partial parsing: updated file: case_project://models/marts/orders_fact.sql
[0m21:34:39.878661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1857abd-4334-4b7e-b05e-552d71ae1cca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c7ddb0>]}
[0m21:34:39.924814 [debug] [MainThread]: Wrote artifact WritableManifest to /Volumes/The Disk/projects/Case Project main/target/manifest.json
[0m21:34:39.926949 [debug] [MainThread]: Wrote artifact SemanticManifest to /Volumes/The Disk/projects/Case Project main/target/semantic_manifest.json
[0m21:34:39.935144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1857abd-4334-4b7e-b05e-552d71ae1cca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c7ed10>]}
[0m21:34:39.935345 [info ] [MainThread]: Found 10 models, 4 seeds, 37 data tests, 4 sources, 429 macros
[0m21:34:39.935486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1857abd-4334-4b7e-b05e-552d71ae1cca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c7d420>]}
[0m21:34:39.936345 [info ] [MainThread]: 
[0m21:34:39.936482 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:34:39.936589 [info ] [MainThread]: 
[0m21:34:39.936785 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:34:39.938902 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m21:34:39.959820 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m21:34:39.960006 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m21:34:39.960115 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:34:39.967608 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m21:34:39.968093 [debug] [ThreadPool]: On list_warehouse: Close
[0m21:34:39.969082 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m21:34:39.969216 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m21:34:39.969322 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:34:39.969637 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:34:39.969990 [debug] [ThreadPool]: On list_warehouse: Close
[0m21:34:39.970200 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_marts)
[0m21:34:39.970348 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_marts"
"
[0m21:34:39.972828 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m21:34:39.972976 [debug] [ThreadPool]: On create_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_marts"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m21:34:39.973081 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:34:39.973384 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:34:39.973789 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m21:34:39.973889 [debug] [ThreadPool]: On create_warehouse_main_marts: BEGIN
[0m21:34:39.974040 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:34:39.974134 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m21:34:39.974225 [debug] [ThreadPool]: On create_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_marts"} */

    
    
        create schema if not exists "warehouse"."main_marts"
    
[0m21:34:39.974397 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:34:39.974647 [debug] [ThreadPool]: On create_warehouse_main_marts: COMMIT
[0m21:34:39.974752 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m21:34:39.974843 [debug] [ThreadPool]: On create_warehouse_main_marts: COMMIT
[0m21:34:39.974981 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:34:39.975081 [debug] [ThreadPool]: On create_warehouse_main_marts: Close
[0m21:34:39.975274 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_warehouse_main_marts, now create_warehouse_main_staging)
[0m21:34:39.975418 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_staging"
"
[0m21:34:39.976134 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m21:34:39.976257 [debug] [ThreadPool]: On create_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m21:34:39.976391 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:34:39.976624 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:34:39.976995 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m21:34:39.977090 [debug] [ThreadPool]: On create_warehouse_main_staging: BEGIN
[0m21:34:39.977225 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:34:39.977317 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m21:34:39.977406 [debug] [ThreadPool]: On create_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_staging"} */

    
    
        create schema if not exists "warehouse"."main_staging"
    
[0m21:34:39.977549 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:34:39.977788 [debug] [ThreadPool]: On create_warehouse_main_staging: COMMIT
[0m21:34:39.977882 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m21:34:39.977966 [debug] [ThreadPool]: On create_warehouse_main_staging: COMMIT
[0m21:34:39.978090 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:34:39.978187 [debug] [ThreadPool]: On create_warehouse_main_staging: Close
[0m21:34:39.978852 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_warehouse_main_staging, now list_warehouse_main_marts)
[0m21:34:39.980765 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m21:34:39.980942 [debug] [ThreadPool]: On list_warehouse_main_marts: BEGIN
[0m21:34:39.981033 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:34:39.981207 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:34:39.981334 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m21:34:39.981446 [debug] [ThreadPool]: On list_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_marts"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'warehouse'
  
[0m21:34:39.985734 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m21:34:39.986198 [debug] [ThreadPool]: On list_warehouse_main_marts: ROLLBACK
[0m21:34:39.986435 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_marts'
[0m21:34:39.986539 [debug] [ThreadPool]: On list_warehouse_main_marts: Close
[0m21:34:39.986713 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_marts, now list_warehouse_main_staging)
[0m21:34:39.987446 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_staging"
[0m21:34:39.987872 [debug] [ThreadPool]: On list_warehouse_main_staging: BEGIN
[0m21:34:39.987957 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:34:39.988130 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:34:39.988246 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_staging"
[0m21:34:39.988355 [debug] [ThreadPool]: On list_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_staging"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'warehouse'
  
[0m21:34:39.989572 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:34:39.989958 [debug] [ThreadPool]: On list_warehouse_main_staging: ROLLBACK
[0m21:34:39.990080 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_staging'
[0m21:34:39.990170 [debug] [ThreadPool]: On list_warehouse_main_staging: Close
[0m21:34:39.990325 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_staging, now list_warehouse_main_raw)
[0m21:34:39.991714 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m21:34:39.991812 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m21:34:39.991897 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:34:39.992053 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:34:39.992155 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m21:34:39.992255 [debug] [ThreadPool]: On list_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_raw"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'warehouse'
  
[0m21:34:39.993357 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:34:39.993738 [debug] [ThreadPool]: On list_warehouse_main_raw: ROLLBACK
[0m21:34:39.993861 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_raw'
[0m21:34:39.993953 [debug] [ThreadPool]: On list_warehouse_main_raw: Close
[0m21:34:39.994314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1857abd-4334-4b7e-b05e-552d71ae1cca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046c5b40>]}
[0m21:34:39.994487 [debug] [MainThread]: Using duckdb connection "master"
[0m21:34:39.994579 [debug] [MainThread]: On master: BEGIN
[0m21:34:39.994668 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:34:39.994820 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:34:39.994912 [debug] [MainThread]: On master: COMMIT
[0m21:34:39.995000 [debug] [MainThread]: Using duckdb connection "master"
[0m21:34:39.995085 [debug] [MainThread]: On master: COMMIT
[0m21:34:39.995225 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:34:39.995327 [debug] [MainThread]: On master: Close
[0m21:34:39.996049 [debug] [Thread-1 (]: Began running node model.case_project.stg_customers
[0m21:34:39.996221 [info ] [Thread-1 (]: 1 of 10 START sql view model main_staging.stg_customers ........................ [RUN]
[0m21:34:39.996393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_main_raw, now model.case_project.stg_customers)
[0m21:34:39.996536 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_customers
[0m21:34:39.999380 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_customers"
[0m21:34:40.002435 [debug] [Thread-1 (]: Began executing node model.case_project.stg_customers
[0m21:34:40.013745 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_customers"
[0m21:34:40.016846 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m21:34:40.016986 [debug] [Thread-1 (]: On model.case_project.stg_customers: BEGIN
[0m21:34:40.017101 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:34:40.017342 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:34:40.017454 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m21:34:40.017571 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */

  
  create view "warehouse"."main_staging"."stg_customers__dbt_tmp" as (
    -- models/staging/stg_customers.sql
with src as (select * from "warehouse"."main_raw"."raw_customers")
select
  cast(id as varchar) as customer_id,
  trim(name) as customer_name
from src
  );

[0m21:34:40.017868 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:34:40.020068 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m21:34:40.020199 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */
alter view "warehouse"."main_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m21:34:40.020428 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:34:40.021482 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m21:34:40.021633 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */
alter view "warehouse"."main_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m21:34:40.021961 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:34:40.026183 [debug] [Thread-1 (]: On model.case_project.stg_customers: COMMIT
[0m21:34:40.026332 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m21:34:40.026452 [debug] [Thread-1 (]: On model.case_project.stg_customers: COMMIT
[0m21:34:40.030765 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m21:34:40.033249 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m21:34:40.033390 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */

      drop view if exists "warehouse"."main_staging"."stg_customers__dbt_backup" cascade
    
[0m21:34:40.035132 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:34:40.036014 [debug] [Thread-1 (]: On model.case_project.stg_customers: Close
[0m21:34:40.036642 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1857abd-4334-4b7e-b05e-552d71ae1cca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048aaec0>]}
[0m21:34:40.036878 [info ] [Thread-1 (]: 1 of 10 OK created sql view model main_staging.stg_customers ................... [[32mOK[0m in 0.04s]
[0m21:34:40.037094 [debug] [Thread-1 (]: Finished running node model.case_project.stg_customers
[0m21:34:40.037241 [debug] [Thread-1 (]: Began running node model.case_project.stg_items
[0m21:34:40.037436 [info ] [Thread-1 (]: 2 of 10 START sql view model main_staging.stg_items ............................ [RUN]
[0m21:34:40.037599 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_customers, now model.case_project.stg_items)
[0m21:34:40.037729 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_items
[0m21:34:40.038821 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_items"
[0m21:34:40.040242 [debug] [Thread-1 (]: Began executing node model.case_project.stg_items
[0m21:34:40.041454 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_items"
[0m21:34:40.042692 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m21:34:40.042808 [debug] [Thread-1 (]: On model.case_project.stg_items: BEGIN
[0m21:34:40.042917 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:34:40.043104 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:34:40.043224 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m21:34:40.043352 [debug] [Thread-1 (]: On model.case_project.stg_items: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_items"} */

  
  create view "warehouse"."main_staging"."stg_items__dbt_tmp" as (
    with src as (
  select * from "warehouse"."main_raw"."raw_items"
)
select
  cast(order_id as varchar) as order_id,  -- FK to orders
  cast(sku      as varchar) as product_id, 
  1                           as quantity  -- Assumption: one row = one item
from src
  );

[0m21:34:40.043618 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:34:40.044853 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m21:34:40.044985 [debug] [Thread-1 (]: On model.case_project.stg_items: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_items"} */
alter view "warehouse"."main_staging"."stg_items" rename to "stg_items__dbt_backup"
[0m21:34:40.045195 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:34:40.046182 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m21:34:40.046297 [debug] [Thread-1 (]: On model.case_project.stg_items: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_items"} */
alter view "warehouse"."main_staging"."stg_items__dbt_tmp" rename to "stg_items"
[0m21:34:40.046474 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:34:40.046947 [debug] [Thread-1 (]: On model.case_project.stg_items: COMMIT
[0m21:34:40.047062 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m21:34:40.047165 [debug] [Thread-1 (]: On model.case_project.stg_items: COMMIT
[0m21:34:40.049376 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:34:40.050279 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m21:34:40.050395 [debug] [Thread-1 (]: On model.case_project.stg_items: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_items"} */

      drop view if exists "warehouse"."main_staging"."stg_items__dbt_backup" cascade
    
[0m21:34:40.051867 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:34:40.052248 [debug] [Thread-1 (]: On model.case_project.stg_items: Close
[0m21:34:40.052450 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1857abd-4334-4b7e-b05e-552d71ae1cca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111506c80>]}
[0m21:34:40.052672 [info ] [Thread-1 (]: 2 of 10 OK created sql view model main_staging.stg_items ....................... [[32mOK[0m in 0.01s]
[0m21:34:40.052878 [debug] [Thread-1 (]: Finished running node model.case_project.stg_items
[0m21:34:40.053027 [debug] [Thread-1 (]: Began running node model.case_project.stg_orders
[0m21:34:40.053226 [info ] [Thread-1 (]: 3 of 10 START sql view model main_staging.stg_orders ........................... [RUN]
[0m21:34:40.053388 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_items, now model.case_project.stg_orders)
[0m21:34:40.053519 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_orders
[0m21:34:40.054519 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_orders"
[0m21:34:40.055724 [debug] [Thread-1 (]: Began executing node model.case_project.stg_orders
[0m21:34:40.057470 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_orders"
[0m21:34:40.058743 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m21:34:40.058860 [debug] [Thread-1 (]: On model.case_project.stg_orders: BEGIN
[0m21:34:40.058966 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:34:40.059148 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:34:40.059268 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m21:34:40.059400 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */

  
  create view "warehouse"."main_staging"."stg_orders__dbt_tmp" as (
    with src as (
  select * from "warehouse"."main_raw"."raw_orders"
)
select
  cast(id as varchar)                 as order_id,
  cast(customer as varchar)           as customer_id,
  cast(store_id as varchar)           as store_id,
  cast(ordered_at as timestamp)       as ordered_at,
  cast(subtotal as decimal(10,2))            as subtotal,
  cast(tax_paid as decimal(10,2))            as tax_paid,
  cast(order_total as decimal(10,2))         as order_total
from src
  );

[0m21:34:40.059723 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:34:40.060838 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m21:34:40.060967 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */
alter view "warehouse"."main_staging"."stg_orders" rename to "stg_orders__dbt_backup"
[0m21:34:40.061192 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:34:40.062185 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m21:34:40.062305 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */
alter view "warehouse"."main_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m21:34:40.062488 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:34:40.063002 [debug] [Thread-1 (]: On model.case_project.stg_orders: COMMIT
[0m21:34:40.063118 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m21:34:40.063225 [debug] [Thread-1 (]: On model.case_project.stg_orders: COMMIT
[0m21:34:40.065259 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:34:40.066108 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m21:34:40.066227 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */

      drop view if exists "warehouse"."main_staging"."stg_orders__dbt_backup" cascade
    
[0m21:34:40.067807 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:34:40.068233 [debug] [Thread-1 (]: On model.case_project.stg_orders: Close
[0m21:34:40.068443 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1857abd-4334-4b7e-b05e-552d71ae1cca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048aaec0>]}
[0m21:34:40.068667 [info ] [Thread-1 (]: 3 of 10 OK created sql view model main_staging.stg_orders ...................... [[32mOK[0m in 0.02s]
[0m21:34:40.068884 [debug] [Thread-1 (]: Finished running node model.case_project.stg_orders
[0m21:34:40.069029 [debug] [Thread-1 (]: Began running node model.case_project.stg_products
[0m21:34:40.069276 [info ] [Thread-1 (]: 4 of 10 START sql view model main_staging.stg_products ......................... [RUN]
[0m21:34:40.069454 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_orders, now model.case_project.stg_products)
[0m21:34:40.069590 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_products
[0m21:34:40.070586 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_products"
[0m21:34:40.071997 [debug] [Thread-1 (]: Began executing node model.case_project.stg_products
[0m21:34:40.073255 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_products"
[0m21:34:40.074587 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m21:34:40.074704 [debug] [Thread-1 (]: On model.case_project.stg_products: BEGIN
[0m21:34:40.074811 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:34:40.075004 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:34:40.075112 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m21:34:40.075228 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */

  
  create view "warehouse"."main_staging"."stg_products__dbt_tmp" as (
    -- models/staging/stg_products.sql
with src as (select * from "warehouse"."main_raw"."raw_products")
select
  cast(sku as varchar)      as product_id,
  trim(name)                as product_name, 
  cast(price as decimal(10,2))    as price
from src
  );

[0m21:34:40.075495 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:34:40.076554 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m21:34:40.076676 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */
alter view "warehouse"."main_staging"."stg_products" rename to "stg_products__dbt_backup"
[0m21:34:40.076870 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:34:40.078390 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m21:34:40.078511 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */
alter view "warehouse"."main_staging"."stg_products__dbt_tmp" rename to "stg_products"
[0m21:34:40.078694 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:34:40.079165 [debug] [Thread-1 (]: On model.case_project.stg_products: COMMIT
[0m21:34:40.079279 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m21:34:40.079388 [debug] [Thread-1 (]: On model.case_project.stg_products: COMMIT
[0m21:34:40.081176 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:34:40.082062 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m21:34:40.082181 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */

      drop view if exists "warehouse"."main_staging"."stg_products__dbt_backup" cascade
    
[0m21:34:40.083807 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:34:40.084203 [debug] [Thread-1 (]: On model.case_project.stg_products: Close
[0m21:34:40.084409 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1857abd-4334-4b7e-b05e-552d71ae1cca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115595a0>]}
[0m21:34:40.084654 [info ] [Thread-1 (]: 4 of 10 OK created sql view model main_staging.stg_products .................... [[32mOK[0m in 0.01s]
[0m21:34:40.084863 [debug] [Thread-1 (]: Finished running node model.case_project.stg_products
[0m21:34:40.085009 [debug] [Thread-1 (]: Began running node model.case_project.dim_customers
[0m21:34:40.085215 [info ] [Thread-1 (]: 5 of 10 START sql view model main_marts.dim_customers .......................... [RUN]
[0m21:34:40.085408 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_products, now model.case_project.dim_customers)
[0m21:34:40.085543 [debug] [Thread-1 (]: Began compiling node model.case_project.dim_customers
[0m21:34:40.086584 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.dim_customers"
[0m21:34:40.089417 [debug] [Thread-1 (]: Began executing node model.case_project.dim_customers
[0m21:34:40.090676 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.dim_customers"
[0m21:34:40.093400 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m21:34:40.093516 [debug] [Thread-1 (]: On model.case_project.dim_customers: BEGIN
[0m21:34:40.093619 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:34:40.093796 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:34:40.093914 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m21:34:40.094051 [debug] [Thread-1 (]: On model.case_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_customers"} */

  
  create view "warehouse"."main_marts"."dim_customers__dbt_tmp" as (
    with
cust as (
  select
    c.customer_id,
    c.customer_name
  from "warehouse"."main_staging"."stg_customers" as c
),
orders as (
  select
    customer_id,
    cast(ordered_at as date) as order_date,
    order_total
  from "warehouse"."main_staging"."stg_orders"
)
select
  cu.customer_id,
  cu.customer_name,
  min(o.order_date) as first_order_date,
  max(o.order_date) as last_order_date,
  count(*)         as order_count,
  sum(o.order_total) as lifetime_value
from cust cu
left join orders o using (customer_id)
group by 1,2
  );

[0m21:34:40.094498 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:34:40.095487 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m21:34:40.095603 [debug] [Thread-1 (]: On model.case_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_customers"} */
alter table "warehouse"."main_marts"."dim_customers" rename to "dim_customers__dbt_backup"
[0m21:34:40.095788 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:34:40.096737 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m21:34:40.096850 [debug] [Thread-1 (]: On model.case_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_customers"} */
alter view "warehouse"."main_marts"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m21:34:40.097023 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:34:40.097507 [debug] [Thread-1 (]: On model.case_project.dim_customers: COMMIT
[0m21:34:40.097636 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m21:34:40.097753 [debug] [Thread-1 (]: On model.case_project.dim_customers: COMMIT
[0m21:34:40.099750 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:34:40.100560 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m21:34:40.100677 [debug] [Thread-1 (]: On model.case_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_customers"} */

      drop table if exists "warehouse"."main_marts"."dim_customers__dbt_backup" cascade
    
[0m21:34:40.102272 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:34:40.102734 [debug] [Thread-1 (]: On model.case_project.dim_customers: Close
[0m21:34:40.102945 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1857abd-4334-4b7e-b05e-552d71ae1cca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11155b340>]}
[0m21:34:40.103160 [info ] [Thread-1 (]: 5 of 10 OK created sql view model main_marts.dim_customers ..................... [[32mOK[0m in 0.02s]
[0m21:34:40.103362 [debug] [Thread-1 (]: Finished running node model.case_project.dim_customers
[0m21:34:40.103505 [debug] [Thread-1 (]: Began running node model.case_project.fct_orders
[0m21:34:40.103680 [info ] [Thread-1 (]: 6 of 10 START sql view model main_marts.fct_orders ............................. [RUN]
[0m21:34:40.103834 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.dim_customers, now model.case_project.fct_orders)
[0m21:34:40.103967 [debug] [Thread-1 (]: Began compiling node model.case_project.fct_orders
[0m21:34:40.105746 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.fct_orders"
[0m21:34:40.106924 [debug] [Thread-1 (]: Began executing node model.case_project.fct_orders
[0m21:34:40.108103 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.fct_orders"
[0m21:34:40.109246 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m21:34:40.109365 [debug] [Thread-1 (]: On model.case_project.fct_orders: BEGIN
[0m21:34:40.109468 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:34:40.109655 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:34:40.109776 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m21:34:40.109902 [debug] [Thread-1 (]: On model.case_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_orders"} */

  
  create view "warehouse"."main_marts"."fct_orders__dbt_tmp" as (
    select
  o.order_id,
  o.customer_id,
  cast(o.ordered_at as date) as order_date,
  cast(date_trunc('month', o.ordered_at) as date) as order_month,
  o.subtotal,
  o.tax_paid,
  o.order_total
from "warehouse"."main_staging"."stg_orders" as o
  );

[0m21:34:40.110216 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:34:40.111286 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m21:34:40.111401 [debug] [Thread-1 (]: On model.case_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_orders"} */
alter table "warehouse"."main_marts"."fct_orders" rename to "fct_orders__dbt_backup"
[0m21:34:40.111590 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:34:40.112531 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m21:34:40.112645 [debug] [Thread-1 (]: On model.case_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_orders"} */
alter view "warehouse"."main_marts"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m21:34:40.112820 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:34:40.113296 [debug] [Thread-1 (]: On model.case_project.fct_orders: COMMIT
[0m21:34:40.113406 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m21:34:40.113543 [debug] [Thread-1 (]: On model.case_project.fct_orders: COMMIT
[0m21:34:40.115444 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:34:40.116248 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m21:34:40.116364 [debug] [Thread-1 (]: On model.case_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_orders"} */

      drop table if exists "warehouse"."main_marts"."fct_orders__dbt_backup" cascade
    
[0m21:34:40.117943 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:34:40.118314 [debug] [Thread-1 (]: On model.case_project.fct_orders: Close
[0m21:34:40.118509 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1857abd-4334-4b7e-b05e-552d71ae1cca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111231120>]}
[0m21:34:40.118726 [info ] [Thread-1 (]: 6 of 10 OK created sql view model main_marts.fct_orders ........................ [[32mOK[0m in 0.01s]
[0m21:34:40.118929 [debug] [Thread-1 (]: Finished running node model.case_project.fct_orders
[0m21:34:40.119072 [debug] [Thread-1 (]: Began running node model.case_project.fct_order_items
[0m21:34:40.119306 [info ] [Thread-1 (]: 7 of 10 START sql view model main_marts.fct_order_items ........................ [RUN]
[0m21:34:40.119479 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.fct_orders, now model.case_project.fct_order_items)
[0m21:34:40.119612 [debug] [Thread-1 (]: Began compiling node model.case_project.fct_order_items
[0m21:34:40.120745 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.fct_order_items"
[0m21:34:40.122135 [debug] [Thread-1 (]: Began executing node model.case_project.fct_order_items
[0m21:34:40.123398 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.fct_order_items"
[0m21:34:40.124808 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_order_items"
[0m21:34:40.124927 [debug] [Thread-1 (]: On model.case_project.fct_order_items: BEGIN
[0m21:34:40.125033 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:34:40.125228 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:34:40.125346 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_order_items"
[0m21:34:40.125491 [debug] [Thread-1 (]: On model.case_project.fct_order_items: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_order_items"} */

  
  create view "warehouse"."main_marts"."fct_order_items__dbt_tmp" as (
    with
items as (
  select
    i.order_id,
    i.product_id,
    i.quantity
  from "warehouse"."main_staging"."stg_items" as i
),
orders as (
  select
    o.order_id,
    o.customer_id,
    cast(o.ordered_at as date) as order_date,
    cast(date_trunc('month', o.ordered_at) as date) as order_month
  from "warehouse"."main_staging"."stg_orders" as o
),
products as (
  select
    p.product_id,
    p.product_name,
    p.price as unit_price,
    case
      when p.product_id like 'BEV%' then 'drinks'
      when p.product_id like 'JAF%' then 'sandwiches'
      else 'other'
    end as product_category
  from "warehouse"."main_staging"."stg_products" as p
)
select
  o.order_id,
  o.customer_id,
  o.order_date,
  o.order_month,
  pr.product_id,
  pr.product_name,
  pr.product_category,
  coalesce(it.quantity, 1) as quantity,
  pr.unit_price,
  coalesce(it.quantity, 1) * pr.unit_price as line_revenue
from items it
join orders o   using (order_id)
join products pr using (product_id)
  );

[0m21:34:40.126098 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:34:40.127716 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_order_items"
[0m21:34:40.127838 [debug] [Thread-1 (]: On model.case_project.fct_order_items: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_order_items"} */
alter table "warehouse"."main_marts"."fct_order_items" rename to "fct_order_items__dbt_backup"
[0m21:34:40.128025 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:34:40.128987 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_order_items"
[0m21:34:40.129101 [debug] [Thread-1 (]: On model.case_project.fct_order_items: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_order_items"} */
alter view "warehouse"."main_marts"."fct_order_items__dbt_tmp" rename to "fct_order_items"
[0m21:34:40.129280 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:34:40.129746 [debug] [Thread-1 (]: On model.case_project.fct_order_items: COMMIT
[0m21:34:40.129859 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_order_items"
[0m21:34:40.129961 [debug] [Thread-1 (]: On model.case_project.fct_order_items: COMMIT
[0m21:34:40.131910 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:34:40.132729 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_order_items"
[0m21:34:40.132842 [debug] [Thread-1 (]: On model.case_project.fct_order_items: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_order_items"} */

      drop table if exists "warehouse"."main_marts"."fct_order_items__dbt_backup" cascade
    
[0m21:34:40.134540 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:34:40.134980 [debug] [Thread-1 (]: On model.case_project.fct_order_items: Close
[0m21:34:40.135187 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1857abd-4334-4b7e-b05e-552d71ae1cca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115bfbe0>]}
[0m21:34:40.135402 [info ] [Thread-1 (]: 7 of 10 OK created sql view model main_marts.fct_order_items ................... [[32mOK[0m in 0.02s]
[0m21:34:40.135602 [debug] [Thread-1 (]: Finished running node model.case_project.fct_order_items
[0m21:34:40.135742 [debug] [Thread-1 (]: Began running node model.case_project.customer_pareto
[0m21:34:40.135917 [info ] [Thread-1 (]: 8 of 10 START sql view model main_marts.customer_pareto ........................ [RUN]
[0m21:34:40.136070 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.fct_order_items, now model.case_project.customer_pareto)
[0m21:34:40.136198 [debug] [Thread-1 (]: Began compiling node model.case_project.customer_pareto
[0m21:34:40.137173 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.customer_pareto"
[0m21:34:40.139488 [debug] [Thread-1 (]: Began executing node model.case_project.customer_pareto
[0m21:34:40.140694 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.customer_pareto"
[0m21:34:40.142597 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.customer_pareto"
[0m21:34:40.142724 [debug] [Thread-1 (]: On model.case_project.customer_pareto: BEGIN
[0m21:34:40.142828 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:34:40.143027 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:34:40.143145 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.customer_pareto"
[0m21:34:40.143274 [debug] [Thread-1 (]: On model.case_project.customer_pareto: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.customer_pareto"} */

  
  create view "warehouse"."main_marts"."customer_pareto__dbt_tmp" as (
    with ltv as (
  select
    customer_id,
    sum(order_total) as lifetime_value
  from "warehouse"."main_marts"."fct_orders"
  group by 1
),
ranked as (
  select
    customer_id,
    lifetime_value,
    rank() over (order by lifetime_value desc) as rnk,
    count(*) over () as total_customers,
    sum(lifetime_value) over () as total_revenue,
    sum(lifetime_value) over (
      order by lifetime_value desc
      rows between unbounded preceding and current row
    ) as cum_revenue
  from ltv
)
select
  customer_id,
  lifetime_value,
  rnk,
  cast(rnk as double)/total_customers  as customer_pct,
  cum_revenue / nullif(total_revenue,0) as revenue_cum_pct
from ranked
order by rnk
  );

[0m21:34:40.143812 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:34:40.144850 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.customer_pareto"
[0m21:34:40.144967 [debug] [Thread-1 (]: On model.case_project.customer_pareto: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.customer_pareto"} */
alter view "warehouse"."main_marts"."customer_pareto__dbt_tmp" rename to "customer_pareto"
[0m21:34:40.145161 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:34:40.145587 [debug] [Thread-1 (]: On model.case_project.customer_pareto: COMMIT
[0m21:34:40.145702 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.customer_pareto"
[0m21:34:40.145805 [debug] [Thread-1 (]: On model.case_project.customer_pareto: COMMIT
[0m21:34:40.147873 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:34:40.148693 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.customer_pareto"
[0m21:34:40.148811 [debug] [Thread-1 (]: On model.case_project.customer_pareto: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.customer_pareto"} */

      drop view if exists "warehouse"."main_marts"."customer_pareto__dbt_backup" cascade
    
[0m21:34:40.148983 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:34:40.149374 [debug] [Thread-1 (]: On model.case_project.customer_pareto: Close
[0m21:34:40.149567 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1857abd-4334-4b7e-b05e-552d71ae1cca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11156ee30>]}
[0m21:34:40.149776 [info ] [Thread-1 (]: 8 of 10 OK created sql view model main_marts.customer_pareto ................... [[32mOK[0m in 0.01s]
[0m21:34:40.149977 [debug] [Thread-1 (]: Finished running node model.case_project.customer_pareto
[0m21:34:40.150118 [debug] [Thread-1 (]: Began running node model.case_project.orders_fact
[0m21:34:40.150287 [info ] [Thread-1 (]: 9 of 10 START sql view model main_marts.orders_fact ............................ [RUN]
[0m21:34:40.150437 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.customer_pareto, now model.case_project.orders_fact)
[0m21:34:40.150566 [debug] [Thread-1 (]: Began compiling node model.case_project.orders_fact
[0m21:34:40.152079 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.orders_fact"
[0m21:34:40.154172 [debug] [Thread-1 (]: Began executing node model.case_project.orders_fact
[0m21:34:40.155597 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.orders_fact"
[0m21:34:40.158219 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.orders_fact"
[0m21:34:40.158367 [debug] [Thread-1 (]: On model.case_project.orders_fact: BEGIN
[0m21:34:40.158478 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:34:40.158697 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:34:40.158817 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.orders_fact"
[0m21:34:40.158941 [debug] [Thread-1 (]: On model.case_project.orders_fact: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.orders_fact"} */

  
  create view "warehouse"."main_marts"."orders_fact__dbt_tmp" as (
    with
orders as (
  select
    order_id, customer_id, order_date, order_month, order_total as order_revenue
  from "warehouse"."main_marts"."fct_orders"
),
first_order as (
  select customer_id, min(order_date) as first_order_date
  from orders
  group by 1
)
select
  o.order_id,
  o.customer_id,
  o.order_date,
  o.order_month,
  o.order_revenue,
  case when o.order_date = f.first_order_date then true else false end as is_first_order,
  case when o.order_date = f.first_order_date then 'new' else 'repeat' end as customer_cohort
from orders o
join first_order f using (customer_id)
  );

[0m21:34:40.159448 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:34:40.160501 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.orders_fact"
[0m21:34:40.160618 [debug] [Thread-1 (]: On model.case_project.orders_fact: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.orders_fact"} */
alter view "warehouse"."main_marts"."orders_fact__dbt_tmp" rename to "orders_fact"
[0m21:34:40.160808 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:34:40.161234 [debug] [Thread-1 (]: On model.case_project.orders_fact: COMMIT
[0m21:34:40.161348 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.orders_fact"
[0m21:34:40.161451 [debug] [Thread-1 (]: On model.case_project.orders_fact: COMMIT
[0m21:34:40.163329 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:34:40.164150 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.orders_fact"
[0m21:34:40.164264 [debug] [Thread-1 (]: On model.case_project.orders_fact: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.orders_fact"} */

      drop view if exists "warehouse"."main_marts"."orders_fact__dbt_backup" cascade
    
[0m21:34:40.164433 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:34:40.164836 [debug] [Thread-1 (]: On model.case_project.orders_fact: Close
[0m21:34:40.165041 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1857abd-4334-4b7e-b05e-552d71ae1cca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112317b0>]}
[0m21:34:40.165262 [info ] [Thread-1 (]: 9 of 10 OK created sql view model main_marts.orders_fact ....................... [[32mOK[0m in 0.01s]
[0m21:34:40.165461 [debug] [Thread-1 (]: Finished running node model.case_project.orders_fact
[0m21:34:40.165741 [debug] [Thread-1 (]: Began running node model.case_project.monthly_summary
[0m21:34:40.165986 [info ] [Thread-1 (]: 10 of 10 START sql view model main_marts.monthly_summary ....................... [RUN]
[0m21:34:40.166172 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.orders_fact, now model.case_project.monthly_summary)
[0m21:34:40.166317 [debug] [Thread-1 (]: Began compiling node model.case_project.monthly_summary
[0m21:34:40.167429 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.monthly_summary"
[0m21:34:40.169395 [debug] [Thread-1 (]: Began executing node model.case_project.monthly_summary
[0m21:34:40.170623 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.monthly_summary"
[0m21:34:40.172787 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.monthly_summary"
[0m21:34:40.172928 [debug] [Thread-1 (]: On model.case_project.monthly_summary: BEGIN
[0m21:34:40.173039 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:34:40.173282 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:34:40.173404 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.monthly_summary"
[0m21:34:40.173540 [debug] [Thread-1 (]: On model.case_project.monthly_summary: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.monthly_summary"} */

  
  create view "warehouse"."main_marts"."monthly_summary__dbt_tmp" as (
    with base as (
  select
    order_id,
    customer_id,
    order_date,
    order_month,
    order_revenue
  from "warehouse"."main_marts"."orders_fact"
),
labeled as (
  select
    b.*,
    case when order_date = min(order_date) over (partition by customer_id) then 1 else 0 end as is_new_order
  from base b
)
select
  order_month,
  sum(order_revenue) as monthly_revenue,
  count(distinct order_id) as monthly_orders,
  count(distinct customer_id) as active_customers,
  sum(order_revenue)*1.0 / nullif(count(distinct order_id),0) as aov,
  sum(is_new_order) as new_customers,
  (count(distinct customer_id) - sum(is_new_order)) as repeat_customers,
  (count(distinct customer_id) - sum(is_new_order))*1.0
    / nullif(count(distinct customer_id),0) as repeat_purchase_rate
from labeled
group by 1
order by 1
  );

[0m21:34:40.174294 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:34:40.175471 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.monthly_summary"
[0m21:34:40.175593 [debug] [Thread-1 (]: On model.case_project.monthly_summary: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.monthly_summary"} */
alter view "warehouse"."main_marts"."monthly_summary__dbt_tmp" rename to "monthly_summary"
[0m21:34:40.175790 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:34:40.176232 [debug] [Thread-1 (]: On model.case_project.monthly_summary: COMMIT
[0m21:34:40.176347 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.monthly_summary"
[0m21:34:40.176451 [debug] [Thread-1 (]: On model.case_project.monthly_summary: COMMIT
[0m21:34:40.178001 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:34:40.230939 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.monthly_summary"
[0m21:34:40.231196 [debug] [Thread-1 (]: On model.case_project.monthly_summary: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.monthly_summary"} */

      drop view if exists "warehouse"."main_marts"."monthly_summary__dbt_backup" cascade
    
[0m21:34:40.231478 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:34:40.232039 [debug] [Thread-1 (]: On model.case_project.monthly_summary: Close
[0m21:34:40.232289 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1857abd-4334-4b7e-b05e-552d71ae1cca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11162dfc0>]}
[0m21:34:40.232549 [info ] [Thread-1 (]: 10 of 10 OK created sql view model main_marts.monthly_summary .................. [[32mOK[0m in 0.07s]
[0m21:34:40.232777 [debug] [Thread-1 (]: Finished running node model.case_project.monthly_summary
[0m21:34:40.233265 [debug] [MainThread]: Using duckdb connection "master"
[0m21:34:40.233378 [debug] [MainThread]: On master: BEGIN
[0m21:34:40.233467 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:34:40.233659 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:34:40.233755 [debug] [MainThread]: On master: COMMIT
[0m21:34:40.233847 [debug] [MainThread]: Using duckdb connection "master"
[0m21:34:40.233935 [debug] [MainThread]: On master: COMMIT
[0m21:34:40.234068 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:34:40.234165 [debug] [MainThread]: On master: Close
[0m21:34:40.234286 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:34:40.234372 [debug] [MainThread]: Connection 'model.case_project.monthly_summary' was properly closed.
[0m21:34:40.234500 [info ] [MainThread]: 
[0m21:34:40.234624 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m21:34:40.235214 [debug] [MainThread]: Command end result
[0m21:34:40.248972 [debug] [MainThread]: Wrote artifact WritableManifest to /Volumes/The Disk/projects/Case Project main/target/manifest.json
[0m21:34:40.250643 [debug] [MainThread]: Wrote artifact SemanticManifest to /Volumes/The Disk/projects/Case Project main/target/semantic_manifest.json
[0m21:34:40.254450 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Volumes/The Disk/projects/Case Project main/target/run_results.json
[0m21:34:40.254575 [info ] [MainThread]: 
[0m21:34:40.254722 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:34:40.254865 [info ] [MainThread]: 
[0m21:34:40.254996 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m21:34:40.256189 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.83339167, "process_in_blocks": "0", "process_kernel_time": 0.128127, "process_mem_max_rss": "181731328", "process_out_blocks": "0", "process_user_time": 1.618121}
[0m21:34:40.256374 [debug] [MainThread]: Command `dbt run` succeeded at 21:34:40.256339 after 0.83 seconds
[0m21:34:40.256522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106435630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057ae8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cf6a10>]}
[0m21:34:40.256662 [debug] [MainThread]: Flushing usage events
[0m21:34:40.742089 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:07:03.078041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B691CE31F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B693FD7C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B693FD7DF0>]}


============================== 09:07:03.085040 | 02400c30-2fca-4fcd-9803-f36baebaebc1 ==============================
[0m09:07:03.085040 [info ] [MainThread]: Running with dbt=1.10.9
[0m09:07:03.085040 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run --no-partial-parse', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'log_path': 'D:\\projects\\Case Project main\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'D:\\projects\\Case Project main', 'static_parser': 'True', 'write_json': 'True'}
[0m09:07:03.461041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02400c30-2fca-4fcd-9803-f36baebaebc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6940EFCA0>]}
[0m09:07:03.546039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02400c30-2fca-4fcd-9803-f36baebaebc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B693FD5EA0>]}
[0m09:07:03.550041 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m09:07:03.914038 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m09:07:03.916040 [debug] [MainThread]: Partial parsing not enabled
[0m09:07:05.962390 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m09:07:05.963390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '02400c30-2fca-4fcd-9803-f36baebaebc1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B695A24C70>]}
[0m09:07:06.271006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02400c30-2fca-4fcd-9803-f36baebaebc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6957D7490>]}
[0m09:07:06.472575 [debug] [MainThread]: Wrote artifact WritableManifest to D:\projects\Case Project main\target\manifest.json
[0m09:07:06.482283 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\projects\Case Project main\target\semantic_manifest.json
[0m09:07:06.534282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02400c30-2fca-4fcd-9803-f36baebaebc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B69576BD60>]}
[0m09:07:06.535283 [info ] [MainThread]: Found 10 models, 4 seeds, 37 data tests, 4 sources, 429 macros
[0m09:07:06.536284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02400c30-2fca-4fcd-9803-f36baebaebc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6957EEE30>]}
[0m09:07:06.539281 [info ] [MainThread]: 
[0m09:07:06.539281 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:07:06.540284 [info ] [MainThread]: 
[0m09:07:06.541282 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:07:06.549281 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m09:07:06.830965 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m09:07:06.831965 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m09:07:06.831965 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:07:06.865935 [debug] [ThreadPool]: SQL status: OK in 0.033 seconds
[0m09:07:06.867934 [debug] [ThreadPool]: On list_warehouse: Close
[0m09:07:06.871934 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m09:07:06.871934 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m09:07:06.872934 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:07:06.873935 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:07:06.874936 [debug] [ThreadPool]: On list_warehouse: Close
[0m09:07:06.875936 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_staging)
[0m09:07:06.876935 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_staging"
"
[0m09:07:06.884935 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m09:07:06.885935 [debug] [ThreadPool]: On create_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m09:07:06.885935 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:07:06.887966 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m09:07:06.889966 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m09:07:06.889966 [debug] [ThreadPool]: On create_warehouse_main_staging: BEGIN
[0m09:07:06.890966 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:07:06.890966 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m09:07:06.891965 [debug] [ThreadPool]: On create_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_staging"} */

    
    
        create schema if not exists "warehouse"."main_staging"
    
[0m09:07:06.892965 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:07:06.893965 [debug] [ThreadPool]: On create_warehouse_main_staging: COMMIT
[0m09:07:06.894965 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m09:07:06.894965 [debug] [ThreadPool]: On create_warehouse_main_staging: COMMIT
[0m09:07:06.895965 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:07:06.895965 [debug] [ThreadPool]: On create_warehouse_main_staging: Close
[0m09:07:06.896936 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_warehouse_main_staging, now create_warehouse_main_marts)
[0m09:07:06.897934 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_marts"
"
[0m09:07:06.900933 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m09:07:06.901934 [debug] [ThreadPool]: On create_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_marts"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m09:07:06.901934 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:07:06.902965 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:07:06.904935 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m09:07:06.904935 [debug] [ThreadPool]: On create_warehouse_main_marts: BEGIN
[0m09:07:06.905935 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:07:06.906935 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m09:07:06.906935 [debug] [ThreadPool]: On create_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_marts"} */

    
    
        create schema if not exists "warehouse"."main_marts"
    
[0m09:07:06.907935 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:07:06.908935 [debug] [ThreadPool]: On create_warehouse_main_marts: COMMIT
[0m09:07:06.908935 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m09:07:06.909935 [debug] [ThreadPool]: On create_warehouse_main_marts: COMMIT
[0m09:07:06.909935 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:07:06.910934 [debug] [ThreadPool]: On create_warehouse_main_marts: Close
[0m09:07:06.913934 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_staging'
[0m09:07:06.919934 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_staging"
[0m09:07:06.920933 [debug] [ThreadPool]: On list_warehouse_main_staging: BEGIN
[0m09:07:06.921934 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:07:06.921934 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:07:06.922935 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_staging"
[0m09:07:06.922935 [debug] [ThreadPool]: On list_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_staging"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'warehouse'
  
[0m09:07:06.948933 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m09:07:06.950967 [debug] [ThreadPool]: On list_warehouse_main_staging: ROLLBACK
[0m09:07:06.951965 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_staging'
[0m09:07:06.952965 [debug] [ThreadPool]: On list_warehouse_main_staging: Close
[0m09:07:06.953965 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_staging, now list_warehouse_main_marts)
[0m09:07:06.956959 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m09:07:06.957962 [debug] [ThreadPool]: On list_warehouse_main_marts: BEGIN
[0m09:07:06.957962 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:07:06.958965 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:07:06.959935 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m09:07:06.959935 [debug] [ThreadPool]: On list_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_marts"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'warehouse'
  
[0m09:07:06.962934 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m09:07:06.964934 [debug] [ThreadPool]: On list_warehouse_main_marts: ROLLBACK
[0m09:07:06.965935 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_marts'
[0m09:07:06.965935 [debug] [ThreadPool]: On list_warehouse_main_marts: Close
[0m09:07:06.966935 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_marts, now list_warehouse_main_raw)
[0m09:07:06.971935 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m09:07:06.972935 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m09:07:06.972935 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:07:06.973935 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:07:06.973935 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m09:07:06.974936 [debug] [ThreadPool]: On list_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_raw"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'warehouse'
  
[0m09:07:06.977933 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m09:07:06.979935 [debug] [ThreadPool]: On list_warehouse_main_raw: ROLLBACK
[0m09:07:06.979935 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_raw'
[0m09:07:06.980935 [debug] [ThreadPool]: On list_warehouse_main_raw: Close
[0m09:07:06.982936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02400c30-2fca-4fcd-9803-f36baebaebc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B69462CF40>]}
[0m09:07:06.982936 [debug] [MainThread]: Using duckdb connection "master"
[0m09:07:06.983965 [debug] [MainThread]: On master: BEGIN
[0m09:07:06.983965 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:07:06.984965 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:07:06.985936 [debug] [MainThread]: On master: COMMIT
[0m09:07:06.985936 [debug] [MainThread]: Using duckdb connection "master"
[0m09:07:06.986937 [debug] [MainThread]: On master: COMMIT
[0m09:07:06.986937 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:07:06.987966 [debug] [MainThread]: On master: Close
[0m09:07:06.992950 [debug] [Thread-1 (]: Began running node model.case_project.stg_customers
[0m09:07:06.993960 [info ] [Thread-1 (]: 1 of 10 START sql view model main_staging.stg_customers ........................ [RUN]
[0m09:07:06.994936 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.case_project.stg_customers'
[0m09:07:06.994936 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_customers
[0m09:07:07.004934 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_customers"
[0m09:07:07.009934 [debug] [Thread-1 (]: Began executing node model.case_project.stg_customers
[0m09:07:07.047933 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_customers"
[0m09:07:07.052401 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m09:07:07.053404 [debug] [Thread-1 (]: On model.case_project.stg_customers: BEGIN
[0m09:07:07.054405 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:07:07.055405 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:07:07.055405 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m09:07:07.056405 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */

  
  create view "warehouse"."main_staging"."stg_customers__dbt_tmp" as (
    -- models/staging/stg_customers.sql
with src as (select * from "warehouse"."main_raw"."raw_customers")
select
  cast(id as varchar) as customer_id,
  trim(name) as customer_name
from src
  );

[0m09:07:07.057403 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:07:07.065402 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m09:07:07.066401 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */
alter view "warehouse"."main_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m09:07:07.068401 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:07:07.072399 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m09:07:07.072399 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */
alter view "warehouse"."main_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m09:07:07.073400 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:07:07.087404 [debug] [Thread-1 (]: On model.case_project.stg_customers: COMMIT
[0m09:07:07.088405 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m09:07:07.088405 [debug] [Thread-1 (]: On model.case_project.stg_customers: COMMIT
[0m09:07:07.095401 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:07:07.102404 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m09:07:07.103405 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */

      drop view if exists "warehouse"."main_staging"."stg_customers__dbt_backup" cascade
    
[0m09:07:07.106431 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:07:07.109404 [debug] [Thread-1 (]: On model.case_project.stg_customers: Close
[0m09:07:07.112402 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02400c30-2fca-4fcd-9803-f36baebaebc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6941BD450>]}
[0m09:07:07.113405 [info ] [Thread-1 (]: 1 of 10 OK created sql view model main_staging.stg_customers ................... [[32mOK[0m in 0.12s]
[0m09:07:07.114405 [debug] [Thread-1 (]: Finished running node model.case_project.stg_customers
[0m09:07:07.114405 [debug] [Thread-1 (]: Began running node model.case_project.stg_items
[0m09:07:07.115405 [info ] [Thread-1 (]: 2 of 10 START sql view model main_staging.stg_items ............................ [RUN]
[0m09:07:07.116431 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_customers, now model.case_project.stg_items)
[0m09:07:07.117405 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_items
[0m09:07:07.120404 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_items"
[0m09:07:07.125404 [debug] [Thread-1 (]: Began executing node model.case_project.stg_items
[0m09:07:07.130402 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_items"
[0m09:07:07.135402 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m09:07:07.136403 [debug] [Thread-1 (]: On model.case_project.stg_items: BEGIN
[0m09:07:07.136403 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:07:07.137403 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:07:07.138401 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m09:07:07.138401 [debug] [Thread-1 (]: On model.case_project.stg_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_items"} */

  
  create view "warehouse"."main_staging"."stg_items__dbt_tmp" as (
    with src as (
  select * from "warehouse"."main_raw"."raw_items"
)
select
  cast(order_id as varchar) as order_id,  -- FK to orders
  cast(sku      as varchar) as product_id, 
  1                           as quantity  -- Assumption: one row = one item
from src
  );

[0m09:07:07.139402 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:07:07.144400 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m09:07:07.144400 [debug] [Thread-1 (]: On model.case_project.stg_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_items"} */
alter view "warehouse"."main_staging"."stg_items" rename to "stg_items__dbt_backup"
[0m09:07:07.145404 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:07:07.151400 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m09:07:07.152401 [debug] [Thread-1 (]: On model.case_project.stg_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_items"} */
alter view "warehouse"."main_staging"."stg_items__dbt_tmp" rename to "stg_items"
[0m09:07:07.153401 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:07:07.155401 [debug] [Thread-1 (]: On model.case_project.stg_items: COMMIT
[0m09:07:07.156401 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m09:07:07.156401 [debug] [Thread-1 (]: On model.case_project.stg_items: COMMIT
[0m09:07:07.158400 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:07:07.162401 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m09:07:07.163399 [debug] [Thread-1 (]: On model.case_project.stg_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_items"} */

      drop view if exists "warehouse"."main_staging"."stg_items__dbt_backup" cascade
    
[0m09:07:07.165400 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:07:07.167404 [debug] [Thread-1 (]: On model.case_project.stg_items: Close
[0m09:07:07.168405 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02400c30-2fca-4fcd-9803-f36baebaebc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B691B959C0>]}
[0m09:07:07.169404 [info ] [Thread-1 (]: 2 of 10 OK created sql view model main_staging.stg_items ....................... [[32mOK[0m in 0.05s]
[0m09:07:07.170405 [debug] [Thread-1 (]: Finished running node model.case_project.stg_items
[0m09:07:07.170405 [debug] [Thread-1 (]: Began running node model.case_project.stg_orders
[0m09:07:07.171405 [info ] [Thread-1 (]: 3 of 10 START sql view model main_staging.stg_orders ........................... [RUN]
[0m09:07:07.172404 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_items, now model.case_project.stg_orders)
[0m09:07:07.172404 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_orders
[0m09:07:07.177405 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_orders"
[0m09:07:07.181401 [debug] [Thread-1 (]: Began executing node model.case_project.stg_orders
[0m09:07:07.187404 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_orders"
[0m09:07:07.192401 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m09:07:07.193403 [debug] [Thread-1 (]: On model.case_project.stg_orders: BEGIN
[0m09:07:07.193403 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:07:07.194404 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:07:07.195402 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m09:07:07.195402 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */

  
  create view "warehouse"."main_staging"."stg_orders__dbt_tmp" as (
    with src as (
  select * from "warehouse"."main_raw"."raw_orders"
)
select
  cast(id as varchar)                 as order_id,
  cast(customer as varchar)           as customer_id,
  cast(store_id as varchar)           as store_id,
  cast(ordered_at as timestamp)       as ordered_at,
  cast(subtotal as decimal(10,2))            as subtotal,
  cast(tax_paid as decimal(10,2))            as tax_paid,
  cast(order_total as decimal(10,2))         as order_total
from src
  );

[0m09:07:07.197403 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:07:07.201401 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m09:07:07.202403 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */
alter view "warehouse"."main_staging"."stg_orders" rename to "stg_orders__dbt_backup"
[0m09:07:07.203401 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:07:07.206399 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m09:07:07.207399 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */
alter view "warehouse"."main_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m09:07:07.208403 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:07:07.211400 [debug] [Thread-1 (]: On model.case_project.stg_orders: COMMIT
[0m09:07:07.211400 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m09:07:07.212401 [debug] [Thread-1 (]: On model.case_project.stg_orders: COMMIT
[0m09:07:07.214400 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:07:07.218401 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m09:07:07.219402 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */

      drop view if exists "warehouse"."main_staging"."stg_orders__dbt_backup" cascade
    
[0m09:07:07.220886 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:07:07.222924 [debug] [Thread-1 (]: On model.case_project.stg_orders: Close
[0m09:07:07.223893 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02400c30-2fca-4fcd-9803-f36baebaebc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B695AA5540>]}
[0m09:07:07.224923 [info ] [Thread-1 (]: 3 of 10 OK created sql view model main_staging.stg_orders ...................... [[32mOK[0m in 0.05s]
[0m09:07:07.225895 [debug] [Thread-1 (]: Finished running node model.case_project.stg_orders
[0m09:07:07.226893 [debug] [Thread-1 (]: Began running node model.case_project.stg_products
[0m09:07:07.227922 [info ] [Thread-1 (]: 4 of 10 START sql view model main_staging.stg_products ......................... [RUN]
[0m09:07:07.228894 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_orders, now model.case_project.stg_products)
[0m09:07:07.228894 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_products
[0m09:07:07.233922 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_products"
[0m09:07:07.237922 [debug] [Thread-1 (]: Began executing node model.case_project.stg_products
[0m09:07:07.243896 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_products"
[0m09:07:07.248893 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m09:07:07.248893 [debug] [Thread-1 (]: On model.case_project.stg_products: BEGIN
[0m09:07:07.249893 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:07:07.250923 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:07:07.251893 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m09:07:07.251893 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */

  
  create view "warehouse"."main_staging"."stg_products__dbt_tmp" as (
    -- models/staging/stg_products.sql
with src as (select * from "warehouse"."main_raw"."raw_products")
select
  cast(sku as varchar)      as product_id,
  trim(name)                as product_name, 
  cast(price as decimal(10,2))    as price
from src
  );

[0m09:07:07.252922 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:07:07.257895 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m09:07:07.257895 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */
alter view "warehouse"."main_staging"."stg_products" rename to "stg_products__dbt_backup"
[0m09:07:07.259896 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:07:07.263895 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m09:07:07.264894 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */
alter view "warehouse"."main_staging"."stg_products__dbt_tmp" rename to "stg_products"
[0m09:07:07.265893 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:07:07.267893 [debug] [Thread-1 (]: On model.case_project.stg_products: COMMIT
[0m09:07:07.267893 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m09:07:07.268893 [debug] [Thread-1 (]: On model.case_project.stg_products: COMMIT
[0m09:07:07.270892 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:07:07.274891 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m09:07:07.274891 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */

      drop view if exists "warehouse"."main_staging"."stg_products__dbt_backup" cascade
    
[0m09:07:07.276891 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:07:07.278891 [debug] [Thread-1 (]: On model.case_project.stg_products: Close
[0m09:07:07.279892 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02400c30-2fca-4fcd-9803-f36baebaebc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B695AA5540>]}
[0m09:07:07.280892 [info ] [Thread-1 (]: 4 of 10 OK created sql view model main_staging.stg_products .................... [[32mOK[0m in 0.05s]
[0m09:07:07.281893 [debug] [Thread-1 (]: Finished running node model.case_project.stg_products
[0m09:07:07.281893 [debug] [Thread-1 (]: Began running node model.case_project.dim_customers
[0m09:07:07.282891 [info ] [Thread-1 (]: 5 of 10 START sql view model main_marts.dim_customers .......................... [RUN]
[0m09:07:07.283891 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_products, now model.case_project.dim_customers)
[0m09:07:07.284892 [debug] [Thread-1 (]: Began compiling node model.case_project.dim_customers
[0m09:07:07.288896 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.dim_customers"
[0m09:07:07.292895 [debug] [Thread-1 (]: Began executing node model.case_project.dim_customers
[0m09:07:07.297896 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.dim_customers"
[0m09:07:07.302821 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m09:07:07.303821 [debug] [Thread-1 (]: On model.case_project.dim_customers: BEGIN
[0m09:07:07.304790 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:07:07.304790 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:07:07.305791 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m09:07:07.306790 [debug] [Thread-1 (]: On model.case_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_customers"} */

  
  create view "warehouse"."main_marts"."dim_customers__dbt_tmp" as (
    -- models/marts/dim_customers.sql
with
cust as (
  select
    c.customer_id,
    c.customer_name
  from "warehouse"."main_staging"."stg_customers" as c
),
orders as (
  select
    customer_id,
    cast(ordered_at as date) as order_date,
    order_total
  from "warehouse"."main_staging"."stg_orders"
)
select
  cu.customer_id,
  cu.customer_name,
  min(o.order_date) as first_order_date,
  max(o.order_date) as last_order_date,
  count(*)         as order_count,
  sum(o.order_total) as lifetime_value
from cust cu
left join orders o using (customer_id)
group by 1,2
  );

[0m09:07:07.308789 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:07:07.314789 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m09:07:07.314789 [debug] [Thread-1 (]: On model.case_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_customers"} */
alter view "warehouse"."main_marts"."dim_customers" rename to "dim_customers__dbt_backup"
[0m09:07:07.315790 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:07:07.319792 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m09:07:07.320794 [debug] [Thread-1 (]: On model.case_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_customers"} */
alter view "warehouse"."main_marts"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m09:07:07.321790 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:07:07.323791 [debug] [Thread-1 (]: On model.case_project.dim_customers: COMMIT
[0m09:07:07.324789 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m09:07:07.324789 [debug] [Thread-1 (]: On model.case_project.dim_customers: COMMIT
[0m09:07:07.326792 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:07:07.330790 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m09:07:07.330790 [debug] [Thread-1 (]: On model.case_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_customers"} */

      drop view if exists "warehouse"."main_marts"."dim_customers__dbt_backup" cascade
    
[0m09:07:07.332790 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:07:07.334790 [debug] [Thread-1 (]: On model.case_project.dim_customers: Close
[0m09:07:07.335790 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02400c30-2fca-4fcd-9803-f36baebaebc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B695E67FA0>]}
[0m09:07:07.336821 [info ] [Thread-1 (]: 5 of 10 OK created sql view model main_marts.dim_customers ..................... [[32mOK[0m in 0.05s]
[0m09:07:07.337793 [debug] [Thread-1 (]: Finished running node model.case_project.dim_customers
[0m09:07:07.338821 [debug] [Thread-1 (]: Began running node model.case_project.fct_orders
[0m09:07:07.339793 [info ] [Thread-1 (]: 6 of 10 START sql view model main_marts.fct_orders ............................. [RUN]
[0m09:07:07.339793 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.dim_customers, now model.case_project.fct_orders)
[0m09:07:07.340821 [debug] [Thread-1 (]: Began compiling node model.case_project.fct_orders
[0m09:07:07.344821 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.fct_orders"
[0m09:07:07.347821 [debug] [Thread-1 (]: Began executing node model.case_project.fct_orders
[0m09:07:07.353792 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.fct_orders"
[0m09:07:07.358790 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m09:07:07.358790 [debug] [Thread-1 (]: On model.case_project.fct_orders: BEGIN
[0m09:07:07.359821 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:07:07.360790 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:07:07.360790 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m09:07:07.361793 [debug] [Thread-1 (]: On model.case_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_orders"} */

  
  create view "warehouse"."main_marts"."fct_orders__dbt_tmp" as (
    -- models/marts/fct_orders.sql
select
  o.order_id,
  o.customer_id,
  cast(o.ordered_at as date)                              as order_date,
  -- Export a clean month anchor as text: 'YYYY-MM-01'
  strftime(date_trunc('month', o.ordered_at), '%Y-%m-01') as order_month,
  o.subtotal,
  o.tax_paid,
  o.order_total
from "warehouse"."main_staging"."stg_orders" as o
  );

[0m09:07:07.362791 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:07:07.366789 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m09:07:07.367791 [debug] [Thread-1 (]: On model.case_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_orders"} */
alter view "warehouse"."main_marts"."fct_orders" rename to "fct_orders__dbt_backup"
[0m09:07:07.368793 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:07:07.372791 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m09:07:07.373823 [debug] [Thread-1 (]: On model.case_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_orders"} */
alter view "warehouse"."main_marts"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m09:07:07.374822 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:07:07.376790 [debug] [Thread-1 (]: On model.case_project.fct_orders: COMMIT
[0m09:07:07.377789 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m09:07:07.377789 [debug] [Thread-1 (]: On model.case_project.fct_orders: COMMIT
[0m09:07:07.379792 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:07:07.384791 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m09:07:07.385789 [debug] [Thread-1 (]: On model.case_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_orders"} */

      drop view if exists "warehouse"."main_marts"."fct_orders__dbt_backup" cascade
    
[0m09:07:07.387792 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:07:07.388790 [debug] [Thread-1 (]: On model.case_project.fct_orders: Close
[0m09:07:07.389790 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02400c30-2fca-4fcd-9803-f36baebaebc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B695E4FEB0>]}
[0m09:07:07.390790 [info ] [Thread-1 (]: 6 of 10 OK created sql view model main_marts.fct_orders ........................ [[32mOK[0m in 0.05s]
[0m09:07:07.391792 [debug] [Thread-1 (]: Finished running node model.case_project.fct_orders
[0m09:07:07.392791 [debug] [Thread-1 (]: Began running node model.case_project.fct_order_items
[0m09:07:07.393790 [info ] [Thread-1 (]: 7 of 10 START sql view model main_marts.fct_order_items ........................ [RUN]
[0m09:07:07.394792 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.fct_orders, now model.case_project.fct_order_items)
[0m09:07:07.394792 [debug] [Thread-1 (]: Began compiling node model.case_project.fct_order_items
[0m09:07:07.398791 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.fct_order_items"
[0m09:07:07.403790 [debug] [Thread-1 (]: Began executing node model.case_project.fct_order_items
[0m09:07:07.408789 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.fct_order_items"
[0m09:07:07.413789 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_order_items"
[0m09:07:07.414791 [debug] [Thread-1 (]: On model.case_project.fct_order_items: BEGIN
[0m09:07:07.414791 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:07:07.415790 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:07:07.416793 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_order_items"
[0m09:07:07.417791 [debug] [Thread-1 (]: On model.case_project.fct_order_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_order_items"} */

  
  create view "warehouse"."main_marts"."fct_order_items__dbt_tmp" as (
    -- models/marts/fct_order_items.sql
with
items as (
  select
    i.order_id,
    i.product_id,
    i.quantity
  from "warehouse"."main_staging"."stg_items" as i
),
orders as (
  select
    o.order_id,
    o.customer_id,
    cast(o.ordered_at as date) as order_date,
    cast(date_trunc('month', o.ordered_at) as date) as order_month
  from "warehouse"."main_staging"."stg_orders" as o
),
products as (
  select
    p.product_id,
    p.product_name,
    p.price as unit_price,
    case
      when p.product_id like 'BEV%' then 'drinks'
      when p.product_id like 'JAF%' then 'sandwiches'
      else 'other'
    end as product_category
  from "warehouse"."main_staging"."stg_products" as p
)
select
  o.order_id,
  o.customer_id,
  o.order_date,
  o.order_month,
  pr.product_id,
  pr.product_name,
  pr.product_category,
  coalesce(it.quantity, 1) as quantity,
  pr.unit_price,
  coalesce(it.quantity, 1) * pr.unit_price as line_revenue
from items it
join orders o   using (order_id)
join products pr using (product_id)
  );

[0m09:07:07.419792 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:07:07.423791 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_order_items"
[0m09:07:07.424791 [debug] [Thread-1 (]: On model.case_project.fct_order_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_order_items"} */
alter view "warehouse"."main_marts"."fct_order_items" rename to "fct_order_items__dbt_backup"
[0m09:07:07.425790 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:07:07.429791 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_order_items"
[0m09:07:07.429791 [debug] [Thread-1 (]: On model.case_project.fct_order_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_order_items"} */
alter view "warehouse"."main_marts"."fct_order_items__dbt_tmp" rename to "fct_order_items"
[0m09:07:07.430791 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:07:07.433790 [debug] [Thread-1 (]: On model.case_project.fct_order_items: COMMIT
[0m09:07:07.434793 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_order_items"
[0m09:07:07.434793 [debug] [Thread-1 (]: On model.case_project.fct_order_items: COMMIT
[0m09:07:07.436793 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:07:07.440789 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_order_items"
[0m09:07:07.440789 [debug] [Thread-1 (]: On model.case_project.fct_order_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_order_items"} */

      drop view if exists "warehouse"."main_marts"."fct_order_items__dbt_backup" cascade
    
[0m09:07:07.442791 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:07:07.444791 [debug] [Thread-1 (]: On model.case_project.fct_order_items: Close
[0m09:07:07.445792 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02400c30-2fca-4fcd-9803-f36baebaebc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B694066BF0>]}
[0m09:07:07.446821 [info ] [Thread-1 (]: 7 of 10 OK created sql view model main_marts.fct_order_items ................... [[32mOK[0m in 0.05s]
[0m09:07:07.447791 [debug] [Thread-1 (]: Finished running node model.case_project.fct_order_items
[0m09:07:07.447791 [debug] [Thread-1 (]: Began running node model.case_project.customer_pareto
[0m09:07:07.448791 [info ] [Thread-1 (]: 8 of 10 START sql view model main_marts.customer_pareto ........................ [RUN]
[0m09:07:07.449791 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.fct_order_items, now model.case_project.customer_pareto)
[0m09:07:07.450790 [debug] [Thread-1 (]: Began compiling node model.case_project.customer_pareto
[0m09:07:07.453790 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.customer_pareto"
[0m09:07:07.457789 [debug] [Thread-1 (]: Began executing node model.case_project.customer_pareto
[0m09:07:07.464793 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.customer_pareto"
[0m09:07:07.468791 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.customer_pareto"
[0m09:07:07.469791 [debug] [Thread-1 (]: On model.case_project.customer_pareto: BEGIN
[0m09:07:07.470792 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:07:07.471791 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:07:07.471791 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.customer_pareto"
[0m09:07:07.472791 [debug] [Thread-1 (]: On model.case_project.customer_pareto: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.customer_pareto"} */

  
  create view "warehouse"."main_marts"."customer_pareto__dbt_tmp" as (
    -- models/marts/customer_pareto.sql
with ltv as (
  select
    customer_id,
    sum(order_total) as lifetime_value
  from "warehouse"."main_marts"."fct_orders"
  group by 1
),
ranked as (
  select
    customer_id,
    lifetime_value,
    rank() over (order by lifetime_value desc) as rnk,
    count(*) over () as total_customers,
    sum(lifetime_value) over () as total_revenue,
    sum(lifetime_value) over (
      order by lifetime_value desc
      rows between unbounded preceding and current row
    ) as cum_revenue
  from ltv
)
select
  customer_id,
  lifetime_value,
  rnk,
  cast(rnk as double)/total_customers  as customer_pct,
  cum_revenue / nullif(total_revenue,0) as revenue_cum_pct
from ranked
order by rnk
  );

[0m09:07:07.475796 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:07:07.480793 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.customer_pareto"
[0m09:07:07.480793 [debug] [Thread-1 (]: On model.case_project.customer_pareto: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.customer_pareto"} */
alter view "warehouse"."main_marts"."customer_pareto" rename to "customer_pareto__dbt_backup"
[0m09:07:07.481793 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:07:07.485793 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.customer_pareto"
[0m09:07:07.486794 [debug] [Thread-1 (]: On model.case_project.customer_pareto: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.customer_pareto"} */
alter view "warehouse"."main_marts"."customer_pareto__dbt_tmp" rename to "customer_pareto"
[0m09:07:07.487792 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:07:07.489792 [debug] [Thread-1 (]: On model.case_project.customer_pareto: COMMIT
[0m09:07:07.490791 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.customer_pareto"
[0m09:07:07.491791 [debug] [Thread-1 (]: On model.case_project.customer_pareto: COMMIT
[0m09:07:07.493791 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:07:07.497792 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.customer_pareto"
[0m09:07:07.497792 [debug] [Thread-1 (]: On model.case_project.customer_pareto: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.customer_pareto"} */

      drop view if exists "warehouse"."main_marts"."customer_pareto__dbt_backup" cascade
    
[0m09:07:07.499792 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:07:07.501791 [debug] [Thread-1 (]: On model.case_project.customer_pareto: Close
[0m09:07:07.502792 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02400c30-2fca-4fcd-9803-f36baebaebc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B694066BF0>]}
[0m09:07:07.502792 [info ] [Thread-1 (]: 8 of 10 OK created sql view model main_marts.customer_pareto ................... [[32mOK[0m in 0.05s]
[0m09:07:07.503792 [debug] [Thread-1 (]: Finished running node model.case_project.customer_pareto
[0m09:07:07.504793 [debug] [Thread-1 (]: Began running node model.case_project.orders_fact
[0m09:07:07.505792 [info ] [Thread-1 (]: 9 of 10 START sql view model main_marts.orders_fact ............................ [RUN]
[0m09:07:07.506792 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.customer_pareto, now model.case_project.orders_fact)
[0m09:07:07.506792 [debug] [Thread-1 (]: Began compiling node model.case_project.orders_fact
[0m09:07:07.510792 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.orders_fact"
[0m09:07:07.514823 [debug] [Thread-1 (]: Began executing node model.case_project.orders_fact
[0m09:07:07.519795 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.orders_fact"
[0m09:07:07.524792 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.orders_fact"
[0m09:07:07.525796 [debug] [Thread-1 (]: On model.case_project.orders_fact: BEGIN
[0m09:07:07.526796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:07:07.527796 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:07:07.527796 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.orders_fact"
[0m09:07:07.528796 [debug] [Thread-1 (]: On model.case_project.orders_fact: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.orders_fact"} */

  
  create view "warehouse"."main_marts"."orders_fact__dbt_tmp" as (
    with
orders as (
  select
    order_id, customer_id, order_date, order_month, order_total as order_revenue
  from "warehouse"."main_marts"."fct_orders"
),
first_order as (
  select customer_id, min(order_date) as first_order_date
  from orders
  group by 1
)
select
  o.order_id,
  o.customer_id,
  o.order_date,
  o.order_month,
  o.order_revenue,
  case when o.order_date = f.first_order_date then true else false end as is_first_order,
  case when o.order_date = f.first_order_date then 'new' else 'repeat' end as customer_cohort
from orders o
join first_order f using (customer_id)
  );

[0m09:07:07.529796 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:07:07.533795 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.orders_fact"
[0m09:07:07.534795 [debug] [Thread-1 (]: On model.case_project.orders_fact: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.orders_fact"} */
alter view "warehouse"."main_marts"."orders_fact" rename to "orders_fact__dbt_backup"
[0m09:07:07.535795 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:07:07.540825 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.orders_fact"
[0m09:07:07.541823 [debug] [Thread-1 (]: On model.case_project.orders_fact: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.orders_fact"} */
alter view "warehouse"."main_marts"."orders_fact__dbt_tmp" rename to "orders_fact"
[0m09:07:07.542793 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:07:07.544792 [debug] [Thread-1 (]: On model.case_project.orders_fact: COMMIT
[0m09:07:07.545792 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.orders_fact"
[0m09:07:07.545792 [debug] [Thread-1 (]: On model.case_project.orders_fact: COMMIT
[0m09:07:07.547793 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:07:07.551793 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.orders_fact"
[0m09:07:07.552792 [debug] [Thread-1 (]: On model.case_project.orders_fact: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.orders_fact"} */

      drop view if exists "warehouse"."main_marts"."orders_fact__dbt_backup" cascade
    
[0m09:07:07.554792 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:07:07.555793 [debug] [Thread-1 (]: On model.case_project.orders_fact: Close
[0m09:07:07.556793 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02400c30-2fca-4fcd-9803-f36baebaebc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B694066BF0>]}
[0m09:07:07.557792 [info ] [Thread-1 (]: 9 of 10 OK created sql view model main_marts.orders_fact ....................... [[32mOK[0m in 0.05s]
[0m09:07:07.558795 [debug] [Thread-1 (]: Finished running node model.case_project.orders_fact
[0m09:07:07.559796 [debug] [Thread-1 (]: Began running node model.case_project.monthly_summary
[0m09:07:07.560795 [info ] [Thread-1 (]: 10 of 10 START sql view model main_marts.monthly_summary ....................... [RUN]
[0m09:07:07.561796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.orders_fact, now model.case_project.monthly_summary)
[0m09:07:07.561796 [debug] [Thread-1 (]: Began compiling node model.case_project.monthly_summary
[0m09:07:07.565795 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.monthly_summary"
[0m09:07:07.569794 [debug] [Thread-1 (]: Began executing node model.case_project.monthly_summary
[0m09:07:07.574796 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.monthly_summary"
[0m09:07:07.579796 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.monthly_summary"
[0m09:07:07.580796 [debug] [Thread-1 (]: On model.case_project.monthly_summary: BEGIN
[0m09:07:07.580796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:07:07.581796 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:07:07.582792 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.monthly_summary"
[0m09:07:07.582792 [debug] [Thread-1 (]: On model.case_project.monthly_summary: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.monthly_summary"} */

  
  create view "warehouse"."main_marts"."monthly_summary__dbt_tmp" as (
    -- models/marts/monthly_summary.sql
with base as (
  select
    order_id,
    customer_id,
    order_date,
    order_month,          -- now 'YYYY-MM-01' text from orders_fact
    order_revenue
  from "warehouse"."main_marts"."orders_fact"
),
labeled as (
  select
    b.*,
    case when order_date = min(order_date) over (partition by customer_id) then 1 else 0 end as is_new_order
  from base b
)
select
  order_month,
  sum(order_revenue)                                  as monthly_revenue,
  count(distinct order_id)                            as monthly_orders,
  count(distinct customer_id)                         as active_customers,
  sum(order_revenue)*1.0 / nullif(count(distinct order_id),0) as aov,
  sum(is_new_order)                                   as new_customers,
  (count(distinct customer_id) - sum(is_new_order))   as repeat_customers,
  (count(distinct customer_id) - sum(is_new_order))*1.0
    / nullif(count(distinct customer_id),0)           as repeat_purchase_rate
from labeled
group by 1
order by 1
  );

[0m09:07:07.585796 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:07:07.589792 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.monthly_summary"
[0m09:07:07.590796 [debug] [Thread-1 (]: On model.case_project.monthly_summary: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.monthly_summary"} */
alter view "warehouse"."main_marts"."monthly_summary" rename to "monthly_summary__dbt_backup"
[0m09:07:07.590796 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:07:07.595799 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.monthly_summary"
[0m09:07:07.599794 [debug] [Thread-1 (]: On model.case_project.monthly_summary: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.monthly_summary"} */
alter view "warehouse"."main_marts"."monthly_summary__dbt_tmp" rename to "monthly_summary"
[0m09:07:07.601794 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:07:07.605792 [debug] [Thread-1 (]: On model.case_project.monthly_summary: COMMIT
[0m09:07:07.606795 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.monthly_summary"
[0m09:07:07.607795 [debug] [Thread-1 (]: On model.case_project.monthly_summary: COMMIT
[0m09:07:07.609793 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:07:07.615792 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.monthly_summary"
[0m09:07:07.616793 [debug] [Thread-1 (]: On model.case_project.monthly_summary: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.monthly_summary"} */

      drop view if exists "warehouse"."main_marts"."monthly_summary__dbt_backup" cascade
    
[0m09:07:07.619793 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:07:07.621793 [debug] [Thread-1 (]: On model.case_project.monthly_summary: Close
[0m09:07:07.622793 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02400c30-2fca-4fcd-9803-f36baebaebc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B69425A110>]}
[0m09:07:07.623793 [info ] [Thread-1 (]: 10 of 10 OK created sql view model main_marts.monthly_summary .................. [[32mOK[0m in 0.06s]
[0m09:07:07.624793 [debug] [Thread-1 (]: Finished running node model.case_project.monthly_summary
[0m09:07:07.626793 [debug] [MainThread]: Using duckdb connection "master"
[0m09:07:07.627797 [debug] [MainThread]: On master: BEGIN
[0m09:07:07.628793 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:07:07.629796 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:07:07.630794 [debug] [MainThread]: On master: COMMIT
[0m09:07:07.631793 [debug] [MainThread]: Using duckdb connection "master"
[0m09:07:07.631793 [debug] [MainThread]: On master: COMMIT
[0m09:07:07.632796 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:07:07.633796 [debug] [MainThread]: On master: Close
[0m09:07:07.633796 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:07:07.634796 [debug] [MainThread]: Connection 'create_warehouse_main_marts' was properly closed.
[0m09:07:07.634796 [debug] [MainThread]: Connection 'list_warehouse_main_raw' was properly closed.
[0m09:07:07.635796 [debug] [MainThread]: Connection 'model.case_project.monthly_summary' was properly closed.
[0m09:07:07.635796 [info ] [MainThread]: 
[0m09:07:07.636796 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 1.09 seconds (1.09s).
[0m09:07:07.639792 [debug] [MainThread]: Command end result
[0m09:07:07.728791 [debug] [MainThread]: Wrote artifact WritableManifest to D:\projects\Case Project main\target\manifest.json
[0m09:07:07.736790 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\projects\Case Project main\target\semantic_manifest.json
[0m09:07:07.749792 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\projects\Case Project main\target\run_results.json
[0m09:07:07.750794 [info ] [MainThread]: 
[0m09:07:07.750794 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:07:07.751792 [info ] [MainThread]: 
[0m09:07:07.752793 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m09:07:07.752793 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 4 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m09:07:07.754793 [debug] [MainThread]: Command `dbt run` succeeded at 09:07:07.753793 after 4.79 seconds
[0m09:07:07.754793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B691CE31F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B69201A230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B695879720>]}
[0m09:07:07.755793 [debug] [MainThread]: Flushing usage events
[0m09:07:08.554685 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:12:26.215805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210A1E631C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210A4153D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210A4153EB0>]}


============================== 09:12:26.226111 | e051d9e9-1d7a-4327-84f6-53f62c0778da ==============================
[0m09:12:26.226111 [info ] [MainThread]: Running with dbt=1.10.9
[0m09:12:26.227121 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'D:\\projects\\Case Project main', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'log_path': 'D:\\projects\\Case Project main\\logs', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m09:12:26.507495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e051d9e9-1d7a-4327-84f6-53f62c0778da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210A38B4DF0>]}
[0m09:12:26.584498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e051d9e9-1d7a-4327-84f6-53f62c0778da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210A4152020>]}
[0m09:12:26.588461 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m09:12:26.930357 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m09:12:27.231587 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:12:27.232589 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:12:27.324589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e051d9e9-1d7a-4327-84f6-53f62c0778da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210A57FC130>]}
[0m09:12:27.570383 [debug] [MainThread]: Wrote artifact WritableManifest to D:\projects\Case Project main\target\manifest.json
[0m09:12:27.578072 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\projects\Case Project main\target\semantic_manifest.json
[0m09:12:27.621861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e051d9e9-1d7a-4327-84f6-53f62c0778da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210A43D6140>]}
[0m09:12:27.621861 [info ] [MainThread]: Found 10 models, 4 seeds, 37 data tests, 4 sources, 429 macros
[0m09:12:27.622861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e051d9e9-1d7a-4327-84f6-53f62c0778da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210A57B0B20>]}
[0m09:12:27.625861 [info ] [MainThread]: 
[0m09:12:27.626838 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:12:27.626838 [info ] [MainThread]: 
[0m09:12:27.627844 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:12:27.636842 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m09:12:27.835337 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m09:12:27.836337 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m09:12:27.836337 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:12:27.859340 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m09:12:27.861340 [debug] [ThreadPool]: On list_warehouse: Close
[0m09:12:27.864340 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m09:12:27.865337 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m09:12:27.865337 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:12:27.866337 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:12:27.867338 [debug] [ThreadPool]: On list_warehouse: Close
[0m09:12:27.868337 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_staging)
[0m09:12:27.869337 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_staging"
"
[0m09:12:27.877337 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m09:12:27.878338 [debug] [ThreadPool]: On create_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m09:12:27.878338 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:12:27.879337 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:12:27.880338 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m09:12:27.881338 [debug] [ThreadPool]: On create_warehouse_main_staging: BEGIN
[0m09:12:27.881338 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:12:27.882337 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m09:12:27.882337 [debug] [ThreadPool]: On create_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_staging"} */

    
    
        create schema if not exists "warehouse"."main_staging"
    
[0m09:12:27.883337 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:12:27.884337 [debug] [ThreadPool]: On create_warehouse_main_staging: COMMIT
[0m09:12:27.885337 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m09:12:27.885337 [debug] [ThreadPool]: On create_warehouse_main_staging: COMMIT
[0m09:12:27.886337 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:12:27.887338 [debug] [ThreadPool]: On create_warehouse_main_staging: Close
[0m09:12:27.887338 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_warehouse_main_staging, now create_warehouse_main_marts)
[0m09:12:27.888338 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_marts"
"
[0m09:12:27.891337 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m09:12:27.891337 [debug] [ThreadPool]: On create_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_marts"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m09:12:27.892337 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:12:27.893337 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:12:27.894338 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m09:12:27.895338 [debug] [ThreadPool]: On create_warehouse_main_marts: BEGIN
[0m09:12:27.895338 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:12:27.896337 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m09:12:27.896337 [debug] [ThreadPool]: On create_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_marts"} */

    
    
        create schema if not exists "warehouse"."main_marts"
    
[0m09:12:27.897337 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:12:27.898337 [debug] [ThreadPool]: On create_warehouse_main_marts: COMMIT
[0m09:12:27.899337 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m09:12:27.899337 [debug] [ThreadPool]: On create_warehouse_main_marts: COMMIT
[0m09:12:27.900337 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:12:27.900337 [debug] [ThreadPool]: On create_warehouse_main_marts: Close
[0m09:12:27.903338 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_staging'
[0m09:12:27.910337 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_staging"
[0m09:12:27.910337 [debug] [ThreadPool]: On list_warehouse_main_staging: BEGIN
[0m09:12:27.911337 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:12:27.911337 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:12:27.912338 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_staging"
[0m09:12:27.912338 [debug] [ThreadPool]: On list_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_staging"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'warehouse'
  
[0m09:12:27.925336 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m09:12:27.927337 [debug] [ThreadPool]: On list_warehouse_main_staging: ROLLBACK
[0m09:12:27.928337 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_staging'
[0m09:12:27.928337 [debug] [ThreadPool]: On list_warehouse_main_staging: Close
[0m09:12:27.929338 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_staging, now list_warehouse_main_raw)
[0m09:12:27.932337 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m09:12:27.933337 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m09:12:27.933337 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:12:27.934337 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:12:27.935338 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m09:12:27.935338 [debug] [ThreadPool]: On list_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_raw"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'warehouse'
  
[0m09:12:27.938337 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m09:12:27.940338 [debug] [ThreadPool]: On list_warehouse_main_raw: ROLLBACK
[0m09:12:27.940338 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_raw'
[0m09:12:27.941337 [debug] [ThreadPool]: On list_warehouse_main_raw: Close
[0m09:12:27.942337 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_raw, now list_warehouse_main_marts)
[0m09:12:27.945337 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m09:12:27.945337 [debug] [ThreadPool]: On list_warehouse_main_marts: BEGIN
[0m09:12:27.946337 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:12:27.947337 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:12:27.947337 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m09:12:27.948337 [debug] [ThreadPool]: On list_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_marts"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'warehouse'
  
[0m09:12:27.951337 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m09:12:27.953337 [debug] [ThreadPool]: On list_warehouse_main_marts: ROLLBACK
[0m09:12:27.953337 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_marts'
[0m09:12:27.954338 [debug] [ThreadPool]: On list_warehouse_main_marts: Close
[0m09:12:27.957169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e051d9e9-1d7a-4327-84f6-53f62c0778da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210A43D4EB0>]}
[0m09:12:27.957169 [debug] [MainThread]: Using duckdb connection "master"
[0m09:12:27.958170 [debug] [MainThread]: On master: BEGIN
[0m09:12:27.958170 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:12:27.959170 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:12:27.959170 [debug] [MainThread]: On master: COMMIT
[0m09:12:27.960170 [debug] [MainThread]: Using duckdb connection "master"
[0m09:12:27.961170 [debug] [MainThread]: On master: COMMIT
[0m09:12:27.961170 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:12:27.962170 [debug] [MainThread]: On master: Close
[0m09:12:27.966704 [debug] [Thread-1 (]: Began running node model.case_project.stg_customers
[0m09:12:27.966704 [info ] [Thread-1 (]: 1 of 10 START sql view model main_staging.stg_customers ........................ [RUN]
[0m09:12:27.967705 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.case_project.stg_customers'
[0m09:12:27.968705 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_customers
[0m09:12:27.977737 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_customers"
[0m09:12:27.984250 [debug] [Thread-1 (]: Began executing node model.case_project.stg_customers
[0m09:12:28.022249 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_customers"
[0m09:12:28.027388 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m09:12:28.028388 [debug] [Thread-1 (]: On model.case_project.stg_customers: BEGIN
[0m09:12:28.028388 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:12:28.029389 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:12:28.030361 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m09:12:28.030361 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */

  
  create view "warehouse"."main_staging"."stg_customers__dbt_tmp" as (
    -- models/staging/stg_customers.sql
with src as (select * from "warehouse"."main_raw"."raw_customers")
select
  cast(id as varchar) as customer_id,
  trim(name) as customer_name
from src
  );

[0m09:12:28.031361 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:12:28.039361 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m09:12:28.040361 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */
alter view "warehouse"."main_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m09:12:28.040361 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:12:28.044361 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m09:12:28.045361 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */
alter view "warehouse"."main_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m09:12:28.046393 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:12:28.060388 [debug] [Thread-1 (]: On model.case_project.stg_customers: COMMIT
[0m09:12:28.060388 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m09:12:28.061389 [debug] [Thread-1 (]: On model.case_project.stg_customers: COMMIT
[0m09:12:28.067496 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:12:28.074495 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m09:12:28.075495 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */

      drop view if exists "warehouse"."main_staging"."stg_customers__dbt_backup" cascade
    
[0m09:12:28.077500 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:12:28.080523 [debug] [Thread-1 (]: On model.case_project.stg_customers: Close
[0m09:12:28.083726 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e051d9e9-1d7a-4327-84f6-53f62c0778da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210A5CADCF0>]}
[0m09:12:28.084732 [info ] [Thread-1 (]: 1 of 10 OK created sql view model main_staging.stg_customers ................... [[32mOK[0m in 0.11s]
[0m09:12:28.085135 [debug] [Thread-1 (]: Finished running node model.case_project.stg_customers
[0m09:12:28.086171 [debug] [Thread-1 (]: Began running node model.case_project.stg_items
[0m09:12:28.086957 [info ] [Thread-1 (]: 2 of 10 START sql view model main_staging.stg_items ............................ [RUN]
[0m09:12:28.087963 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_customers, now model.case_project.stg_items)
[0m09:12:28.087963 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_items
[0m09:12:28.091963 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_items"
[0m09:12:28.096963 [debug] [Thread-1 (]: Began executing node model.case_project.stg_items
[0m09:12:28.101963 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_items"
[0m09:12:28.107621 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m09:12:28.108628 [debug] [Thread-1 (]: On model.case_project.stg_items: BEGIN
[0m09:12:28.108628 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:12:28.109595 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:12:28.110625 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m09:12:28.110625 [debug] [Thread-1 (]: On model.case_project.stg_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_items"} */

  
  create view "warehouse"."main_staging"."stg_items__dbt_tmp" as (
    with src as (
  select * from "warehouse"."main_raw"."raw_items"
)
select
  cast(order_id as varchar) as order_id,  -- FK to orders
  cast(sku      as varchar) as product_id, 
  1                           as quantity  -- Assumption: one row = one item
from src
  );

[0m09:12:28.111625 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:12:28.116625 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m09:12:28.117624 [debug] [Thread-1 (]: On model.case_project.stg_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_items"} */
alter view "warehouse"."main_staging"."stg_items" rename to "stg_items__dbt_backup"
[0m09:12:28.118615 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:12:28.121624 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m09:12:28.122625 [debug] [Thread-1 (]: On model.case_project.stg_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_items"} */
alter view "warehouse"."main_staging"."stg_items__dbt_tmp" rename to "stg_items"
[0m09:12:28.123601 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:12:28.125625 [debug] [Thread-1 (]: On model.case_project.stg_items: COMMIT
[0m09:12:28.126625 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m09:12:28.127607 [debug] [Thread-1 (]: On model.case_project.stg_items: COMMIT
[0m09:12:28.129595 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:12:28.132592 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m09:12:28.133592 [debug] [Thread-1 (]: On model.case_project.stg_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_items"} */

      drop view if exists "warehouse"."main_staging"."stg_items__dbt_backup" cascade
    
[0m09:12:28.135784 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:12:28.136794 [debug] [Thread-1 (]: On model.case_project.stg_items: Close
[0m09:12:28.137793 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e051d9e9-1d7a-4327-84f6-53f62c0778da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210A1D159C0>]}
[0m09:12:28.138794 [info ] [Thread-1 (]: 2 of 10 OK created sql view model main_staging.stg_items ....................... [[32mOK[0m in 0.05s]
[0m09:12:28.139778 [debug] [Thread-1 (]: Finished running node model.case_project.stg_items
[0m09:12:28.140817 [debug] [Thread-1 (]: Began running node model.case_project.stg_orders
[0m09:12:28.141784 [info ] [Thread-1 (]: 3 of 10 START sql view model main_staging.stg_orders ........................... [RUN]
[0m09:12:28.142784 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_items, now model.case_project.stg_orders)
[0m09:12:28.142784 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_orders
[0m09:12:28.146813 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_orders"
[0m09:12:28.151290 [debug] [Thread-1 (]: Began executing node model.case_project.stg_orders
[0m09:12:28.156292 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_orders"
[0m09:12:28.162292 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m09:12:28.162292 [debug] [Thread-1 (]: On model.case_project.stg_orders: BEGIN
[0m09:12:28.163293 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:12:28.164291 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:12:28.164291 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m09:12:28.165292 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */

  
  create view "warehouse"."main_staging"."stg_orders__dbt_tmp" as (
    with src as (
  select * from "warehouse"."main_raw"."raw_orders"
)
select
  cast(id as varchar)                 as order_id,
  cast(customer as varchar)           as customer_id,
  cast(store_id as varchar)           as store_id,
  cast(ordered_at as timestamp)       as ordered_at,
  cast(subtotal as decimal(10,2))            as subtotal,
  cast(tax_paid as decimal(10,2))            as tax_paid,
  cast(order_total as decimal(10,2))         as order_total
from src
  );

[0m09:12:28.166291 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:12:28.170292 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m09:12:28.171292 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */
alter view "warehouse"."main_staging"."stg_orders" rename to "stg_orders__dbt_backup"
[0m09:12:28.172291 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:12:28.176292 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m09:12:28.177292 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */
alter view "warehouse"."main_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m09:12:28.178292 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:12:28.180292 [debug] [Thread-1 (]: On model.case_project.stg_orders: COMMIT
[0m09:12:28.180292 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m09:12:28.181291 [debug] [Thread-1 (]: On model.case_project.stg_orders: COMMIT
[0m09:12:28.183360 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:12:28.188342 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m09:12:28.188342 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */

      drop view if exists "warehouse"."main_staging"."stg_orders__dbt_backup" cascade
    
[0m09:12:28.191344 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:12:28.192344 [debug] [Thread-1 (]: On model.case_project.stg_orders: Close
[0m09:12:28.193343 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e051d9e9-1d7a-4327-84f6-53f62c0778da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210A1D159C0>]}
[0m09:12:28.194342 [info ] [Thread-1 (]: 3 of 10 OK created sql view model main_staging.stg_orders ...................... [[32mOK[0m in 0.05s]
[0m09:12:28.195343 [debug] [Thread-1 (]: Finished running node model.case_project.stg_orders
[0m09:12:28.196343 [debug] [Thread-1 (]: Began running node model.case_project.stg_products
[0m09:12:28.197342 [info ] [Thread-1 (]: 4 of 10 START sql view model main_staging.stg_products ......................... [RUN]
[0m09:12:28.198342 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_orders, now model.case_project.stg_products)
[0m09:12:28.198342 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_products
[0m09:12:28.202373 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_products"
[0m09:12:28.207640 [debug] [Thread-1 (]: Began executing node model.case_project.stg_products
[0m09:12:28.212771 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_products"
[0m09:12:28.218933 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m09:12:28.218933 [debug] [Thread-1 (]: On model.case_project.stg_products: BEGIN
[0m09:12:28.219933 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:12:28.220933 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:12:28.220933 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m09:12:28.221933 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */

  
  create view "warehouse"."main_staging"."stg_products__dbt_tmp" as (
    -- models/staging/stg_products.sql
with src as (select * from "warehouse"."main_raw"."raw_products")
select
  cast(sku as varchar)      as product_id,
  trim(name)                as product_name, 
  cast(price as decimal(10,2))    as price
from src
  );

[0m09:12:28.222933 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:12:28.226933 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m09:12:28.226933 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */
alter view "warehouse"."main_staging"."stg_products" rename to "stg_products__dbt_backup"
[0m09:12:28.227933 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:12:28.231933 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m09:12:28.232930 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */
alter view "warehouse"."main_staging"."stg_products__dbt_tmp" rename to "stg_products"
[0m09:12:28.233930 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:12:28.235930 [debug] [Thread-1 (]: On model.case_project.stg_products: COMMIT
[0m09:12:28.235930 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m09:12:28.236930 [debug] [Thread-1 (]: On model.case_project.stg_products: COMMIT
[0m09:12:28.238931 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:12:28.242933 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m09:12:28.243933 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */

      drop view if exists "warehouse"."main_staging"."stg_products__dbt_backup" cascade
    
[0m09:12:28.245099 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:12:28.247128 [debug] [Thread-1 (]: On model.case_project.stg_products: Close
[0m09:12:28.248138 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e051d9e9-1d7a-4327-84f6-53f62c0778da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210A5BC0430>]}
[0m09:12:28.249138 [info ] [Thread-1 (]: 4 of 10 OK created sql view model main_staging.stg_products .................... [[32mOK[0m in 0.05s]
[0m09:12:28.250134 [debug] [Thread-1 (]: Finished running node model.case_project.stg_products
[0m09:12:28.250134 [debug] [Thread-1 (]: Began running node model.case_project.dim_customers
[0m09:12:28.251134 [info ] [Thread-1 (]: 5 of 10 START sql view model main_marts.dim_customers .......................... [RUN]
[0m09:12:28.252104 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_products, now model.case_project.dim_customers)
[0m09:12:28.252104 [debug] [Thread-1 (]: Began compiling node model.case_project.dim_customers
[0m09:12:28.256136 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.dim_customers"
[0m09:12:28.261256 [debug] [Thread-1 (]: Began executing node model.case_project.dim_customers
[0m09:12:28.267264 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.dim_customers"
[0m09:12:28.273070 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m09:12:28.273070 [debug] [Thread-1 (]: On model.case_project.dim_customers: BEGIN
[0m09:12:28.274073 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:12:28.275072 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:12:28.275072 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m09:12:28.276072 [debug] [Thread-1 (]: On model.case_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_customers"} */

  
  create view "warehouse"."main_marts"."dim_customers__dbt_tmp" as (
    -- models/marts/dim_customers.sql
with
cust as (
  select
    c.customer_id,
    c.customer_name
  from "warehouse"."main_staging"."stg_customers" as c
),
orders as (
  select
    customer_id,
    cast(ordered_at as date) as order_date,
    order_total
  from "warehouse"."main_staging"."stg_orders"
)
select
  cu.customer_id,
  cu.customer_name,
  min(o.order_date) as first_order_date,
  max(o.order_date) as last_order_date,
  count(*)         as order_count,
  sum(o.order_total) as lifetime_value
from cust cu
left join orders o using (customer_id)
group by 1,2
  );

[0m09:12:28.277072 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:12:28.282071 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m09:12:28.282071 [debug] [Thread-1 (]: On model.case_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_customers"} */
alter view "warehouse"."main_marts"."dim_customers" rename to "dim_customers__dbt_backup"
[0m09:12:28.283072 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:12:28.288072 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m09:12:28.288072 [debug] [Thread-1 (]: On model.case_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_customers"} */
alter view "warehouse"."main_marts"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m09:12:28.289072 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:12:28.291072 [debug] [Thread-1 (]: On model.case_project.dim_customers: COMMIT
[0m09:12:28.292072 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m09:12:28.293072 [debug] [Thread-1 (]: On model.case_project.dim_customers: COMMIT
[0m09:12:28.294071 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:12:28.298071 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m09:12:28.299068 [debug] [Thread-1 (]: On model.case_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_customers"} */

      drop view if exists "warehouse"."main_marts"."dim_customers__dbt_backup" cascade
    
[0m09:12:28.301069 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:12:28.303072 [debug] [Thread-1 (]: On model.case_project.dim_customers: Close
[0m09:12:28.303072 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e051d9e9-1d7a-4327-84f6-53f62c0778da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210A5BC0430>]}
[0m09:12:28.304072 [info ] [Thread-1 (]: 5 of 10 OK created sql view model main_marts.dim_customers ..................... [[32mOK[0m in 0.05s]
[0m09:12:28.305072 [debug] [Thread-1 (]: Finished running node model.case_project.dim_customers
[0m09:12:28.306072 [debug] [Thread-1 (]: Began running node model.case_project.fct_orders
[0m09:12:28.307072 [info ] [Thread-1 (]: 6 of 10 START sql view model main_marts.fct_orders ............................. [RUN]
[0m09:12:28.307072 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.dim_customers, now model.case_project.fct_orders)
[0m09:12:28.308072 [debug] [Thread-1 (]: Began compiling node model.case_project.fct_orders
[0m09:12:28.312072 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.fct_orders"
[0m09:12:28.316460 [debug] [Thread-1 (]: Began executing node model.case_project.fct_orders
[0m09:12:28.321469 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.fct_orders"
[0m09:12:28.326277 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m09:12:28.327280 [debug] [Thread-1 (]: On model.case_project.fct_orders: BEGIN
[0m09:12:28.327280 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:12:28.328276 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:12:28.329279 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m09:12:28.329279 [debug] [Thread-1 (]: On model.case_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_orders"} */

  
  create view "warehouse"."main_marts"."fct_orders__dbt_tmp" as (
    -- models/marts/fct_orders.sql
select
  o.order_id,
  o.customer_id,
  cast(o.ordered_at as date)                              as order_date,
  -- Export a clean month anchor as text: 'YYYY-MM-01'
  strftime(date_trunc('month', o.ordered_at), '%Y-%m-01') as order_month,
  o.subtotal,
  o.tax_paid,
  o.order_total
from "warehouse"."main_staging"."stg_orders" as o
  );

[0m09:12:28.330278 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:12:28.336279 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m09:12:28.337279 [debug] [Thread-1 (]: On model.case_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_orders"} */
alter view "warehouse"."main_marts"."fct_orders" rename to "fct_orders__dbt_backup"
[0m09:12:28.338279 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:12:28.342275 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m09:12:28.343276 [debug] [Thread-1 (]: On model.case_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_orders"} */
alter view "warehouse"."main_marts"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m09:12:28.344276 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:12:28.346276 [debug] [Thread-1 (]: On model.case_project.fct_orders: COMMIT
[0m09:12:28.347276 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m09:12:28.347276 [debug] [Thread-1 (]: On model.case_project.fct_orders: COMMIT
[0m09:12:28.349276 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:12:28.353279 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m09:12:28.353279 [debug] [Thread-1 (]: On model.case_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_orders"} */

      drop view if exists "warehouse"."main_marts"."fct_orders__dbt_backup" cascade
    
[0m09:12:28.355276 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:12:28.357279 [debug] [Thread-1 (]: On model.case_project.fct_orders: Close
[0m09:12:28.358279 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e051d9e9-1d7a-4327-84f6-53f62c0778da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210A438A7A0>]}
[0m09:12:28.359279 [info ] [Thread-1 (]: 6 of 10 OK created sql view model main_marts.fct_orders ........................ [[32mOK[0m in 0.05s]
[0m09:12:28.360315 [debug] [Thread-1 (]: Finished running node model.case_project.fct_orders
[0m09:12:28.360315 [debug] [Thread-1 (]: Began running node model.case_project.fct_order_items
[0m09:12:28.361351 [info ] [Thread-1 (]: 7 of 10 START sql view model main_marts.fct_order_items ........................ [RUN]
[0m09:12:28.362321 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.fct_orders, now model.case_project.fct_order_items)
[0m09:12:28.362321 [debug] [Thread-1 (]: Began compiling node model.case_project.fct_order_items
[0m09:12:28.366356 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.fct_order_items"
[0m09:12:28.371351 [debug] [Thread-1 (]: Began executing node model.case_project.fct_order_items
[0m09:12:28.376319 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.fct_order_items"
[0m09:12:28.381969 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_order_items"
[0m09:12:28.381969 [debug] [Thread-1 (]: On model.case_project.fct_order_items: BEGIN
[0m09:12:28.382978 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:12:28.383978 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:12:28.384978 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_order_items"
[0m09:12:28.384978 [debug] [Thread-1 (]: On model.case_project.fct_order_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_order_items"} */

  
  create view "warehouse"."main_marts"."fct_order_items__dbt_tmp" as (
    -- models/marts/fct_order_items.sql
with
items as (
  select
    i.order_id,
    i.product_id,
    i.quantity
  from "warehouse"."main_staging"."stg_items" as i
),
orders as (
  select
    o.order_id,
    o.customer_id,
    cast(o.ordered_at as date) as order_date,
    cast(date_trunc('month', o.ordered_at) as date) as order_month
  from "warehouse"."main_staging"."stg_orders" as o
),
products as (
  select
    p.product_id,
    p.product_name,
    p.price as unit_price,
    case
      when p.product_id like 'BEV%' then 'drinks'
      when p.product_id like 'JAF%' then 'sandwiches'
      else 'other'
    end as product_category
  from "warehouse"."main_staging"."stg_products" as p
)
select
  o.order_id,
  o.customer_id,
  o.order_date,
  o.order_month,
  pr.product_id,
  pr.product_name,
  pr.product_category,
  coalesce(it.quantity, 1) as quantity,
  pr.unit_price,
  coalesce(it.quantity, 1) * pr.unit_price as line_revenue
from items it
join orders o   using (order_id)
join products pr using (product_id)
  );

[0m09:12:28.386978 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:12:28.391977 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_order_items"
[0m09:12:28.391977 [debug] [Thread-1 (]: On model.case_project.fct_order_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_order_items"} */
alter view "warehouse"."main_marts"."fct_order_items" rename to "fct_order_items__dbt_backup"
[0m09:12:28.392978 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:12:28.396977 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_order_items"
[0m09:12:28.397978 [debug] [Thread-1 (]: On model.case_project.fct_order_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_order_items"} */
alter view "warehouse"."main_marts"."fct_order_items__dbt_tmp" rename to "fct_order_items"
[0m09:12:28.398975 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:12:28.400978 [debug] [Thread-1 (]: On model.case_project.fct_order_items: COMMIT
[0m09:12:28.400978 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_order_items"
[0m09:12:28.401978 [debug] [Thread-1 (]: On model.case_project.fct_order_items: COMMIT
[0m09:12:28.403989 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:12:28.407974 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_order_items"
[0m09:12:28.408973 [debug] [Thread-1 (]: On model.case_project.fct_order_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_order_items"} */

      drop view if exists "warehouse"."main_marts"."fct_order_items__dbt_backup" cascade
    
[0m09:12:28.410987 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:12:28.411978 [debug] [Thread-1 (]: On model.case_project.fct_order_items: Close
[0m09:12:28.412978 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e051d9e9-1d7a-4327-84f6-53f62c0778da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210A5DF8B50>]}
[0m09:12:28.413978 [info ] [Thread-1 (]: 7 of 10 OK created sql view model main_marts.fct_order_items ................... [[32mOK[0m in 0.05s]
[0m09:12:28.414824 [debug] [Thread-1 (]: Finished running node model.case_project.fct_order_items
[0m09:12:28.415861 [debug] [Thread-1 (]: Began running node model.case_project.customer_pareto
[0m09:12:28.416862 [info ] [Thread-1 (]: 8 of 10 START sql view model main_marts.customer_pareto ........................ [RUN]
[0m09:12:28.416862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.fct_order_items, now model.case_project.customer_pareto)
[0m09:12:28.417860 [debug] [Thread-1 (]: Began compiling node model.case_project.customer_pareto
[0m09:12:28.420860 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.customer_pareto"
[0m09:12:28.426266 [debug] [Thread-1 (]: Began executing node model.case_project.customer_pareto
[0m09:12:28.431267 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.customer_pareto"
[0m09:12:28.436267 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.customer_pareto"
[0m09:12:28.436267 [debug] [Thread-1 (]: On model.case_project.customer_pareto: BEGIN
[0m09:12:28.437268 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:12:28.438267 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:12:28.438267 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.customer_pareto"
[0m09:12:28.439268 [debug] [Thread-1 (]: On model.case_project.customer_pareto: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.customer_pareto"} */

  
  create view "warehouse"."main_marts"."customer_pareto__dbt_tmp" as (
    -- models/marts/customer_pareto.sql
with ltv as (
  select
    customer_id,
    sum(order_total) as lifetime_value
  from "warehouse"."main_marts"."fct_orders"
  group by 1
),
ranked as (
  select
    customer_id,
    lifetime_value,
    rank() over (order by lifetime_value desc) as rnk,
    count(*) over () as total_customers,
    sum(lifetime_value) over () as total_revenue,
    sum(lifetime_value) over (
      order by lifetime_value desc
      rows between unbounded preceding and current row
    ) as cum_revenue
  from ltv
)
select
  customer_id,
  lifetime_value,
  rnk,
  cast(rnk as double)/total_customers  as customer_pct,
  cum_revenue / nullif(total_revenue,0) as revenue_cum_pct
from ranked
order by rnk
  );

[0m09:12:28.441268 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:12:28.445267 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.customer_pareto"
[0m09:12:28.446267 [debug] [Thread-1 (]: On model.case_project.customer_pareto: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.customer_pareto"} */
alter view "warehouse"."main_marts"."customer_pareto" rename to "customer_pareto__dbt_backup"
[0m09:12:28.447268 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:12:28.451266 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.customer_pareto"
[0m09:12:28.452265 [debug] [Thread-1 (]: On model.case_project.customer_pareto: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.customer_pareto"} */
alter view "warehouse"."main_marts"."customer_pareto__dbt_tmp" rename to "customer_pareto"
[0m09:12:28.452265 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:12:28.455264 [debug] [Thread-1 (]: On model.case_project.customer_pareto: COMMIT
[0m09:12:28.455264 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.customer_pareto"
[0m09:12:28.456265 [debug] [Thread-1 (]: On model.case_project.customer_pareto: COMMIT
[0m09:12:28.458263 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:12:28.461264 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.customer_pareto"
[0m09:12:28.462264 [debug] [Thread-1 (]: On model.case_project.customer_pareto: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.customer_pareto"} */

      drop view if exists "warehouse"."main_marts"."customer_pareto__dbt_backup" cascade
    
[0m09:12:28.464534 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:12:28.466544 [debug] [Thread-1 (]: On model.case_project.customer_pareto: Close
[0m09:12:28.466544 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e051d9e9-1d7a-4327-84f6-53f62c0778da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210A5DF1330>]}
[0m09:12:28.467543 [info ] [Thread-1 (]: 8 of 10 OK created sql view model main_marts.customer_pareto ................... [[32mOK[0m in 0.05s]
[0m09:12:28.468544 [debug] [Thread-1 (]: Finished running node model.case_project.customer_pareto
[0m09:12:28.469547 [debug] [Thread-1 (]: Began running node model.case_project.orders_fact
[0m09:12:28.470547 [info ] [Thread-1 (]: 9 of 10 START sql view model main_marts.orders_fact ............................ [RUN]
[0m09:12:28.470547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.customer_pareto, now model.case_project.orders_fact)
[0m09:12:28.471547 [debug] [Thread-1 (]: Began compiling node model.case_project.orders_fact
[0m09:12:28.475547 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.orders_fact"
[0m09:12:28.479543 [debug] [Thread-1 (]: Began executing node model.case_project.orders_fact
[0m09:12:28.486546 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.orders_fact"
[0m09:12:28.491612 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.orders_fact"
[0m09:12:28.491612 [debug] [Thread-1 (]: On model.case_project.orders_fact: BEGIN
[0m09:12:28.492620 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:12:28.493620 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:12:28.493620 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.orders_fact"
[0m09:12:28.494620 [debug] [Thread-1 (]: On model.case_project.orders_fact: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.orders_fact"} */

  
  create view "warehouse"."main_marts"."orders_fact__dbt_tmp" as (
    with
orders as (
  select
    order_id, customer_id, order_date, order_month, order_total as order_revenue
  from "warehouse"."main_marts"."fct_orders"
),
first_order as (
  select customer_id, min(order_date) as first_order_date
  from orders
  group by 1
)
select
  o.order_id,
  o.customer_id,
  o.order_date,
  o.order_month,
  o.order_revenue,
  case when o.order_date = f.first_order_date then true else false end as is_first_order,
  case when o.order_date = f.first_order_date then 'new' else 'repeat' end as customer_cohort
from orders o
join first_order f using (customer_id)
  );

[0m09:12:28.496620 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:12:28.501620 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.orders_fact"
[0m09:12:28.502621 [debug] [Thread-1 (]: On model.case_project.orders_fact: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.orders_fact"} */
alter view "warehouse"."main_marts"."orders_fact" rename to "orders_fact__dbt_backup"
[0m09:12:28.503616 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:12:28.507620 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.orders_fact"
[0m09:12:28.508620 [debug] [Thread-1 (]: On model.case_project.orders_fact: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.orders_fact"} */
alter view "warehouse"."main_marts"."orders_fact__dbt_tmp" rename to "orders_fact"
[0m09:12:28.508620 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:12:28.510620 [debug] [Thread-1 (]: On model.case_project.orders_fact: COMMIT
[0m09:12:28.511620 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.orders_fact"
[0m09:12:28.512620 [debug] [Thread-1 (]: On model.case_project.orders_fact: COMMIT
[0m09:12:28.514620 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:12:28.517619 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.orders_fact"
[0m09:12:28.518620 [debug] [Thread-1 (]: On model.case_project.orders_fact: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.orders_fact"} */

      drop view if exists "warehouse"."main_marts"."orders_fact__dbt_backup" cascade
    
[0m09:12:28.520267 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:12:28.521282 [debug] [Thread-1 (]: On model.case_project.orders_fact: Close
[0m09:12:28.522281 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e051d9e9-1d7a-4327-84f6-53f62c0778da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210A5E20040>]}
[0m09:12:28.523281 [info ] [Thread-1 (]: 9 of 10 OK created sql view model main_marts.orders_fact ....................... [[32mOK[0m in 0.05s]
[0m09:12:28.524281 [debug] [Thread-1 (]: Finished running node model.case_project.orders_fact
[0m09:12:28.525278 [debug] [Thread-1 (]: Began running node model.case_project.monthly_summary
[0m09:12:28.526281 [info ] [Thread-1 (]: 10 of 10 START sql view model main_marts.monthly_summary ....................... [RUN]
[0m09:12:28.526281 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.orders_fact, now model.case_project.monthly_summary)
[0m09:12:28.527281 [debug] [Thread-1 (]: Began compiling node model.case_project.monthly_summary
[0m09:12:28.531281 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.monthly_summary"
[0m09:12:28.535279 [debug] [Thread-1 (]: Began executing node model.case_project.monthly_summary
[0m09:12:28.540281 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.monthly_summary"
[0m09:12:28.545498 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.monthly_summary"
[0m09:12:28.546504 [debug] [Thread-1 (]: On model.case_project.monthly_summary: BEGIN
[0m09:12:28.546504 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:12:28.547503 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:12:28.548504 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.monthly_summary"
[0m09:12:28.548504 [debug] [Thread-1 (]: On model.case_project.monthly_summary: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.monthly_summary"} */

  
  create view "warehouse"."main_marts"."monthly_summary__dbt_tmp" as (
    -- models/marts/monthly_summary.sql
with base as (
  select
    order_id,
    customer_id,
    order_date,
    order_month,          -- now 'YYYY-MM-01' text from orders_fact
    order_revenue
  from "warehouse"."main_marts"."orders_fact"
),
labeled as (
  select
    b.*,
    case when order_date = min(order_date) over (partition by customer_id) then 1 else 0 end as is_new_order
  from base b
)
select
  order_month,
  sum(order_revenue)                                  as monthly_revenue,
  count(distinct order_id)                            as monthly_orders,
  count(distinct customer_id)                         as active_customers,
  sum(order_revenue)*1.0 / nullif(count(distinct order_id),0) as aov,
  sum(is_new_order)                                   as new_customers,
  (count(distinct customer_id) - sum(is_new_order))   as repeat_customers,
  (count(distinct customer_id) - sum(is_new_order))*1.0
    / nullif(count(distinct customer_id),0)           as repeat_purchase_rate
from labeled
group by 1
order by 1
  );

[0m09:12:28.551500 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:12:28.555499 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.monthly_summary"
[0m09:12:28.556500 [debug] [Thread-1 (]: On model.case_project.monthly_summary: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.monthly_summary"} */
alter view "warehouse"."main_marts"."monthly_summary" rename to "monthly_summary__dbt_backup"
[0m09:12:28.557499 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:12:28.562502 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.monthly_summary"
[0m09:12:28.563500 [debug] [Thread-1 (]: On model.case_project.monthly_summary: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.monthly_summary"} */
alter view "warehouse"."main_marts"."monthly_summary__dbt_tmp" rename to "monthly_summary"
[0m09:12:28.564503 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:12:28.566504 [debug] [Thread-1 (]: On model.case_project.monthly_summary: COMMIT
[0m09:12:28.567503 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.monthly_summary"
[0m09:12:28.567503 [debug] [Thread-1 (]: On model.case_project.monthly_summary: COMMIT
[0m09:12:28.569500 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:12:28.573502 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.monthly_summary"
[0m09:12:28.574503 [debug] [Thread-1 (]: On model.case_project.monthly_summary: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.monthly_summary"} */

      drop view if exists "warehouse"."main_marts"."monthly_summary__dbt_backup" cascade
    
[0m09:12:28.576214 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:12:28.577228 [debug] [Thread-1 (]: On model.case_project.monthly_summary: Close
[0m09:12:28.578224 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e051d9e9-1d7a-4327-84f6-53f62c0778da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210A5E386D0>]}
[0m09:12:28.579228 [info ] [Thread-1 (]: 10 of 10 OK created sql view model main_marts.monthly_summary .................. [[32mOK[0m in 0.05s]
[0m09:12:28.580112 [debug] [Thread-1 (]: Finished running node model.case_project.monthly_summary
[0m09:12:28.581254 [debug] [MainThread]: Using duckdb connection "master"
[0m09:12:28.582290 [debug] [MainThread]: On master: BEGIN
[0m09:12:28.582290 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:12:28.583289 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:12:28.583289 [debug] [MainThread]: On master: COMMIT
[0m09:12:28.584291 [debug] [MainThread]: Using duckdb connection "master"
[0m09:12:28.584291 [debug] [MainThread]: On master: COMMIT
[0m09:12:28.585261 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:12:28.586289 [debug] [MainThread]: On master: Close
[0m09:12:28.587300 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:12:28.587300 [debug] [MainThread]: Connection 'create_warehouse_main_marts' was properly closed.
[0m09:12:28.588292 [debug] [MainThread]: Connection 'list_warehouse_main_marts' was properly closed.
[0m09:12:28.588292 [debug] [MainThread]: Connection 'model.case_project.monthly_summary' was properly closed.
[0m09:12:28.589291 [info ] [MainThread]: 
[0m09:12:28.589291 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 0.96 seconds (0.96s).
[0m09:12:28.592262 [debug] [MainThread]: Command end result
[0m09:12:28.680806 [debug] [MainThread]: Wrote artifact WritableManifest to D:\projects\Case Project main\target\manifest.json
[0m09:12:28.688811 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\projects\Case Project main\target\semantic_manifest.json
[0m09:12:28.701761 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\projects\Case Project main\target\run_results.json
[0m09:12:28.702762 [info ] [MainThread]: 
[0m09:12:28.703761 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:12:28.703761 [info ] [MainThread]: 
[0m09:12:28.704762 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m09:12:28.705761 [debug] [MainThread]: Command `dbt run` succeeded at 09:12:28.705761 after 2.58 seconds
[0m09:12:28.706762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210A1E631C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210A38B4DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210A1869450>]}
[0m09:12:28.707762 [debug] [MainThread]: Flushing usage events
[0m09:12:29.535964 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:18:49.496629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF797D3220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF7BAC3D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF7BAC3F70>]}


============================== 14:18:49.503627 | f25e8867-1a00-4581-b2e4-ea244ee40465 ==============================
[0m14:18:49.503627 [info ] [MainThread]: Running with dbt=1.10.9
[0m14:18:49.504627 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'D:\\projects\\Case Project main\\logs', 'profiles_dir': 'D:\\projects\\Case Project main', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m14:18:49.807491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f25e8867-1a00-4581-b2e4-ea244ee40465', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF7BBDFCA0>]}
[0m14:18:49.886497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f25e8867-1a00-4581-b2e4-ea244ee40465', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF7BAC1FC0>]}
[0m14:18:49.892509 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:18:50.256198 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m14:18:50.636241 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m14:18:50.637241 [debug] [MainThread]: Partial parsing: updated file: case_project://models\marts\fct_order_items.sql
[0m14:18:50.638241 [debug] [MainThread]: Partial parsing: updated file: case_project://models\marts\fct_orders.sql
[0m14:18:50.639246 [debug] [MainThread]: Partial parsing: updated file: case_project://models\marts\dim_customers.sql
[0m14:18:50.639246 [debug] [MainThread]: Partial parsing: updated file: case_project://models\marts\monthly_summary.sql
[0m14:18:50.640241 [debug] [MainThread]: Partial parsing: updated file: case_project://models\marts\orders_fact.sql
[0m14:18:51.314082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f25e8867-1a00-4581-b2e4-ea244ee40465', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF7D381E70>]}
[0m14:18:51.519901 [debug] [MainThread]: Wrote artifact WritableManifest to D:\projects\Case Project main\target\manifest.json
[0m14:18:51.527898 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\projects\Case Project main\target\semantic_manifest.json
[0m14:18:51.575138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f25e8867-1a00-4581-b2e4-ea244ee40465', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF7D10AFB0>]}
[0m14:18:51.575138 [info ] [MainThread]: Found 10 models, 4 seeds, 37 data tests, 4 sources, 429 macros
[0m14:18:51.576175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f25e8867-1a00-4581-b2e4-ea244ee40465', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF7D108040>]}
[0m14:18:51.579175 [info ] [MainThread]: 
[0m14:18:51.580146 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:18:51.581145 [info ] [MainThread]: 
[0m14:18:51.582145 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:18:51.589610 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m14:18:51.817516 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m14:18:51.818485 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m14:18:51.818485 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:18:51.854484 [debug] [ThreadPool]: SQL status: OK in 0.036 seconds
[0m14:18:51.857485 [debug] [ThreadPool]: On list_warehouse: Close
[0m14:18:51.860484 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m14:18:51.861484 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m14:18:51.861484 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:18:51.863485 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:18:51.864515 [debug] [ThreadPool]: On list_warehouse: Close
[0m14:18:51.865485 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_marts)
[0m14:18:51.866485 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_marts"
"
[0m14:18:51.874484 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m14:18:51.875484 [debug] [ThreadPool]: On create_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_marts"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m14:18:51.875484 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:18:51.877485 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m14:18:51.879485 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m14:18:51.879485 [debug] [ThreadPool]: On create_warehouse_main_marts: BEGIN
[0m14:18:51.880485 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:18:51.881485 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m14:18:51.881485 [debug] [ThreadPool]: On create_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_marts"} */

    
    
        create schema if not exists "warehouse"."main_marts"
    
[0m14:18:51.884154 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m14:18:51.885154 [debug] [ThreadPool]: On create_warehouse_main_marts: COMMIT
[0m14:18:51.885154 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m14:18:51.886153 [debug] [ThreadPool]: On create_warehouse_main_marts: COMMIT
[0m14:18:51.886153 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:18:51.887153 [debug] [ThreadPool]: On create_warehouse_main_marts: Close
[0m14:18:51.888153 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_warehouse_main_marts, now create_warehouse_main_staging)
[0m14:18:51.888153 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_staging"
"
[0m14:18:51.891152 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m14:18:51.892156 [debug] [ThreadPool]: On create_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m14:18:51.892156 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:18:51.893156 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:18:51.895156 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m14:18:51.895156 [debug] [ThreadPool]: On create_warehouse_main_staging: BEGIN
[0m14:18:51.896156 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:18:51.897156 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m14:18:51.897156 [debug] [ThreadPool]: On create_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_staging"} */

    
    
        create schema if not exists "warehouse"."main_staging"
    
[0m14:18:51.898156 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:18:51.899156 [debug] [ThreadPool]: On create_warehouse_main_staging: COMMIT
[0m14:18:51.899156 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m14:18:51.900156 [debug] [ThreadPool]: On create_warehouse_main_staging: COMMIT
[0m14:18:51.900156 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:18:51.901156 [debug] [ThreadPool]: On create_warehouse_main_staging: Close
[0m14:18:51.904156 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_marts'
[0m14:18:51.911184 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m14:18:51.911184 [debug] [ThreadPool]: On list_warehouse_main_marts: BEGIN
[0m14:18:51.912185 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:18:51.912185 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:18:51.913184 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m14:18:51.913184 [debug] [ThreadPool]: On list_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_marts"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'warehouse'
  
[0m14:18:51.936597 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m14:18:51.938621 [debug] [ThreadPool]: On list_warehouse_main_marts: ROLLBACK
[0m14:18:51.940596 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_marts'
[0m14:18:51.940596 [debug] [ThreadPool]: On list_warehouse_main_marts: Close
[0m14:18:51.941596 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_marts, now list_warehouse_main_staging)
[0m14:18:51.946626 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_staging"
[0m14:18:51.947597 [debug] [ThreadPool]: On list_warehouse_main_staging: BEGIN
[0m14:18:51.947597 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:18:51.948597 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:18:51.948597 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_staging"
[0m14:18:51.949626 [debug] [ThreadPool]: On list_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_staging"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'warehouse'
  
[0m14:18:51.952627 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m14:18:51.954627 [debug] [ThreadPool]: On list_warehouse_main_staging: ROLLBACK
[0m14:18:51.954627 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_staging'
[0m14:18:51.955627 [debug] [ThreadPool]: On list_warehouse_main_staging: Close
[0m14:18:51.955627 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_staging, now list_warehouse_main_raw)
[0m14:18:51.959626 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m14:18:51.960626 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m14:18:51.960626 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:18:51.961627 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:18:51.961627 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m14:18:51.962597 [debug] [ThreadPool]: On list_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_raw"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'warehouse'
  
[0m14:18:51.965627 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m14:18:51.967626 [debug] [ThreadPool]: On list_warehouse_main_raw: ROLLBACK
[0m14:18:51.967626 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_raw'
[0m14:18:51.968626 [debug] [ThreadPool]: On list_warehouse_main_raw: Close
[0m14:18:51.970597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f25e8867-1a00-4581-b2e4-ea244ee40465', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF79151E40>]}
[0m14:18:51.970597 [debug] [MainThread]: Using duckdb connection "master"
[0m14:18:51.971626 [debug] [MainThread]: On master: BEGIN
[0m14:18:51.971626 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:18:51.972626 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:18:51.972626 [debug] [MainThread]: On master: COMMIT
[0m14:18:51.973630 [debug] [MainThread]: Using duckdb connection "master"
[0m14:18:51.973630 [debug] [MainThread]: On master: COMMIT
[0m14:18:51.974627 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:18:51.975626 [debug] [MainThread]: On master: Close
[0m14:18:51.981762 [debug] [Thread-1 (]: Began running node model.case_project.stg_customers
[0m14:18:51.981762 [info ] [Thread-1 (]: 1 of 10 START sql view model main_staging.stg_customers ........................ [RUN]
[0m14:18:51.982763 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.case_project.stg_customers'
[0m14:18:51.983763 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_customers
[0m14:18:51.993767 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_customers"
[0m14:18:51.998762 [debug] [Thread-1 (]: Began executing node model.case_project.stg_customers
[0m14:18:52.038764 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_customers"
[0m14:18:52.043848 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m14:18:52.044851 [debug] [Thread-1 (]: On model.case_project.stg_customers: BEGIN
[0m14:18:52.044851 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:18:52.045850 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:18:52.046850 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m14:18:52.046850 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */

  
  create view "warehouse"."main_staging"."stg_customers__dbt_tmp" as (
    -- models/staging/stg_customers.sql
with src as (select * from "warehouse"."main_raw"."raw_customers")
select
  cast(id as varchar) as customer_id,
  trim(name) as customer_name
from src
  );

[0m14:18:52.048869 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:18:52.056881 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m14:18:52.057881 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */
alter view "warehouse"."main_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m14:18:52.060856 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:18:52.064861 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m14:18:52.065862 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */
alter view "warehouse"."main_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m14:18:52.066862 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:18:52.080861 [debug] [Thread-1 (]: On model.case_project.stg_customers: COMMIT
[0m14:18:52.081862 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m14:18:52.081862 [debug] [Thread-1 (]: On model.case_project.stg_customers: COMMIT
[0m14:18:52.089280 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m14:18:52.096283 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m14:18:52.097283 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */

      drop view if exists "warehouse"."main_staging"."stg_customers__dbt_backup" cascade
    
[0m14:18:52.100415 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:18:52.104310 [debug] [Thread-1 (]: On model.case_project.stg_customers: Close
[0m14:18:52.107119 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f25e8867-1a00-4581-b2e4-ea244ee40465', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF7D8ED630>]}
[0m14:18:52.108126 [info ] [Thread-1 (]: 1 of 10 OK created sql view model main_staging.stg_customers ................... [[32mOK[0m in 0.12s]
[0m14:18:52.109125 [debug] [Thread-1 (]: Finished running node model.case_project.stg_customers
[0m14:18:52.109125 [debug] [Thread-1 (]: Began running node model.case_project.stg_items
[0m14:18:52.110125 [info ] [Thread-1 (]: 2 of 10 START sql view model main_staging.stg_items ............................ [RUN]
[0m14:18:52.111180 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_customers, now model.case_project.stg_items)
[0m14:18:52.112186 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_items
[0m14:18:52.115185 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_items"
[0m14:18:52.120188 [debug] [Thread-1 (]: Began executing node model.case_project.stg_items
[0m14:18:52.125186 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_items"
[0m14:18:52.130185 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m14:18:52.131186 [debug] [Thread-1 (]: On model.case_project.stg_items: BEGIN
[0m14:18:52.131186 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:18:52.132186 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:18:52.133187 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m14:18:52.133187 [debug] [Thread-1 (]: On model.case_project.stg_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_items"} */

  
  create view "warehouse"."main_staging"."stg_items__dbt_tmp" as (
    with src as (
  select * from "warehouse"."main_raw"."raw_items"
)
select
  cast(order_id as varchar) as order_id,  -- FK to orders
  cast(sku      as varchar) as product_id, 
  1                           as quantity  -- Assumption: one row = one item
from src
  );

[0m14:18:52.134186 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:18:52.140184 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m14:18:52.140184 [debug] [Thread-1 (]: On model.case_project.stg_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_items"} */
alter view "warehouse"."main_staging"."stg_items" rename to "stg_items__dbt_backup"
[0m14:18:52.141186 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:18:52.145186 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m14:18:52.146186 [debug] [Thread-1 (]: On model.case_project.stg_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_items"} */
alter view "warehouse"."main_staging"."stg_items__dbt_tmp" rename to "stg_items"
[0m14:18:52.146186 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:18:52.148186 [debug] [Thread-1 (]: On model.case_project.stg_items: COMMIT
[0m14:18:52.149186 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m14:18:52.150186 [debug] [Thread-1 (]: On model.case_project.stg_items: COMMIT
[0m14:18:52.152194 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:18:52.156187 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m14:18:52.157189 [debug] [Thread-1 (]: On model.case_project.stg_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_items"} */

      drop view if exists "warehouse"."main_staging"."stg_items__dbt_backup" cascade
    
[0m14:18:52.159189 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:18:52.161187 [debug] [Thread-1 (]: On model.case_project.stg_items: Close
[0m14:18:52.162186 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f25e8867-1a00-4581-b2e4-ea244ee40465', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF796819C0>]}
[0m14:18:52.163186 [info ] [Thread-1 (]: 2 of 10 OK created sql view model main_staging.stg_items ....................... [[32mOK[0m in 0.05s]
[0m14:18:52.164186 [debug] [Thread-1 (]: Finished running node model.case_project.stg_items
[0m14:18:52.164186 [debug] [Thread-1 (]: Began running node model.case_project.stg_orders
[0m14:18:52.165186 [info ] [Thread-1 (]: 3 of 10 START sql view model main_staging.stg_orders ........................... [RUN]
[0m14:18:52.166189 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_items, now model.case_project.stg_orders)
[0m14:18:52.167185 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_orders
[0m14:18:52.171186 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_orders"
[0m14:18:52.175204 [debug] [Thread-1 (]: Began executing node model.case_project.stg_orders
[0m14:18:52.180204 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_orders"
[0m14:18:52.185201 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m14:18:52.185201 [debug] [Thread-1 (]: On model.case_project.stg_orders: BEGIN
[0m14:18:52.186200 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:18:52.187202 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:18:52.188203 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m14:18:52.188203 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */

  
  create view "warehouse"."main_staging"."stg_orders__dbt_tmp" as (
    with src as (
  select * from "warehouse"."main_raw"."raw_orders"
)
select
  cast(id as varchar)                 as order_id,
  cast(customer as varchar)           as customer_id,
  cast(store_id as varchar)           as store_id,
  cast(ordered_at as timestamp)       as ordered_at,
  cast(subtotal as decimal(10,2))            as subtotal,
  cast(tax_paid as decimal(10,2))            as tax_paid,
  cast(order_total as decimal(10,2))         as order_total
from src
  );

[0m14:18:52.189756 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:18:52.193760 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m14:18:52.194761 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */
alter view "warehouse"."main_staging"."stg_orders" rename to "stg_orders__dbt_backup"
[0m14:18:52.195762 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:18:52.200762 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m14:18:52.200762 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */
alter view "warehouse"."main_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m14:18:52.201765 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:18:52.203762 [debug] [Thread-1 (]: On model.case_project.stg_orders: COMMIT
[0m14:18:52.204760 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m14:18:52.205761 [debug] [Thread-1 (]: On model.case_project.stg_orders: COMMIT
[0m14:18:52.207766 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:18:52.211776 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m14:18:52.212776 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */

      drop view if exists "warehouse"."main_staging"."stg_orders__dbt_backup" cascade
    
[0m14:18:52.215149 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:18:52.216158 [debug] [Thread-1 (]: On model.case_project.stg_orders: Close
[0m14:18:52.217158 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f25e8867-1a00-4581-b2e4-ea244ee40465', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF7D9D38E0>]}
[0m14:18:52.218158 [info ] [Thread-1 (]: 3 of 10 OK created sql view model main_staging.stg_orders ...................... [[32mOK[0m in 0.05s]
[0m14:18:52.219157 [debug] [Thread-1 (]: Finished running node model.case_project.stg_orders
[0m14:18:52.220158 [debug] [Thread-1 (]: Began running node model.case_project.stg_products
[0m14:18:52.221158 [info ] [Thread-1 (]: 4 of 10 START sql view model main_staging.stg_products ......................... [RUN]
[0m14:18:52.221158 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_orders, now model.case_project.stg_products)
[0m14:18:52.222158 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_products
[0m14:18:52.226158 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_products"
[0m14:18:52.230155 [debug] [Thread-1 (]: Began executing node model.case_project.stg_products
[0m14:18:52.235153 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_products"
[0m14:18:52.240038 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m14:18:52.240038 [debug] [Thread-1 (]: On model.case_project.stg_products: BEGIN
[0m14:18:52.241040 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:18:52.242039 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:18:52.242039 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m14:18:52.243040 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */

  
  create view "warehouse"."main_staging"."stg_products__dbt_tmp" as (
    -- models/staging/stg_products.sql
with src as (select * from "warehouse"."main_raw"."raw_products")
select
  cast(sku as varchar)      as product_id,
  trim(name)                as product_name, 
  cast(price as decimal(10,2))    as price
from src
  );

[0m14:18:52.244040 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:18:52.248039 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m14:18:52.249040 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */
alter view "warehouse"."main_staging"."stg_products" rename to "stg_products__dbt_backup"
[0m14:18:52.250040 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:18:52.253039 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m14:18:52.254040 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */
alter view "warehouse"."main_staging"."stg_products__dbt_tmp" rename to "stg_products"
[0m14:18:52.255040 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:18:52.257040 [debug] [Thread-1 (]: On model.case_project.stg_products: COMMIT
[0m14:18:52.257040 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m14:18:52.258040 [debug] [Thread-1 (]: On model.case_project.stg_products: COMMIT
[0m14:18:52.260038 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:18:52.264041 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m14:18:52.265041 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */

      drop view if exists "warehouse"."main_staging"."stg_products__dbt_backup" cascade
    
[0m14:18:52.267264 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:18:52.268278 [debug] [Thread-1 (]: On model.case_project.stg_products: Close
[0m14:18:52.269278 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f25e8867-1a00-4581-b2e4-ea244ee40465', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF7D9D0EB0>]}
[0m14:18:52.270275 [info ] [Thread-1 (]: 4 of 10 OK created sql view model main_staging.stg_products .................... [[32mOK[0m in 0.05s]
[0m14:18:52.271278 [debug] [Thread-1 (]: Finished running node model.case_project.stg_products
[0m14:18:52.272278 [debug] [Thread-1 (]: Began running node model.case_project.dim_customers
[0m14:18:52.273277 [info ] [Thread-1 (]: 5 of 10 START sql view model main_marts.dim_customers .......................... [RUN]
[0m14:18:52.273277 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_products, now model.case_project.dim_customers)
[0m14:18:52.274278 [debug] [Thread-1 (]: Began compiling node model.case_project.dim_customers
[0m14:18:52.278278 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.dim_customers"
[0m14:18:52.281762 [debug] [Thread-1 (]: Began executing node model.case_project.dim_customers
[0m14:18:52.288765 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.dim_customers"
[0m14:18:52.293765 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m14:18:52.294763 [debug] [Thread-1 (]: On model.case_project.dim_customers: BEGIN
[0m14:18:52.294763 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:18:52.295763 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:18:52.296763 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m14:18:52.297762 [debug] [Thread-1 (]: On model.case_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_customers"} */

  
  create view "warehouse"."main_marts"."dim_customers__dbt_tmp" as (
    with orders as (
  select customer_id, cast(ordered_at as date) as order_date, order_total/100.0 as order_total_usd
  from "warehouse"."main_staging"."stg_orders"
)
select
  c.customer_id,
  c.customer_name,
  min(o.order_date)                  as first_order_date,
  max(o.order_date)                  as last_order_date,
  count(*)                           as order_count,
  sum(o.order_total_usd)             as lifetime_value_usd
from "warehouse"."main_staging"."stg_customers" c
left join orders o using (customer_id)
group by 1,2
  );

[0m14:18:52.299764 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:18:52.356760 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m14:18:52.357760 [debug] [Thread-1 (]: On model.case_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_customers"} */
alter view "warehouse"."main_marts"."dim_customers" rename to "dim_customers__dbt_backup"
[0m14:18:52.358762 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:18:52.362765 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m14:18:52.362765 [debug] [Thread-1 (]: On model.case_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_customers"} */
alter view "warehouse"."main_marts"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m14:18:52.363765 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:18:52.365765 [debug] [Thread-1 (]: On model.case_project.dim_customers: COMMIT
[0m14:18:52.366765 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m14:18:52.366765 [debug] [Thread-1 (]: On model.case_project.dim_customers: COMMIT
[0m14:18:52.369762 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:18:52.372760 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m14:18:52.372760 [debug] [Thread-1 (]: On model.case_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_customers"} */

      drop view if exists "warehouse"."main_marts"."dim_customers__dbt_backup" cascade
    
[0m14:18:52.375653 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:18:52.377652 [debug] [Thread-1 (]: On model.case_project.dim_customers: Close
[0m14:18:52.378652 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f25e8867-1a00-4581-b2e4-ea244ee40465', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF796819C0>]}
[0m14:18:52.378652 [info ] [Thread-1 (]: 5 of 10 OK created sql view model main_marts.dim_customers ..................... [[32mOK[0m in 0.10s]
[0m14:18:52.380653 [debug] [Thread-1 (]: Finished running node model.case_project.dim_customers
[0m14:18:52.380653 [debug] [Thread-1 (]: Began running node model.case_project.fct_orders
[0m14:18:52.381653 [info ] [Thread-1 (]: 6 of 10 START sql view model main_marts.fct_orders ............................. [RUN]
[0m14:18:52.382652 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.dim_customers, now model.case_project.fct_orders)
[0m14:18:52.382652 [debug] [Thread-1 (]: Began compiling node model.case_project.fct_orders
[0m14:18:52.386652 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.fct_orders"
[0m14:18:52.391145 [debug] [Thread-1 (]: Began executing node model.case_project.fct_orders
[0m14:18:52.396155 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.fct_orders"
[0m14:18:52.400919 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m14:18:52.401924 [debug] [Thread-1 (]: On model.case_project.fct_orders: BEGIN
[0m14:18:52.401924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:18:52.402923 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:18:52.403950 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m14:18:52.404921 [debug] [Thread-1 (]: On model.case_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_orders"} */

  
  create view "warehouse"."main_marts"."fct_orders__dbt_tmp" as (
    select
  o.order_id,
  o.customer_id,
  cast(o.ordered_at as date)                              as order_date,
  strftime(date_trunc('month', o.ordered_at), '%Y-%m-01') as order_month,
  -- cents -> USD
  o.subtotal    / 100.0 as subtotal_usd,
  o.tax_paid    / 100.0 as tax_paid_usd,
  o.order_total / 100.0 as order_total_usd
from "warehouse"."main_staging"."stg_orders" as o
  );

[0m14:18:52.405952 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:18:52.409920 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m14:18:52.410949 [debug] [Thread-1 (]: On model.case_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_orders"} */
alter view "warehouse"."main_marts"."fct_orders" rename to "fct_orders__dbt_backup"
[0m14:18:52.411920 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:18:52.416949 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m14:18:52.417949 [debug] [Thread-1 (]: On model.case_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_orders"} */
alter view "warehouse"."main_marts"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m14:18:52.418921 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:18:52.420920 [debug] [Thread-1 (]: On model.case_project.fct_orders: COMMIT
[0m14:18:52.421919 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m14:18:52.421919 [debug] [Thread-1 (]: On model.case_project.fct_orders: COMMIT
[0m14:18:52.424163 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:18:52.427168 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m14:18:52.428199 [debug] [Thread-1 (]: On model.case_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_orders"} */

      drop view if exists "warehouse"."main_marts"."fct_orders__dbt_backup" cascade
    
[0m14:18:52.429854 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:18:52.431864 [debug] [Thread-1 (]: On model.case_project.fct_orders: Close
[0m14:18:52.432864 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f25e8867-1a00-4581-b2e4-ea244ee40465', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF78AD5FF0>]}
[0m14:18:52.433864 [info ] [Thread-1 (]: 6 of 10 OK created sql view model main_marts.fct_orders ........................ [[32mOK[0m in 0.05s]
[0m14:18:52.434864 [debug] [Thread-1 (]: Finished running node model.case_project.fct_orders
[0m14:18:52.435891 [debug] [Thread-1 (]: Began running node model.case_project.fct_order_items
[0m14:18:52.436859 [info ] [Thread-1 (]: 7 of 10 START sql view model main_marts.fct_order_items ........................ [RUN]
[0m14:18:52.437861 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.fct_orders, now model.case_project.fct_order_items)
[0m14:18:52.438864 [debug] [Thread-1 (]: Began compiling node model.case_project.fct_order_items
[0m14:18:52.442864 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.fct_order_items"
[0m14:18:52.446861 [debug] [Thread-1 (]: Began executing node model.case_project.fct_order_items
[0m14:18:52.452861 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.fct_order_items"
[0m14:18:52.457876 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_order_items"
[0m14:18:52.457876 [debug] [Thread-1 (]: On model.case_project.fct_order_items: BEGIN
[0m14:18:52.458905 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:18:52.459877 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:18:52.459877 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_order_items"
[0m14:18:52.460907 [debug] [Thread-1 (]: On model.case_project.fct_order_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_order_items"} */

  
  create view "warehouse"."main_marts"."fct_order_items__dbt_tmp" as (
    with items as (
  select i.order_id, i.product_id, coalesce(i.quantity, 1) as quantity
  from "warehouse"."main_staging"."stg_items" i
),
orders as (
  select order_id, customer_id,
         cast(ordered_at as date) as order_date,
         strftime(date_trunc('month', ordered_at), '%Y-%m-01') as order_month
  from "warehouse"."main_staging"."stg_orders"
),
products as (
  select
    p.product_id,
    p.product_name,
    p.price / 100.0 as unit_price_usd,              -- cents -> USD
    case when p.product_id like 'BEV%' then 'drinks'
         when p.product_id like 'JAF%' then 'sandwiches'
         else 'other'
    end as product_category
  from "warehouse"."main_staging"."stg_products" p
)
select
  o.order_id,
  o.customer_id,
  o.order_date,
  o.order_month,
  pr.product_id,
  pr.product_name,
  pr.product_category,
  it.quantity,
  pr.unit_price_usd,
  it.quantity * pr.unit_price_usd as line_revenue_usd
from items it
join orders  o  using (order_id)
join products pr using (product_id)
  );

[0m14:18:52.461906 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:18:52.466874 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_order_items"
[0m14:18:52.467877 [debug] [Thread-1 (]: On model.case_project.fct_order_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_order_items"} */
alter view "warehouse"."main_marts"."fct_order_items" rename to "fct_order_items__dbt_backup"
[0m14:18:52.468878 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:18:52.472874 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_order_items"
[0m14:18:52.472874 [debug] [Thread-1 (]: On model.case_project.fct_order_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_order_items"} */
alter view "warehouse"."main_marts"."fct_order_items__dbt_tmp" rename to "fct_order_items"
[0m14:18:52.473876 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:18:52.475874 [debug] [Thread-1 (]: On model.case_project.fct_order_items: COMMIT
[0m14:18:52.476873 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_order_items"
[0m14:18:52.477873 [debug] [Thread-1 (]: On model.case_project.fct_order_items: COMMIT
[0m14:18:52.479873 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:18:52.482873 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_order_items"
[0m14:18:52.483873 [debug] [Thread-1 (]: On model.case_project.fct_order_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_order_items"} */

      drop view if exists "warehouse"."main_marts"."fct_order_items__dbt_backup" cascade
    
[0m14:18:52.484875 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:18:52.486875 [debug] [Thread-1 (]: On model.case_project.fct_order_items: Close
[0m14:18:52.487873 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f25e8867-1a00-4581-b2e4-ea244ee40465', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF7D1DF670>]}
[0m14:18:52.488874 [info ] [Thread-1 (]: 7 of 10 OK created sql view model main_marts.fct_order_items ................... [[32mOK[0m in 0.05s]
[0m14:18:52.489902 [debug] [Thread-1 (]: Finished running node model.case_project.fct_order_items
[0m14:18:52.489902 [debug] [Thread-1 (]: Began running node model.case_project.customer_pareto
[0m14:18:52.490905 [info ] [Thread-1 (]: 8 of 10 START sql view model main_marts.customer_pareto ........................ [RUN]
[0m14:18:52.491882 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.fct_order_items, now model.case_project.customer_pareto)
[0m14:18:52.492907 [debug] [Thread-1 (]: Began compiling node model.case_project.customer_pareto
[0m14:18:52.497906 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.customer_pareto"
[0m14:18:52.502325 [debug] [Thread-1 (]: Began executing node model.case_project.customer_pareto
[0m14:18:52.507323 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.customer_pareto"
[0m14:18:52.511683 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.customer_pareto"
[0m14:18:52.512685 [debug] [Thread-1 (]: On model.case_project.customer_pareto: BEGIN
[0m14:18:52.512685 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:18:52.513682 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:18:52.514687 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.customer_pareto"
[0m14:18:52.514687 [debug] [Thread-1 (]: On model.case_project.customer_pareto: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.customer_pareto"} */

  
  create view "warehouse"."main_marts"."customer_pareto__dbt_tmp" as (
    -- models/marts/customer_pareto.sql
with ltv as (
  select
    customer_id,
    sum(order_total) as lifetime_value
  from "warehouse"."main_marts"."fct_orders"
  group by 1
),
ranked as (
  select
    customer_id,
    lifetime_value,
    rank() over (order by lifetime_value desc) as rnk,
    count(*) over () as total_customers,
    sum(lifetime_value) over () as total_revenue,
    sum(lifetime_value) over (
      order by lifetime_value desc
      rows between unbounded preceding and current row
    ) as cum_revenue
  from ltv
)
select
  customer_id,
  lifetime_value,
  rnk,
  cast(rnk as double)/total_customers  as customer_pct,
  cum_revenue / nullif(total_revenue,0) as revenue_cum_pct
from ranked
order by rnk
  );

[0m14:18:52.526421 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.customer_pareto"} */

  
  create view "warehouse"."main_marts"."customer_pareto__dbt_tmp" as (
    -- models/marts/customer_pareto.sql
with ltv as (
  select
    customer_id,
    sum(order_total) as lifetime_value
  from "warehouse"."main_marts"."fct_orders"
  group by 1
),
ranked as (
  select
    customer_id,
    lifetime_value,
    rank() over (order by lifetime_value desc) as rnk,
    count(*) over () as total_customers,
    sum(lifetime_value) over () as total_revenue,
    sum(lifetime_value) over (
      order by lifetime_value desc
      rows between unbounded preceding and current row
    ) as cum_revenue
  from ltv
)
select
  customer_id,
  lifetime_value,
  rnk,
  cast(rnk as double)/total_customers  as customer_pct,
  cum_revenue / nullif(total_revenue,0) as revenue_cum_pct
from ranked
order by rnk
  );

[0m14:18:52.526421 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m14:18:52.527421 [debug] [Thread-1 (]: On model.case_project.customer_pareto: ROLLBACK
[0m14:18:52.538474 [debug] [Thread-1 (]: Failed to rollback 'model.case_project.customer_pareto'
[0m14:18:52.539471 [debug] [Thread-1 (]: On model.case_project.customer_pareto: Close
[0m14:18:52.541473 [debug] [Thread-1 (]: Runtime Error in model customer_pareto (models\marts\customer_pareto.sql)
  Binder Error: Referenced column "order_total" not found in FROM clause!
  Candidate bindings: "order_total_usd", "order_date", "order_month", "order_id", "subtotal_usd"
  
  LINE 9:     sum(order_total) as lifetime_value
                  ^
[0m14:18:52.541473 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f25e8867-1a00-4581-b2e4-ea244ee40465', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF7D134940>]}
[0m14:18:52.542472 [error] [Thread-1 (]: 8 of 10 ERROR creating sql view model main_marts.customer_pareto ............... [[31mERROR[0m in 0.05s]
[0m14:18:52.543471 [debug] [Thread-1 (]: Finished running node model.case_project.customer_pareto
[0m14:18:52.544473 [debug] [Thread-1 (]: Began running node model.case_project.orders_fact
[0m14:18:52.545473 [debug] [Thread-4 (]: Marking all children of 'model.case_project.customer_pareto' to be skipped because of status 'error'.  Reason: Runtime Error in model customer_pareto (models\marts\customer_pareto.sql)
  Binder Error: Referenced column "order_total" not found in FROM clause!
  Candidate bindings: "order_total_usd", "order_date", "order_month", "order_id", "subtotal_usd"
  
  LINE 9:     sum(order_total) as lifetime_value
                  ^.
[0m14:18:52.545473 [info ] [Thread-1 (]: 9 of 10 START sql view model main_marts.orders_fact ............................ [RUN]
[0m14:18:52.547472 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.customer_pareto, now model.case_project.orders_fact)
[0m14:18:52.548473 [debug] [Thread-1 (]: Began compiling node model.case_project.orders_fact
[0m14:18:52.551472 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.orders_fact"
[0m14:18:52.556473 [debug] [Thread-1 (]: Began executing node model.case_project.orders_fact
[0m14:18:52.561471 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.orders_fact"
[0m14:18:52.565475 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.orders_fact"
[0m14:18:52.566474 [debug] [Thread-1 (]: On model.case_project.orders_fact: BEGIN
[0m14:18:52.567503 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:18:52.568474 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:18:52.568474 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.orders_fact"
[0m14:18:52.569503 [debug] [Thread-1 (]: On model.case_project.orders_fact: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.orders_fact"} */

  
  create view "warehouse"."main_marts"."orders_fact__dbt_tmp" as (
    with orders as (
  select
    order_id, customer_id, order_date, order_month,
    order_total_usd as order_revenue_usd
  from "warehouse"."main_marts"."fct_orders"
),
first_order as (
  select customer_id, min(order_date) as first_order_date
  from orders
  group by 1
)
select
  o.order_id,
  o.customer_id,
  o.order_date,
  o.order_month,
  o.order_revenue_usd,
  case when o.order_date = f.first_order_date then true else false end as is_first_order,
  case when o.order_date = f.first_order_date then 'new' else 'repeat' end as customer_cohort
from orders o
join first_order f using (customer_id)
  );

[0m14:18:52.571473 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:18:52.575472 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.orders_fact"
[0m14:18:52.576474 [debug] [Thread-1 (]: On model.case_project.orders_fact: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.orders_fact"} */
alter view "warehouse"."main_marts"."orders_fact" rename to "orders_fact__dbt_backup"
[0m14:18:52.577475 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:18:52.581472 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.orders_fact"
[0m14:18:52.582472 [debug] [Thread-1 (]: On model.case_project.orders_fact: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.orders_fact"} */
alter view "warehouse"."main_marts"."orders_fact__dbt_tmp" rename to "orders_fact"
[0m14:18:52.583479 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:18:52.585473 [debug] [Thread-1 (]: On model.case_project.orders_fact: COMMIT
[0m14:18:52.586472 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.orders_fact"
[0m14:18:52.586472 [debug] [Thread-1 (]: On model.case_project.orders_fact: COMMIT
[0m14:18:52.588472 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:18:52.592475 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.orders_fact"
[0m14:18:52.592475 [debug] [Thread-1 (]: On model.case_project.orders_fact: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.orders_fact"} */

      drop view if exists "warehouse"."main_marts"."orders_fact__dbt_backup" cascade
    
[0m14:18:52.594965 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:18:52.595977 [debug] [Thread-1 (]: On model.case_project.orders_fact: Close
[0m14:18:52.596977 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f25e8867-1a00-4581-b2e4-ea244ee40465', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF7C110850>]}
[0m14:18:52.597976 [info ] [Thread-1 (]: 9 of 10 OK created sql view model main_marts.orders_fact ....................... [[32mOK[0m in 0.05s]
[0m14:18:52.598975 [debug] [Thread-1 (]: Finished running node model.case_project.orders_fact
[0m14:18:52.599977 [debug] [Thread-1 (]: Began running node model.case_project.monthly_summary
[0m14:18:52.600976 [info ] [Thread-1 (]: 10 of 10 START sql view model main_marts.monthly_summary ....................... [RUN]
[0m14:18:52.601976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.orders_fact, now model.case_project.monthly_summary)
[0m14:18:52.601976 [debug] [Thread-1 (]: Began compiling node model.case_project.monthly_summary
[0m14:18:52.606976 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.monthly_summary"
[0m14:18:52.611977 [debug] [Thread-1 (]: Began executing node model.case_project.monthly_summary
[0m14:18:52.616976 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.monthly_summary"
[0m14:18:52.621976 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.monthly_summary"
[0m14:18:52.621976 [debug] [Thread-1 (]: On model.case_project.monthly_summary: BEGIN
[0m14:18:52.622977 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:18:52.623976 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:18:52.623976 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.monthly_summary"
[0m14:18:52.624977 [debug] [Thread-1 (]: On model.case_project.monthly_summary: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.monthly_summary"} */

  
  create view "warehouse"."main_marts"."monthly_summary__dbt_tmp" as (
    with base as (
  select order_id, customer_id, order_date, order_month, order_revenue_usd
  from "warehouse"."main_marts"."orders_fact"
),
labeled as (
  select b.*,
         case when order_date = min(order_date) over (partition by customer_id) then 1 else 0 end as is_new_order
  from base b
)
select
  order_month,
  sum(order_revenue_usd)                                as monthly_revenue_usd,
  count(distinct order_id)                              as monthly_orders,
  count(distinct customer_id)                           as active_customers,
  sum(order_revenue_usd) / nullif(count(distinct order_id),0) as aov_usd,
  sum(is_new_order)                                     as new_customers,
  (count(distinct customer_id) - sum(is_new_order))     as repeat_customers,
  (count(distinct customer_id) - sum(is_new_order)) * 1.0
    / nullif(count(distinct customer_id),0)             as repeat_purchase_rate
from labeled
group by 1
order by 1
  );

[0m14:18:52.627977 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:18:52.631976 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.monthly_summary"
[0m14:18:52.632977 [debug] [Thread-1 (]: On model.case_project.monthly_summary: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.monthly_summary"} */
alter view "warehouse"."main_marts"."monthly_summary" rename to "monthly_summary__dbt_backup"
[0m14:18:52.633976 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:18:52.637976 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.monthly_summary"
[0m14:18:52.638976 [debug] [Thread-1 (]: On model.case_project.monthly_summary: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.monthly_summary"} */
alter view "warehouse"."main_marts"."monthly_summary__dbt_tmp" rename to "monthly_summary"
[0m14:18:52.639977 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:18:52.641976 [debug] [Thread-1 (]: On model.case_project.monthly_summary: COMMIT
[0m14:18:52.641976 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.monthly_summary"
[0m14:18:52.642977 [debug] [Thread-1 (]: On model.case_project.monthly_summary: COMMIT
[0m14:18:52.644975 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:18:52.647976 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.monthly_summary"
[0m14:18:52.648976 [debug] [Thread-1 (]: On model.case_project.monthly_summary: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.monthly_summary"} */

      drop view if exists "warehouse"."main_marts"."monthly_summary__dbt_backup" cascade
    
[0m14:18:52.650262 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:18:52.652267 [debug] [Thread-1 (]: On model.case_project.monthly_summary: Close
[0m14:18:52.653270 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f25e8867-1a00-4581-b2e4-ea244ee40465', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF78AD5FF0>]}
[0m14:18:52.654270 [info ] [Thread-1 (]: 10 of 10 OK created sql view model main_marts.monthly_summary .................. [[32mOK[0m in 0.05s]
[0m14:18:52.655271 [debug] [Thread-1 (]: Finished running node model.case_project.monthly_summary
[0m14:18:52.656267 [debug] [MainThread]: Using duckdb connection "master"
[0m14:18:52.657269 [debug] [MainThread]: On master: BEGIN
[0m14:18:52.657269 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:18:52.658267 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:18:52.658267 [debug] [MainThread]: On master: COMMIT
[0m14:18:52.659268 [debug] [MainThread]: Using duckdb connection "master"
[0m14:18:52.659268 [debug] [MainThread]: On master: COMMIT
[0m14:18:52.660268 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:18:52.661267 [debug] [MainThread]: On master: Close
[0m14:18:52.661267 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:18:52.662267 [debug] [MainThread]: Connection 'create_warehouse_main_staging' was properly closed.
[0m14:18:52.662267 [debug] [MainThread]: Connection 'list_warehouse_main_raw' was properly closed.
[0m14:18:52.663267 [debug] [MainThread]: Connection 'model.case_project.monthly_summary' was properly closed.
[0m14:18:52.663267 [info ] [MainThread]: 
[0m14:18:52.664267 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 1.08 seconds (1.08s).
[0m14:18:52.667265 [debug] [MainThread]: Command end result
[0m14:18:52.760827 [debug] [MainThread]: Wrote artifact WritableManifest to D:\projects\Case Project main\target\manifest.json
[0m14:18:52.767829 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\projects\Case Project main\target\semantic_manifest.json
[0m14:18:52.780124 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\projects\Case Project main\target\run_results.json
[0m14:18:52.781126 [info ] [MainThread]: 
[0m14:18:52.781126 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:18:52.782126 [info ] [MainThread]: 
[0m14:18:52.783125 [error] [MainThread]: [31mFailure in model customer_pareto (models\marts\customer_pareto.sql)[0m
[0m14:18:52.783125 [error] [MainThread]:   Runtime Error in model customer_pareto (models\marts\customer_pareto.sql)
  Binder Error: Referenced column "order_total" not found in FROM clause!
  Candidate bindings: "order_total_usd", "order_date", "order_month", "order_id", "subtotal_usd"
  
  LINE 9:     sum(order_total) as lifetime_value
                  ^
[0m14:18:52.784125 [info ] [MainThread]: 
[0m14:18:52.785127 [info ] [MainThread]:   compiled code at target\compiled\case_project\models\marts\customer_pareto.sql
[0m14:18:52.785127 [info ] [MainThread]: 
[0m14:18:52.786126 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=10
[0m14:18:52.787126 [debug] [MainThread]: Command `dbt run` failed at 14:18:52.787126 after 3.40 seconds
[0m14:18:52.788127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF797D3220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF7BBDC790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF7D382890>]}
[0m14:18:52.788127 [debug] [MainThread]: Flushing usage events
[0m14:18:53.630376 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:20:44.517465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BB53E3220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BB76D3D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BB76D3F70>]}


============================== 14:20:44.523747 | 9dee4be4-6e56-4e28-aed3-211074008c27 ==============================
[0m14:20:44.523747 [info ] [MainThread]: Running with dbt=1.10.9
[0m14:20:44.523747 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'log_path': 'D:\\projects\\Case Project main\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'D:\\projects\\Case Project main', 'static_parser': 'True', 'write_json': 'True'}
[0m14:20:44.810352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9dee4be4-6e56-4e28-aed3-211074008c27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BB77EFCA0>]}
[0m14:20:44.889352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9dee4be4-6e56-4e28-aed3-211074008c27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BB76D1FC0>]}
[0m14:20:44.892834 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:20:45.242763 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m14:20:45.550212 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:20:45.551212 [debug] [MainThread]: Partial parsing: updated file: case_project://models\marts\customer_pareto.sql
[0m14:20:46.172005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9dee4be4-6e56-4e28-aed3-211074008c27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BB8F80A90>]}
[0m14:20:46.379308 [debug] [MainThread]: Wrote artifact WritableManifest to D:\projects\Case Project main\target\manifest.json
[0m14:20:46.385399 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\projects\Case Project main\target\semantic_manifest.json
[0m14:20:46.421406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9dee4be4-6e56-4e28-aed3-211074008c27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BB8F72620>]}
[0m14:20:46.421406 [info ] [MainThread]: Found 10 models, 4 seeds, 37 data tests, 4 sources, 429 macros
[0m14:20:46.422407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9dee4be4-6e56-4e28-aed3-211074008c27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BB8F725C0>]}
[0m14:20:46.425406 [info ] [MainThread]: 
[0m14:20:46.426405 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:20:46.427407 [info ] [MainThread]: 
[0m14:20:46.427407 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:20:46.436402 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m14:20:46.648577 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m14:20:46.649576 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m14:20:46.649576 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:20:46.674578 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m14:20:46.676579 [debug] [ThreadPool]: On list_warehouse: Close
[0m14:20:46.679577 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m14:20:46.680577 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m14:20:46.680577 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:20:46.681578 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:20:46.683579 [debug] [ThreadPool]: On list_warehouse: Close
[0m14:20:46.684557 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_marts)
[0m14:20:46.684557 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_marts"
"
[0m14:20:46.693562 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m14:20:46.693562 [debug] [ThreadPool]: On create_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_marts"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m14:20:46.694566 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:20:46.695564 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:20:46.697564 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m14:20:46.697564 [debug] [ThreadPool]: On create_warehouse_main_marts: BEGIN
[0m14:20:46.698564 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:20:46.699569 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m14:20:46.699569 [debug] [ThreadPool]: On create_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_marts"} */

    
    
        create schema if not exists "warehouse"."main_marts"
    
[0m14:20:46.700567 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:20:46.701568 [debug] [ThreadPool]: On create_warehouse_main_marts: COMMIT
[0m14:20:46.702568 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m14:20:46.702568 [debug] [ThreadPool]: On create_warehouse_main_marts: COMMIT
[0m14:20:46.703569 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:20:46.703569 [debug] [ThreadPool]: On create_warehouse_main_marts: Close
[0m14:20:46.704568 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_warehouse_main_marts, now create_warehouse_main_staging)
[0m14:20:46.705567 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_staging"
"
[0m14:20:46.708567 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m14:20:46.709567 [debug] [ThreadPool]: On create_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m14:20:46.709567 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:20:46.710569 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:20:46.712594 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m14:20:46.712594 [debug] [ThreadPool]: On create_warehouse_main_staging: BEGIN
[0m14:20:46.713564 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:20:46.714566 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m14:20:46.714566 [debug] [ThreadPool]: On create_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_staging"} */

    
    
        create schema if not exists "warehouse"."main_staging"
    
[0m14:20:46.715564 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:20:46.716563 [debug] [ThreadPool]: On create_warehouse_main_staging: COMMIT
[0m14:20:46.717563 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m14:20:46.717563 [debug] [ThreadPool]: On create_warehouse_main_staging: COMMIT
[0m14:20:46.718564 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:20:46.719564 [debug] [ThreadPool]: On create_warehouse_main_staging: Close
[0m14:20:46.721595 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_raw'
[0m14:20:46.729563 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m14:20:46.729563 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m14:20:46.730564 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:20:46.731564 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:20:46.732563 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m14:20:46.732563 [debug] [ThreadPool]: On list_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_raw"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'warehouse'
  
[0m14:20:46.746561 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m14:20:46.748564 [debug] [ThreadPool]: On list_warehouse_main_raw: ROLLBACK
[0m14:20:46.750564 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_raw'
[0m14:20:46.750564 [debug] [ThreadPool]: On list_warehouse_main_raw: Close
[0m14:20:46.751564 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_raw, now list_warehouse_main_marts)
[0m14:20:46.756563 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m14:20:46.757564 [debug] [ThreadPool]: On list_warehouse_main_marts: BEGIN
[0m14:20:46.757564 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:20:46.758563 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:20:46.758563 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m14:20:46.759563 [debug] [ThreadPool]: On list_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_marts"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'warehouse'
  
[0m14:20:46.762563 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m14:20:46.764563 [debug] [ThreadPool]: On list_warehouse_main_marts: ROLLBACK
[0m14:20:46.765564 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_marts'
[0m14:20:46.766563 [debug] [ThreadPool]: On list_warehouse_main_marts: Close
[0m14:20:46.766563 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_marts, now list_warehouse_main_staging)
[0m14:20:46.771563 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_staging"
[0m14:20:46.772562 [debug] [ThreadPool]: On list_warehouse_main_staging: BEGIN
[0m14:20:46.772562 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:20:46.773564 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:20:46.774564 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_staging"
[0m14:20:46.774564 [debug] [ThreadPool]: On list_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_staging"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'warehouse'
  
[0m14:20:46.778565 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m14:20:46.779564 [debug] [ThreadPool]: On list_warehouse_main_staging: ROLLBACK
[0m14:20:46.780563 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_staging'
[0m14:20:46.781563 [debug] [ThreadPool]: On list_warehouse_main_staging: Close
[0m14:20:46.782565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9dee4be4-6e56-4e28-aed3-211074008c27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BB776AEF0>]}
[0m14:20:46.783564 [debug] [MainThread]: Using duckdb connection "master"
[0m14:20:46.783564 [debug] [MainThread]: On master: BEGIN
[0m14:20:46.784563 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:20:46.785563 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:20:46.785563 [debug] [MainThread]: On master: COMMIT
[0m14:20:46.786563 [debug] [MainThread]: Using duckdb connection "master"
[0m14:20:46.786563 [debug] [MainThread]: On master: COMMIT
[0m14:20:46.787563 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:20:46.787563 [debug] [MainThread]: On master: Close
[0m14:20:46.792563 [debug] [Thread-1 (]: Began running node model.case_project.stg_customers
[0m14:20:46.793564 [info ] [Thread-1 (]: 1 of 10 START sql view model main_staging.stg_customers ........................ [RUN]
[0m14:20:46.794565 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.case_project.stg_customers'
[0m14:20:46.794565 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_customers
[0m14:20:46.804563 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_customers"
[0m14:20:46.810568 [debug] [Thread-1 (]: Began executing node model.case_project.stg_customers
[0m14:20:46.849562 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_customers"
[0m14:20:46.854015 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m14:20:46.855021 [debug] [Thread-1 (]: On model.case_project.stg_customers: BEGIN
[0m14:20:46.855021 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:20:46.856021 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:20:46.857021 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m14:20:46.857021 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */

  
  create view "warehouse"."main_staging"."stg_customers__dbt_tmp" as (
    -- models/staging/stg_customers.sql
with src as (select * from "warehouse"."main_raw"."raw_customers")
select
  cast(id as varchar) as customer_id,
  trim(name) as customer_name
from src
  );

[0m14:20:46.858020 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:20:46.866019 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m14:20:46.867021 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */
alter view "warehouse"."main_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m14:20:46.868021 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:20:46.872019 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m14:20:46.873022 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */
alter view "warehouse"."main_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m14:20:46.874023 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:20:46.892020 [debug] [Thread-1 (]: On model.case_project.stg_customers: COMMIT
[0m14:20:46.893021 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m14:20:46.893021 [debug] [Thread-1 (]: On model.case_project.stg_customers: COMMIT
[0m14:20:46.899021 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m14:20:46.907019 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m14:20:46.907523 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */

      drop view if exists "warehouse"."main_staging"."stg_customers__dbt_backup" cascade
    
[0m14:20:46.909815 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:20:46.912821 [debug] [Thread-1 (]: On model.case_project.stg_customers: Close
[0m14:20:46.915819 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9dee4be4-6e56-4e28-aed3-211074008c27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BB41402B0>]}
[0m14:20:46.916824 [info ] [Thread-1 (]: 1 of 10 OK created sql view model main_staging.stg_customers ................... [[32mOK[0m in 0.12s]
[0m14:20:46.917824 [debug] [Thread-1 (]: Finished running node model.case_project.stg_customers
[0m14:20:46.918824 [debug] [Thread-1 (]: Began running node model.case_project.stg_items
[0m14:20:46.919823 [info ] [Thread-1 (]: 2 of 10 START sql view model main_staging.stg_items ............................ [RUN]
[0m14:20:46.919823 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_customers, now model.case_project.stg_items)
[0m14:20:46.920824 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_items
[0m14:20:46.924823 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_items"
[0m14:20:46.928838 [debug] [Thread-1 (]: Began executing node model.case_project.stg_items
[0m14:20:46.934840 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_items"
[0m14:20:46.938838 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m14:20:46.939841 [debug] [Thread-1 (]: On model.case_project.stg_items: BEGIN
[0m14:20:46.940837 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:20:46.941841 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:20:46.941841 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m14:20:46.942838 [debug] [Thread-1 (]: On model.case_project.stg_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_items"} */

  
  create view "warehouse"."main_staging"."stg_items__dbt_tmp" as (
    with src as (
  select * from "warehouse"."main_raw"."raw_items"
)
select
  cast(order_id as varchar) as order_id,  -- FK to orders
  cast(sku      as varchar) as product_id, 
  1                           as quantity  -- Assumption: one row = one item
from src
  );

[0m14:20:46.943841 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:20:46.948840 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m14:20:46.949841 [debug] [Thread-1 (]: On model.case_project.stg_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_items"} */
alter view "warehouse"."main_staging"."stg_items" rename to "stg_items__dbt_backup"
[0m14:20:46.949841 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:20:46.954840 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m14:20:46.955841 [debug] [Thread-1 (]: On model.case_project.stg_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_items"} */
alter view "warehouse"."main_staging"."stg_items__dbt_tmp" rename to "stg_items"
[0m14:20:46.956841 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:20:46.958841 [debug] [Thread-1 (]: On model.case_project.stg_items: COMMIT
[0m14:20:46.958841 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m14:20:46.959842 [debug] [Thread-1 (]: On model.case_project.stg_items: COMMIT
[0m14:20:46.961837 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:20:46.965840 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m14:20:46.966841 [debug] [Thread-1 (]: On model.case_project.stg_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_items"} */

      drop view if exists "warehouse"."main_staging"."stg_items__dbt_backup" cascade
    
[0m14:20:46.968839 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:20:46.969841 [debug] [Thread-1 (]: On model.case_project.stg_items: Close
[0m14:20:46.970841 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9dee4be4-6e56-4e28-aed3-211074008c27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BB7D338B0>]}
[0m14:20:46.971841 [info ] [Thread-1 (]: 2 of 10 OK created sql view model main_staging.stg_items ....................... [[32mOK[0m in 0.05s]
[0m14:20:46.973839 [debug] [Thread-1 (]: Finished running node model.case_project.stg_items
[0m14:20:46.973839 [debug] [Thread-1 (]: Began running node model.case_project.stg_orders
[0m14:20:46.974838 [info ] [Thread-1 (]: 3 of 10 START sql view model main_staging.stg_orders ........................... [RUN]
[0m14:20:46.975840 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_items, now model.case_project.stg_orders)
[0m14:20:46.975840 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_orders
[0m14:20:46.981840 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_orders"
[0m14:20:46.985782 [debug] [Thread-1 (]: Began executing node model.case_project.stg_orders
[0m14:20:46.990791 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_orders"
[0m14:20:46.994789 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m14:20:46.995792 [debug] [Thread-1 (]: On model.case_project.stg_orders: BEGIN
[0m14:20:46.996792 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:20:46.997791 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:20:46.997791 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m14:20:46.998792 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */

  
  create view "warehouse"."main_staging"."stg_orders__dbt_tmp" as (
    with src as (
  select * from "warehouse"."main_raw"."raw_orders"
)
select
  cast(id as varchar)                 as order_id,
  cast(customer as varchar)           as customer_id,
  cast(store_id as varchar)           as store_id,
  cast(ordered_at as timestamp)       as ordered_at,
  cast(subtotal as decimal(10,2))            as subtotal,
  cast(tax_paid as decimal(10,2))            as tax_paid,
  cast(order_total as decimal(10,2))         as order_total
from src
  );

[0m14:20:46.999788 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:20:47.004791 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m14:20:47.005792 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */
alter view "warehouse"."main_staging"."stg_orders" rename to "stg_orders__dbt_backup"
[0m14:20:47.006792 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:20:47.010791 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m14:20:47.010791 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */
alter view "warehouse"."main_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m14:20:47.011788 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:20:47.013792 [debug] [Thread-1 (]: On model.case_project.stg_orders: COMMIT
[0m14:20:47.014791 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m14:20:47.015790 [debug] [Thread-1 (]: On model.case_project.stg_orders: COMMIT
[0m14:20:47.017790 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:20:47.021791 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m14:20:47.021791 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */

      drop view if exists "warehouse"."main_staging"."stg_orders__dbt_backup" cascade
    
[0m14:20:47.023788 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:20:47.025789 [debug] [Thread-1 (]: On model.case_project.stg_orders: Close
[0m14:20:47.026791 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9dee4be4-6e56-4e28-aed3-211074008c27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BB7D328C0>]}
[0m14:20:47.027791 [info ] [Thread-1 (]: 3 of 10 OK created sql view model main_staging.stg_orders ...................... [[32mOK[0m in 0.05s]
[0m14:20:47.029789 [debug] [Thread-1 (]: Finished running node model.case_project.stg_orders
[0m14:20:47.029789 [debug] [Thread-1 (]: Began running node model.case_project.stg_products
[0m14:20:47.030787 [info ] [Thread-1 (]: 4 of 10 START sql view model main_staging.stg_products ......................... [RUN]
[0m14:20:47.031787 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_orders, now model.case_project.stg_products)
[0m14:20:47.032789 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_products
[0m14:20:47.036788 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_products"
[0m14:20:47.040788 [debug] [Thread-1 (]: Began executing node model.case_project.stg_products
[0m14:20:47.045788 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_products"
[0m14:20:47.050788 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m14:20:47.050788 [debug] [Thread-1 (]: On model.case_project.stg_products: BEGIN
[0m14:20:47.051787 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:20:47.052790 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:20:47.053790 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m14:20:47.053790 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */

  
  create view "warehouse"."main_staging"."stg_products__dbt_tmp" as (
    -- models/staging/stg_products.sql
with src as (select * from "warehouse"."main_raw"."raw_products")
select
  cast(sku as varchar)      as product_id,
  trim(name)                as product_name, 
  cast(price as decimal(10,2))    as price
from src
  );

[0m14:20:47.054788 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:20:47.060791 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m14:20:47.061792 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */
alter view "warehouse"."main_staging"."stg_products" rename to "stg_products__dbt_backup"
[0m14:20:47.062791 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:20:47.066790 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m14:20:47.067792 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */
alter view "warehouse"."main_staging"."stg_products__dbt_tmp" rename to "stg_products"
[0m14:20:47.068793 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:20:47.070789 [debug] [Thread-1 (]: On model.case_project.stg_products: COMMIT
[0m14:20:47.071787 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m14:20:47.071787 [debug] [Thread-1 (]: On model.case_project.stg_products: COMMIT
[0m14:20:47.073787 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:20:47.077788 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m14:20:47.078788 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */

      drop view if exists "warehouse"."main_staging"."stg_products__dbt_backup" cascade
    
[0m14:20:47.080947 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:20:47.082960 [debug] [Thread-1 (]: On model.case_project.stg_products: Close
[0m14:20:47.083957 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9dee4be4-6e56-4e28-aed3-211074008c27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BB52919C0>]}
[0m14:20:47.084960 [info ] [Thread-1 (]: 4 of 10 OK created sql view model main_staging.stg_products .................... [[32mOK[0m in 0.05s]
[0m14:20:47.084960 [debug] [Thread-1 (]: Finished running node model.case_project.stg_products
[0m14:20:47.085960 [debug] [Thread-1 (]: Began running node model.case_project.dim_customers
[0m14:20:47.086958 [info ] [Thread-1 (]: 5 of 10 START sql view model main_marts.dim_customers .......................... [RUN]
[0m14:20:47.087639 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_products, now model.case_project.dim_customers)
[0m14:20:47.088648 [debug] [Thread-1 (]: Began compiling node model.case_project.dim_customers
[0m14:20:47.092643 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.dim_customers"
[0m14:20:47.096645 [debug] [Thread-1 (]: Began executing node model.case_project.dim_customers
[0m14:20:47.102648 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.dim_customers"
[0m14:20:47.106823 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m14:20:47.106823 [debug] [Thread-1 (]: On model.case_project.dim_customers: BEGIN
[0m14:20:47.107832 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:20:47.108832 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:20:47.108832 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m14:20:47.109832 [debug] [Thread-1 (]: On model.case_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_customers"} */

  
  create view "warehouse"."main_marts"."dim_customers__dbt_tmp" as (
    with orders as (
  select customer_id, cast(ordered_at as date) as order_date, order_total/100.0 as order_total_usd
  from "warehouse"."main_staging"."stg_orders"
)
select
  c.customer_id,
  c.customer_name,
  min(o.order_date)                  as first_order_date,
  max(o.order_date)                  as last_order_date,
  count(*)                           as order_count,
  sum(o.order_total_usd)             as lifetime_value_usd
from "warehouse"."main_staging"."stg_customers" c
left join orders o using (customer_id)
group by 1,2
  );

[0m14:20:47.111831 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:20:47.115828 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m14:20:47.116828 [debug] [Thread-1 (]: On model.case_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_customers"} */
alter view "warehouse"."main_marts"."dim_customers" rename to "dim_customers__dbt_backup"
[0m14:20:47.117829 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:20:47.121829 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m14:20:47.122829 [debug] [Thread-1 (]: On model.case_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_customers"} */
alter view "warehouse"."main_marts"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m14:20:47.123830 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:20:47.125827 [debug] [Thread-1 (]: On model.case_project.dim_customers: COMMIT
[0m14:20:47.126829 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m14:20:47.126829 [debug] [Thread-1 (]: On model.case_project.dim_customers: COMMIT
[0m14:20:47.128910 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:20:47.184946 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m14:20:47.185918 [debug] [Thread-1 (]: On model.case_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_customers"} */

      drop view if exists "warehouse"."main_marts"."dim_customers__dbt_backup" cascade
    
[0m14:20:47.187263 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:20:47.189267 [debug] [Thread-1 (]: On model.case_project.dim_customers: Close
[0m14:20:47.190269 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9dee4be4-6e56-4e28-aed3-211074008c27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BB41402B0>]}
[0m14:20:47.191266 [info ] [Thread-1 (]: 5 of 10 OK created sql view model main_marts.dim_customers ..................... [[32mOK[0m in 0.10s]
[0m14:20:47.192268 [debug] [Thread-1 (]: Finished running node model.case_project.dim_customers
[0m14:20:47.193269 [debug] [Thread-1 (]: Began running node model.case_project.fct_orders
[0m14:20:47.194269 [info ] [Thread-1 (]: 6 of 10 START sql view model main_marts.fct_orders ............................. [RUN]
[0m14:20:47.194269 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.dim_customers, now model.case_project.fct_orders)
[0m14:20:47.195268 [debug] [Thread-1 (]: Began compiling node model.case_project.fct_orders
[0m14:20:47.199268 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.fct_orders"
[0m14:20:47.203268 [debug] [Thread-1 (]: Began executing node model.case_project.fct_orders
[0m14:20:47.208272 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.fct_orders"
[0m14:20:47.212275 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m14:20:47.213269 [debug] [Thread-1 (]: On model.case_project.fct_orders: BEGIN
[0m14:20:47.214268 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:20:47.215269 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:20:47.215269 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m14:20:47.216273 [debug] [Thread-1 (]: On model.case_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_orders"} */

  
  create view "warehouse"."main_marts"."fct_orders__dbt_tmp" as (
    select
  o.order_id,
  o.customer_id,
  cast(o.ordered_at as date)                              as order_date,
  strftime(date_trunc('month', o.ordered_at), '%Y-%m-01') as order_month,
  -- cents -> USD
  o.subtotal    / 100.0 as subtotal_usd,
  o.tax_paid    / 100.0 as tax_paid_usd,
  o.order_total / 100.0 as order_total_usd
from "warehouse"."main_staging"."stg_orders" as o
  );

[0m14:20:47.217268 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:20:47.221267 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m14:20:47.222268 [debug] [Thread-1 (]: On model.case_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_orders"} */
alter view "warehouse"."main_marts"."fct_orders" rename to "fct_orders__dbt_backup"
[0m14:20:47.223268 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:20:47.227268 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m14:20:47.228267 [debug] [Thread-1 (]: On model.case_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_orders"} */
alter view "warehouse"."main_marts"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m14:20:47.229269 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:20:47.231268 [debug] [Thread-1 (]: On model.case_project.fct_orders: COMMIT
[0m14:20:47.232268 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m14:20:47.232268 [debug] [Thread-1 (]: On model.case_project.fct_orders: COMMIT
[0m14:20:47.234269 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:20:47.238267 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m14:20:47.239268 [debug] [Thread-1 (]: On model.case_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_orders"} */

      drop view if exists "warehouse"."main_marts"."fct_orders__dbt_backup" cascade
    
[0m14:20:47.240893 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:20:47.243030 [debug] [Thread-1 (]: On model.case_project.fct_orders: Close
[0m14:20:47.244030 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9dee4be4-6e56-4e28-aed3-211074008c27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BB95E4610>]}
[0m14:20:47.244030 [info ] [Thread-1 (]: 6 of 10 OK created sql view model main_marts.fct_orders ........................ [[32mOK[0m in 0.05s]
[0m14:20:47.245030 [debug] [Thread-1 (]: Finished running node model.case_project.fct_orders
[0m14:20:47.246032 [debug] [Thread-1 (]: Began running node model.case_project.fct_order_items
[0m14:20:47.247029 [info ] [Thread-1 (]: 7 of 10 START sql view model main_marts.fct_order_items ........................ [RUN]
[0m14:20:47.248030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.fct_orders, now model.case_project.fct_order_items)
[0m14:20:47.248030 [debug] [Thread-1 (]: Began compiling node model.case_project.fct_order_items
[0m14:20:47.252029 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.fct_order_items"
[0m14:20:47.257031 [debug] [Thread-1 (]: Began executing node model.case_project.fct_order_items
[0m14:20:47.263033 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.fct_order_items"
[0m14:20:47.267030 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_order_items"
[0m14:20:47.268031 [debug] [Thread-1 (]: On model.case_project.fct_order_items: BEGIN
[0m14:20:47.269031 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:20:47.269031 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:20:47.270032 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_order_items"
[0m14:20:47.271030 [debug] [Thread-1 (]: On model.case_project.fct_order_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_order_items"} */

  
  create view "warehouse"."main_marts"."fct_order_items__dbt_tmp" as (
    with items as (
  select i.order_id, i.product_id, coalesce(i.quantity, 1) as quantity
  from "warehouse"."main_staging"."stg_items" i
),
orders as (
  select order_id, customer_id,
         cast(ordered_at as date) as order_date,
         strftime(date_trunc('month', ordered_at), '%Y-%m-01') as order_month
  from "warehouse"."main_staging"."stg_orders"
),
products as (
  select
    p.product_id,
    p.product_name,
    p.price / 100.0 as unit_price_usd,              -- cents -> USD
    case when p.product_id like 'BEV%' then 'drinks'
         when p.product_id like 'JAF%' then 'sandwiches'
         else 'other'
    end as product_category
  from "warehouse"."main_staging"."stg_products" p
)
select
  o.order_id,
  o.customer_id,
  o.order_date,
  o.order_month,
  pr.product_id,
  pr.product_name,
  pr.product_category,
  it.quantity,
  pr.unit_price_usd,
  it.quantity * pr.unit_price_usd as line_revenue_usd
from items it
join orders  o  using (order_id)
join products pr using (product_id)
  );

[0m14:20:47.272031 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:20:47.277033 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_order_items"
[0m14:20:47.277033 [debug] [Thread-1 (]: On model.case_project.fct_order_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_order_items"} */
alter view "warehouse"."main_marts"."fct_order_items" rename to "fct_order_items__dbt_backup"
[0m14:20:47.278031 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:20:47.282064 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_order_items"
[0m14:20:47.283064 [debug] [Thread-1 (]: On model.case_project.fct_order_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_order_items"} */
alter view "warehouse"."main_marts"."fct_order_items__dbt_tmp" rename to "fct_order_items"
[0m14:20:47.284032 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:20:47.286030 [debug] [Thread-1 (]: On model.case_project.fct_order_items: COMMIT
[0m14:20:47.287029 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_order_items"
[0m14:20:47.287029 [debug] [Thread-1 (]: On model.case_project.fct_order_items: COMMIT
[0m14:20:47.289159 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:20:47.293194 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_order_items"
[0m14:20:47.293194 [debug] [Thread-1 (]: On model.case_project.fct_order_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_order_items"} */

      drop view if exists "warehouse"."main_marts"."fct_order_items__dbt_backup" cascade
    
[0m14:20:47.294924 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:20:47.296928 [debug] [Thread-1 (]: On model.case_project.fct_order_items: Close
[0m14:20:47.297929 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9dee4be4-6e56-4e28-aed3-211074008c27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BB7924F70>]}
[0m14:20:47.298929 [info ] [Thread-1 (]: 7 of 10 OK created sql view model main_marts.fct_order_items ................... [[32mOK[0m in 0.05s]
[0m14:20:47.299928 [debug] [Thread-1 (]: Finished running node model.case_project.fct_order_items
[0m14:20:47.300929 [debug] [Thread-1 (]: Began running node model.case_project.customer_pareto
[0m14:20:47.301929 [info ] [Thread-1 (]: 8 of 10 START sql view model main_marts.customer_pareto ........................ [RUN]
[0m14:20:47.301929 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.fct_order_items, now model.case_project.customer_pareto)
[0m14:20:47.302929 [debug] [Thread-1 (]: Began compiling node model.case_project.customer_pareto
[0m14:20:47.306928 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.customer_pareto"
[0m14:20:47.310928 [debug] [Thread-1 (]: Began executing node model.case_project.customer_pareto
[0m14:20:47.316929 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.customer_pareto"
[0m14:20:47.320928 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.customer_pareto"
[0m14:20:47.321930 [debug] [Thread-1 (]: On model.case_project.customer_pareto: BEGIN
[0m14:20:47.321930 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:20:47.322928 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:20:47.323929 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.customer_pareto"
[0m14:20:47.323929 [debug] [Thread-1 (]: On model.case_project.customer_pareto: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.customer_pareto"} */

  
  create view "warehouse"."main_marts"."customer_pareto__dbt_tmp" as (
    -- models/marts/customer_pareto.sql

with ltv as (
  select
    customer_id,
    sum(order_total_usd) as lifetime_value_usd 
  from "warehouse"."main_marts"."fct_orders"
  group by 1
),
ranked as (
  select
    customer_id,
    lifetime_value_usd,
    rank()  over (order by lifetime_value_usd desc) as rnk,
    count(*) over ()                                 as total_customers,
    sum(lifetime_value_usd) over ()                  as total_revenue_usd,
    sum(lifetime_value_usd) over (
      order by lifetime_value_usd desc
      rows between unbounded preceding and current row
    )                                               as cum_revenue_usd
  from ltv
)
select
  customer_id,
  lifetime_value_usd,
  rnk,
  cast(rnk as double) / total_customers                 as customer_pct,
  cum_revenue_usd / nullif(total_revenue_usd, 0)        as revenue_cum_pct
from ranked
order by rnk
  );

[0m14:20:47.328692 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:20:47.333693 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.customer_pareto"
[0m14:20:47.334691 [debug] [Thread-1 (]: On model.case_project.customer_pareto: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.customer_pareto"} */
alter view "warehouse"."main_marts"."customer_pareto" rename to "customer_pareto__dbt_backup"
[0m14:20:47.335691 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:20:47.340693 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.customer_pareto"
[0m14:20:47.341690 [debug] [Thread-1 (]: On model.case_project.customer_pareto: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.customer_pareto"} */
alter view "warehouse"."main_marts"."customer_pareto__dbt_tmp" rename to "customer_pareto"
[0m14:20:47.342691 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:20:47.344691 [debug] [Thread-1 (]: On model.case_project.customer_pareto: COMMIT
[0m14:20:47.344691 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.customer_pareto"
[0m14:20:47.345696 [debug] [Thread-1 (]: On model.case_project.customer_pareto: COMMIT
[0m14:20:47.347692 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:20:47.350691 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.customer_pareto"
[0m14:20:47.351692 [debug] [Thread-1 (]: On model.case_project.customer_pareto: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.customer_pareto"} */

      drop view if exists "warehouse"."main_marts"."customer_pareto__dbt_backup" cascade
    
[0m14:20:47.353693 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:20:47.354692 [debug] [Thread-1 (]: On model.case_project.customer_pareto: Close
[0m14:20:47.355692 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9dee4be4-6e56-4e28-aed3-211074008c27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BB8FBBB20>]}
[0m14:20:47.356692 [info ] [Thread-1 (]: 8 of 10 OK created sql view model main_marts.customer_pareto ................... [[32mOK[0m in 0.05s]
[0m14:20:47.357662 [debug] [Thread-1 (]: Finished running node model.case_project.customer_pareto
[0m14:20:47.358702 [debug] [Thread-1 (]: Began running node model.case_project.orders_fact
[0m14:20:47.359671 [info ] [Thread-1 (]: 9 of 10 START sql view model main_marts.orders_fact ............................ [RUN]
[0m14:20:47.359671 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.customer_pareto, now model.case_project.orders_fact)
[0m14:20:47.360698 [debug] [Thread-1 (]: Began compiling node model.case_project.orders_fact
[0m14:20:47.364698 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.orders_fact"
[0m14:20:47.368697 [debug] [Thread-1 (]: Began executing node model.case_project.orders_fact
[0m14:20:47.374698 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.orders_fact"
[0m14:20:47.378228 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.orders_fact"
[0m14:20:47.379230 [debug] [Thread-1 (]: On model.case_project.orders_fact: BEGIN
[0m14:20:47.379230 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:20:47.380234 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:20:47.381231 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.orders_fact"
[0m14:20:47.382231 [debug] [Thread-1 (]: On model.case_project.orders_fact: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.orders_fact"} */

  
  create view "warehouse"."main_marts"."orders_fact__dbt_tmp" as (
    with orders as (
  select
    order_id, customer_id, order_date, order_month,
    order_total_usd as order_revenue_usd
  from "warehouse"."main_marts"."fct_orders"
),
first_order as (
  select customer_id, min(order_date) as first_order_date
  from orders
  group by 1
)
select
  o.order_id,
  o.customer_id,
  o.order_date,
  o.order_month,
  o.order_revenue_usd,
  case when o.order_date = f.first_order_date then true else false end as is_first_order,
  case when o.order_date = f.first_order_date then 'new' else 'repeat' end as customer_cohort
from orders o
join first_order f using (customer_id)
  );

[0m14:20:47.383230 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:20:47.388230 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.orders_fact"
[0m14:20:47.389230 [debug] [Thread-1 (]: On model.case_project.orders_fact: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.orders_fact"} */
alter view "warehouse"."main_marts"."orders_fact" rename to "orders_fact__dbt_backup"
[0m14:20:47.389230 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:20:47.394230 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.orders_fact"
[0m14:20:47.395234 [debug] [Thread-1 (]: On model.case_project.orders_fact: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.orders_fact"} */
alter view "warehouse"."main_marts"."orders_fact__dbt_tmp" rename to "orders_fact"
[0m14:20:47.396234 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:20:47.398233 [debug] [Thread-1 (]: On model.case_project.orders_fact: COMMIT
[0m14:20:47.398233 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.orders_fact"
[0m14:20:47.399234 [debug] [Thread-1 (]: On model.case_project.orders_fact: COMMIT
[0m14:20:47.401232 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:20:47.405230 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.orders_fact"
[0m14:20:47.405230 [debug] [Thread-1 (]: On model.case_project.orders_fact: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.orders_fact"} */

      drop view if exists "warehouse"."main_marts"."orders_fact__dbt_backup" cascade
    
[0m14:20:47.406997 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:20:47.409003 [debug] [Thread-1 (]: On model.case_project.orders_fact: Close
[0m14:20:47.410015 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9dee4be4-6e56-4e28-aed3-211074008c27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BB8FBBB20>]}
[0m14:20:47.411002 [info ] [Thread-1 (]: 9 of 10 OK created sql view model main_marts.orders_fact ....................... [[32mOK[0m in 0.05s]
[0m14:20:47.412001 [debug] [Thread-1 (]: Finished running node model.case_project.orders_fact
[0m14:20:47.413002 [debug] [Thread-1 (]: Began running node model.case_project.monthly_summary
[0m14:20:47.414003 [info ] [Thread-1 (]: 10 of 10 START sql view model main_marts.monthly_summary ....................... [RUN]
[0m14:20:47.415003 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.orders_fact, now model.case_project.monthly_summary)
[0m14:20:47.416003 [debug] [Thread-1 (]: Began compiling node model.case_project.monthly_summary
[0m14:20:47.421002 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.monthly_summary"
[0m14:20:47.425002 [debug] [Thread-1 (]: Began executing node model.case_project.monthly_summary
[0m14:20:47.430003 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.monthly_summary"
[0m14:20:47.434795 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.monthly_summary"
[0m14:20:47.434795 [debug] [Thread-1 (]: On model.case_project.monthly_summary: BEGIN
[0m14:20:47.435802 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:20:47.436802 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:20:47.437801 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.monthly_summary"
[0m14:20:47.437801 [debug] [Thread-1 (]: On model.case_project.monthly_summary: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.monthly_summary"} */

  
  create view "warehouse"."main_marts"."monthly_summary__dbt_tmp" as (
    with base as (
  select order_id, customer_id, order_date, order_month, order_revenue_usd
  from "warehouse"."main_marts"."orders_fact"
),
labeled as (
  select b.*,
         case when order_date = min(order_date) over (partition by customer_id) then 1 else 0 end as is_new_order
  from base b
)
select
  order_month,
  sum(order_revenue_usd)                                as monthly_revenue_usd,
  count(distinct order_id)                              as monthly_orders,
  count(distinct customer_id)                           as active_customers,
  sum(order_revenue_usd) / nullif(count(distinct order_id),0) as aov_usd,
  sum(is_new_order)                                     as new_customers,
  (count(distinct customer_id) - sum(is_new_order))     as repeat_customers,
  (count(distinct customer_id) - sum(is_new_order)) * 1.0
    / nullif(count(distinct customer_id),0)             as repeat_purchase_rate
from labeled
group by 1
order by 1
  );

[0m14:20:47.440801 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:20:47.444800 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.monthly_summary"
[0m14:20:47.445801 [debug] [Thread-1 (]: On model.case_project.monthly_summary: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.monthly_summary"} */
alter view "warehouse"."main_marts"."monthly_summary" rename to "monthly_summary__dbt_backup"
[0m14:20:47.446801 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:20:47.450801 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.monthly_summary"
[0m14:20:47.451801 [debug] [Thread-1 (]: On model.case_project.monthly_summary: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.monthly_summary"} */
alter view "warehouse"."main_marts"."monthly_summary__dbt_tmp" rename to "monthly_summary"
[0m14:20:47.452800 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:20:47.454800 [debug] [Thread-1 (]: On model.case_project.monthly_summary: COMMIT
[0m14:20:47.454800 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.monthly_summary"
[0m14:20:47.455801 [debug] [Thread-1 (]: On model.case_project.monthly_summary: COMMIT
[0m14:20:47.457448 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:20:47.461763 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.monthly_summary"
[0m14:20:47.461763 [debug] [Thread-1 (]: On model.case_project.monthly_summary: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.monthly_summary"} */

      drop view if exists "warehouse"."main_marts"."monthly_summary__dbt_backup" cascade
    
[0m14:20:47.463763 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:20:47.465763 [debug] [Thread-1 (]: On model.case_project.monthly_summary: Close
[0m14:20:47.466764 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9dee4be4-6e56-4e28-aed3-211074008c27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BB8DEB640>]}
[0m14:20:47.467764 [info ] [Thread-1 (]: 10 of 10 OK created sql view model main_marts.monthly_summary .................. [[32mOK[0m in 0.05s]
[0m14:20:47.468763 [debug] [Thread-1 (]: Finished running node model.case_project.monthly_summary
[0m14:20:47.469763 [debug] [MainThread]: Using duckdb connection "master"
[0m14:20:47.470765 [debug] [MainThread]: On master: BEGIN
[0m14:20:47.470765 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:20:47.471762 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:20:47.471762 [debug] [MainThread]: On master: COMMIT
[0m14:20:47.472762 [debug] [MainThread]: Using duckdb connection "master"
[0m14:20:47.472762 [debug] [MainThread]: On master: COMMIT
[0m14:20:47.473763 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:20:47.474763 [debug] [MainThread]: On master: Close
[0m14:20:47.474763 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:20:47.475763 [debug] [MainThread]: Connection 'create_warehouse_main_staging' was properly closed.
[0m14:20:47.475763 [debug] [MainThread]: Connection 'list_warehouse_main_staging' was properly closed.
[0m14:20:47.476762 [debug] [MainThread]: Connection 'model.case_project.monthly_summary' was properly closed.
[0m14:20:47.476762 [info ] [MainThread]: 
[0m14:20:47.477765 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 1.05 seconds (1.05s).
[0m14:20:47.480762 [debug] [MainThread]: Command end result
[0m14:20:47.568815 [debug] [MainThread]: Wrote artifact WritableManifest to D:\projects\Case Project main\target\manifest.json
[0m14:20:47.575814 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\projects\Case Project main\target\semantic_manifest.json
[0m14:20:47.588816 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\projects\Case Project main\target\run_results.json
[0m14:20:47.589815 [info ] [MainThread]: 
[0m14:20:47.590816 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:20:47.590816 [info ] [MainThread]: 
[0m14:20:47.591815 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m14:20:47.592815 [debug] [MainThread]: Command `dbt run` succeeded at 14:20:47.592815 after 3.17 seconds
[0m14:20:47.593816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BB53E3220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BB6711E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BB75DF850>]}
[0m14:20:47.594815 [debug] [MainThread]: Flushing usage events
[0m14:20:48.336322 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:35:34.365315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A163673190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A165963C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A165963FD0>]}


============================== 14:35:34.371458 | 73d92fd6-c973-4d6b-b0f7-e9bc4e7b07cc ==============================
[0m14:35:34.371458 [info ] [MainThread]: Running with dbt=1.10.9
[0m14:35:34.373315 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'log_path': 'D:\\projects\\Case Project main\\logs', 'profiles_dir': 'D:\\projects\\Case Project main', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True'}
[0m14:35:34.665613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73d92fd6-c973-4d6b-b0f7-e9bc4e7b07cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1650C6B90>]}
[0m14:35:34.745613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '73d92fd6-c973-4d6b-b0f7-e9bc4e7b07cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A165961ED0>]}
[0m14:35:34.748984 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:35:35.099506 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m14:35:35.453341 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 6 files changed.
[0m14:35:35.454341 [debug] [MainThread]: Partial parsing: updated file: case_project://models\marts\dim_customers.sql
[0m14:35:35.454341 [debug] [MainThread]: Partial parsing: updated file: case_project://models\marts\fct_order_items.sql
[0m14:35:35.455345 [debug] [MainThread]: Partial parsing: updated file: case_project://models\marts\customer_pareto.sql
[0m14:35:35.456341 [debug] [MainThread]: Partial parsing: updated file: case_project://models\marts\fct_orders.sql
[0m14:35:35.456341 [debug] [MainThread]: Partial parsing: updated file: case_project://models\marts\monthly_summary.sql
[0m14:35:35.457341 [debug] [MainThread]: Partial parsing: updated file: case_project://models\marts\orders_fact.sql
[0m14:35:36.145997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '73d92fd6-c973-4d6b-b0f7-e9bc4e7b07cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A167225B70>]}
[0m14:35:36.352707 [debug] [MainThread]: Wrote artifact WritableManifest to D:\projects\Case Project main\target\manifest.json
[0m14:35:36.358774 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\projects\Case Project main\target\semantic_manifest.json
[0m14:35:36.395816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '73d92fd6-c973-4d6b-b0f7-e9bc4e7b07cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A166FAE620>]}
[0m14:35:36.396817 [info ] [MainThread]: Found 10 models, 4 seeds, 37 data tests, 4 sources, 429 macros
[0m14:35:36.397787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73d92fd6-c973-4d6b-b0f7-e9bc4e7b07cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A166FADBA0>]}
[0m14:35:36.400818 [info ] [MainThread]: 
[0m14:35:36.401790 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:35:36.401790 [info ] [MainThread]: 
[0m14:35:36.402807 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:35:36.412787 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m14:35:36.635799 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m14:35:36.636799 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m14:35:36.636799 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:35:36.660772 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m14:35:36.662772 [debug] [ThreadPool]: On list_warehouse: Close
[0m14:35:36.665772 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m14:35:36.666772 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m14:35:36.666772 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:35:36.668769 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:35:36.669803 [debug] [ThreadPool]: On list_warehouse: Close
[0m14:35:36.670770 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_marts)
[0m14:35:36.670770 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_marts"
"
[0m14:35:36.679799 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m14:35:36.679799 [debug] [ThreadPool]: On create_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_marts"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m14:35:36.680799 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:35:36.681807 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:35:36.682799 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m14:35:36.683770 [debug] [ThreadPool]: On create_warehouse_main_marts: BEGIN
[0m14:35:36.683770 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:35:36.684799 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m14:35:36.684799 [debug] [ThreadPool]: On create_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_marts"} */

    
    
        create schema if not exists "warehouse"."main_marts"
    
[0m14:35:36.685799 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:35:36.686799 [debug] [ThreadPool]: On create_warehouse_main_marts: COMMIT
[0m14:35:36.686799 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m14:35:36.687799 [debug] [ThreadPool]: On create_warehouse_main_marts: COMMIT
[0m14:35:36.688769 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:35:36.688769 [debug] [ThreadPool]: On create_warehouse_main_marts: Close
[0m14:35:36.689789 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_warehouse_main_marts, now create_warehouse_main_staging)
[0m14:35:36.690769 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_staging"
"
[0m14:35:36.692799 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m14:35:36.693799 [debug] [ThreadPool]: On create_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m14:35:36.694799 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:35:36.695802 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:35:36.696800 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m14:35:36.697769 [debug] [ThreadPool]: On create_warehouse_main_staging: BEGIN
[0m14:35:36.697769 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:35:36.698799 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m14:35:36.698799 [debug] [ThreadPool]: On create_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "create_warehouse_main_staging"} */

    
    
        create schema if not exists "warehouse"."main_staging"
    
[0m14:35:36.699810 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:35:36.700799 [debug] [ThreadPool]: On create_warehouse_main_staging: COMMIT
[0m14:35:36.700799 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_staging"
[0m14:35:36.701799 [debug] [ThreadPool]: On create_warehouse_main_staging: COMMIT
[0m14:35:36.701799 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:35:36.702769 [debug] [ThreadPool]: On create_warehouse_main_staging: Close
[0m14:35:36.705640 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_marts'
[0m14:35:36.712779 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m14:35:36.712779 [debug] [ThreadPool]: On list_warehouse_main_marts: BEGIN
[0m14:35:36.713779 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:35:36.714780 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:35:36.714780 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m14:35:36.715780 [debug] [ThreadPool]: On list_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_marts"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'warehouse'
  
[0m14:35:36.729779 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m14:35:36.731780 [debug] [ThreadPool]: On list_warehouse_main_marts: ROLLBACK
[0m14:35:36.732793 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_marts'
[0m14:35:36.732793 [debug] [ThreadPool]: On list_warehouse_main_marts: Close
[0m14:35:36.733815 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_marts, now list_warehouse_main_raw)
[0m14:35:36.738851 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m14:35:36.738851 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m14:35:36.739821 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:35:36.740822 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:35:36.740822 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m14:35:36.741850 [debug] [ThreadPool]: On list_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_raw"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'warehouse'
  
[0m14:35:36.744851 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m14:35:36.746851 [debug] [ThreadPool]: On list_warehouse_main_raw: ROLLBACK
[0m14:35:36.746851 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_raw'
[0m14:35:36.747850 [debug] [ThreadPool]: On list_warehouse_main_raw: Close
[0m14:35:36.747850 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_raw, now list_warehouse_main_staging)
[0m14:35:36.751850 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_staging"
[0m14:35:36.752850 [debug] [ThreadPool]: On list_warehouse_main_staging: BEGIN
[0m14:35:36.752850 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:35:36.753851 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:35:36.754822 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_staging"
[0m14:35:36.754822 [debug] [ThreadPool]: On list_warehouse_main_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "connection_name": "list_warehouse_main_staging"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'warehouse'
  
[0m14:35:36.757853 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m14:35:36.759851 [debug] [ThreadPool]: On list_warehouse_main_staging: ROLLBACK
[0m14:35:36.760821 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_staging'
[0m14:35:36.760821 [debug] [ThreadPool]: On list_warehouse_main_staging: Close
[0m14:35:36.762855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73d92fd6-c973-4d6b-b0f7-e9bc4e7b07cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A162FF1DB0>]}
[0m14:35:36.762855 [debug] [MainThread]: Using duckdb connection "master"
[0m14:35:36.763851 [debug] [MainThread]: On master: BEGIN
[0m14:35:36.763851 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:35:36.764853 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:35:36.765822 [debug] [MainThread]: On master: COMMIT
[0m14:35:36.765822 [debug] [MainThread]: Using duckdb connection "master"
[0m14:35:36.766821 [debug] [MainThread]: On master: COMMIT
[0m14:35:36.766821 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:35:36.767823 [debug] [MainThread]: On master: Close
[0m14:35:36.771888 [debug] [Thread-1 (]: Began running node model.case_project.stg_customers
[0m14:35:36.772923 [info ] [Thread-1 (]: 1 of 10 START sql view model main_staging.stg_customers ........................ [RUN]
[0m14:35:36.773893 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.case_project.stg_customers'
[0m14:35:36.773893 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_customers
[0m14:35:36.785925 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_customers"
[0m14:35:36.791893 [debug] [Thread-1 (]: Began executing node model.case_project.stg_customers
[0m14:35:36.830924 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_customers"
[0m14:35:36.835200 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m14:35:36.835200 [debug] [Thread-1 (]: On model.case_project.stg_customers: BEGIN
[0m14:35:36.836209 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:35:36.837209 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:35:36.838209 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m14:35:36.838209 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */

  
  create view "warehouse"."main_staging"."stg_customers__dbt_tmp" as (
    -- models/staging/stg_customers.sql
with src as (select * from "warehouse"."main_raw"."raw_customers")
select
  cast(id as varchar) as customer_id,
  trim(name) as customer_name
from src
  );

[0m14:35:36.839208 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:35:36.847208 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m14:35:36.848209 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */
alter view "warehouse"."main_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m14:35:36.849209 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:35:36.853208 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m14:35:36.854209 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */
alter view "warehouse"."main_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m14:35:36.854209 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:35:36.869208 [debug] [Thread-1 (]: On model.case_project.stg_customers: COMMIT
[0m14:35:36.870208 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m14:35:36.870208 [debug] [Thread-1 (]: On model.case_project.stg_customers: COMMIT
[0m14:35:36.876208 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m14:35:36.883240 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_customers"
[0m14:35:36.883240 [debug] [Thread-1 (]: On model.case_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_customers"} */

      drop view if exists "warehouse"."main_staging"."stg_customers__dbt_backup" cascade
    
[0m14:35:36.885206 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:35:36.888209 [debug] [Thread-1 (]: On model.case_project.stg_customers: Close
[0m14:35:36.891209 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d92fd6-c973-4d6b-b0f7-e9bc4e7b07cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A162404520>]}
[0m14:35:36.892209 [info ] [Thread-1 (]: 1 of 10 OK created sql view model main_staging.stg_customers ................... [[32mOK[0m in 0.12s]
[0m14:35:36.893208 [debug] [Thread-1 (]: Finished running node model.case_project.stg_customers
[0m14:35:36.894236 [debug] [Thread-1 (]: Began running node model.case_project.stg_items
[0m14:35:36.895209 [info ] [Thread-1 (]: 2 of 10 START sql view model main_staging.stg_items ............................ [RUN]
[0m14:35:36.896209 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_customers, now model.case_project.stg_items)
[0m14:35:36.896209 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_items
[0m14:35:36.900208 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_items"
[0m14:35:36.904262 [debug] [Thread-1 (]: Began executing node model.case_project.stg_items
[0m14:35:36.910265 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_items"
[0m14:35:36.915265 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m14:35:36.915265 [debug] [Thread-1 (]: On model.case_project.stg_items: BEGIN
[0m14:35:36.916265 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:36.917265 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:35:36.917265 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m14:35:36.918265 [debug] [Thread-1 (]: On model.case_project.stg_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_items"} */

  
  create view "warehouse"."main_staging"."stg_items__dbt_tmp" as (
    with src as (
  select * from "warehouse"."main_raw"."raw_items"
)
select
  cast(order_id as varchar) as order_id,  -- FK to orders
  cast(sku      as varchar) as product_id, 
  1                           as quantity  -- Assumption: one row = one item
from src
  );

[0m14:35:36.919266 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:35:36.924265 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m14:35:36.924265 [debug] [Thread-1 (]: On model.case_project.stg_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_items"} */
alter view "warehouse"."main_staging"."stg_items" rename to "stg_items__dbt_backup"
[0m14:35:36.925266 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:35:36.929261 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m14:35:36.930261 [debug] [Thread-1 (]: On model.case_project.stg_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_items"} */
alter view "warehouse"."main_staging"."stg_items__dbt_tmp" rename to "stg_items"
[0m14:35:36.931262 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:35:36.933262 [debug] [Thread-1 (]: On model.case_project.stg_items: COMMIT
[0m14:35:36.933262 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m14:35:36.934263 [debug] [Thread-1 (]: On model.case_project.stg_items: COMMIT
[0m14:35:36.935927 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:35:36.939935 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_items"
[0m14:35:36.940933 [debug] [Thread-1 (]: On model.case_project.stg_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_items"} */

      drop view if exists "warehouse"."main_staging"."stg_items__dbt_backup" cascade
    
[0m14:35:36.942447 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:35:36.944456 [debug] [Thread-1 (]: On model.case_project.stg_items: Close
[0m14:35:36.945453 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d92fd6-c973-4d6b-b0f7-e9bc4e7b07cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1672BC8E0>]}
[0m14:35:36.946456 [info ] [Thread-1 (]: 2 of 10 OK created sql view model main_staging.stg_items ....................... [[32mOK[0m in 0.05s]
[0m14:35:36.947456 [debug] [Thread-1 (]: Finished running node model.case_project.stg_items
[0m14:35:36.947456 [debug] [Thread-1 (]: Began running node model.case_project.stg_orders
[0m14:35:36.948456 [info ] [Thread-1 (]: 3 of 10 START sql view model main_staging.stg_orders ........................... [RUN]
[0m14:35:36.949453 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_items, now model.case_project.stg_orders)
[0m14:35:36.950456 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_orders
[0m14:35:36.953455 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_orders"
[0m14:35:36.957454 [debug] [Thread-1 (]: Began executing node model.case_project.stg_orders
[0m14:35:36.963456 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_orders"
[0m14:35:36.967687 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m14:35:36.968695 [debug] [Thread-1 (]: On model.case_project.stg_orders: BEGIN
[0m14:35:36.968695 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:36.969695 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:35:36.969695 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m14:35:36.970696 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */

  
  create view "warehouse"."main_staging"."stg_orders__dbt_tmp" as (
    with src as (
  select * from "warehouse"."main_raw"."raw_orders"
)
select
  cast(id as varchar)                 as order_id,
  cast(customer as varchar)           as customer_id,
  cast(store_id as varchar)           as store_id,
  cast(ordered_at as timestamp)       as ordered_at,
  cast(subtotal as decimal(10,2))            as subtotal,
  cast(tax_paid as decimal(10,2))            as tax_paid,
  cast(order_total as decimal(10,2))         as order_total
from src
  );

[0m14:35:36.971695 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:35:36.976693 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m14:35:36.977693 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */
alter view "warehouse"."main_staging"."stg_orders" rename to "stg_orders__dbt_backup"
[0m14:35:36.978692 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:35:36.983690 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m14:35:36.984690 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */
alter view "warehouse"."main_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m14:35:36.985693 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:35:36.987692 [debug] [Thread-1 (]: On model.case_project.stg_orders: COMMIT
[0m14:35:36.988692 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m14:35:36.988692 [debug] [Thread-1 (]: On model.case_project.stg_orders: COMMIT
[0m14:35:36.991055 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:35:36.994061 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_orders"
[0m14:35:36.995064 [debug] [Thread-1 (]: On model.case_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_orders"} */

      drop view if exists "warehouse"."main_staging"."stg_orders__dbt_backup" cascade
    
[0m14:35:36.996101 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:35:36.998472 [debug] [Thread-1 (]: On model.case_project.stg_orders: Close
[0m14:35:36.999472 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d92fd6-c973-4d6b-b0f7-e9bc4e7b07cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A16783FF70>]}
[0m14:35:37.000472 [info ] [Thread-1 (]: 3 of 10 OK created sql view model main_staging.stg_orders ...................... [[32mOK[0m in 0.05s]
[0m14:35:37.001471 [debug] [Thread-1 (]: Finished running node model.case_project.stg_orders
[0m14:35:37.001471 [debug] [Thread-1 (]: Began running node model.case_project.stg_products
[0m14:35:37.002472 [info ] [Thread-1 (]: 4 of 10 START sql view model main_staging.stg_products ......................... [RUN]
[0m14:35:37.003468 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_orders, now model.case_project.stg_products)
[0m14:35:37.004472 [debug] [Thread-1 (]: Began compiling node model.case_project.stg_products
[0m14:35:37.007471 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.stg_products"
[0m14:35:37.011468 [debug] [Thread-1 (]: Began executing node model.case_project.stg_products
[0m14:35:37.016471 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.stg_products"
[0m14:35:37.020923 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m14:35:37.020923 [debug] [Thread-1 (]: On model.case_project.stg_products: BEGIN
[0m14:35:37.021921 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:37.022924 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:35:37.022924 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m14:35:37.023924 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */

  
  create view "warehouse"."main_staging"."stg_products__dbt_tmp" as (
    -- models/staging/stg_products.sql
with src as (select * from "warehouse"."main_raw"."raw_products")
select
  cast(sku as varchar)      as product_id,
  trim(name)                as product_name, 
  cast(price as decimal(10,2))    as price
from src
  );

[0m14:35:37.024924 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:35:37.029924 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m14:35:37.029924 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */
alter view "warehouse"."main_staging"."stg_products" rename to "stg_products__dbt_backup"
[0m14:35:37.030924 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:35:37.034923 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m14:35:37.035924 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */
alter view "warehouse"."main_staging"."stg_products__dbt_tmp" rename to "stg_products"
[0m14:35:37.036924 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:35:37.038924 [debug] [Thread-1 (]: On model.case_project.stg_products: COMMIT
[0m14:35:37.039924 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m14:35:37.039924 [debug] [Thread-1 (]: On model.case_project.stg_products: COMMIT
[0m14:35:37.042924 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:35:37.045921 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.stg_products"
[0m14:35:37.046920 [debug] [Thread-1 (]: On model.case_project.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.stg_products"} */

      drop view if exists "warehouse"."main_staging"."stg_products__dbt_backup" cascade
    
[0m14:35:37.049040 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:35:37.050257 [debug] [Thread-1 (]: On model.case_project.stg_products: Close
[0m14:35:37.051265 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d92fd6-c973-4d6b-b0f7-e9bc4e7b07cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A167852080>]}
[0m14:35:37.052264 [info ] [Thread-1 (]: 4 of 10 OK created sql view model main_staging.stg_products .................... [[32mOK[0m in 0.05s]
[0m14:35:37.053267 [debug] [Thread-1 (]: Finished running node model.case_project.stg_products
[0m14:35:37.054267 [debug] [Thread-1 (]: Began running node model.case_project.dim_customers
[0m14:35:37.054267 [info ] [Thread-1 (]: 5 of 10 START sql view model main_marts.dim_customers .......................... [RUN]
[0m14:35:37.055267 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.stg_products, now model.case_project.dim_customers)
[0m14:35:37.056267 [debug] [Thread-1 (]: Began compiling node model.case_project.dim_customers
[0m14:35:37.061266 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.dim_customers"
[0m14:35:37.065265 [debug] [Thread-1 (]: Began executing node model.case_project.dim_customers
[0m14:35:37.070267 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.dim_customers"
[0m14:35:37.075049 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m14:35:37.075049 [debug] [Thread-1 (]: On model.case_project.dim_customers: BEGIN
[0m14:35:37.076080 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:37.077055 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:35:37.078055 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m14:35:37.078055 [debug] [Thread-1 (]: On model.case_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_customers"} */

  
  create view "warehouse"."main_marts"."dim_customers__dbt_tmp" as (
    with orders as (
  select
    customer_id,
    cast(ordered_at as date) as order_date,
    subtotal / 100.0         as revenue_usd   -- net of tax for LTV
  from "warehouse"."main_staging"."stg_orders"
)
select
  c.customer_id,
  c.customer_name,
  min(o.order_date)              as first_order_date,
  max(o.order_date)              as last_order_date,
  count(*)                       as order_count,
  sum(o.revenue_usd)             as lifetime_value_usd
from "warehouse"."main_staging"."stg_customers" c
left join orders o using (customer_id)
group by 1,2
  );

[0m14:35:37.080055 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:35:37.084053 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m14:35:37.085056 [debug] [Thread-1 (]: On model.case_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_customers"} */
alter view "warehouse"."main_marts"."dim_customers" rename to "dim_customers__dbt_backup"
[0m14:35:37.085056 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:35:37.090056 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m14:35:37.090056 [debug] [Thread-1 (]: On model.case_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_customers"} */
alter view "warehouse"."main_marts"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m14:35:37.091055 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:35:37.093055 [debug] [Thread-1 (]: On model.case_project.dim_customers: COMMIT
[0m14:35:37.094055 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m14:35:37.095054 [debug] [Thread-1 (]: On model.case_project.dim_customers: COMMIT
[0m14:35:37.097217 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:35:37.100216 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.dim_customers"
[0m14:35:37.101217 [debug] [Thread-1 (]: On model.case_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.dim_customers"} */

      drop view if exists "warehouse"."main_marts"."dim_customers__dbt_backup" cascade
    
[0m14:35:37.103216 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:35:37.104217 [debug] [Thread-1 (]: On model.case_project.dim_customers: Close
[0m14:35:37.105214 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d92fd6-c973-4d6b-b0f7-e9bc4e7b07cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A16783FF70>]}
[0m14:35:37.106217 [info ] [Thread-1 (]: 5 of 10 OK created sql view model main_marts.dim_customers ..................... [[32mOK[0m in 0.05s]
[0m14:35:37.107216 [debug] [Thread-1 (]: Finished running node model.case_project.dim_customers
[0m14:35:37.108217 [debug] [Thread-1 (]: Began running node model.case_project.fct_orders
[0m14:35:37.108217 [info ] [Thread-1 (]: 6 of 10 START sql view model main_marts.fct_orders ............................. [RUN]
[0m14:35:37.109214 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.dim_customers, now model.case_project.fct_orders)
[0m14:35:37.110216 [debug] [Thread-1 (]: Began compiling node model.case_project.fct_orders
[0m14:35:37.114214 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.fct_orders"
[0m14:35:37.117633 [debug] [Thread-1 (]: Began executing node model.case_project.fct_orders
[0m14:35:37.122637 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.fct_orders"
[0m14:35:37.127039 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m14:35:37.128038 [debug] [Thread-1 (]: On model.case_project.fct_orders: BEGIN
[0m14:35:37.129012 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:37.129012 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:35:37.130012 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m14:35:37.131013 [debug] [Thread-1 (]: On model.case_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_orders"} */

  
  create view "warehouse"."main_marts"."fct_orders__dbt_tmp" as (
    -- Revenue = subtotal (excl. tax); Gross = subtotal + tax
select
  o.order_id,
  o.customer_id,
  cast(o.ordered_at as date)                              as order_date,
  strftime(date_trunc('month', o.ordered_at), '%Y-%m-01') as order_month,

  -- cents -> USD
  o.subtotal    / 100.0 as revenue_usd,        -- <- use this everywhere for KPIs/charts
  o.tax_paid    / 100.0 as tax_usd,
  o.order_total / 100.0 as gross_sales_usd     -- (= revenue_usd + tax_usd)
from "warehouse"."main_staging"."stg_orders" as o
  );

[0m14:35:37.132012 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:35:37.137043 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m14:35:37.138043 [debug] [Thread-1 (]: On model.case_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_orders"} */
alter view "warehouse"."main_marts"."fct_orders" rename to "fct_orders__dbt_backup"
[0m14:35:37.139042 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:35:37.191044 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m14:35:37.192016 [debug] [Thread-1 (]: On model.case_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_orders"} */
alter view "warehouse"."main_marts"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m14:35:37.193048 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:35:37.195045 [debug] [Thread-1 (]: On model.case_project.fct_orders: COMMIT
[0m14:35:37.195045 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m14:35:37.196043 [debug] [Thread-1 (]: On model.case_project.fct_orders: COMMIT
[0m14:35:37.198043 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:35:37.201043 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_orders"
[0m14:35:37.202043 [debug] [Thread-1 (]: On model.case_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_orders"} */

      drop view if exists "warehouse"."main_marts"."fct_orders__dbt_backup" cascade
    
[0m14:35:37.204070 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:35:37.205013 [debug] [Thread-1 (]: On model.case_project.fct_orders: Close
[0m14:35:37.206043 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d92fd6-c973-4d6b-b0f7-e9bc4e7b07cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1677ACA00>]}
[0m14:35:37.207043 [info ] [Thread-1 (]: 6 of 10 OK created sql view model main_marts.fct_orders ........................ [[32mOK[0m in 0.10s]
[0m14:35:37.208043 [debug] [Thread-1 (]: Finished running node model.case_project.fct_orders
[0m14:35:37.209013 [debug] [Thread-1 (]: Began running node model.case_project.fct_order_items
[0m14:35:37.210013 [info ] [Thread-1 (]: 7 of 10 START sql view model main_marts.fct_order_items ........................ [RUN]
[0m14:35:37.211013 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.fct_orders, now model.case_project.fct_order_items)
[0m14:35:37.211013 [debug] [Thread-1 (]: Began compiling node model.case_project.fct_order_items
[0m14:35:37.215043 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.fct_order_items"
[0m14:35:37.219191 [debug] [Thread-1 (]: Began executing node model.case_project.fct_order_items
[0m14:35:37.224194 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.fct_order_items"
[0m14:35:37.228191 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_order_items"
[0m14:35:37.229193 [debug] [Thread-1 (]: On model.case_project.fct_order_items: BEGIN
[0m14:35:37.230191 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:37.231194 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:35:37.231194 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_order_items"
[0m14:35:37.232195 [debug] [Thread-1 (]: On model.case_project.fct_order_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_order_items"} */

  
  create view "warehouse"."main_marts"."fct_order_items__dbt_tmp" as (
    --- models/marts/fct_order_items.sql
with items as (
  select i.order_id, i.product_id, coalesce(i.quantity, 1) as quantity
  from "warehouse"."main_staging"."stg_items" i
),
orders as (
  select order_id, customer_id,
         cast(ordered_at as date) as order_date,
         strftime(date_trunc('month', ordered_at), '%Y-%m-01') as order_month
  from "warehouse"."main_staging"."stg_orders"
),
products as (
  select
    p.product_id,
    p.product_name,
    p.price / 100.0 as unit_price_usd,
    case
      when p.product_id like 'BEV%' then 'drinks'
      when p.product_id like 'JAF%' then 'sandwiches'
      else 'other'
    end as product_category
  from "warehouse"."main_staging"."stg_products" p
)
select
  o.order_id,
  o.customer_id,
  o.order_date,
  o.order_month,
  pr.product_id,
  pr.product_name,
  pr.product_category,
  it.quantity,
  pr.unit_price_usd,
  it.quantity * pr.unit_price_usd as line_revenue_usd
from items it
join orders  o  using (order_id)
join products pr using (product_id)
  );

[0m14:35:37.234191 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:35:37.238190 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_order_items"
[0m14:35:37.239192 [debug] [Thread-1 (]: On model.case_project.fct_order_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_order_items"} */
alter view "warehouse"."main_marts"."fct_order_items" rename to "fct_order_items__dbt_backup"
[0m14:35:37.240191 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:35:37.244191 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_order_items"
[0m14:35:37.244191 [debug] [Thread-1 (]: On model.case_project.fct_order_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_order_items"} */
alter view "warehouse"."main_marts"."fct_order_items__dbt_tmp" rename to "fct_order_items"
[0m14:35:37.245192 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:35:37.247190 [debug] [Thread-1 (]: On model.case_project.fct_order_items: COMMIT
[0m14:35:37.248192 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_order_items"
[0m14:35:37.248192 [debug] [Thread-1 (]: On model.case_project.fct_order_items: COMMIT
[0m14:35:37.251193 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:35:37.256194 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.fct_order_items"
[0m14:35:37.256194 [debug] [Thread-1 (]: On model.case_project.fct_order_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.fct_order_items"} */

      drop view if exists "warehouse"."main_marts"."fct_order_items__dbt_backup" cascade
    
[0m14:35:37.258191 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:35:37.260194 [debug] [Thread-1 (]: On model.case_project.fct_order_items: Close
[0m14:35:37.261194 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d92fd6-c973-4d6b-b0f7-e9bc4e7b07cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1634A8430>]}
[0m14:35:37.262194 [info ] [Thread-1 (]: 7 of 10 OK created sql view model main_marts.fct_order_items ................... [[32mOK[0m in 0.05s]
[0m14:35:37.262674 [debug] [Thread-1 (]: Finished running node model.case_project.fct_order_items
[0m14:35:37.263707 [debug] [Thread-1 (]: Began running node model.case_project.customer_pareto
[0m14:35:37.264709 [info ] [Thread-1 (]: 8 of 10 START sql view model main_marts.customer_pareto ........................ [RUN]
[0m14:35:37.264709 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.fct_order_items, now model.case_project.customer_pareto)
[0m14:35:37.265709 [debug] [Thread-1 (]: Began compiling node model.case_project.customer_pareto
[0m14:35:37.269710 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.customer_pareto"
[0m14:35:37.273678 [debug] [Thread-1 (]: Began executing node model.case_project.customer_pareto
[0m14:35:37.279678 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.customer_pareto"
[0m14:35:37.283700 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.customer_pareto"
[0m14:35:37.283700 [debug] [Thread-1 (]: On model.case_project.customer_pareto: BEGIN
[0m14:35:37.284710 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:37.285705 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:35:37.285705 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.customer_pareto"
[0m14:35:37.286710 [debug] [Thread-1 (]: On model.case_project.customer_pareto: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.customer_pareto"} */

  
  create view "warehouse"."main_marts"."customer_pareto__dbt_tmp" as (
    with ltv as (
  select
    customer_id,
    sum(revenue_usd) as lifetime_value_usd  -- net of tax
  from "warehouse"."main_marts"."fct_orders"
  group by 1
),
ranked as (
  select
    customer_id,
    lifetime_value_usd,
    rank()  over (order by lifetime_value_usd desc) as rnk,
    count(*) over ()                                 as total_customers,
    sum(lifetime_value_usd) over ()                  as total_revenue_usd,
    sum(lifetime_value_usd) over (
      order by lifetime_value_usd desc
      rows between unbounded preceding and current row
    )                                               as cum_revenue_usd
  from ltv
)
select
  customer_id,
  lifetime_value_usd,
  rnk,
  cast(rnk as double) / total_customers                  as customer_pct,
  cum_revenue_usd / nullif(total_revenue_usd, 0)         as revenue_cum_pct
from ranked
order by rnk
  );

[0m14:35:37.288709 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:35:37.292705 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.customer_pareto"
[0m14:35:37.292705 [debug] [Thread-1 (]: On model.case_project.customer_pareto: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.customer_pareto"} */
alter view "warehouse"."main_marts"."customer_pareto" rename to "customer_pareto__dbt_backup"
[0m14:35:37.293709 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:35:37.297708 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.customer_pareto"
[0m14:35:37.298709 [debug] [Thread-1 (]: On model.case_project.customer_pareto: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.customer_pareto"} */
alter view "warehouse"."main_marts"."customer_pareto__dbt_tmp" rename to "customer_pareto"
[0m14:35:37.299709 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:35:37.301709 [debug] [Thread-1 (]: On model.case_project.customer_pareto: COMMIT
[0m14:35:37.301709 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.customer_pareto"
[0m14:35:37.302709 [debug] [Thread-1 (]: On model.case_project.customer_pareto: COMMIT
[0m14:35:37.304706 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:35:37.308709 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.customer_pareto"
[0m14:35:37.309709 [debug] [Thread-1 (]: On model.case_project.customer_pareto: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.customer_pareto"} */

      drop view if exists "warehouse"."main_marts"."customer_pareto__dbt_backup" cascade
    
[0m14:35:37.310708 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:35:37.312709 [debug] [Thread-1 (]: On model.case_project.customer_pareto: Close
[0m14:35:37.313709 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d92fd6-c973-4d6b-b0f7-e9bc4e7b07cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1630328C0>]}
[0m14:35:37.314709 [info ] [Thread-1 (]: 8 of 10 OK created sql view model main_marts.customer_pareto ................... [[32mOK[0m in 0.05s]
[0m14:35:37.315448 [debug] [Thread-1 (]: Finished running node model.case_project.customer_pareto
[0m14:35:37.316486 [debug] [Thread-1 (]: Began running node model.case_project.orders_fact
[0m14:35:37.317484 [info ] [Thread-1 (]: 9 of 10 START sql view model main_marts.orders_fact ............................ [RUN]
[0m14:35:37.317484 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.customer_pareto, now model.case_project.orders_fact)
[0m14:35:37.318485 [debug] [Thread-1 (]: Began compiling node model.case_project.orders_fact
[0m14:35:37.322485 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.orders_fact"
[0m14:35:37.326442 [debug] [Thread-1 (]: Began executing node model.case_project.orders_fact
[0m14:35:37.332450 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.orders_fact"
[0m14:35:37.336903 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.orders_fact"
[0m14:35:37.336903 [debug] [Thread-1 (]: On model.case_project.orders_fact: BEGIN
[0m14:35:37.337912 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:37.338912 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:35:37.338912 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.orders_fact"
[0m14:35:37.339912 [debug] [Thread-1 (]: On model.case_project.orders_fact: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.orders_fact"} */

  
  create view "warehouse"."main_marts"."orders_fact__dbt_tmp" as (
    with orders as (
  select
    order_id,
    customer_id,
    order_date,
    order_month,
    revenue_usd as order_revenue_usd  -- <- net of tax
  from "warehouse"."main_marts"."fct_orders"
),
first_order as (
  select customer_id, min(order_date) as first_order_date
  from orders
  group by 1
)
select
  o.order_id,
  o.customer_id,
  o.order_date,
  o.order_month,
  o.order_revenue_usd,
  case when o.order_date = f.first_order_date then true else false end as is_first_order,
  case when o.order_date = f.first_order_date then 'new' else 'repeat' end as customer_cohort
from orders o
join first_order f using (customer_id)
  );

[0m14:35:37.341912 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:35:37.345913 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.orders_fact"
[0m14:35:37.346911 [debug] [Thread-1 (]: On model.case_project.orders_fact: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.orders_fact"} */
alter view "warehouse"."main_marts"."orders_fact" rename to "orders_fact__dbt_backup"
[0m14:35:37.347912 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:35:37.351908 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.orders_fact"
[0m14:35:37.352912 [debug] [Thread-1 (]: On model.case_project.orders_fact: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.orders_fact"} */
alter view "warehouse"."main_marts"."orders_fact__dbt_tmp" rename to "orders_fact"
[0m14:35:37.353912 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:35:37.355912 [debug] [Thread-1 (]: On model.case_project.orders_fact: COMMIT
[0m14:35:37.356912 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.orders_fact"
[0m14:35:37.356912 [debug] [Thread-1 (]: On model.case_project.orders_fact: COMMIT
[0m14:35:37.359910 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:35:37.363909 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.orders_fact"
[0m14:35:37.363909 [debug] [Thread-1 (]: On model.case_project.orders_fact: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.orders_fact"} */

      drop view if exists "warehouse"."main_marts"."orders_fact__dbt_backup" cascade
    
[0m14:35:37.366511 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:35:37.367510 [debug] [Thread-1 (]: On model.case_project.orders_fact: Close
[0m14:35:37.368510 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d92fd6-c973-4d6b-b0f7-e9bc4e7b07cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1634F0490>]}
[0m14:35:37.369512 [info ] [Thread-1 (]: 9 of 10 OK created sql view model main_marts.orders_fact ....................... [[32mOK[0m in 0.05s]
[0m14:35:37.370512 [debug] [Thread-1 (]: Finished running node model.case_project.orders_fact
[0m14:35:37.371510 [debug] [Thread-1 (]: Began running node model.case_project.monthly_summary
[0m14:35:37.372511 [info ] [Thread-1 (]: 10 of 10 START sql view model main_marts.monthly_summary ....................... [RUN]
[0m14:35:37.372511 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.case_project.orders_fact, now model.case_project.monthly_summary)
[0m14:35:37.373512 [debug] [Thread-1 (]: Began compiling node model.case_project.monthly_summary
[0m14:35:37.377510 [debug] [Thread-1 (]: Writing injected SQL for node "model.case_project.monthly_summary"
[0m14:35:37.381511 [debug] [Thread-1 (]: Began executing node model.case_project.monthly_summary
[0m14:35:37.386511 [debug] [Thread-1 (]: Writing runtime sql for node "model.case_project.monthly_summary"
[0m14:35:37.393511 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.monthly_summary"
[0m14:35:37.393511 [debug] [Thread-1 (]: On model.case_project.monthly_summary: BEGIN
[0m14:35:37.394512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:37.395512 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:35:37.396513 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.monthly_summary"
[0m14:35:37.397512 [debug] [Thread-1 (]: On model.case_project.monthly_summary: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.monthly_summary"} */

  
  create view "warehouse"."main_marts"."monthly_summary__dbt_tmp" as (
    with base as (
  select
    order_id,
    customer_id,
    order_date,
    order_month,
    order_revenue_usd
  from "warehouse"."main_marts"."orders_fact"
),
labeled as (
  select
    b.*,
    case when order_date = min(order_date) over (partition by customer_id)
         then 1 else 0 end as is_new_order
  from base b
)
select
  order_month,
  sum(order_revenue_usd)                                   as monthly_revenue_usd,   -- KPI: Revenue
  count(distinct order_id)                                 as monthly_orders,
  count(distinct customer_id)                              as active_customers,
  sum(order_revenue_usd) / nullif(count(distinct order_id),0) as aov_usd,
  sum(is_new_order)                                        as new_customers,
  (count(distinct customer_id) - sum(is_new_order))        as repeat_customers,
  (count(distinct customer_id) - sum(is_new_order)) * 1.0
    / nullif(count(distinct customer_id),0)                as repeat_purchase_rate
from labeled
group by 1
order by 1
  );

[0m14:35:37.401512 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:35:37.409512 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.monthly_summary"
[0m14:35:37.410513 [debug] [Thread-1 (]: On model.case_project.monthly_summary: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.monthly_summary"} */
alter view "warehouse"."main_marts"."monthly_summary" rename to "monthly_summary__dbt_backup"
[0m14:35:37.411512 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:35:37.416515 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.monthly_summary"
[0m14:35:37.417514 [debug] [Thread-1 (]: On model.case_project.monthly_summary: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.monthly_summary"} */
alter view "warehouse"."main_marts"."monthly_summary__dbt_tmp" rename to "monthly_summary"
[0m14:35:37.418542 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:35:37.421510 [debug] [Thread-1 (]: On model.case_project.monthly_summary: COMMIT
[0m14:35:37.423512 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.monthly_summary"
[0m14:35:37.423512 [debug] [Thread-1 (]: On model.case_project.monthly_summary: COMMIT
[0m14:35:37.426542 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:35:37.430541 [debug] [Thread-1 (]: Using duckdb connection "model.case_project.monthly_summary"
[0m14:35:37.431541 [debug] [Thread-1 (]: On model.case_project.monthly_summary: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "case_duckdb", "target_name": "dev", "node_id": "model.case_project.monthly_summary"} */

      drop view if exists "warehouse"."main_marts"."monthly_summary__dbt_backup" cascade
    
[0m14:35:37.433739 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:35:37.434748 [debug] [Thread-1 (]: On model.case_project.monthly_summary: Close
[0m14:35:37.435748 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d92fd6-c973-4d6b-b0f7-e9bc4e7b07cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1670C86D0>]}
[0m14:35:37.436748 [info ] [Thread-1 (]: 10 of 10 OK created sql view model main_marts.monthly_summary .................. [[32mOK[0m in 0.06s]
[0m14:35:37.437605 [debug] [Thread-1 (]: Finished running node model.case_project.monthly_summary
[0m14:35:37.439008 [debug] [MainThread]: Using duckdb connection "master"
[0m14:35:37.440044 [debug] [MainThread]: On master: BEGIN
[0m14:35:37.440044 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:35:37.441044 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:35:37.441044 [debug] [MainThread]: On master: COMMIT
[0m14:35:37.442044 [debug] [MainThread]: Using duckdb connection "master"
[0m14:35:37.442044 [debug] [MainThread]: On master: COMMIT
[0m14:35:37.443046 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:35:37.444015 [debug] [MainThread]: On master: Close
[0m14:35:37.444015 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:35:37.445017 [debug] [MainThread]: Connection 'create_warehouse_main_staging' was properly closed.
[0m14:35:37.445017 [debug] [MainThread]: Connection 'list_warehouse_main_staging' was properly closed.
[0m14:35:37.446017 [debug] [MainThread]: Connection 'model.case_project.monthly_summary' was properly closed.
[0m14:35:37.446017 [info ] [MainThread]: 
[0m14:35:37.447018 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 1.04 seconds (1.04s).
[0m14:35:37.450044 [debug] [MainThread]: Command end result
[0m14:35:37.540484 [debug] [MainThread]: Wrote artifact WritableManifest to D:\projects\Case Project main\target\manifest.json
[0m14:35:37.547837 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\projects\Case Project main\target\semantic_manifest.json
[0m14:35:37.560844 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\projects\Case Project main\target\run_results.json
[0m14:35:37.560844 [info ] [MainThread]: 
[0m14:35:37.561873 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:35:37.562873 [info ] [MainThread]: 
[0m14:35:37.563842 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m14:35:37.564842 [debug] [MainThread]: Command `dbt run` succeeded at 14:35:37.564842 after 3.30 seconds
[0m14:35:37.565843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A163673190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1650C6B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1630740D0>]}
[0m14:35:37.565843 [debug] [MainThread]: Flushing usage events
[0m14:35:38.424588 [debug] [MainThread]: An error was encountered while trying to flush usage events
